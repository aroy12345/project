2025-04-13 12:52:14,176 - INFO - --- Logging Initialized ---

2025-04-13 12:52:16,670 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,671 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,672 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,858 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,860 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,864 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,865 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,997 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:16,999 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,008 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,008 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,009 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,010 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,011 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,012 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,013 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,056 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,057 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,058 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,301 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,303 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,419 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:52:17,419 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:52:17,529 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,530 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,531 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,531 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,532 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,533 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,536 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:52:17,536 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,537 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,539 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,540 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,541 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,542 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,544 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,545 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,546 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,547 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,553 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,669 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,677 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,678 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,680 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,806 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,815 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,816 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,820 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,828 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,828 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,834 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,836 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,836 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,837 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,838 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,840 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,840 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,841 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,842 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,843 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,844 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,845 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,850 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,855 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,856 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,858 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,859 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,860 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,861 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,861 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,861 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,867 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,868 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,869 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,869 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,870 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,871 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,871 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,874 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,874 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,878 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,879 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,884 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:17,885 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:18,084 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:18,085 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:18,086 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:52:18,644 - INFO - Starting training loop with: epochs=20, batch_size=8
2025-04-13 12:52:18,644 - INFO - Loss coefficients: diffusion=1.0, grasp=0.5, tsdf=0.0, collision=0.0, distance=0.0, euclidean=0.0
2025-04-13 12:52:18,644 - INFO - Model settings: seq_len=50, obs_dim=7, cond_dim=104, tsdf_dim=32, num_grasp_points=64, num_tsdf_points=32
2025-04-13 12:52:18,671 - INFO - 
=== EPOCH 1/20 ===
2025-04-13 12:52:18,672 - INFO - GPU Memory: 0.06GB allocated, 0.08GB reserved
2025-04-13 12:52:18,676 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:18,681 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9397, 3.9134]
2025-04-13 12:52:18,681 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0471, 3.0024]
2025-04-13 12:52:18,691 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:18,691 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:18,750 - INFO -   True actions shape: tensor([-0.6666, -1.0131, -0.0311,  0.1305,  0.3485,  0.3685, -0.1544],
       device='cuda:0'), range: [-3.9397, 3.9134]
2025-04-13 12:52:18,751 - INFO -   Noise shape: tensor([ 1.2214,  0.7733, -1.5650,  0.9370,  0.7866,  2.0985,  0.4123],
       device='cuda:0'), range: [-2.8623, 3.9696]
2025-04-13 12:52:18,751 - INFO -   Noisy actions shape: tensor([ 0.4377, -0.1262, -1.1651,  0.7739,  0.8128,  1.7852,  0.1959],
       device='cuda:0'), range: [-3.9070, 4.0220]
2025-04-13 12:52:18,752 - INFO -   Diffusion: timestep range [318, 979], noise range [-2.8623, 3.9696]
2025-04-13 12:52:18,752 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.9070, 4.0220]
2025-04-13 12:52:19,205 - INFO -   Model output shapes:
2025-04-13 12:52:19,205 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:19,208 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4297, 0.5883]
2025-04-13 12:52:19,208 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7183
2025-04-13 12:52:19,208 - INFO -     Grasp width: torch.Size([8, 64]), range: [-1.0101, 0.0640]
2025-04-13 12:52:19,329 - INFO -   Loss components:
2025-04-13 12:52:19,329 - INFO -     Diffusion loss: 3.684196 (coef: 1.0)
2025-04-13 12:52:19,329 - INFO -     Grasp quality loss: 0.694373 (coef: 0.5)
2025-04-13 12:52:19,329 - INFO -     Grasp rotation loss: 0.594938 (coef: 0.5)
2025-04-13 12:52:19,329 - INFO -     Grasp width loss: 436.188660 (coef: 0.005)
2025-04-13 12:52:19,329 - INFO -     TOTAL loss: 6.509794
2025-04-13 12:52:19,337 - INFO -   Gradients: avg norm: 2.183311, max norm: 28.481197, non-zero params: 250
2025-04-13 12:52:19,337 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:52:19,337 - INFO - --- Gradient Check @ Epoch 1, Batch 0 ---
2025-04-13 12:52:19,360 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:19,360 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:19,360 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.2759e+00, MaxNorm=5.3261e+00
2025-04-13 12:52:19,360 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.6649e-02, MaxNorm=5.2263e-02
2025-04-13 12:52:19,360 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.3566e-02, MaxNorm=3.1160e-02
2025-04-13 12:52:19,360 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=9.0666e+00, MaxNorm=2.3462e+01
2025-04-13 12:52:19,360 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.1458e+00, MaxNorm=3.9803e+00
2025-04-13 12:52:19,360 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.2357e+00, MaxNorm=4.0378e+00
2025-04-13 12:52:19,360 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.7377e-01, MaxNorm=1.2324e+00
2025-04-13 12:52:19,361 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.5499e+01, MaxNorm=2.8481e+01
2025-04-13 12:52:19,361 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9877e+00, MaxNorm=2.2190e+00
2025-04-13 12:52:19,361 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.3780e+00, MaxNorm=6.1498e+00
2025-04-13 12:52:19,361 - INFO - --- End Gradient Check ---
2025-04-13 12:52:19,364 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:19,364 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1203, 3.3493]
2025-04-13 12:52:19,364 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8500, 3.3019]
2025-04-13 12:52:19,364 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,364 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,365 - INFO -   True actions shape: tensor([-0.4643, -0.0068, -3.1203, -0.0182,  0.7365,  0.3831, -1.5187],
       device='cuda:0'), range: [-3.1203, 3.3493]
2025-04-13 12:52:19,366 - INFO -   Noise shape: tensor([ 0.2762, -0.0269, -0.2051, -0.9875, -0.5300,  1.0164, -0.1090],
       device='cuda:0'), range: [-3.3792, 3.8011]
2025-04-13 12:52:19,366 - INFO -   Noisy actions shape: tensor([-0.0836, -0.0250, -2.1489, -0.7719,  0.0618,  1.0270, -1.0529],
       device='cuda:0'), range: [-3.3302, 3.9014]
2025-04-13 12:52:19,409 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:19,409 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6604, 3.1860]
2025-04-13 12:52:19,409 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9504, 2.9697]
2025-04-13 12:52:19,410 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,410 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,410 - INFO -   True actions shape: tensor([-0.3889,  0.9209,  0.4214,  1.2663, -0.5470,  0.0451,  1.7984],
       device='cuda:0'), range: [-3.6604, 3.1860]
2025-04-13 12:52:19,411 - INFO -   Noise shape: tensor([ 0.0037, -0.1090,  0.1668,  0.1331,  1.1770,  0.7267, -1.9685],
       device='cuda:0'), range: [-3.2019, 3.4325]
2025-04-13 12:52:19,411 - INFO -   Noisy actions shape: tensor([-0.1527,  0.2698,  0.3219,  0.6302,  0.8585,  0.6837, -1.0812],
       device='cuda:0'), range: [-3.2693, 2.9358]
2025-04-13 12:52:19,453 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:19,453 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2380, 3.1834]
2025-04-13 12:52:19,454 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8751, 3.1316]
2025-04-13 12:52:19,454 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,454 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,454 - INFO -   True actions shape: tensor([-0.1856,  0.3001, -0.8868, -2.2780,  0.2187, -0.7680,  0.1066],
       device='cuda:0'), range: [-4.2380, 3.1834]
2025-04-13 12:52:19,455 - INFO -   Noise shape: tensor([ 1.3945,  0.2047, -1.0255,  0.0733, -0.2128, -0.8137, -1.8497],
       device='cuda:0'), range: [-3.5483, 3.1642]
2025-04-13 12:52:19,456 - INFO -   Noisy actions shape: tensor([ 0.1267,  0.3378, -1.0912, -2.2056,  0.1663, -0.9286, -0.3042],
       device='cuda:0'), range: [-3.8763, 3.3063]
2025-04-13 12:52:19,500 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:19,501 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4967, 2.9657]
2025-04-13 12:52:19,501 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2552, 3.2593]
2025-04-13 12:52:19,501 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,501 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,502 - INFO -   True actions shape: tensor([-0.3463,  1.0331, -0.1401, -1.0246, -0.5331,  0.0725,  0.8749],
       device='cuda:0'), range: [-3.4967, 2.9657]
2025-04-13 12:52:19,503 - INFO -   Noise shape: tensor([-1.7517,  2.1312,  1.8157, -1.4012, -0.3844, -0.0640,  0.9998],
       device='cuda:0'), range: [-3.4327, 3.4030]
2025-04-13 12:52:19,504 - INFO -   Noisy actions shape: tensor([-0.6158,  1.3534,  0.1454, -1.2309, -0.5866,  0.0616,  1.0203],
       device='cuda:0'), range: [-4.0371, 3.2379]
2025-04-13 12:52:19,554 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:19,554 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1994, 3.1074]
2025-04-13 12:52:19,554 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7495, 3.8757]
2025-04-13 12:52:19,554 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,554 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,555 - INFO -   True actions shape: tensor([ 0.8408, -0.4295, -1.0335,  1.3449,  0.3419,  1.0533, -0.2507],
       device='cuda:0'), range: [-4.1994, 3.1074]
2025-04-13 12:52:19,556 - INFO -   Noise shape: tensor([ 1.0290, -0.8454,  0.9431, -0.9867, -0.8276, -1.7638, -0.2000],
       device='cuda:0'), range: [-3.3043, 4.1422]
2025-04-13 12:52:19,556 - INFO -   Noisy actions shape: tensor([ 1.3010, -0.9482,  0.3593, -0.2542, -0.5762, -1.0780, -0.2931],
       device='cuda:0'), range: [-3.6499, 3.5433]
2025-04-13 12:52:19,606 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:19,606 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3820, 3.4661]
2025-04-13 12:52:19,606 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0076, 3.0073]
2025-04-13 12:52:19,606 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,606 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,607 - INFO -   True actions shape: tensor([ 0.2726, -1.2039,  0.8749,  1.3065, -1.9803,  0.8436, -0.3921],
       device='cuda:0'), range: [-3.3820, 3.4661]
2025-04-13 12:52:19,608 - INFO -   Noise shape: tensor([-1.1808, -1.0224, -0.1465,  1.1248, -0.6543, -0.2835, -0.1676],
       device='cuda:0'), range: [-4.1097, 3.0055]
2025-04-13 12:52:19,608 - INFO -   Noisy actions shape: tensor([-0.5917, -1.5786,  0.5494,  1.7234, -1.9061,  0.4342, -0.4030],
       device='cuda:0'), range: [-3.8237, 3.2322]
2025-04-13 12:52:19,651 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:19,651 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6739, 4.2254]
2025-04-13 12:52:19,651 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6162, 2.5894]
2025-04-13 12:52:19,651 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,651 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,652 - INFO -   True actions shape: tensor([ 0.7707, -0.0842,  0.5269,  1.1477,  0.7826,  0.6090,  1.4257],
       device='cuda:0'), range: [-3.6739, 4.2254]
2025-04-13 12:52:19,652 - INFO -   Noise shape: tensor([-1.0647,  1.1365, -0.2196, -0.3521, -0.3110,  0.1509, -0.6110],
       device='cuda:0'), range: [-3.4924, 3.7494]
2025-04-13 12:52:19,653 - INFO -   Noisy actions shape: tensor([-0.5236,  0.9351,  0.0795,  0.2817,  0.1311,  0.4401,  0.2005],
       device='cuda:0'), range: [-3.1488, 4.2156]
2025-04-13 12:52:19,695 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:19,695 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4315, 3.1897]
2025-04-13 12:52:19,695 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9581, 3.3731]
2025-04-13 12:52:19,695 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,695 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,696 - INFO -   True actions shape: tensor([ 0.2169, -0.3409,  0.2340, -0.6041,  1.4946,  0.1573, -1.7103],
       device='cuda:0'), range: [-3.4315, 3.1897]
2025-04-13 12:52:19,697 - INFO -   Noise shape: tensor([-0.2725,  0.0779,  0.3452,  1.6402,  0.2430,  1.6771,  0.1773],
       device='cuda:0'), range: [-4.0344, 2.9099]
2025-04-13 12:52:19,697 - INFO -   Noisy actions shape: tensor([-0.0967, -0.1337,  0.4170,  0.9880,  1.0631,  1.4588, -0.8452],
       device='cuda:0'), range: [-3.6715, 3.5761]
2025-04-13 12:52:19,739 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:19,739 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.8716, 3.2998]
2025-04-13 12:52:19,739 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6258, 3.6490]
2025-04-13 12:52:19,739 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,740 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,740 - INFO -   True actions shape: tensor([-0.7268, -0.4867,  0.7691, -1.4098,  0.1055, -0.7214,  0.9365],
       device='cuda:0'), range: [-2.8716, 3.2998]
2025-04-13 12:52:19,741 - INFO -   Noise shape: tensor([-0.4401,  1.0694, -0.7158, -1.0670, -1.3156,  0.0077,  0.0512],
       device='cuda:0'), range: [-3.5038, 3.2508]
2025-04-13 12:52:19,742 - INFO -   Noisy actions shape: tensor([-0.7611,  0.6419, -0.1920, -1.6565, -1.0541, -0.3802,  0.5452],
       device='cuda:0'), range: [-4.0453, 3.2241]
2025-04-13 12:52:19,785 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:19,785 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3286, 4.1814]
2025-04-13 12:52:19,785 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2653, 3.2176]
2025-04-13 12:52:19,785 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,785 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,786 - INFO -   True actions shape: tensor([ 2.2944,  0.4994,  1.5391, -1.1620,  2.0285,  0.2566, -0.3258],
       device='cuda:0'), range: [-3.3286, 4.1814]
2025-04-13 12:52:19,787 - INFO -   Noise shape: tensor([-1.1018, -1.6709, -0.7822, -1.2188,  0.4603, -0.7381, -0.6859],
       device='cuda:0'), range: [-3.4642, 3.1013]
2025-04-13 12:52:19,787 - INFO -   Noisy actions shape: tensor([-0.4079, -1.4614, -0.3150, -1.4977,  1.0153, -0.6354, -0.7500],
       device='cuda:0'), range: [-3.6966, 3.4986]
2025-04-13 12:52:19,826 - INFO -   Loss components:
2025-04-13 12:52:19,826 - INFO -     Diffusion loss: 3.308336 (coef: 1.0)
2025-04-13 12:52:19,826 - INFO -     Grasp quality loss: 0.693757 (coef: 0.5)
2025-04-13 12:52:19,826 - INFO -     Grasp rotation loss: 0.558718 (coef: 0.5)
2025-04-13 12:52:19,826 - INFO -     Grasp width loss: 110.025482 (coef: 0.005)
2025-04-13 12:52:19,826 - INFO -     TOTAL loss: 4.484701
2025-04-13 12:52:19,835 - INFO -   Gradients: avg norm: 1.268981, max norm: 10.893431, non-zero params: 250
2025-04-13 12:52:19,835 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:52:19,837 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:19,837 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3830, 3.0896]
2025-04-13 12:52:19,837 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0187, 3.1012]
2025-04-13 12:52:19,838 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,838 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,838 - INFO -   True actions shape: tensor([ 1.1139,  0.4048,  1.8872,  0.0647, -0.3570, -0.9342, -1.0618],
       device='cuda:0'), range: [-3.3830, 3.0896]
2025-04-13 12:52:19,839 - INFO -   Noise shape: tensor([-0.9651,  1.1498, -0.2174, -0.4101,  0.5417, -0.7178, -0.8238],
       device='cuda:0'), range: [-3.3963, 3.1861]
2025-04-13 12:52:19,839 - INFO -   Noisy actions shape: tensor([ 0.2058,  1.0605,  1.2801, -0.2206,  0.0867, -1.1759, -1.3417],
       device='cuda:0'), range: [-3.3567, 3.1380]
2025-04-13 12:52:19,881 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:19,881 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1978, 3.9235]
2025-04-13 12:52:19,881 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0819, 2.9041]
2025-04-13 12:52:19,881 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,881 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,882 - INFO -   True actions shape: tensor([ 1.5729, -0.6532, -0.6387, -0.8654, -0.6268, -0.5278,  1.3351],
       device='cuda:0'), range: [-4.1978, 3.9235]
2025-04-13 12:52:19,882 - INFO -   Noise shape: tensor([ 2.1106, -1.3758, -0.5379,  0.2603, -1.4839, -0.6956, -0.3677],
       device='cuda:0'), range: [-3.3606, 3.3107]
2025-04-13 12:52:19,883 - INFO -   Noisy actions shape: tensor([ 2.5990, -1.4274, -0.8330, -0.4390, -1.4838, -0.8633,  0.7010],
       device='cuda:0'), range: [-4.1248, 3.3024]
2025-04-13 12:52:19,950 - INFO - 
=== Epoch 1 Summary ===
2025-04-13 12:52:19,950 - INFO -   Avg total loss: 5.193854
2025-04-13 12:52:19,950 - INFO -   Avg diffusion loss: 3.380566
2025-04-13 12:52:19,950 - INFO -   Avg grasp loss: 3.626577
2025-04-13 12:52:19,950 - INFO - 
=== EPOCH 2/20 ===
2025-04-13 12:52:19,951 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:19,954 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:19,954 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4152, 3.1792]
2025-04-13 12:52:19,954 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6647, 3.3442]
2025-04-13 12:52:19,954 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:19,954 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:19,955 - INFO -   True actions shape: tensor([ 0.1679, -0.7249, -2.0377, -0.7047, -2.6330,  0.5964, -0.4057],
       device='cuda:0'), range: [-3.4152, 3.1792]
2025-04-13 12:52:19,955 - INFO -   Noise shape: tensor([ 3.7676, -1.8073,  0.3019, -0.3516, -0.2697,  0.9036, -1.9750],
       device='cuda:0'), range: [-3.4643, 3.7676]
2025-04-13 12:52:19,956 - INFO -   Noisy actions shape: tensor([ 3.1761, -1.8948, -0.9273, -0.6934, -1.7375,  1.0822, -1.8480],
       device='cuda:0'), range: [-3.3299, 3.3897]
2025-04-13 12:52:19,956 - INFO -   Diffusion: timestep range [225, 890], noise range [-3.4643, 3.7676]
2025-04-13 12:52:19,956 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3299, 3.3897]
2025-04-13 12:52:19,975 - INFO -   Model output shapes:
2025-04-13 12:52:19,975 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:19,975 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4194, 0.5539]
2025-04-13 12:52:19,975 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7268
2025-04-13 12:52:19,975 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.5133, 0.2973]
2025-04-13 12:52:19,996 - INFO -   Loss components:
2025-04-13 12:52:19,996 - INFO -     Diffusion loss: 3.308315 (coef: 1.0)
2025-04-13 12:52:19,996 - INFO -     Grasp quality loss: 0.695727 (coef: 0.5)
2025-04-13 12:52:19,996 - INFO -     Grasp rotation loss: 0.579500 (coef: 0.5)
2025-04-13 12:52:19,996 - INFO -     Grasp width loss: 83.888641 (coef: 0.005)
2025-04-13 12:52:19,996 - INFO -     TOTAL loss: 4.365372
2025-04-13 12:52:20,004 - INFO -   Gradients: avg norm: 1.198550, max norm: 8.784425, non-zero params: 250
2025-04-13 12:52:20,004 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:52:20,004 - INFO - --- Gradient Check @ Epoch 2, Batch 0 ---
2025-04-13 12:52:20,022 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:20,022 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:20,022 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.3015e+00, MaxNorm=5.2918e+00
2025-04-13 12:52:20,022 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.1484e-02, MaxNorm=2.4046e-02
2025-04-13 12:52:20,022 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.3532e-02, MaxNorm=2.7998e-02
2025-04-13 12:52:20,022 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.7534e+00, MaxNorm=7.4298e+00
2025-04-13 12:52:20,022 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.2928e+00, MaxNorm=4.3278e+00
2025-04-13 12:52:20,022 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.5007e+00, MaxNorm=4.5501e+00
2025-04-13 12:52:20,022 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.4679e-01, MaxNorm=1.0981e+00
2025-04-13 12:52:20,022 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=7.9253e+00, MaxNorm=8.7844e+00
2025-04-13 12:52:20,022 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7705e+00, MaxNorm=1.8961e+00
2025-04-13 12:52:20,022 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.4871e+00, MaxNorm=6.2752e+00
2025-04-13 12:52:20,022 - INFO - --- End Gradient Check ---
2025-04-13 12:52:20,024 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:20,025 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6263, 3.5644]
2025-04-13 12:52:20,025 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2282, 3.0583]
2025-04-13 12:52:20,025 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,025 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,026 - INFO -   True actions shape: tensor([-0.5797, -0.0863,  1.4390, -1.3037,  1.0380, -0.3109,  1.3381],
       device='cuda:0'), range: [-3.6263, 3.5644]
2025-04-13 12:52:20,026 - INFO -   Noise shape: tensor([-1.8624,  1.2275,  0.5603,  0.6808, -0.6435, -0.6417,  1.5907],
       device='cuda:0'), range: [-3.6466, 3.1915]
2025-04-13 12:52:20,027 - INFO -   Noisy actions shape: tensor([-1.5448,  0.6349,  1.4996, -0.6755,  0.4796, -0.6232,  2.0092],
       device='cuda:0'), range: [-4.1974, 3.6572]
2025-04-13 12:52:20,072 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:20,072 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4406, 3.3157]
2025-04-13 12:52:20,072 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0379, 2.7197]
2025-04-13 12:52:20,072 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,072 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,073 - INFO -   True actions shape: tensor([-1.8217,  1.1807, -1.2310, -0.4848, -0.4134,  0.9575, -0.0946],
       device='cuda:0'), range: [-3.4406, 3.3157]
2025-04-13 12:52:20,074 - INFO -   Noise shape: tensor([-0.2260, -1.1290,  0.5135,  0.1512,  0.1142,  0.8261, -0.0532],
       device='cuda:0'), range: [-3.4751, 4.1981]
2025-04-13 12:52:20,074 - INFO -   Noisy actions shape: tensor([-1.3577, -0.0880, -0.4119, -0.2009, -0.1825,  1.2504, -0.1020],
       device='cuda:0'), range: [-3.4962, 3.5603]
2025-04-13 12:52:20,117 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:20,118 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5989, 3.5287]
2025-04-13 12:52:20,118 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8992, 3.9257]
2025-04-13 12:52:20,118 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,118 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,119 - INFO -   True actions shape: tensor([ 0.2285,  0.1135,  0.7308,  0.5886,  0.7678,  0.5021, -1.2398],
       device='cuda:0'), range: [-3.5989, 3.5287]
2025-04-13 12:52:20,119 - INFO -   Noise shape: tensor([ 0.0808,  0.1091, -0.5575,  0.4786,  0.0576, -0.3249, -1.8844],
       device='cuda:0'), range: [-3.5552, 3.5519]
2025-04-13 12:52:20,120 - INFO -   Noisy actions shape: tensor([ 0.2140,  0.1571,  0.0827,  0.7506,  0.5612,  0.0997, -2.2268],
       device='cuda:0'), range: [-3.3358, 4.0127]
2025-04-13 12:52:20,163 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:20,163 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4486, 3.2810]
2025-04-13 12:52:20,163 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5452, 2.9078]
2025-04-13 12:52:20,163 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,163 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,164 - INFO -   True actions shape: tensor([ 1.0803,  0.2797, -1.0855,  0.9842,  0.9556, -1.0564,  0.0182],
       device='cuda:0'), range: [-3.4486, 3.2810]
2025-04-13 12:52:20,165 - INFO -   Noise shape: tensor([ 0.4324, -0.2288, -1.5277,  1.5924,  0.0970,  0.8661, -1.3167],
       device='cuda:0'), range: [-3.3420, 3.8479]
2025-04-13 12:52:20,165 - INFO -   Noisy actions shape: tensor([ 0.8848, -0.0727, -1.8571,  1.8673,  0.5298,  0.2762, -1.1575],
       device='cuda:0'), range: [-3.2745, 3.3209]
2025-04-13 12:52:20,207 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:20,207 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3263, 3.0915]
2025-04-13 12:52:20,207 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2790, 2.8367]
2025-04-13 12:52:20,207 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,207 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,208 - INFO -   True actions shape: tensor([-0.0253, -1.3960,  0.1867, -0.2099, -0.1322, -0.6402,  0.0705],
       device='cuda:0'), range: [-4.3263, 3.0915]
2025-04-13 12:52:20,209 - INFO -   Noise shape: tensor([-0.9895,  1.3058, -0.8007, -0.0566, -1.6710, -0.1017, -1.4796],
       device='cuda:0'), range: [-3.6277, 3.3795]
2025-04-13 12:52:20,209 - INFO -   Noisy actions shape: tensor([-0.7940,  0.1653, -0.5146, -0.1741, -1.3960, -0.4752, -1.1204],
       device='cuda:0'), range: [-3.3089, 3.4503]
2025-04-13 12:52:20,251 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:20,251 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3180, 3.6843]
2025-04-13 12:52:20,251 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0693, 3.4025]
2025-04-13 12:52:20,251 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,251 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,252 - INFO -   True actions shape: tensor([ 2.1105, -1.2195, -2.1114, -0.0091,  0.0460,  1.3429,  1.6600],
       device='cuda:0'), range: [-3.3180, 3.6843]
2025-04-13 12:52:20,253 - INFO -   Noise shape: tensor([ 0.3530,  0.7732, -0.0932, -1.1098, -0.9773,  0.7604,  0.9957],
       device='cuda:0'), range: [-3.5940, 3.4296]
2025-04-13 12:52:20,253 - INFO -   Noisy actions shape: tensor([ 1.5396, -0.1044, -1.3314, -0.8973, -0.7580,  1.4103,  1.7881],
       device='cuda:0'), range: [-3.4536, 3.0326]
2025-04-13 12:52:20,295 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:20,296 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2992, 3.6545]
2025-04-13 12:52:20,296 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7602, 3.0434]
2025-04-13 12:52:20,296 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,296 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,297 - INFO -   True actions shape: tensor([-0.2951,  0.3785, -0.9563, -0.0107,  0.4578,  1.5222, -0.0783],
       device='cuda:0'), range: [-3.2992, 3.6545]
2025-04-13 12:52:20,297 - INFO -   Noise shape: tensor([-1.0945, -1.1947,  0.3814, -0.1442,  0.5276, -1.1408,  2.0021],
       device='cuda:0'), range: [-3.5995, 3.5365]
2025-04-13 12:52:20,298 - INFO -   Noisy actions shape: tensor([-1.0694, -0.7708, -0.2268, -0.1249,  0.6940, -0.0791,  1.6063],
       device='cuda:0'), range: [-3.5408, 4.1468]
2025-04-13 12:52:20,340 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:20,340 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4495, 3.1986]
2025-04-13 12:52:20,340 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1368, 2.6729]
2025-04-13 12:52:20,340 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,340 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,341 - INFO -   True actions shape: tensor([ 1.0596,  1.0569, -2.4171,  0.0086,  1.3230,  0.5891,  2.1032],
       device='cuda:0'), range: [-3.4495, 3.1986]
2025-04-13 12:52:20,341 - INFO -   Noise shape: tensor([-1.1582, -0.2032, -0.2323,  1.5845,  2.2641, -0.4478, -0.0153],
       device='cuda:0'), range: [-3.2188, 3.5648]
2025-04-13 12:52:20,342 - INFO -   Noisy actions shape: tensor([-0.4263,  0.3841, -1.4707,  1.3514,  2.6214, -0.0703,  1.0950],
       device='cuda:0'), range: [-3.3127, 3.4142]
2025-04-13 12:52:20,384 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:20,384 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2303, 4.3183]
2025-04-13 12:52:20,385 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5946, 3.1230]
2025-04-13 12:52:20,385 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,385 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,385 - INFO -   True actions shape: tensor([ 1.4717,  0.0681, -0.6291,  0.1411,  0.9453,  2.4909, -1.3741],
       device='cuda:0'), range: [-3.2303, 4.3183]
2025-04-13 12:52:20,386 - INFO -   Noise shape: tensor([-0.3902,  2.2457,  0.3350,  1.1655,  0.7645, -1.0707, -0.1716],
       device='cuda:0'), range: [-3.5713, 3.4849]
2025-04-13 12:52:20,387 - INFO -   Noisy actions shape: tensor([ 1.3655,  0.5109, -0.5504,  0.3688,  1.0779,  2.2299, -1.3809],
       device='cuda:0'), range: [-3.6811, 4.1101]
2025-04-13 12:52:20,428 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:20,428 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6247, 3.9889]
2025-04-13 12:52:20,428 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9864, 3.3528]
2025-04-13 12:52:20,429 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,429 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,429 - INFO -   True actions shape: tensor([-0.7030, -1.9333, -0.1206,  2.2723,  0.9816, -0.9586,  0.3250],
       device='cuda:0'), range: [-3.6247, 3.9889]
2025-04-13 12:52:20,430 - INFO -   Noise shape: tensor([ 0.8852,  1.1660, -0.1965, -0.2450, -0.5195, -0.1091,  0.0820],
       device='cuda:0'), range: [-3.1925, 3.7783]
2025-04-13 12:52:20,430 - INFO -   Noisy actions shape: tensor([ 0.2002, -0.4017, -0.2272,  1.3171,  0.2584, -0.7151,  0.2763],
       device='cuda:0'), range: [-3.8723, 3.5399]
2025-04-13 12:52:20,469 - INFO -   Loss components:
2025-04-13 12:52:20,469 - INFO -     Diffusion loss: 3.116931 (coef: 1.0)
2025-04-13 12:52:20,469 - INFO -     Grasp quality loss: 0.691314 (coef: 0.5)
2025-04-13 12:52:20,469 - INFO -     Grasp rotation loss: 0.575889 (coef: 0.5)
2025-04-13 12:52:20,469 - INFO -     Grasp width loss: 71.948318 (coef: 0.005)
2025-04-13 12:52:20,469 - INFO -     TOTAL loss: 4.110274
2025-04-13 12:52:20,478 - INFO -   Gradients: avg norm: 1.048114, max norm: 7.354327, non-zero params: 250
2025-04-13 12:52:20,478 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:52:20,480 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:20,480 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4078, 3.0252]
2025-04-13 12:52:20,481 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5981, 4.1663]
2025-04-13 12:52:20,481 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,481 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,481 - INFO -   True actions shape: tensor([-0.5100, -0.9684,  0.6031, -0.3778,  0.8911,  0.8038, -1.2325],
       device='cuda:0'), range: [-3.4078, 3.0252]
2025-04-13 12:52:20,482 - INFO -   Noise shape: tensor([-0.5576,  0.8881,  0.7978,  0.1873,  1.2719,  0.6276,  0.4758],
       device='cuda:0'), range: [-3.7411, 3.3456]
2025-04-13 12:52:20,483 - INFO -   Noisy actions shape: tensor([-0.5996, -0.7983,  0.7333, -0.3393,  1.0997,  0.9011, -1.1304],
       device='cuda:0'), range: [-3.4979, 3.7140]
2025-04-13 12:52:20,524 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:20,524 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6606, 3.5269]
2025-04-13 12:52:20,524 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1320, 2.8130]
2025-04-13 12:52:20,524 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,524 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,525 - INFO -   True actions shape: tensor([ 0.6957, -0.8348, -0.0194,  1.4993,  0.0192,  0.5517,  0.4251],
       device='cuda:0'), range: [-3.6606, 3.5269]
2025-04-13 12:52:20,526 - INFO -   Noise shape: tensor([-1.1408,  1.1145, -0.3810,  0.9511,  0.6097, -0.5680,  0.0444],
       device='cuda:0'), range: [-3.6344, 3.0912]
2025-04-13 12:52:20,526 - INFO -   Noisy actions shape: tensor([-0.9718,  0.9173, -0.3768,  1.2413,  0.6004, -0.4413,  0.1316],
       device='cuda:0'), range: [-3.9132, 3.5082]
2025-04-13 12:52:20,565 - INFO - 
=== Epoch 2 Summary ===
2025-04-13 12:52:20,565 - INFO -   Avg total loss: 3.966645
2025-04-13 12:52:20,565 - INFO -   Avg diffusion loss: 2.983597
2025-04-13 12:52:20,565 - INFO -   Avg grasp loss: 1.966096
2025-04-13 12:52:20,565 - INFO - 
=== EPOCH 3/20 ===
2025-04-13 12:52:20,566 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:20,569 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:20,569 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2301, 3.4227]
2025-04-13 12:52:20,569 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9771, 3.5760]
2025-04-13 12:52:20,569 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,569 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,570 - INFO -   True actions shape: tensor([-0.3892,  0.5221,  1.9381, -1.4132, -0.9871,  1.9017,  0.2119],
       device='cuda:0'), range: [-3.2301, 3.4227]
2025-04-13 12:52:20,571 - INFO -   Noise shape: tensor([ 0.1793,  2.7327,  1.0262,  0.6918, -1.3533, -0.0283, -1.1522],
       device='cuda:0'), range: [-3.2974, 3.3681]
2025-04-13 12:52:20,571 - INFO -   Noisy actions shape: tensor([ 1.3583e-03,  2.7026e+00,  1.7388e+00,  4.1974e-02, -1.6411e+00,
         7.6454e-01, -9.5992e-01], device='cuda:0'), range: [-3.2580, 3.7313]
2025-04-13 12:52:20,571 - INFO -   Diffusion: timestep range [167, 724], noise range [-3.2974, 3.3681]
2025-04-13 12:52:20,571 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.2580, 3.7313]
2025-04-13 12:52:20,590 - INFO -   Model output shapes:
2025-04-13 12:52:20,590 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:20,590 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4191, 0.5639]
2025-04-13 12:52:20,590 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7049
2025-04-13 12:52:20,590 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.4470, 0.2994]
2025-04-13 12:52:20,610 - INFO -   Loss components:
2025-04-13 12:52:20,610 - INFO -     Diffusion loss: 3.116881 (coef: 1.0)
2025-04-13 12:52:20,610 - INFO -     Grasp quality loss: 0.698785 (coef: 0.5)
2025-04-13 12:52:20,610 - INFO -     Grasp rotation loss: 0.582241 (coef: 0.5)
2025-04-13 12:52:20,611 - INFO -     Grasp width loss: 65.739563 (coef: 0.005)
2025-04-13 12:52:20,611 - INFO -     TOTAL loss: 4.086092
2025-04-13 12:52:20,619 - INFO -   Gradients: avg norm: 1.012008, max norm: 6.526047, non-zero params: 250
2025-04-13 12:52:20,619 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:52:20,619 - INFO - --- Gradient Check @ Epoch 3, Batch 0 ---
2025-04-13 12:52:20,636 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:20,636 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:20,636 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1645e+00, MaxNorm=4.6669e+00
2025-04-13 12:52:20,636 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.2016e-02, MaxNorm=2.0131e-02
2025-04-13 12:52:20,636 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.5307e-02, MaxNorm=3.3778e-02
2025-04-13 12:52:20,636 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.0714e+00, MaxNorm=5.5522e+00
2025-04-13 12:52:20,636 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.9582e+00, MaxNorm=3.6141e+00
2025-04-13 12:52:20,636 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.2949e+00, MaxNorm=4.1336e+00
2025-04-13 12:52:20,636 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.3547e-01, MaxNorm=1.0728e+00
2025-04-13 12:52:20,636 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.8537e+00, MaxNorm=6.5260e+00
2025-04-13 12:52:20,636 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7946e+00, MaxNorm=1.8655e+00
2025-04-13 12:52:20,636 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.1525e+00, MaxNorm=5.6983e+00
2025-04-13 12:52:20,636 - INFO - --- End Gradient Check ---
2025-04-13 12:52:20,639 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:20,639 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9598, 3.6185]
2025-04-13 12:52:20,639 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7003, 2.8406]
2025-04-13 12:52:20,639 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,639 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,640 - INFO -   True actions shape: tensor([-0.1949, -0.6028,  0.4053,  1.4352,  2.1202,  0.7989,  0.8051],
       device='cuda:0'), range: [-2.9598, 3.6185]
2025-04-13 12:52:20,640 - INFO -   Noise shape: tensor([ 0.6787,  0.4439, -1.4097, -0.7080,  1.6182, -1.5558,  0.5533],
       device='cuda:0'), range: [-4.1459, 4.1549]
2025-04-13 12:52:20,641 - INFO -   Noisy actions shape: tensor([ 0.6193,  0.3008, -1.2864, -0.3758,  2.0441, -1.3425,  0.7165],
       device='cuda:0'), range: [-3.6025, 4.0186]
2025-04-13 12:52:20,683 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:20,683 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1160, 3.7131]
2025-04-13 12:52:20,683 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6718, 3.5788]
2025-04-13 12:52:20,683 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,683 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,684 - INFO -   True actions shape: tensor([-0.5442,  1.9383,  0.8482,  1.1124, -1.0619,  1.1885,  0.1322],
       device='cuda:0'), range: [-4.1160, 3.7131]
2025-04-13 12:52:20,685 - INFO -   Noise shape: tensor([-0.3451, -2.5833,  0.8979,  0.6633,  0.4059,  1.3259,  1.2830],
       device='cuda:0'), range: [-3.4025, 3.1405]
2025-04-13 12:52:20,685 - INFO -   Noisy actions shape: tensor([-0.5648,  1.7727,  0.9028,  1.1517, -1.0344,  1.2692,  0.2123],
       device='cuda:0'), range: [-3.3584, 3.2598]
2025-04-13 12:52:20,727 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:20,727 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4050, 3.4269]
2025-04-13 12:52:20,727 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5395, 2.8079]
2025-04-13 12:52:20,727 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,727 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,728 - INFO -   True actions shape: tensor([-1.1124, -0.1856,  1.2295, -0.3142,  0.8883, -0.7666, -0.3787],
       device='cuda:0'), range: [-3.4050, 3.4269]
2025-04-13 12:52:20,728 - INFO -   Noise shape: tensor([-1.3871, -0.9116, -0.1117,  0.8107, -2.0847,  0.4844, -0.6647],
       device='cuda:0'), range: [-3.2274, 3.2163]
2025-04-13 12:52:20,729 - INFO -   Noisy actions shape: tensor([-1.7512, -0.8885,  0.4935,  0.5596, -1.4004,  0.0559, -0.7649],
       device='cuda:0'), range: [-3.7003, 3.2708]
2025-04-13 12:52:20,775 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:20,776 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4837, 3.4492]
2025-04-13 12:52:20,776 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6451, 2.8135]
2025-04-13 12:52:20,776 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,776 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,777 - INFO -   True actions shape: tensor([-1.0706, -1.0254,  0.7174, -0.2807, -0.7727,  0.9318, -0.2340],
       device='cuda:0'), range: [-3.4837, 3.4492]
2025-04-13 12:52:20,777 - INFO -   Noise shape: tensor([ 0.1815, -1.3155, -0.1281,  0.0433,  1.0254,  0.9444, -0.1682],
       device='cuda:0'), range: [-3.1669, 3.5274]
2025-04-13 12:52:20,778 - INFO -   Noisy actions shape: tensor([-0.4746, -1.6665,  0.3128, -0.1279,  0.3853,  1.3101, -0.2729],
       device='cuda:0'), range: [-3.4678, 3.8079]
2025-04-13 12:52:20,827 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:20,827 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3405, 4.0453]
2025-04-13 12:52:20,828 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4744, 3.3001]
2025-04-13 12:52:20,828 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,828 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,829 - INFO -   True actions shape: tensor([ 0.5516,  0.6295,  0.3203, -1.4905,  0.7138,  0.9180,  0.0458],
       device='cuda:0'), range: [-4.3405, 4.0453]
2025-04-13 12:52:20,829 - INFO -   Noise shape: tensor([-2.1727, -1.1118, -1.5044, -1.1329,  0.5265,  0.4710, -0.5159],
       device='cuda:0'), range: [-3.2973, 3.1832]
2025-04-13 12:52:20,830 - INFO -   Noisy actions shape: tensor([-2.0702, -1.0093, -1.4423, -1.3363,  0.6241,  0.5987, -0.5039],
       device='cuda:0'), range: [-3.3017, 3.6551]
2025-04-13 12:52:20,874 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:20,874 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5286, 3.3391]
2025-04-13 12:52:20,874 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7442, 3.0863]
2025-04-13 12:52:20,874 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,874 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,875 - INFO -   True actions shape: tensor([-0.2877,  0.4409,  0.2229,  0.1356, -1.0713,  0.0476, -0.8189],
       device='cuda:0'), range: [-3.5286, 3.3391]
2025-04-13 12:52:20,875 - INFO -   Noise shape: tensor([-0.1579, -1.1098, -0.6748,  1.1522, -1.5605, -0.3302, -0.2063],
       device='cuda:0'), range: [-3.2910, 3.3766]
2025-04-13 12:52:20,876 - INFO -   Noisy actions shape: tensor([-0.2300, -0.9489, -0.5892,  1.1459, -1.7924, -0.3049, -0.4204],
       device='cuda:0'), range: [-3.9196, 3.1811]
2025-04-13 12:52:20,918 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:20,918 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4508, 3.1842]
2025-04-13 12:52:20,918 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3391, 3.2081]
2025-04-13 12:52:20,918 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,918 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,919 - INFO -   True actions shape: tensor([-2.2064,  0.9534,  1.6092,  3.1842,  0.5713,  2.6282, -0.6997],
       device='cuda:0'), range: [-3.4508, 3.1842]
2025-04-13 12:52:20,920 - INFO -   Noise shape: tensor([-0.2315, -0.6638, -0.3947, -1.7582,  1.4827,  0.3403,  1.0107],
       device='cuda:0'), range: [-4.3653, 3.1052]
2025-04-13 12:52:20,920 - INFO -   Noisy actions shape: tensor([-2.2149,  0.8342,  1.5248,  2.8599,  0.8024,  2.6487, -0.5280],
       device='cuda:0'), range: [-3.5483, 3.7585]
2025-04-13 12:52:20,962 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:20,962 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1925, 4.0308]
2025-04-13 12:52:20,962 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0633, 3.8760]
2025-04-13 12:52:20,962 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:20,962 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:20,963 - INFO -   True actions shape: tensor([ 1.6967, -0.1975,  0.0912, -1.7914,  0.8059,  1.1549,  0.8303],
       device='cuda:0'), range: [-3.1925, 4.0308]
2025-04-13 12:52:20,964 - INFO -   Noise shape: tensor([ 0.3788, -0.1760, -1.2853,  0.0290, -1.0259,  0.3113, -0.4130],
       device='cuda:0'), range: [-3.3030, 3.2038]
2025-04-13 12:52:20,964 - INFO -   Noisy actions shape: tensor([ 1.0817, -0.2445, -1.1164, -0.7563, -0.5709,  0.7844, -0.0089],
       device='cuda:0'), range: [-3.1383, 3.3817]
2025-04-13 12:52:21,008 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:21,008 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7224, 3.3917]
2025-04-13 12:52:21,008 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9808, 2.9238]
2025-04-13 12:52:21,008 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,008 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,009 - INFO -   True actions shape: tensor([-2.4300, -0.1085, -0.9117,  0.3989, -0.4610, -0.1068, -1.3982],
       device='cuda:0'), range: [-3.7224, 3.3917]
2025-04-13 12:52:21,009 - INFO -   Noise shape: tensor([-1.0518, -0.1925, -0.2829,  1.3353, -0.8457, -0.7816,  0.9944],
       device='cuda:0'), range: [-3.3243, 3.1594]
2025-04-13 12:52:21,010 - INFO -   Noisy actions shape: tensor([-2.6191, -0.1938, -0.9236,  1.0438, -0.8380, -0.5034, -0.6624],
       device='cuda:0'), range: [-3.8365, 3.4064]
2025-04-13 12:52:21,051 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:21,051 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1721, 3.8178]
2025-04-13 12:52:21,051 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2783, 3.5015]
2025-04-13 12:52:21,051 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,052 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,052 - INFO -   True actions shape: tensor([ 0.9488, -1.3409, -0.2290, -0.9717,  1.1797, -0.9006,  1.5014],
       device='cuda:0'), range: [-3.1721, 3.8178]
2025-04-13 12:52:21,053 - INFO -   Noise shape: tensor([ 1.3338,  1.0214, -0.7307, -0.6272, -0.0697, -1.3996, -1.2761],
       device='cuda:0'), range: [-3.8072, 4.0686]
2025-04-13 12:52:21,053 - INFO -   Noisy actions shape: tensor([ 1.4666, -0.6989, -0.5472, -1.1528,  1.0067, -1.4551,  0.7200],
       device='cuda:0'), range: [-3.3400, 3.8114]
2025-04-13 12:52:21,092 - INFO -   Loss components:
2025-04-13 12:52:21,092 - INFO -     Diffusion loss: 2.530308 (coef: 1.0)
2025-04-13 12:52:21,092 - INFO -     Grasp quality loss: 0.694314 (coef: 0.5)
2025-04-13 12:52:21,092 - INFO -     Grasp rotation loss: 0.574911 (coef: 0.5)
2025-04-13 12:52:21,092 - INFO -     Grasp width loss: 33.472450 (coef: 0.005)
2025-04-13 12:52:21,092 - INFO -     TOTAL loss: 3.332283
2025-04-13 12:52:21,100 - INFO -   Gradients: avg norm: 0.598554, max norm: 4.470554, non-zero params: 250
2025-04-13 12:52:21,100 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:52:21,103 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:21,103 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4630, 3.5535]
2025-04-13 12:52:21,103 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8933, 2.8754]
2025-04-13 12:52:21,103 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,103 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,104 - INFO -   True actions shape: tensor([ 1.3481,  1.0164,  0.2813, -0.3226, -0.0272, -1.3524,  0.0548],
       device='cuda:0'), range: [-3.4630, 3.5535]
2025-04-13 12:52:21,104 - INFO -   Noise shape: tensor([ 0.3886,  1.1903,  0.2150,  0.6325,  1.0606, -0.4466, -1.6683],
       device='cuda:0'), range: [-3.0574, 3.2194]
2025-04-13 12:52:21,105 - INFO -   Noisy actions shape: tensor([ 1.4000,  1.3597,  0.3375, -0.0892,  0.3338, -1.4238, -0.5138],
       device='cuda:0'), range: [-3.1622, 3.2511]
2025-04-13 12:52:21,146 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:21,146 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5196, 3.6981]
2025-04-13 12:52:21,146 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2701, 2.9677]
2025-04-13 12:52:21,146 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,146 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,147 - INFO -   True actions shape: tensor([ 0.1293,  0.0172,  1.0263, -1.5341, -1.2997,  1.0114, -0.5989],
       device='cuda:0'), range: [-3.5196, 3.6981]
2025-04-13 12:52:21,148 - INFO -   Noise shape: tensor([-1.7877, -1.9756,  0.0256, -1.8377, -0.2448, -0.0837, -0.3728],
       device='cuda:0'), range: [-3.2344, 3.3150]
2025-04-13 12:52:21,148 - INFO -   Noisy actions shape: tensor([-1.7066, -1.9156,  0.2672, -2.1480, -0.5448,  0.1576, -0.5037],
       device='cuda:0'), range: [-3.2728, 3.8351]
2025-04-13 12:52:21,188 - INFO - 
=== Epoch 3 Summary ===
2025-04-13 12:52:21,188 - INFO -   Avg total loss: 3.674604
2025-04-13 12:52:21,188 - INFO -   Avg diffusion loss: 2.799705
2025-04-13 12:52:21,188 - INFO -   Avg grasp loss: 1.749798
2025-04-13 12:52:21,188 - INFO - 
=== EPOCH 4/20 ===
2025-04-13 12:52:21,189 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:21,191 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:21,192 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9237, 3.8641]
2025-04-13 12:52:21,192 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2030, 3.2765]
2025-04-13 12:52:21,192 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,192 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,193 - INFO -   True actions shape: tensor([ 1.8012,  0.6979,  0.4822, -0.2788, -0.0822,  0.3399,  1.7742],
       device='cuda:0'), range: [-3.9237, 3.8641]
2025-04-13 12:52:21,193 - INFO -   Noise shape: tensor([ 0.1109,  0.1253, -0.3376,  1.2382,  0.4304, -0.2781,  1.3598],
       device='cuda:0'), range: [-3.7641, 3.5253]
2025-04-13 12:52:21,194 - INFO -   Noisy actions shape: tensor([1.7048, 0.6923, 0.3149, 0.2199, 0.0900, 0.2065, 2.1612],
       device='cuda:0'), range: [-3.2590, 3.2959]
2025-04-13 12:52:21,194 - INFO -   Diffusion: timestep range [202, 935], noise range [-3.7641, 3.5253]
2025-04-13 12:52:21,194 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.2590, 3.2959]
2025-04-13 12:52:21,212 - INFO -   Model output shapes:
2025-04-13 12:52:21,212 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:21,213 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4288, 0.5922]
2025-04-13 12:52:21,213 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7192
2025-04-13 12:52:21,213 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2634, 0.4074]
2025-04-13 12:52:21,234 - INFO -   Loss components:
2025-04-13 12:52:21,234 - INFO -     Diffusion loss: 2.481213 (coef: 1.0)
2025-04-13 12:52:21,234 - INFO -     Grasp quality loss: 0.693107 (coef: 0.5)
2025-04-13 12:52:21,234 - INFO -     Grasp rotation loss: 0.563683 (coef: 0.5)
2025-04-13 12:52:21,234 - INFO -     Grasp width loss: 35.339615 (coef: 0.005)
2025-04-13 12:52:21,234 - INFO -     TOTAL loss: 3.286306
2025-04-13 12:52:21,242 - INFO -   Gradients: avg norm: 0.695015, max norm: 4.958633, non-zero params: 250
2025-04-13 12:52:21,242 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:52:21,242 - INFO - --- Gradient Check @ Epoch 4, Batch 0 ---
2025-04-13 12:52:21,259 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:21,259 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:21,259 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.0443e+00, MaxNorm=4.6132e+00
2025-04-13 12:52:21,259 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.7860e-02, MaxNorm=4.0771e-02
2025-04-13 12:52:21,259 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.5675e-02, MaxNorm=3.7403e-02
2025-04-13 12:52:21,259 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.5294e-01, MaxNorm=1.1843e+00
2025-04-13 12:52:21,259 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.6773e+00, MaxNorm=3.1987e+00
2025-04-13 12:52:21,259 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.7434e+00, MaxNorm=3.1696e+00
2025-04-13 12:52:21,259 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.9656e-01, MaxNorm=9.0639e-01
2025-04-13 12:52:21,259 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.6929e+00, MaxNorm=1.7963e+00
2025-04-13 12:52:21,259 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6100e+00, MaxNorm=1.6848e+00
2025-04-13 12:52:21,259 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.7257e+00, MaxNorm=4.9586e+00
2025-04-13 12:52:21,260 - INFO - --- End Gradient Check ---
2025-04-13 12:52:21,262 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:21,262 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8341, 3.5508]
2025-04-13 12:52:21,262 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8885, 2.7211]
2025-04-13 12:52:21,262 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,262 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,263 - INFO -   True actions shape: tensor([-1.2344, -0.2127, -1.1515, -2.1460, -1.0616,  1.2244,  0.7739],
       device='cuda:0'), range: [-3.8341, 3.5508]
2025-04-13 12:52:21,264 - INFO -   Noise shape: tensor([-0.9936,  0.0597,  0.5530,  0.0705,  0.3555, -0.5266, -0.6962],
       device='cuda:0'), range: [-3.4384, 3.3504]
2025-04-13 12:52:21,264 - INFO -   Noisy actions shape: tensor([-1.4686, -0.1864, -0.9430, -2.0343, -0.9139,  1.0204,  0.5401],
       device='cuda:0'), range: [-3.0709, 3.8485]
2025-04-13 12:52:21,317 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:21,317 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.8998, 3.3698]
2025-04-13 12:52:21,317 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2002, 2.9585]
2025-04-13 12:52:21,317 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,317 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,318 - INFO -   True actions shape: tensor([ 0.1213,  0.2829, -1.1416, -1.8027, -0.1165,  1.0375,  0.2011],
       device='cuda:0'), range: [-4.8998, 3.3698]
2025-04-13 12:52:21,319 - INFO -   Noise shape: tensor([ 0.1466,  1.2163, -1.1271, -0.2270, -0.3592,  0.3936,  1.5134],
       device='cuda:0'), range: [-3.3502, 3.4925]
2025-04-13 12:52:21,319 - INFO -   Noisy actions shape: tensor([ 0.1856,  1.2128, -1.5215, -1.0175, -0.3731,  0.8201,  1.4408],
       device='cuda:0'), range: [-3.5528, 3.6324]
2025-04-13 12:52:21,366 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:21,366 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8116, 3.2996]
2025-04-13 12:52:21,367 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9137, 3.2440]
2025-04-13 12:52:21,367 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,367 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,368 - INFO -   True actions shape: tensor([-0.1235, -2.8027, -2.5743, -0.5479,  0.2232,  1.4987,  0.2865],
       device='cuda:0'), range: [-3.8116, 3.2996]
2025-04-13 12:52:21,368 - INFO -   Noise shape: tensor([-1.4651, -1.6765, -0.0551, -0.5265,  0.0720,  0.7332, -0.7349],
       device='cuda:0'), range: [-3.2988, 3.3679]
2025-04-13 12:52:21,369 - INFO -   Noisy actions shape: tensor([-1.2199, -3.0619, -1.6544, -0.7536,  0.1958,  1.5099, -0.3938],
       device='cuda:0'), range: [-3.3245, 2.9975]
2025-04-13 12:52:21,412 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:21,412 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2727, 4.3279]
2025-04-13 12:52:21,412 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2172, 3.2597]
2025-04-13 12:52:21,412 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,412 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,413 - INFO -   True actions shape: tensor([-0.1237,  0.9242,  0.3967,  0.0646,  0.2476,  0.5890, -2.2407],
       device='cuda:0'), range: [-3.2727, 4.3279]
2025-04-13 12:52:21,413 - INFO -   Noise shape: tensor([-0.4388,  0.2102,  2.4270,  0.3289, -0.2169,  0.3849, -0.8334],
       device='cuda:0'), range: [-3.2717, 3.8375]
2025-04-13 12:52:21,414 - INFO -   Noisy actions shape: tensor([-0.4482,  0.5973,  2.3522,  0.3236, -0.0850,  0.6057, -1.7386],
       device='cuda:0'), range: [-2.7363, 3.7659]
2025-04-13 12:52:21,456 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:21,456 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8370, 3.1297]
2025-04-13 12:52:21,456 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2811, 2.7509]
2025-04-13 12:52:21,456 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,456 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,457 - INFO -   True actions shape: tensor([ 0.7325, -0.4505, -0.9333,  1.8750,  1.5530,  1.5583,  1.0372],
       device='cuda:0'), range: [-3.8370, 3.1297]
2025-04-13 12:52:21,457 - INFO -   Noise shape: tensor([ 0.9918, -0.2823,  0.9492, -0.0559, -1.4219,  0.1369, -0.7064],
       device='cuda:0'), range: [-3.3786, 3.7748]
2025-04-13 12:52:21,458 - INFO -   Noisy actions shape: tensor([ 0.8784, -0.4891, -0.7735,  1.8432,  1.3117,  1.5605,  0.9141],
       device='cuda:0'), range: [-2.9958, 3.0961]
2025-04-13 12:52:21,500 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:21,500 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1444, 4.2299]
2025-04-13 12:52:21,500 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5759, 3.0408]
2025-04-13 12:52:21,500 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,500 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,501 - INFO -   True actions shape: tensor([-0.7910,  1.1175, -0.0345, -0.0030,  0.5485,  0.0337, -0.4151],
       device='cuda:0'), range: [-3.1444, 4.2299]
2025-04-13 12:52:21,501 - INFO -   Noise shape: tensor([ 0.7368,  1.0936,  0.5805, -0.9466, -1.0119,  1.8735,  0.7984],
       device='cuda:0'), range: [-3.8119, 3.7161]
2025-04-13 12:52:21,502 - INFO -   Noisy actions shape: tensor([ 0.1980,  1.5223,  0.4716, -0.8007, -0.5602,  1.5997,  0.4515],
       device='cuda:0'), range: [-3.0682, 3.9030]
2025-04-13 12:52:21,544 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:21,544 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1070, 3.0520]
2025-04-13 12:52:21,544 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2992, 2.9488]
2025-04-13 12:52:21,544 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,544 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,545 - INFO -   True actions shape: tensor([-1.7343,  0.0364, -0.5404, -0.5163, -0.7696, -1.2904, -0.5260],
       device='cuda:0'), range: [-3.1070, 3.0520]
2025-04-13 12:52:21,545 - INFO -   Noise shape: tensor([-1.3538, -1.2006,  0.1011,  2.1930, -1.5326,  0.6030,  1.6103],
       device='cuda:0'), range: [-3.4700, 3.7488]
2025-04-13 12:52:21,546 - INFO -   Noisy actions shape: tensor([-1.8833, -1.1087, -0.0983,  1.8646, -1.7063,  0.1032,  1.3168],
       device='cuda:0'), range: [-3.7017, 3.6767]
2025-04-13 12:52:21,589 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:21,589 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9828, 3.6230]
2025-04-13 12:52:21,589 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4094, 3.6490]
2025-04-13 12:52:21,589 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,589 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,590 - INFO -   True actions shape: tensor([ 0.3861, -0.9373,  0.1751,  0.6025, -1.3524, -0.5837,  0.6249],
       device='cuda:0'), range: [-3.9828, 3.6230]
2025-04-13 12:52:21,590 - INFO -   Noise shape: tensor([ 0.3430,  0.2491, -0.2721, -0.0398,  0.4751,  0.7083, -0.4488],
       device='cuda:0'), range: [-3.4540, 3.3918]
2025-04-13 12:52:21,591 - INFO -   Noisy actions shape: tensor([ 0.5131, -0.6238, -0.0131,  0.4702, -0.8337, -0.0705,  0.2534],
       device='cuda:0'), range: [-3.9752, 3.6221]
2025-04-13 12:52:21,632 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:21,633 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2440, 3.4892]
2025-04-13 12:52:21,633 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0471, 3.1685]
2025-04-13 12:52:21,633 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,633 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,634 - INFO -   True actions shape: tensor([-1.3908,  1.2141,  1.2318,  1.4267,  0.6555,  1.3901,  0.1014],
       device='cuda:0'), range: [-3.2440, 3.4892]
2025-04-13 12:52:21,634 - INFO -   Noise shape: tensor([-0.7428, -0.3849,  2.1872, -0.0839, -0.2873,  0.5812,  1.3089],
       device='cuda:0'), range: [-3.4807, 3.4718]
2025-04-13 12:52:21,635 - INFO -   Noisy actions shape: tensor([-1.5505,  0.7094,  2.3266,  1.0632,  0.3335,  1.4493,  0.8953],
       device='cuda:0'), range: [-3.7281, 3.4929]
2025-04-13 12:52:21,676 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:21,676 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4366, 3.6775]
2025-04-13 12:52:21,676 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5867, 2.9562]
2025-04-13 12:52:21,676 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,676 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,677 - INFO -   True actions shape: tensor([-0.1079, -1.0114, -0.3279, -1.6508, -0.2454, -1.0988,  1.0523],
       device='cuda:0'), range: [-3.4366, 3.6775]
2025-04-13 12:52:21,678 - INFO -   Noise shape: tensor([-0.6062,  0.6024, -0.4756, -0.2287,  0.8572,  0.2967,  1.1546],
       device='cuda:0'), range: [-3.4084, 3.1560]
2025-04-13 12:52:21,678 - INFO -   Noisy actions shape: tensor([-0.4138, -0.5360, -0.5306, -1.5195,  0.2482, -0.7727,  1.5052],
       device='cuda:0'), range: [-3.5446, 3.8295]
2025-04-13 12:52:21,717 - INFO -   Loss components:
2025-04-13 12:52:21,717 - INFO -     Diffusion loss: 2.107103 (coef: 1.0)
2025-04-13 12:52:21,717 - INFO -     Grasp quality loss: 0.695289 (coef: 0.5)
2025-04-13 12:52:21,717 - INFO -     Grasp rotation loss: 0.572555 (coef: 0.5)
2025-04-13 12:52:21,717 - INFO -     Grasp width loss: 27.480381 (coef: 0.005)
2025-04-13 12:52:21,717 - INFO -     TOTAL loss: 2.878427
2025-04-13 12:52:21,725 - INFO -   Gradients: avg norm: 0.618711, max norm: 4.060095, non-zero params: 250
2025-04-13 12:52:21,725 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:52:21,728 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:21,728 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5452, 3.6614]
2025-04-13 12:52:21,728 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9357, 3.3217]
2025-04-13 12:52:21,728 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,728 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,729 - INFO -   True actions shape: tensor([ 0.2571, -0.6558,  0.4446,  0.0970, -0.9050, -1.3130, -0.2700],
       device='cuda:0'), range: [-3.5452, 3.6614]
2025-04-13 12:52:21,729 - INFO -   Noise shape: tensor([ 0.4499,  1.8225, -0.8016,  0.2073,  0.6135,  1.4534, -1.2334],
       device='cuda:0'), range: [-3.9912, 3.3704]
2025-04-13 12:52:21,730 - INFO -   Noisy actions shape: tensor([ 0.5026,  0.8602, -0.2701,  0.2167, -0.1844,  0.1387, -1.0766],
       device='cuda:0'), range: [-3.1897, 4.3724]
2025-04-13 12:52:21,771 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:21,771 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4796, 3.3069]
2025-04-13 12:52:21,771 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8565, 2.4580]
2025-04-13 12:52:21,771 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,771 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,772 - INFO -   True actions shape: tensor([ 2.0189, -0.8751,  0.2267, -0.3738,  0.1814, -1.2660, -1.5642],
       device='cuda:0'), range: [-3.4796, 3.3069]
2025-04-13 12:52:21,773 - INFO -   Noise shape: tensor([ 0.0318,  0.5955,  0.7040, -1.5746,  1.0596, -0.0580,  0.2620],
       device='cuda:0'), range: [-3.6426, 3.8006]
2025-04-13 12:52:21,773 - INFO -   Noisy actions shape: tensor([ 2.0119, -0.8109,  0.2962, -0.5300,  0.2868, -1.2655, -1.5300],
       device='cuda:0'), range: [-3.4008, 3.4458]
2025-04-13 12:52:21,813 - INFO - 
=== Epoch 4 Summary ===
2025-04-13 12:52:21,813 - INFO -   Avg total loss: 3.203142
2025-04-13 12:52:21,813 - INFO -   Avg diffusion loss: 2.410914
2025-04-13 12:52:21,813 - INFO -   Avg grasp loss: 1.584456
2025-04-13 12:52:21,813 - INFO - 
=== EPOCH 5/20 ===
2025-04-13 12:52:21,815 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:21,818 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:21,818 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4300, 3.3457]
2025-04-13 12:52:21,818 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1914, 3.0783]
2025-04-13 12:52:21,819 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,819 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,820 - INFO -   True actions shape: tensor([ 1.8813, -2.2956,  0.9140, -1.1054,  0.3551, -0.4750,  1.5377],
       device='cuda:0'), range: [-3.4300, 3.3457]
2025-04-13 12:52:21,820 - INFO -   Noise shape: tensor([ 2.0281,  0.2764, -0.1972,  1.2114,  0.5988, -0.9373, -0.9597],
       device='cuda:0'), range: [-3.0800, 3.6216]
2025-04-13 12:52:21,821 - INFO -   Noisy actions shape: tensor([ 2.5810, -1.9407,  0.7344, -0.4607,  0.5821, -0.8385,  0.9597],
       device='cuda:0'), range: [-3.0249, 3.9584]
2025-04-13 12:52:21,821 - INFO -   Diffusion: timestep range [47, 974], noise range [-3.0800, 3.6216]
2025-04-13 12:52:21,821 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.0249, 3.9584]
2025-04-13 12:52:21,842 - INFO -   Model output shapes:
2025-04-13 12:52:21,842 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:21,842 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4387, 0.5578]
2025-04-13 12:52:21,842 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7072
2025-04-13 12:52:21,842 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2901, 0.3720]
2025-04-13 12:52:21,864 - INFO -   Loss components:
2025-04-13 12:52:21,864 - INFO -     Diffusion loss: 2.434416 (coef: 1.0)
2025-04-13 12:52:21,864 - INFO -     Grasp quality loss: 0.692887 (coef: 0.5)
2025-04-13 12:52:21,864 - INFO -     Grasp rotation loss: 0.582940 (coef: 0.5)
2025-04-13 12:52:21,864 - INFO -     Grasp width loss: 27.276079 (coef: 0.005)
2025-04-13 12:52:21,864 - INFO -     TOTAL loss: 3.208710
2025-04-13 12:52:21,872 - INFO -   Gradients: avg norm: 0.645698, max norm: 4.713851, non-zero params: 250
2025-04-13 12:52:21,872 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:52:21,872 - INFO - --- Gradient Check @ Epoch 5, Batch 0 ---
2025-04-13 12:52:21,890 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:21,890 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:21,890 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=9.6246e-01, MaxNorm=4.0873e+00
2025-04-13 12:52:21,890 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.1465e-02, MaxNorm=2.3373e-02
2025-04-13 12:52:21,890 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0792e-02, MaxNorm=2.3636e-02
2025-04-13 12:52:21,890 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.3446e-01, MaxNorm=1.1817e+00
2025-04-13 12:52:21,890 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5424e+00, MaxNorm=2.8963e+00
2025-04-13 12:52:21,890 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.7074e+00, MaxNorm=3.0857e+00
2025-04-13 12:52:21,890 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.8423e-01, MaxNorm=8.1814e-01
2025-04-13 12:52:21,890 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.6390e+00, MaxNorm=1.7443e+00
2025-04-13 12:52:21,890 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4699e+00, MaxNorm=1.4996e+00
2025-04-13 12:52:21,890 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.6023e+00, MaxNorm=4.7139e+00
2025-04-13 12:52:21,890 - INFO - --- End Gradient Check ---
2025-04-13 12:52:21,893 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:21,893 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.8288, 3.5962]
2025-04-13 12:52:21,893 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8744, 3.7047]
2025-04-13 12:52:21,893 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,893 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,894 - INFO -   True actions shape: tensor([-0.3720,  0.3451,  0.2378,  1.5232, -1.4717,  0.2856, -0.5530],
       device='cuda:0'), range: [-4.8288, 3.5962]
2025-04-13 12:52:21,895 - INFO -   Noise shape: tensor([ 0.2477, -0.8645,  0.4025, -1.2168, -0.6805, -0.5588,  0.6487],
       device='cuda:0'), range: [-3.3083, 3.5006]
2025-04-13 12:52:21,895 - INFO -   Noisy actions shape: tensor([-2.1807e-01, -8.7180e-02,  3.9519e-01,  8.0065e-01, -1.6201e+00,
        -6.7270e-04, -1.9624e-01], device='cuda:0'), range: [-5.0211, 3.3789]
2025-04-13 12:52:21,938 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:21,938 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4856, 3.3546]
2025-04-13 12:52:21,938 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4505, 3.2846]
2025-04-13 12:52:21,938 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,938 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,939 - INFO -   True actions shape: tensor([-0.0660, -0.4089,  0.4723,  0.8984,  0.6239, -0.2552,  0.6242],
       device='cuda:0'), range: [-3.4856, 3.3546]
2025-04-13 12:52:21,940 - INFO -   Noise shape: tensor([ 0.5469, -1.4776, -1.4133, -0.1428, -0.5072, -1.2589, -0.1742],
       device='cuda:0'), range: [-3.5204, 3.9722]
2025-04-13 12:52:21,940 - INFO -   Noisy actions shape: tensor([ 0.5330, -1.5193, -1.3365, -0.0200, -0.4182, -1.2819, -0.0882],
       device='cuda:0'), range: [-3.0230, 3.2431]
2025-04-13 12:52:21,982 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:21,982 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9077, 3.1729]
2025-04-13 12:52:21,983 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6832, 3.1049]
2025-04-13 12:52:21,983 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:21,983 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:21,983 - INFO -   True actions shape: tensor([-0.9116,  0.4493, -0.2948,  0.6240,  0.9031,  0.8723, -1.0579],
       device='cuda:0'), range: [-3.9077, 3.1729]
2025-04-13 12:52:21,984 - INFO -   Noise shape: tensor([-1.0659, -0.0119,  1.2547, -0.8121,  0.0102,  1.6311,  0.0095],
       device='cuda:0'), range: [-3.8717, 3.6941]
2025-04-13 12:52:21,985 - INFO -   Noisy actions shape: tensor([-1.2747,  0.4028,  0.2589,  0.2256,  0.8240,  1.4763, -0.9562],
       device='cuda:0'), range: [-3.8161, 3.4601]
2025-04-13 12:52:22,026 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:22,026 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6046, 3.0593]
2025-04-13 12:52:22,026 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9052, 3.2206]
2025-04-13 12:52:22,027 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,027 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,027 - INFO -   True actions shape: tensor([-0.4968,  0.5128,  0.7532,  1.8087, -0.5897,  0.1288, -0.0426],
       device='cuda:0'), range: [-3.6046, 3.0593]
2025-04-13 12:52:22,028 - INFO -   Noise shape: tensor([ 0.7691, -0.3725, -0.5594,  0.1064, -1.5285,  0.0042, -0.4862],
       device='cuda:0'), range: [-3.0183, 3.6472]
2025-04-13 12:52:22,028 - INFO -   Noisy actions shape: tensor([ 0.0754,  0.1792,  0.2557,  1.4982, -1.3996,  0.1047, -0.3303],
       device='cuda:0'), range: [-3.2885, 3.6184]
2025-04-13 12:52:22,070 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:22,070 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3452, 3.5905]
2025-04-13 12:52:22,070 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4484, 3.8697]
2025-04-13 12:52:22,070 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,070 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,071 - INFO -   True actions shape: tensor([-1.0713, -1.1204,  1.0904, -0.6916, -1.2561, -0.8279,  0.7704],
       device='cuda:0'), range: [-3.3452, 3.5905]
2025-04-13 12:52:22,072 - INFO -   Noise shape: tensor([ 0.4030,  1.2629, -0.3021, -1.1854,  1.0511, -0.8355, -1.8373],
       device='cuda:0'), range: [-3.2993, 3.6202]
2025-04-13 12:52:22,072 - INFO -   Noisy actions shape: tensor([-0.6391, -0.1805,  0.7132, -1.2508, -0.4139, -1.1589, -0.4377],
       device='cuda:0'), range: [-3.2705, 3.4129]
2025-04-13 12:52:22,114 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:22,114 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7221, 3.3009]
2025-04-13 12:52:22,114 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8248, 3.0831]
2025-04-13 12:52:22,114 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,114 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,115 - INFO -   True actions shape: tensor([ 1.2480, -1.3864,  1.4180, -0.8929, -0.5158, -1.0836,  1.6094],
       device='cuda:0'), range: [-3.7221, 3.3009]
2025-04-13 12:52:22,116 - INFO -   Noise shape: tensor([-1.5850, -0.7417, -1.7015, -1.9461,  1.0261, -2.7437, -1.6641],
       device='cuda:0'), range: [-3.4977, 3.0233]
2025-04-13 12:52:22,116 - INFO -   Noisy actions shape: tensor([ 0.5407, -1.5651,  0.6528, -1.5739, -0.0805, -2.0573,  0.8438],
       device='cuda:0'), range: [-3.6676, 3.1973]
2025-04-13 12:52:22,157 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:22,158 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8300, 3.0066]
2025-04-13 12:52:22,158 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1388, 3.5327]
2025-04-13 12:52:22,158 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,158 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,159 - INFO -   True actions shape: tensor([ 0.2921, -0.7989,  0.1059, -0.7837, -0.2738, -0.6255, -2.3050],
       device='cuda:0'), range: [-3.8300, 3.0066]
2025-04-13 12:52:22,159 - INFO -   Noise shape: tensor([ 0.5985,  0.8348,  0.6152, -0.5422,  0.0458, -2.5166,  0.8138],
       device='cuda:0'), range: [-3.7591, 3.4050]
2025-04-13 12:52:22,160 - INFO -   Noisy actions shape: tensor([ 0.6657,  0.4307,  0.6041, -0.8173, -0.0713, -2.5505, -0.2101],
       device='cuda:0'), range: [-3.9001, 3.2168]
2025-04-13 12:52:22,202 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:22,202 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8680, 2.9871]
2025-04-13 12:52:22,202 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7252, 3.0999]
2025-04-13 12:52:22,202 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,202 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,203 - INFO -   True actions shape: tensor([ 0.7189, -0.1567, -0.5860, -1.3568,  0.8862,  1.8303,  0.2394],
       device='cuda:0'), range: [-3.8680, 2.9871]
2025-04-13 12:52:22,203 - INFO -   Noise shape: tensor([-5.6622e-01, -4.0257e-01, -1.6510e-03, -2.2900e-01,  8.5279e-01,
         1.2977e+00,  2.4468e+00], device='cuda:0'), range: [-3.1296, 3.4191]
2025-04-13 12:52:22,204 - INFO -   Noisy actions shape: tensor([ 0.2244, -0.3697, -0.4654, -1.2149,  1.2224,  2.2419,  1.6820],
       device='cuda:0'), range: [-3.3989, 3.3031]
2025-04-13 12:52:22,245 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:22,245 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5948, 3.5163]
2025-04-13 12:52:22,245 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5921, 2.4801]
2025-04-13 12:52:22,246 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,246 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,246 - INFO -   True actions shape: tensor([ 0.5198, -0.8054, -0.8888,  1.1696, -0.6556,  0.6071, -0.0215],
       device='cuda:0'), range: [-3.5948, 3.5163]
2025-04-13 12:52:22,247 - INFO -   Noise shape: tensor([-0.8479, -1.2795, -1.0403,  2.1680,  0.6801,  0.1694,  0.7838],
       device='cuda:0'), range: [-3.5344, 3.6235]
2025-04-13 12:52:22,247 - INFO -   Noisy actions shape: tensor([-0.0774, -1.4034, -1.3304,  2.2201, -0.1311,  0.5908,  0.4430],
       device='cuda:0'), range: [-3.0508, 3.4074]
2025-04-13 12:52:22,289 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:22,289 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7218, 3.6333]
2025-04-13 12:52:22,289 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4585, 3.3777]
2025-04-13 12:52:22,289 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,289 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,290 - INFO -   True actions shape: tensor([-0.5330,  0.1392, -0.8438, -0.1144,  0.5009,  1.4844,  2.1650],
       device='cuda:0'), range: [-3.7218, 3.6333]
2025-04-13 12:52:22,290 - INFO -   Noise shape: tensor([ 0.3075, -0.6622, -0.6069,  0.3008, -0.4348, -0.1605,  0.0082],
       device='cuda:0'), range: [-3.7801, 4.2252]
2025-04-13 12:52:22,291 - INFO -   Noisy actions shape: tensor([-0.5234,  0.1191, -0.8618, -0.1052,  0.4875,  1.4789,  2.1642],
       device='cuda:0'), range: [-3.8212, 4.2117]
2025-04-13 12:52:22,330 - INFO -   Loss components:
2025-04-13 12:52:22,330 - INFO -     Diffusion loss: 2.336551 (coef: 1.0)
2025-04-13 12:52:22,330 - INFO -     Grasp quality loss: 0.695856 (coef: 0.5)
2025-04-13 12:52:22,330 - INFO -     Grasp rotation loss: 0.577080 (coef: 0.5)
2025-04-13 12:52:22,330 - INFO -     Grasp width loss: 27.766941 (coef: 0.005)
2025-04-13 12:52:22,330 - INFO -     TOTAL loss: 3.111854
2025-04-13 12:52:22,338 - INFO -   Gradients: avg norm: 0.663830, max norm: 4.733570, non-zero params: 250
2025-04-13 12:52:22,338 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:52:22,341 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:22,341 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5126, 3.9030]
2025-04-13 12:52:22,341 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2503, 3.1760]
2025-04-13 12:52:22,341 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,341 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,342 - INFO -   True actions shape: tensor([-0.2527, -1.3931,  0.0678,  0.3958,  0.2478,  0.4587,  0.6301],
       device='cuda:0'), range: [-3.5126, 3.9030]
2025-04-13 12:52:22,342 - INFO -   Noise shape: tensor([-1.4703, -0.6125,  0.2962,  1.1821,  0.5220, -0.3478, -0.4836],
       device='cuda:0'), range: [-3.5520, 2.8706]
2025-04-13 12:52:22,343 - INFO -   Noisy actions shape: tensor([-1.2708, -1.3801,  0.2672,  1.1489,  0.5556,  0.0419,  0.0532],
       device='cuda:0'), range: [-3.5537, 3.8173]
2025-04-13 12:52:22,388 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:22,388 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0474, 3.3871]
2025-04-13 12:52:22,388 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9294, 2.9575]
2025-04-13 12:52:22,388 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,388 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,389 - INFO -   True actions shape: tensor([-1.1462, -1.1026,  0.3260, -0.2944, -0.2529, -0.2349, -1.1261],
       device='cuda:0'), range: [-3.0474, 3.3871]
2025-04-13 12:52:22,389 - INFO -   Noise shape: tensor([-0.1924, -0.0633, -0.0950,  0.7782, -0.2684,  0.3432,  0.1827],
       device='cuda:0'), range: [-3.4302, 2.9408]
2025-04-13 12:52:22,390 - INFO -   Noisy actions shape: tensor([-1.1373, -1.0496,  0.2689,  0.0101, -0.3334, -0.0934, -0.9816],
       device='cuda:0'), range: [-3.3905, 3.3421]
2025-04-13 12:52:22,433 - INFO - 
=== Epoch 5 Summary ===
2025-04-13 12:52:22,433 - INFO -   Avg total loss: 3.116936
2025-04-13 12:52:22,433 - INFO -   Avg diffusion loss: 2.344589
2025-04-13 12:52:22,433 - INFO -   Avg grasp loss: 1.544694
2025-04-13 12:52:22,634 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125218/ckpt_epoch_5.pth
2025-04-13 12:52:22,634 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:52:22,634 - INFO - 
=== EPOCH 6/20 ===
2025-04-13 12:52:22,635 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:22,638 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:22,638 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0991, 3.4195]
2025-04-13 12:52:22,639 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7090, 3.3921]
2025-04-13 12:52:22,639 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,639 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,640 - INFO -   True actions shape: tensor([ 0.4389, -1.7151,  0.7164,  0.7518, -0.3655, -0.3795, -0.0152],
       device='cuda:0'), range: [-3.0991, 3.4195]
2025-04-13 12:52:22,640 - INFO -   Noise shape: tensor([-0.9448, -0.4202,  0.2866, -0.2959,  0.3025,  1.3977,  0.1802],
       device='cuda:0'), range: [-3.4840, 4.3163]
2025-04-13 12:52:22,641 - INFO -   Noisy actions shape: tensor([-0.1002, -1.6916,  0.7628,  0.4983, -0.1619,  0.3809,  0.0781],
       device='cuda:0'), range: [-3.8351, 3.9990]
2025-04-13 12:52:22,641 - INFO -   Diffusion: timestep range [233, 862], noise range [-3.4840, 4.3163]
2025-04-13 12:52:22,641 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8351, 3.9990]
2025-04-13 12:52:22,660 - INFO -   Model output shapes:
2025-04-13 12:52:22,660 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:22,660 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4490, 0.5689]
2025-04-13 12:52:22,660 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6993
2025-04-13 12:52:22,660 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2731, 0.4404]
2025-04-13 12:52:22,681 - INFO -   Loss components:
2025-04-13 12:52:22,681 - INFO -     Diffusion loss: 2.157247 (coef: 1.0)
2025-04-13 12:52:22,681 - INFO -     Grasp quality loss: 0.692972 (coef: 0.5)
2025-04-13 12:52:22,681 - INFO -     Grasp rotation loss: 0.586258 (coef: 0.5)
2025-04-13 12:52:22,681 - INFO -     Grasp width loss: 23.809753 (coef: 0.005)
2025-04-13 12:52:22,681 - INFO -     TOTAL loss: 2.915911
2025-04-13 12:52:22,689 - INFO -   Gradients: avg norm: 0.623213, max norm: 4.323744, non-zero params: 250
2025-04-13 12:52:22,689 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:52:22,689 - INFO - --- Gradient Check @ Epoch 6, Batch 0 ---
2025-04-13 12:52:22,706 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:22,706 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:22,706 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=9.0209e-01, MaxNorm=4.0327e+00
2025-04-13 12:52:22,706 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=3.2315e-02, MaxNorm=7.2865e-02
2025-04-13 12:52:22,706 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.3644e-02, MaxNorm=4.2256e-02
2025-04-13 12:52:22,707 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.9414e-01, MaxNorm=1.5076e+00
2025-04-13 12:52:22,707 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5520e+00, MaxNorm=2.8937e+00
2025-04-13 12:52:22,707 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.6121e+00, MaxNorm=2.9147e+00
2025-04-13 12:52:22,707 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.5669e-01, MaxNorm=7.1638e-01
2025-04-13 12:52:22,707 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.7749e+00, MaxNorm=1.9337e+00
2025-04-13 12:52:22,707 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3170e+00, MaxNorm=1.4697e+00
2025-04-13 12:52:22,707 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.3778e+00, MaxNorm=4.3237e+00
2025-04-13 12:52:22,707 - INFO - --- End Gradient Check ---
2025-04-13 12:52:22,709 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:22,709 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1561, 3.9393]
2025-04-13 12:52:22,709 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8764, 2.9370]
2025-04-13 12:52:22,710 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,710 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,710 - INFO -   True actions shape: tensor([-0.6068,  0.4124,  0.4548, -0.2277,  0.7594, -0.7687, -0.5054],
       device='cuda:0'), range: [-3.1561, 3.9393]
2025-04-13 12:52:22,711 - INFO -   Noise shape: tensor([-0.2410,  0.0456, -1.4256,  0.2909,  0.3845,  0.1434,  0.5250],
       device='cuda:0'), range: [-3.4054, 3.6254]
2025-04-13 12:52:22,712 - INFO -   Noisy actions shape: tensor([-0.6253,  0.3516, -0.5287,  0.0022,  0.8340, -0.5135, -0.0702],
       device='cuda:0'), range: [-3.1687, 3.7336]
2025-04-13 12:52:22,753 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:22,753 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6037, 3.8880]
2025-04-13 12:52:22,753 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5694, 2.8216]
2025-04-13 12:52:22,754 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,754 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,754 - INFO -   True actions shape: tensor([ 5.4344e-01,  1.4059e-03, -1.0881e+00,  4.5071e-01, -2.0037e-01,
        -5.2915e-01,  1.8989e+00], device='cuda:0'), range: [-3.6037, 3.8880]
2025-04-13 12:52:22,755 - INFO -   Noise shape: tensor([ 0.3480, -0.0764,  0.2544, -0.2808,  1.2443, -0.2973, -0.9018],
       device='cuda:0'), range: [-3.6678, 3.6111]
2025-04-13 12:52:22,756 - INFO -   Noisy actions shape: tensor([ 0.3738, -0.0762,  0.2015, -0.2587,  1.2332, -0.3225, -0.8090],
       device='cuda:0'), range: [-3.4649, 3.8132]
2025-04-13 12:52:22,801 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:22,801 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1668, 3.5937]
2025-04-13 12:52:22,802 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2459, 3.6377]
2025-04-13 12:52:22,802 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,802 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,803 - INFO -   True actions shape: tensor([ 0.3626, -0.0040, -0.7319, -0.4380,  0.0158,  1.4927, -0.6880],
       device='cuda:0'), range: [-4.1668, 3.5937]
2025-04-13 12:52:22,803 - INFO -   Noise shape: tensor([-0.8304, -1.0625,  1.4731,  0.4257, -0.7669, -1.4364, -0.7140],
       device='cuda:0'), range: [-3.4706, 3.2776]
2025-04-13 12:52:22,804 - INFO -   Noisy actions shape: tensor([ 0.0428, -0.3825, -0.1588, -0.2575, -0.2586,  0.8827, -0.8973],
       device='cuda:0'), range: [-3.8812, 3.5746]
2025-04-13 12:52:22,845 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:22,846 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6048, 4.8402]
2025-04-13 12:52:22,846 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8390, 3.1212]
2025-04-13 12:52:22,846 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,846 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,847 - INFO -   True actions shape: tensor([ 0.1775, -0.9367, -1.0154, -0.2878,  0.6339,  1.1414, -2.3215],
       device='cuda:0'), range: [-3.6048, 4.8402]
2025-04-13 12:52:22,847 - INFO -   Noise shape: tensor([ 1.2840,  0.5722, -0.6420,  2.2475, -1.4915, -0.1635,  2.2033],
       device='cuda:0'), range: [-3.5324, 3.2196]
2025-04-13 12:52:22,848 - INFO -   Noisy actions shape: tensor([ 0.5053, -0.7556, -1.1474,  0.3066,  0.2242,  1.0596, -1.6687],
       device='cuda:0'), range: [-3.8788, 4.4002]
2025-04-13 12:52:22,890 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:22,891 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5471, 3.5705]
2025-04-13 12:52:22,891 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5847, 3.5325]
2025-04-13 12:52:22,891 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,891 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,892 - INFO -   True actions shape: tensor([-0.8241,  0.1363,  0.8506, -0.0991, -0.6990, -0.1970,  3.5705],
       device='cuda:0'), range: [-3.5471, 3.5705]
2025-04-13 12:52:22,893 - INFO -   Noise shape: tensor([ 0.1170, -1.5383, -0.5458,  0.5990,  0.2350, -0.7130,  0.8694],
       device='cuda:0'), range: [-3.3538, 3.1294]
2025-04-13 12:52:22,893 - INFO -   Noisy actions shape: tensor([-0.4412, -1.0890,  0.1303,  0.3945, -0.2704, -0.6723,  2.9646],
       device='cuda:0'), range: [-3.6001, 3.2709]
2025-04-13 12:52:22,939 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:22,939 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5922, 3.7290]
2025-04-13 12:52:22,939 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5317, 3.4508]
2025-04-13 12:52:22,940 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,940 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,940 - INFO -   True actions shape: tensor([ 1.9256, -0.0493, -0.3273,  0.2056, -0.1687, -0.6009, -0.3558],
       device='cuda:0'), range: [-3.5922, 3.7290]
2025-04-13 12:52:22,941 - INFO -   Noise shape: tensor([ 1.2707,  0.7489,  2.2363, -0.2430,  1.0198,  3.0388, -0.4306],
       device='cuda:0'), range: [-3.9879, 4.2861]
2025-04-13 12:52:22,942 - INFO -   Noisy actions shape: tensor([ 2.2113,  0.5420,  1.5026, -0.0539,  0.6727,  1.9415, -0.5585],
       device='cuda:0'), range: [-3.7069, 3.7689]
2025-04-13 12:52:22,986 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:22,986 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5096, 3.7226]
2025-04-13 12:52:22,986 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1474, 2.7828]
2025-04-13 12:52:22,986 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:22,986 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:22,987 - INFO -   True actions shape: tensor([-2.0677,  0.4182, -0.9631,  0.4200,  1.5892, -0.8414, -0.0928],
       device='cuda:0'), range: [-3.5096, 3.7226]
2025-04-13 12:52:22,987 - INFO -   Noise shape: tensor([-0.9342, -1.6209, -1.6846, -0.2216, -0.1870, -1.5012,  1.0424],
       device='cuda:0'), range: [-3.1638, 3.7134]
2025-04-13 12:52:22,988 - INFO -   Noisy actions shape: tensor([-1.3425, -1.4990, -1.8476, -0.1297,  0.1466, -1.6430,  1.0005],
       device='cuda:0'), range: [-3.1012, 3.5423]
2025-04-13 12:52:23,030 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:23,031 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2657, 3.6262]
2025-04-13 12:52:23,031 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4188, 3.5579]
2025-04-13 12:52:23,031 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,031 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,032 - INFO -   True actions shape: tensor([ 2.1411,  0.1766, -0.3973, -0.5920,  0.0194, -1.4291, -0.8137],
       device='cuda:0'), range: [-3.2657, 3.6262]
2025-04-13 12:52:23,032 - INFO -   Noise shape: tensor([-1.8320,  0.5687, -0.7086, -0.9349, -0.3571,  1.2589,  0.6776],
       device='cuda:0'), range: [-3.8375, 3.6858]
2025-04-13 12:52:23,033 - INFO -   Noisy actions shape: tensor([-1.4812,  0.5891, -0.7612, -1.0147, -0.3499,  1.0243,  0.5445],
       device='cuda:0'), range: [-3.8257, 3.6636]
2025-04-13 12:52:23,074 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:23,074 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2069, 4.0195]
2025-04-13 12:52:23,075 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0962, 2.6257]
2025-04-13 12:52:23,075 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,075 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,075 - INFO -   True actions shape: tensor([-1.3345,  0.1152, -1.3289,  1.0772, -0.2333, -1.0330, -1.1414],
       device='cuda:0'), range: [-3.2069, 4.0195]
2025-04-13 12:52:23,076 - INFO -   Noise shape: tensor([ 2.2046,  0.8186,  0.5663, -1.2398, -0.9891,  0.0228, -0.0214],
       device='cuda:0'), range: [-3.6939, 3.3582]
2025-04-13 12:52:23,077 - INFO -   Noisy actions shape: tensor([-0.4650,  0.3982, -1.0413,  0.5670, -0.5692, -0.9577, -1.0747],
       device='cuda:0'), range: [-3.3000, 3.5370]
2025-04-13 12:52:23,118 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:23,118 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0127, 3.1740]
2025-04-13 12:52:23,118 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8449, 3.0968]
2025-04-13 12:52:23,118 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,118 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,119 - INFO -   True actions shape: tensor([ 0.1881,  1.4227, -1.1020, -1.4224,  0.8656,  1.1530, -1.5341],
       device='cuda:0'), range: [-3.0127, 3.1740]
2025-04-13 12:52:23,119 - INFO -   Noise shape: tensor([-1.2619e-01,  4.2561e-01,  6.0761e-01, -7.1849e-01,  7.5672e-01,
         1.6874e+00, -6.6346e-04], device='cuda:0'), range: [-3.8442, 3.3471]
2025-04-13 12:52:23,120 - INFO -   Noisy actions shape: tensor([-0.0078,  1.1128, -0.0660, -1.3613,  1.0997,  2.0418, -0.8107],
       device='cuda:0'), range: [-3.0202, 3.2574]
2025-04-13 12:52:23,159 - INFO -   Loss components:
2025-04-13 12:52:23,159 - INFO -     Diffusion loss: 2.040601 (coef: 1.0)
2025-04-13 12:52:23,159 - INFO -     Grasp quality loss: 0.695997 (coef: 0.5)
2025-04-13 12:52:23,159 - INFO -     Grasp rotation loss: 0.578545 (coef: 0.5)
2025-04-13 12:52:23,159 - INFO -     Grasp width loss: 17.726152 (coef: 0.005)
2025-04-13 12:52:23,159 - INFO -     TOTAL loss: 2.766503
2025-04-13 12:52:23,167 - INFO -   Gradients: avg norm: 0.502995, max norm: 3.737537, non-zero params: 250
2025-04-13 12:52:23,167 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:52:23,170 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:23,170 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1709, 2.8922]
2025-04-13 12:52:23,170 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9934, 2.7131]
2025-04-13 12:52:23,170 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,170 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,171 - INFO -   True actions shape: tensor([-0.5365, -0.1921, -0.9270,  0.3932, -0.4003, -0.2825, -0.2151],
       device='cuda:0'), range: [-3.1709, 2.8922]
2025-04-13 12:52:23,172 - INFO -   Noise shape: tensor([ 0.7126,  0.1937,  0.7652, -0.2367,  1.0996,  0.8476, -0.2583],
       device='cuda:0'), range: [-3.5504, 3.8331]
2025-04-13 12:52:23,172 - INFO -   Noisy actions shape: tensor([-0.4575, -0.1703, -0.8402,  0.3657, -0.2808, -0.1905, -0.2414],
       device='cuda:0'), range: [-3.2739, 3.6363]
2025-04-13 12:52:23,214 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:23,214 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3552, 3.3928]
2025-04-13 12:52:23,214 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6757, 3.6227]
2025-04-13 12:52:23,214 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,214 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,215 - INFO -   True actions shape: tensor([ 0.1167, -1.4653,  2.0256,  0.4069,  1.1701,  0.8168, -0.2627],
       device='cuda:0'), range: [-3.3552, 3.3928]
2025-04-13 12:52:23,215 - INFO -   Noise shape: tensor([-1.6238,  0.2861, -0.1181, -1.6070, -0.1345,  0.2996, -0.2883],
       device='cuda:0'), range: [-3.4303, 3.9040]
2025-04-13 12:52:23,216 - INFO -   Noisy actions shape: tensor([-0.7447, -1.1028,  1.6688, -0.4881,  0.9296,  0.8535, -0.3743],
       device='cuda:0'), range: [-3.4613, 3.8021]
2025-04-13 12:52:23,255 - INFO - 
=== Epoch 6 Summary ===
2025-04-13 12:52:23,255 - INFO -   Avg total loss: 2.908308
2025-04-13 12:52:23,255 - INFO -   Avg diffusion loss: 2.169357
2025-04-13 12:52:23,255 - INFO -   Avg grasp loss: 1.477901
2025-04-13 12:52:23,255 - INFO - 
=== EPOCH 7/20 ===
2025-04-13 12:52:23,256 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:23,259 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:23,259 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4603, 3.7597]
2025-04-13 12:52:23,259 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5404, 3.2329]
2025-04-13 12:52:23,259 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,259 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,260 - INFO -   True actions shape: tensor([ 0.3371,  1.0625, -0.7908,  0.5465,  0.7218,  0.7094, -0.3932],
       device='cuda:0'), range: [-3.4603, 3.7597]
2025-04-13 12:52:23,261 - INFO -   Noise shape: tensor([ 0.5982,  0.8532, -0.2866,  1.8177, -0.3852, -0.1808,  0.3344],
       device='cuda:0'), range: [-3.7218, 4.1358]
2025-04-13 12:52:23,261 - INFO -   Noisy actions shape: tensor([ 0.6123,  0.8987, -0.3208,  1.8398, -0.3534, -0.1497,  0.3169],
       device='cuda:0'), range: [-3.7322, 3.9504]
2025-04-13 12:52:23,261 - INFO -   Diffusion: timestep range [171, 976], noise range [-3.7218, 4.1358]
2025-04-13 12:52:23,261 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.7322, 3.9504]
2025-04-13 12:52:23,280 - INFO -   Model output shapes:
2025-04-13 12:52:23,280 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:23,280 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4516, 0.5683]
2025-04-13 12:52:23,280 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6524
2025-04-13 12:52:23,280 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2916, 0.2673]
2025-04-13 12:52:23,301 - INFO -   Loss components:
2025-04-13 12:52:23,301 - INFO -     Diffusion loss: 2.470602 (coef: 1.0)
2025-04-13 12:52:23,301 - INFO -     Grasp quality loss: 0.694054 (coef: 0.5)
2025-04-13 12:52:23,301 - INFO -     Grasp rotation loss: 0.571169 (coef: 0.5)
2025-04-13 12:52:23,301 - INFO -     Grasp width loss: 16.113674 (coef: 0.005)
2025-04-13 12:52:23,301 - INFO -     TOTAL loss: 3.183782
2025-04-13 12:52:23,309 - INFO -   Gradients: avg norm: 0.696050, max norm: 5.118322, non-zero params: 250
2025-04-13 12:52:23,309 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:52:23,309 - INFO - --- Gradient Check @ Epoch 7, Batch 0 ---
2025-04-13 12:52:23,326 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:23,326 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:23,326 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.0883e+00, MaxNorm=4.5510e+00
2025-04-13 12:52:23,326 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.1836e-02, MaxNorm=4.9312e-02
2025-04-13 12:52:23,326 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=7.4440e-03, MaxNorm=2.1498e-02
2025-04-13 12:52:23,326 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.0315e-01, MaxNorm=1.0552e+00
2025-04-13 12:52:23,326 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.8428e+00, MaxNorm=3.4018e+00
2025-04-13 12:52:23,326 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.8607e+00, MaxNorm=3.3026e+00
2025-04-13 12:52:23,326 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.9535e-01, MaxNorm=8.9840e-01
2025-04-13 12:52:23,326 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.1350e+00, MaxNorm=1.1743e+00
2025-04-13 12:52:23,326 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6119e+00, MaxNorm=1.6950e+00
2025-04-13 12:52:23,327 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.8366e+00, MaxNorm=5.1183e+00
2025-04-13 12:52:23,327 - INFO - --- End Gradient Check ---
2025-04-13 12:52:23,329 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:23,329 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2864, 3.3282]
2025-04-13 12:52:23,329 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9763, 3.2166]
2025-04-13 12:52:23,329 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,329 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,330 - INFO -   True actions shape: tensor([ 0.3053,  0.0330,  2.2922, -0.6214,  0.2486, -0.3476, -0.1581],
       device='cuda:0'), range: [-3.2864, 3.3282]
2025-04-13 12:52:23,331 - INFO -   Noise shape: tensor([ 1.8976,  0.9850, -0.4776,  0.2065,  0.7491, -0.9520, -0.2040],
       device='cuda:0'), range: [-4.1427, 3.4070]
2025-04-13 12:52:23,331 - INFO -   Noisy actions shape: tensor([ 0.6407,  0.2091,  2.1694, -0.5742,  0.3790, -0.5127, -0.1922],
       device='cuda:0'), range: [-4.0477, 3.5320]
2025-04-13 12:52:23,374 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:23,374 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0764, 3.9557]
2025-04-13 12:52:23,374 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.7764, 2.7906]
2025-04-13 12:52:23,374 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,374 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,375 - INFO -   True actions shape: tensor([-0.1538, -1.6127, -0.0351, -0.4198,  0.7542, -1.2227,  1.7149],
       device='cuda:0'), range: [-3.0764, 3.9557]
2025-04-13 12:52:23,376 - INFO -   Noise shape: tensor([-0.9365,  0.1164,  1.3955, -0.2507, -0.2165, -0.6145, -3.4931],
       device='cuda:0'), range: [-3.4931, 2.9339]
2025-04-13 12:52:23,376 - INFO -   Noisy actions shape: tensor([-0.6921, -1.2087,  0.8216, -0.4857,  0.4666, -1.3441, -0.7655],
       device='cuda:0'), range: [-3.4017, 3.5258]
2025-04-13 12:52:23,418 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:23,418 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8840, 3.7685]
2025-04-13 12:52:23,419 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0776, 2.9118]
2025-04-13 12:52:23,419 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,419 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,419 - INFO -   True actions shape: tensor([ 0.7779,  0.8092, -1.1056,  1.0395, -0.3236, -0.0945, -1.5602],
       device='cuda:0'), range: [-3.8840, 3.7685]
2025-04-13 12:52:23,420 - INFO -   Noise shape: tensor([ 0.3723,  0.1373, -0.2674, -1.3150, -0.0097, -0.3537,  0.3465],
       device='cuda:0'), range: [-3.8872, 3.4931]
2025-04-13 12:52:23,421 - INFO -   Noisy actions shape: tensor([ 0.7431,  0.5656, -0.8390, -0.5108, -0.1887, -0.3462, -0.5834],
       device='cuda:0'), range: [-3.9276, 3.8061]
2025-04-13 12:52:23,466 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:23,467 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5676, 3.6430]
2025-04-13 12:52:23,467 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2262, 3.2888]
2025-04-13 12:52:23,467 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,467 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,468 - INFO -   True actions shape: tensor([ 1.2935,  0.2043,  0.1880, -1.3728, -0.5671,  0.2948, -0.7566],
       device='cuda:0'), range: [-3.5676, 3.6430]
2025-04-13 12:52:23,468 - INFO -   Noise shape: tensor([ 0.9630,  1.2956, -0.7653,  1.1179,  0.1100,  0.0987,  0.1104],
       device='cuda:0'), range: [-3.3549, 3.5789]
2025-04-13 12:52:23,469 - INFO -   Noisy actions shape: tensor([ 1.6125,  0.9465, -0.3132, -0.4168, -0.3850,  0.2944, -0.5357],
       device='cuda:0'), range: [-3.5037, 3.9666]
2025-04-13 12:52:23,512 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:23,512 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7654, 3.2041]
2025-04-13 12:52:23,512 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4851, 3.7653]
2025-04-13 12:52:23,512 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,512 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,513 - INFO -   True actions shape: tensor([-0.1908,  0.9124, -0.2692, -0.1098,  0.1181,  0.0208, -2.0237],
       device='cuda:0'), range: [-3.7654, 3.2041]
2025-04-13 12:52:23,514 - INFO -   Noise shape: tensor([-1.3188,  0.4407,  0.4158,  0.0499, -0.8004,  0.8145, -0.6950],
       device='cuda:0'), range: [-3.4784, 3.2902]
2025-04-13 12:52:23,514 - INFO -   Noisy actions shape: tensor([-0.5894,  1.0040, -0.1274, -0.0890, -0.1353,  0.2718, -2.1395],
       device='cuda:0'), range: [-3.3455, 3.2390]
2025-04-13 12:52:23,557 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:23,557 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1937, 3.6536]
2025-04-13 12:52:23,557 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9487, 3.1992]
2025-04-13 12:52:23,557 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,557 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,558 - INFO -   True actions shape: tensor([ 0.0924, -1.1064,  1.0352, -0.5300,  0.4884, -0.9174,  0.2849],
       device='cuda:0'), range: [-3.1937, 3.6536]
2025-04-13 12:52:23,559 - INFO -   Noise shape: tensor([0.6922, 0.7555, 0.3611, 0.1273, 0.9165, 0.1021, 0.1974],
       device='cuda:0'), range: [-3.4361, 5.1182]
2025-04-13 12:52:23,559 - INFO -   Noisy actions shape: tensor([0.6943, 0.7277, 0.3868, 0.1140, 0.9284, 0.0792, 0.2045],
       device='cuda:0'), range: [-3.4233, 3.4833]
2025-04-13 12:52:23,601 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:23,601 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3604, 3.3295]
2025-04-13 12:52:23,601 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2128, 3.0236]
2025-04-13 12:52:23,602 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,602 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,602 - INFO -   True actions shape: tensor([-0.0045, -0.7541,  1.3763, -0.4728, -0.3920, -0.1806,  0.9285],
       device='cuda:0'), range: [-3.3604, 3.3295]
2025-04-13 12:52:23,603 - INFO -   Noise shape: tensor([ 0.2380,  1.1704,  0.4098, -0.4605,  0.3956, -1.2117, -0.5870],
       device='cuda:0'), range: [-3.5595, 3.5003]
2025-04-13 12:52:23,603 - INFO -   Noisy actions shape: tensor([ 0.0194, -0.6329,  1.4104, -0.5166, -0.3503, -0.3012,  0.8650],
       device='cuda:0'), range: [-3.3481, 3.3221]
2025-04-13 12:52:23,645 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:23,645 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3198, 3.1467]
2025-04-13 12:52:23,645 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2815, 3.4384]
2025-04-13 12:52:23,646 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,646 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,646 - INFO -   True actions shape: tensor([ 1.3856, -1.0917,  0.0034,  1.5234, -1.3441,  0.4364,  0.9107],
       device='cuda:0'), range: [-3.3198, 3.1467]
2025-04-13 12:52:23,647 - INFO -   Noise shape: tensor([ 0.7308, -0.0162, -2.0434, -0.9917, -0.5701,  0.4106, -0.8068],
       device='cuda:0'), range: [-4.2042, 3.1281]
2025-04-13 12:52:23,647 - INFO -   Noisy actions shape: tensor([ 1.4604, -0.7283, -1.5402,  0.2506, -1.3119,  0.5962, -0.0117],
       device='cuda:0'), range: [-4.1831, 3.3918]
2025-04-13 12:52:23,689 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:23,689 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7334, 3.3895]
2025-04-13 12:52:23,689 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1431, 2.9514]
2025-04-13 12:52:23,689 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,689 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,690 - INFO -   True actions shape: tensor([ 0.0561,  2.1932,  1.0738,  0.2197, -2.3683, -2.3454, -0.5356],
       device='cuda:0'), range: [-3.7334, 3.3895]
2025-04-13 12:52:23,691 - INFO -   Noise shape: tensor([ 0.5727,  0.1379, -0.0121,  1.5555,  1.4177, -0.4359,  0.6311],
       device='cuda:0'), range: [-3.9526, 3.0869]
2025-04-13 12:52:23,691 - INFO -   Noisy actions shape: tensor([ 0.4066,  1.7830,  0.8225,  1.1565, -0.9316, -2.0897, -0.0137],
       device='cuda:0'), range: [-3.6918, 3.6301]
2025-04-13 12:52:23,732 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:23,733 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2305, 3.0916]
2025-04-13 12:52:23,733 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6649, 2.8259]
2025-04-13 12:52:23,733 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,733 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,734 - INFO -   True actions shape: tensor([-0.2052,  0.0407, -0.4366,  0.7102,  1.3009, -2.1310,  0.7960],
       device='cuda:0'), range: [-3.2305, 3.0916]
2025-04-13 12:52:23,734 - INFO -   Noise shape: tensor([-1.8073, -0.0551,  0.8389, -1.3837,  1.4247, -0.0787, -1.9070],
       device='cuda:0'), range: [-3.7929, 3.5034]
2025-04-13 12:52:23,735 - INFO -   Noisy actions shape: tensor([-1.0163e+00,  1.0660e-02, -7.8917e-05, -8.7805e-03,  1.8116e+00,
        -1.9267e+00, -1.7417e-01], device='cuda:0'), range: [-3.1492, 4.0738]
2025-04-13 12:52:23,773 - INFO -   Loss components:
2025-04-13 12:52:23,773 - INFO -     Diffusion loss: 1.927631 (coef: 1.0)
2025-04-13 12:52:23,773 - INFO -     Grasp quality loss: 0.693374 (coef: 0.5)
2025-04-13 12:52:23,773 - INFO -     Grasp rotation loss: 0.578694 (coef: 0.5)
2025-04-13 12:52:23,773 - INFO -     Grasp width loss: 15.009305 (coef: 0.005)
2025-04-13 12:52:23,773 - INFO -     TOTAL loss: 2.638711
2025-04-13 12:52:23,782 - INFO -   Gradients: avg norm: 0.486608, max norm: 3.650928, non-zero params: 250
2025-04-13 12:52:23,782 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:52:23,784 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:23,784 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4501, 3.6618]
2025-04-13 12:52:23,784 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3341, 3.0833]
2025-04-13 12:52:23,785 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,785 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,785 - INFO -   True actions shape: tensor([ 0.4693, -0.2379,  0.9106, -0.2681,  0.8451, -0.6290,  1.4767],
       device='cuda:0'), range: [-3.4501, 3.6618]
2025-04-13 12:52:23,786 - INFO -   Noise shape: tensor([ 1.3342,  1.1058,  0.8474,  0.4767, -0.1618,  0.1888,  0.4219],
       device='cuda:0'), range: [-3.3446, 3.9236]
2025-04-13 12:52:23,786 - INFO -   Noisy actions shape: tensor([ 1.3117,  0.6731,  1.2377,  0.1808,  0.4368, -0.2738,  1.2922],
       device='cuda:0'), range: [-3.3189, 3.7389]
2025-04-13 12:52:23,828 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:23,828 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4199, 3.0521]
2025-04-13 12:52:23,828 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6225, 2.9284]
2025-04-13 12:52:23,828 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,828 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,829 - INFO -   True actions shape: tensor([ 0.4804,  0.7112, -1.7096,  0.6556,  0.0399,  0.2566, -0.0349],
       device='cuda:0'), range: [-3.4199, 3.0521]
2025-04-13 12:52:23,829 - INFO -   Noise shape: tensor([ 0.9739, -1.6336,  0.2088, -1.0868,  0.6224, -1.9897, -2.0852],
       device='cuda:0'), range: [-3.7353, 3.5912]
2025-04-13 12:52:23,830 - INFO -   Noisy actions shape: tensor([ 0.6795,  0.3414, -1.6240,  0.4053,  0.1735, -0.1794, -0.4847],
       device='cuda:0'), range: [-3.4029, 3.0904]
2025-04-13 12:52:23,869 - INFO - 
=== Epoch 7 Summary ===
2025-04-13 12:52:23,869 - INFO -   Avg total loss: 2.760042
2025-04-13 12:52:23,869 - INFO -   Avg diffusion loss: 2.050098
2025-04-13 12:52:23,869 - INFO -   Avg grasp loss: 1.419887
2025-04-13 12:52:23,869 - INFO - 
=== EPOCH 8/20 ===
2025-04-13 12:52:23,870 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:23,873 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:23,873 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2808, 3.6928]
2025-04-13 12:52:23,873 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0871, 3.1813]
2025-04-13 12:52:23,873 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,873 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,874 - INFO -   True actions shape: tensor([-1.6931,  0.2178,  1.6855, -0.1507, -1.4728,  3.0762,  0.4736],
       device='cuda:0'), range: [-3.2808, 3.6928]
2025-04-13 12:52:23,875 - INFO -   Noise shape: tensor([ 1.0675,  0.4679, -0.0385, -0.6259,  0.1765, -0.1866, -2.5770],
       device='cuda:0'), range: [-3.6709, 3.3940]
2025-04-13 12:52:23,875 - INFO -   Noisy actions shape: tensor([ 0.2209,  0.5160,  0.7015, -0.6288, -0.4845,  1.1756, -2.1115],
       device='cuda:0'), range: [-3.1702, 3.7870]
2025-04-13 12:52:23,875 - INFO -   Diffusion: timestep range [29, 777], noise range [-3.6709, 3.3940]
2025-04-13 12:52:23,875 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.1702, 3.7870]
2025-04-13 12:52:23,894 - INFO -   Model output shapes:
2025-04-13 12:52:23,894 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:23,894 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4446, 0.5525]
2025-04-13 12:52:23,894 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5992
2025-04-13 12:52:23,894 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2581, 0.3328]
2025-04-13 12:52:23,915 - INFO -   Loss components:
2025-04-13 12:52:23,915 - INFO -     Diffusion loss: 2.170956 (coef: 1.0)
2025-04-13 12:52:23,915 - INFO -     Grasp quality loss: 0.694717 (coef: 0.5)
2025-04-13 12:52:23,915 - INFO -     Grasp rotation loss: 0.573788 (coef: 0.5)
2025-04-13 12:52:23,915 - INFO -     Grasp width loss: 13.277243 (coef: 0.005)
2025-04-13 12:52:23,915 - INFO -     TOTAL loss: 2.871594
2025-04-13 12:52:23,924 - INFO -   Gradients: avg norm: 0.552593, max norm: 4.296348, non-zero params: 250
2025-04-13 12:52:23,924 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-13 12:52:23,924 - INFO - --- Gradient Check @ Epoch 8, Batch 0 ---
2025-04-13 12:52:23,942 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:23,942 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:23,942 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.2316e-01, MaxNorm=3.6778e+00
2025-04-13 12:52:23,942 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.5907e-02, MaxNorm=3.5930e-02
2025-04-13 12:52:23,942 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.0142e-02, MaxNorm=4.7632e-02
2025-04-13 12:52:23,942 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.2465e-01, MaxNorm=1.1923e+00
2025-04-13 12:52:23,942 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.6652e+00, MaxNorm=3.1190e+00
2025-04-13 12:52:23,942 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.4915e+00, MaxNorm=2.6554e+00
2025-04-13 12:52:23,942 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.3597e-01, MaxNorm=6.1661e-01
2025-04-13 12:52:23,942 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.1140e+00, MaxNorm=1.1928e+00
2025-04-13 12:52:23,942 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1166e+00, MaxNorm=1.1498e+00
2025-04-13 12:52:23,942 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.3571e+00, MaxNorm=4.2963e+00
2025-04-13 12:52:23,942 - INFO - --- End Gradient Check ---
2025-04-13 12:52:23,945 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:23,946 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2794, 3.0650]
2025-04-13 12:52:23,946 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0924, 3.1316]
2025-04-13 12:52:23,946 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,946 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,947 - INFO -   True actions shape: tensor([-0.6886,  0.3122, -0.8940,  0.3956,  0.5094, -1.2832,  0.0242],
       device='cuda:0'), range: [-3.2794, 3.0650]
2025-04-13 12:52:23,948 - INFO -   Noise shape: tensor([-1.6253, -1.0779, -0.8845,  0.5443, -2.0017, -0.5975,  1.1131],
       device='cuda:0'), range: [-3.6216, 3.4780]
2025-04-13 12:52:23,948 - INFO -   Noisy actions shape: tensor([-1.7244, -1.0018, -1.0342,  0.6079, -1.8734, -0.8239,  1.0985],
       device='cuda:0'), range: [-3.3042, 3.6694]
2025-04-13 12:52:23,993 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:23,994 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4383, 3.0249]
2025-04-13 12:52:23,994 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9961, 3.5480]
2025-04-13 12:52:23,994 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:23,994 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:23,995 - INFO -   True actions shape: tensor([ 0.5961, -0.8124, -1.0037,  0.0561, -2.5138, -0.3159, -0.6778],
       device='cuda:0'), range: [-3.4383, 3.0249]
2025-04-13 12:52:23,995 - INFO -   Noise shape: tensor([-0.1139, -0.9907, -0.5372, -2.1636,  0.4212, -0.3456, -0.4840],
       device='cuda:0'), range: [-3.0557, 3.2556]
2025-04-13 12:52:23,996 - INFO -   Noisy actions shape: tensor([ 0.3857, -1.2580, -1.1153, -1.3397, -1.6642, -0.4639, -0.8307],
       device='cuda:0'), range: [-3.0906, 3.0720]
2025-04-13 12:52:24,039 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:24,039 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3510, 3.8107]
2025-04-13 12:52:24,039 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5520, 3.0028]
2025-04-13 12:52:24,039 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,039 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,040 - INFO -   True actions shape: tensor([1.3624, 0.0701, 0.4832, 0.2903, 0.1756, 1.2408, 2.6428],
       device='cuda:0'), range: [-3.3510, 3.8107]
2025-04-13 12:52:24,040 - INFO -   Noise shape: tensor([-2.0794,  0.6502,  0.4731, -1.5249,  1.5115, -0.6938, -1.4769],
       device='cuda:0'), range: [-3.3012, 3.6813]
2025-04-13 12:52:24,041 - INFO -   Noisy actions shape: tensor([1.0065, 0.1748, 0.5536, 0.0388, 0.4188, 1.1116, 2.3678],
       device='cuda:0'), range: [-3.3770, 3.9347]
2025-04-13 12:52:24,083 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:24,083 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0615, 3.1342]
2025-04-13 12:52:24,083 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9427, 3.8938]
2025-04-13 12:52:24,083 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,083 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,084 - INFO -   True actions shape: tensor([1.7682, 0.9146, 0.2417, 0.4241, 0.6024, 0.9413, 1.7179],
       device='cuda:0'), range: [-3.0615, 3.1342]
2025-04-13 12:52:24,085 - INFO -   Noise shape: tensor([ 1.0936, -0.4215,  1.5713, -0.9045, -0.1101, -1.7131, -0.9505],
       device='cuda:0'), range: [-3.7953, 3.2738]
2025-04-13 12:52:24,085 - INFO -   Noisy actions shape: tensor([ 2.0266,  0.3546,  1.2760, -0.3338,  0.3513, -0.5339,  0.5545],
       device='cuda:0'), range: [-3.3534, 3.2961]
2025-04-13 12:52:24,127 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:24,127 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6980, 3.2458]
2025-04-13 12:52:24,127 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4225, 3.0710]
2025-04-13 12:52:24,128 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,128 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,128 - INFO -   True actions shape: tensor([ 0.5398,  0.7362,  1.0675,  0.0075, -1.0783,  1.9904,  0.0952],
       device='cuda:0'), range: [-3.6980, 3.2458]
2025-04-13 12:52:24,129 - INFO -   Noise shape: tensor([-0.0698,  1.9207, -0.2045,  1.0228,  0.4191, -1.0469,  1.8866],
       device='cuda:0'), range: [-3.9896, 3.1841]
2025-04-13 12:52:24,129 - INFO -   Noisy actions shape: tensor([ 0.4056,  1.6938,  0.7645,  0.5849, -0.6520,  1.0489,  1.1460],
       device='cuda:0'), range: [-3.0165, 3.3891]
2025-04-13 12:52:24,171 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:24,171 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1137, 3.1649]
2025-04-13 12:52:24,171 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5663, 2.9193]
2025-04-13 12:52:24,171 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,171 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,172 - INFO -   True actions shape: tensor([-1.1441, -0.8681, -0.3586,  0.6605, -0.1112,  0.2989,  1.0072],
       device='cuda:0'), range: [-3.1137, 3.1649]
2025-04-13 12:52:24,173 - INFO -   Noise shape: tensor([-0.0081, -0.2725, -0.0669, -0.6675, -1.0554,  1.8009,  1.0061],
       device='cuda:0'), range: [-3.2221, 3.7154]
2025-04-13 12:52:24,173 - INFO -   Noisy actions shape: tensor([-0.0830, -0.3287, -0.0902, -0.6229, -1.0604,  1.8166,  1.0698],
       device='cuda:0'), range: [-3.2407, 3.5965]
2025-04-13 12:52:24,214 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:24,215 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6460, 3.1933]
2025-04-13 12:52:24,215 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2071, 3.0675]
2025-04-13 12:52:24,215 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,215 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,216 - INFO -   True actions shape: tensor([ 0.2113,  1.1958, -0.8356, -1.4848, -0.9115,  1.9140, -0.8428],
       device='cuda:0'), range: [-3.6460, 3.1933]
2025-04-13 12:52:24,216 - INFO -   Noise shape: tensor([-1.4412, -1.0588, -1.1213,  0.5817,  0.0145,  1.6067,  1.3710],
       device='cuda:0'), range: [-3.3736, 3.3891]
2025-04-13 12:52:24,217 - INFO -   Noisy actions shape: tensor([-0.9999, -0.0895, -1.3979, -0.4639, -0.5536,  2.4472,  0.5534],
       device='cuda:0'), range: [-3.3318, 3.1654]
2025-04-13 12:52:24,258 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:24,258 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1886, 3.3547]
2025-04-13 12:52:24,258 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1538, 2.9463]
2025-04-13 12:52:24,258 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,258 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,259 - INFO -   True actions shape: tensor([-0.1775,  0.1892,  0.3163, -1.1242, -0.6484, -0.7710,  0.6608],
       device='cuda:0'), range: [-3.1886, 3.3547]
2025-04-13 12:52:24,259 - INFO -   Noise shape: tensor([-0.1300, -0.2448,  1.0648,  2.8104, -0.4665,  0.5050, -1.1839],
       device='cuda:0'), range: [-3.9810, 3.2237]
2025-04-13 12:52:24,260 - INFO -   Noisy actions shape: tensor([-0.1911, -0.1462,  1.1011,  2.1060, -0.6906,  0.1460, -0.8107],
       device='cuda:0'), range: [-3.6790, 3.4931]
2025-04-13 12:52:24,301 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:24,301 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4360, 3.4822]
2025-04-13 12:52:24,302 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3315, 3.5403]
2025-04-13 12:52:24,302 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,302 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,302 - INFO -   True actions shape: tensor([-0.7596, -0.1165, -0.2022, -2.5112,  0.2588, -0.2088,  0.1950],
       device='cuda:0'), range: [-3.4360, 3.4822]
2025-04-13 12:52:24,303 - INFO -   Noise shape: tensor([ 0.0866, -0.7324,  0.5680,  0.0726, -0.8417,  1.3990,  0.3114],
       device='cuda:0'), range: [-3.7560, 3.5208]
2025-04-13 12:52:24,304 - INFO -   Noisy actions shape: tensor([-0.6970, -0.3343, -0.0194, -2.3694, -0.0102,  0.2277,  0.2807],
       device='cuda:0'), range: [-3.4645, 3.0146]
2025-04-13 12:52:24,345 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:24,345 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6374, 3.4511]
2025-04-13 12:52:24,345 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0480, 3.1951]
2025-04-13 12:52:24,345 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,345 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,346 - INFO -   True actions shape: tensor([-0.2347, -0.7196,  0.5959,  0.0321,  0.9221,  0.6081, -0.4186],
       device='cuda:0'), range: [-3.6374, 3.4511]
2025-04-13 12:52:24,346 - INFO -   Noise shape: tensor([ 0.2969,  0.3223, -0.0535, -0.1355, -0.3561,  0.5795, -0.5628],
       device='cuda:0'), range: [-3.2626, 3.2282]
2025-04-13 12:52:24,347 - INFO -   Noisy actions shape: tensor([ 0.1276, -0.1075,  0.2700, -0.0980,  0.1861,  0.8136, -0.6991],
       device='cuda:0'), range: [-3.2369, 3.8003]
2025-04-13 12:52:24,386 - INFO -   Loss components:
2025-04-13 12:52:24,386 - INFO -     Diffusion loss: 2.166522 (coef: 1.0)
2025-04-13 12:52:24,386 - INFO -     Grasp quality loss: 0.691506 (coef: 0.5)
2025-04-13 12:52:24,386 - INFO -     Grasp rotation loss: 0.584220 (coef: 0.5)
2025-04-13 12:52:24,386 - INFO -     Grasp width loss: 12.798860 (coef: 0.005)
2025-04-13 12:52:24,386 - INFO -     TOTAL loss: 2.868379
2025-04-13 12:52:24,394 - INFO -   Gradients: avg norm: 0.559607, max norm: 4.337634, non-zero params: 250
2025-04-13 12:52:24,394 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:52:24,397 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:24,397 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3883, 3.7469]
2025-04-13 12:52:24,397 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8914, 3.3617]
2025-04-13 12:52:24,397 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,397 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,398 - INFO -   True actions shape: tensor([ 1.9823,  0.6825,  2.7333,  0.6640,  0.4831,  0.5599, -0.7960],
       device='cuda:0'), range: [-3.3883, 3.7469]
2025-04-13 12:52:24,399 - INFO -   Noise shape: tensor([-0.7091,  1.2784,  0.5408, -0.8077, -0.6767,  1.3897,  0.7951],
       device='cuda:0'), range: [-3.9655, 3.5964]
2025-04-13 12:52:24,399 - INFO -   Noisy actions shape: tensor([ 1.4574,  1.1813,  2.6873,  0.2336,  0.1303,  1.1213, -0.3574],
       device='cuda:0'), range: [-3.9385, 3.7488]
2025-04-13 12:52:24,441 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:24,441 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2114, 3.4319]
2025-04-13 12:52:24,441 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3991, 3.2144]
2025-04-13 12:52:24,441 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,441 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,442 - INFO -   True actions shape: tensor([-0.4676,  0.4975,  0.9964,  1.1816,  0.0891,  0.8111, -0.3620],
       device='cuda:0'), range: [-3.2114, 3.4319]
2025-04-13 12:52:24,442 - INFO -   Noise shape: tensor([ 0.0782,  0.2900, -1.0910,  0.0733,  0.2296, -1.1864, -1.2942],
       device='cuda:0'), range: [-3.3819, 3.8389]
2025-04-13 12:52:24,443 - INFO -   Noisy actions shape: tensor([-0.3393,  0.5740,  0.1952,  1.0120,  0.2043, -0.0115, -1.0361],
       device='cuda:0'), range: [-3.4817, 3.4059]
2025-04-13 12:52:24,486 - INFO - 
=== Epoch 8 Summary ===
2025-04-13 12:52:24,486 - INFO -   Avg total loss: 2.654755
2025-04-13 12:52:24,486 - INFO -   Avg diffusion loss: 1.951916
2025-04-13 12:52:24,486 - INFO -   Avg grasp loss: 1.405677
2025-04-13 12:52:24,486 - INFO - 
=== EPOCH 9/20 ===
2025-04-13 12:52:24,487 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:24,490 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:24,490 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5085, 3.9163]
2025-04-13 12:52:24,490 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0728, 3.6659]
2025-04-13 12:52:24,490 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,490 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,491 - INFO -   True actions shape: tensor([ 1.0825,  1.2331, -0.2945,  1.0477,  1.0552,  1.2998, -0.7579],
       device='cuda:0'), range: [-3.5085, 3.9163]
2025-04-13 12:52:24,492 - INFO -   Noise shape: tensor([-1.5481,  0.3223,  2.0211, -1.1827,  0.3497, -1.0452, -0.4791],
       device='cuda:0'), range: [-3.8340, 3.9493]
2025-04-13 12:52:24,492 - INFO -   Noisy actions shape: tensor([-0.1832,  1.1467,  1.0896,  0.0277,  1.0292,  0.3087, -0.8874],
       device='cuda:0'), range: [-3.4483, 3.1580]
2025-04-13 12:52:24,493 - INFO -   Diffusion: timestep range [14, 875], noise range [-3.8340, 3.9493]
2025-04-13 12:52:24,493 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4483, 3.1580]
2025-04-13 12:52:24,512 - INFO -   Model output shapes:
2025-04-13 12:52:24,512 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:24,512 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4282, 0.5425]
2025-04-13 12:52:24,513 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6218
2025-04-13 12:52:24,513 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2767, 0.2494]
2025-04-13 12:52:24,535 - INFO -   Loss components:
2025-04-13 12:52:24,535 - INFO -     Diffusion loss: 2.039488 (coef: 1.0)
2025-04-13 12:52:24,535 - INFO -     Grasp quality loss: 0.694161 (coef: 0.5)
2025-04-13 12:52:24,535 - INFO -     Grasp rotation loss: 0.610519 (coef: 0.5)
2025-04-13 12:52:24,535 - INFO -     Grasp width loss: 13.752314 (coef: 0.005)
2025-04-13 12:52:24,535 - INFO -     TOTAL loss: 2.760590
2025-04-13 12:52:24,543 - INFO -   Gradients: avg norm: 0.505521, max norm: 3.835937, non-zero params: 250
2025-04-13 12:52:24,543 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:52:24,543 - INFO - --- Gradient Check @ Epoch 9, Batch 0 ---
2025-04-13 12:52:24,561 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:24,562 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:24,562 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.6506e-01, MaxNorm=3.1321e+00
2025-04-13 12:52:24,562 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.3388e-02, MaxNorm=3.2166e-02
2025-04-13 12:52:24,562 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.6024e-03, MaxNorm=2.3842e-02
2025-04-13 12:52:24,562 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=3.7654e-01, MaxNorm=1.0271e+00
2025-04-13 12:52:24,562 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3555e+00, MaxNorm=2.4732e+00
2025-04-13 12:52:24,562 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3754e+00, MaxNorm=2.4910e+00
2025-04-13 12:52:24,562 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.1978e-01, MaxNorm=5.3845e-01
2025-04-13 12:52:24,562 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.0296e+00, MaxNorm=1.0796e+00
2025-04-13 12:52:24,562 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0631e+00, MaxNorm=1.1807e+00
2025-04-13 12:52:24,562 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.1014e+00, MaxNorm=3.8359e+00
2025-04-13 12:52:24,562 - INFO - --- End Gradient Check ---
2025-04-13 12:52:24,565 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:24,565 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3845, 3.2347]
2025-04-13 12:52:24,565 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6055, 2.8834]
2025-04-13 12:52:24,565 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,565 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,566 - INFO -   True actions shape: tensor([ 0.8831,  2.1310,  0.1792, -0.6405,  0.3072, -2.4934,  0.5540],
       device='cuda:0'), range: [-4.3845, 3.2347]
2025-04-13 12:52:24,567 - INFO -   Noise shape: tensor([-1.1641,  0.1665, -0.4632, -0.5302,  0.6742, -0.9657, -0.6558],
       device='cuda:0'), range: [-3.2084, 3.7738]
2025-04-13 12:52:24,568 - INFO -   Noisy actions shape: tensor([ 0.3331,  2.0144, -0.0248, -0.8009,  0.5550, -2.6706,  0.2393],
       device='cuda:0'), range: [-3.1577, 3.0901]
2025-04-13 12:52:24,611 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:24,611 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3001, 3.0638]
2025-04-13 12:52:24,611 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9070, 3.0942]
2025-04-13 12:52:24,611 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,611 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,612 - INFO -   True actions shape: tensor([ 1.0689, -0.4730,  0.7849,  1.8342,  0.7292,  0.9030, -0.2955],
       device='cuda:0'), range: [-3.3001, 3.0638]
2025-04-13 12:52:24,612 - INFO -   Noise shape: tensor([-1.1446, -0.7465,  0.3005, -2.8854,  0.0164,  0.3378,  2.4369],
       device='cuda:0'), range: [-3.9017, 3.1136]
2025-04-13 12:52:24,613 - INFO -   Noisy actions shape: tensor([ 0.8891, -0.5775,  0.8205,  1.3901,  0.7237,  0.9429,  0.0659],
       device='cuda:0'), range: [-3.3168, 3.7071]
2025-04-13 12:52:24,655 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:24,655 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3039, 3.6010]
2025-04-13 12:52:24,655 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4435, 3.5988]
2025-04-13 12:52:24,655 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,655 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,656 - INFO -   True actions shape: tensor([-0.8168,  0.8815,  1.0427, -0.1324,  1.6950,  0.9612,  1.0252],
       device='cuda:0'), range: [-4.3039, 3.6010]
2025-04-13 12:52:24,656 - INFO -   Noise shape: tensor([-0.2653,  2.3138, -0.0086,  0.8599, -0.3559, -1.4247,  0.3969],
       device='cuda:0'), range: [-3.2622, 3.8021]
2025-04-13 12:52:24,657 - INFO -   Noisy actions shape: tensor([-0.6686,  2.4194,  0.5627,  0.6477,  0.6283, -0.6678,  0.8927],
       device='cuda:0'), range: [-3.8027, 3.4815]
2025-04-13 12:52:24,699 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:24,699 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9718, 3.6027]
2025-04-13 12:52:24,699 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6891, 3.0685]
2025-04-13 12:52:24,699 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,699 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,700 - INFO -   True actions shape: tensor([ 1.2479, -0.0150,  0.5619, -0.5387, -2.1750,  0.1722, -1.1604],
       device='cuda:0'), range: [-3.9718, 3.6027]
2025-04-13 12:52:24,700 - INFO -   Noise shape: tensor([-0.6230,  1.2197, -1.7702, -0.4537, -0.0925, -1.2764, -0.5441],
       device='cuda:0'), range: [-3.0884, 3.8813]
2025-04-13 12:52:24,701 - INFO -   Noisy actions shape: tensor([-0.0806,  1.1151, -1.4054, -0.6293, -0.9424, -1.1052, -0.9575],
       device='cuda:0'), range: [-3.1845, 3.5908]
2025-04-13 12:52:24,743 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:24,743 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4895, 3.5100]
2025-04-13 12:52:24,743 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1733, 3.4128]
2025-04-13 12:52:24,743 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,743 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,744 - INFO -   True actions shape: tensor([ 0.0931, -0.1189, -1.8157,  0.1074, -0.4792, -0.5053,  0.5375],
       device='cuda:0'), range: [-3.4895, 3.5100]
2025-04-13 12:52:24,745 - INFO -   Noise shape: tensor([-1.1893,  0.7805, -0.3126,  0.9261, -1.5137,  1.0224, -0.1972],
       device='cuda:0'), range: [-3.5649, 3.6199]
2025-04-13 12:52:24,745 - INFO -   Noisy actions shape: tensor([-0.9462,  0.5894, -1.2520,  0.8349, -1.5301,  0.5816,  0.1278],
       device='cuda:0'), range: [-3.3216, 3.3901]
2025-04-13 12:52:24,788 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:24,788 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4596, 3.6059]
2025-04-13 12:52:24,788 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7968, 3.2573]
2025-04-13 12:52:24,788 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,788 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,789 - INFO -   True actions shape: tensor([ 0.4248,  0.9957,  0.1185, -1.7052, -0.2360, -0.6172, -0.3630],
       device='cuda:0'), range: [-3.4596, 3.6059]
2025-04-13 12:52:24,789 - INFO -   Noise shape: tensor([ 0.5062, -2.0529, -1.2468,  0.4217,  0.1783, -0.3440, -0.9281],
       device='cuda:0'), range: [-3.6846, 3.7814]
2025-04-13 12:52:24,790 - INFO -   Noisy actions shape: tensor([ 0.6469, -1.3382, -1.0426, -0.4346,  0.0456, -0.5950, -0.9895],
       device='cuda:0'), range: [-3.1922, 4.1494]
2025-04-13 12:52:24,831 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:24,831 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2738, 3.1384]
2025-04-13 12:52:24,832 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8296, 3.0386]
2025-04-13 12:52:24,832 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,832 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,832 - INFO -   True actions shape: tensor([-1.1140, -0.6559, -1.4057,  0.2278, -0.6294,  1.1698,  0.9475],
       device='cuda:0'), range: [-4.2738, 3.1384]
2025-04-13 12:52:24,833 - INFO -   Noise shape: tensor([ 1.1093,  0.2523,  1.1863, -2.0340,  1.2775,  0.8494,  1.6228],
       device='cuda:0'), range: [-3.5491, 3.3439]
2025-04-13 12:52:24,834 - INFO -   Noisy actions shape: tensor([ 0.0260, -0.2734, -0.1210, -1.3067,  0.4833,  1.4233,  1.8261],
       device='cuda:0'), range: [-4.1905, 3.3542]
2025-04-13 12:52:24,875 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:24,875 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7603, 3.5758]
2025-04-13 12:52:24,875 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1045, 3.3734]
2025-04-13 12:52:24,875 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,875 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,876 - INFO -   True actions shape: tensor([ 0.8464, -0.1411, -0.2033,  0.4981, -0.5458,  0.6141,  1.2290],
       device='cuda:0'), range: [-3.7603, 3.5758]
2025-04-13 12:52:24,876 - INFO -   Noise shape: tensor([-0.0499, -0.5175,  0.9182,  0.0101, -0.6799,  0.2252,  0.4643],
       device='cuda:0'), range: [-3.2596, 2.9949]
2025-04-13 12:52:24,877 - INFO -   Noisy actions shape: tensor([ 0.8426, -0.1683, -0.1542,  0.4979, -0.5811,  0.6252,  1.2519],
       device='cuda:0'), range: [-3.2323, 3.4415]
2025-04-13 12:52:24,918 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:24,918 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0845, 3.1859]
2025-04-13 12:52:24,918 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6470, 2.7637]
2025-04-13 12:52:24,918 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,919 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,919 - INFO -   True actions shape: tensor([-0.4165,  0.1538,  0.7076,  1.7859, -0.1458, -0.0773,  0.2594],
       device='cuda:0'), range: [-3.0845, 3.1859]
2025-04-13 12:52:24,920 - INFO -   Noise shape: tensor([-0.3499,  1.0725, -0.5483,  0.8301, -0.3525, -0.8379, -0.3479],
       device='cuda:0'), range: [-2.9857, 3.3190]
2025-04-13 12:52:24,920 - INFO -   Noisy actions shape: tensor([-0.4109,  1.0833, -0.4306,  1.0997, -0.3710, -0.8396, -0.3029],
       device='cuda:0'), range: [-2.9698, 3.2671]
2025-04-13 12:52:24,963 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:24,963 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8937, 3.3431]
2025-04-13 12:52:24,963 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4311, 3.3690]
2025-04-13 12:52:24,963 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:24,963 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:24,964 - INFO -   True actions shape: tensor([-1.7558, -0.0170, -0.9201,  0.2837,  0.7458, -0.2745, -0.7239],
       device='cuda:0'), range: [-3.8937, 3.3431]
2025-04-13 12:52:24,965 - INFO -   Noise shape: tensor([-1.0464,  0.3440,  0.4648,  0.7152,  1.0872, -0.8267, -0.8802],
       device='cuda:0'), range: [-3.9322, 4.0172]
2025-04-13 12:52:24,965 - INFO -   Noisy actions shape: tensor([-1.1643,  0.3420,  0.4007,  0.7330,  1.1358, -0.8436, -0.9277],
       device='cuda:0'), range: [-3.1788, 4.0279]
2025-04-13 12:52:25,005 - INFO -   Loss components:
2025-04-13 12:52:25,005 - INFO -     Diffusion loss: 1.791694 (coef: 1.0)
2025-04-13 12:52:25,005 - INFO -     Grasp quality loss: 0.693262 (coef: 0.5)
2025-04-13 12:52:25,005 - INFO -     Grasp rotation loss: 0.593499 (coef: 0.5)
2025-04-13 12:52:25,005 - INFO -     Grasp width loss: 9.743623 (coef: 0.005)
2025-04-13 12:52:25,005 - INFO -     TOTAL loss: 2.483792
2025-04-13 12:52:25,013 - INFO -   Gradients: avg norm: 0.510763, max norm: 4.005270, non-zero params: 250
2025-04-13 12:52:25,013 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:52:25,016 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:25,016 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5101, 3.7026]
2025-04-13 12:52:25,016 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9489, 3.2772]
2025-04-13 12:52:25,016 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,016 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,017 - INFO -   True actions shape: tensor([-0.8970, -0.1524, -0.0384,  0.8454, -0.5039,  0.5255,  1.5032],
       device='cuda:0'), range: [-3.5101, 3.7026]
2025-04-13 12:52:25,017 - INFO -   Noise shape: tensor([-0.6867, -0.0225, -0.2143,  0.1109, -1.2436, -0.3774, -1.6280],
       device='cuda:0'), range: [-3.7031, 3.3376]
2025-04-13 12:52:25,018 - INFO -   Noisy actions shape: tensor([-1.0270, -0.0913, -0.2072,  0.4942, -1.3347, -0.0871, -0.7335],
       device='cuda:0'), range: [-3.5030, 3.3687]
2025-04-13 12:52:25,059 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:25,059 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1953, 3.6344]
2025-04-13 12:52:25,059 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3912, 2.8998]
2025-04-13 12:52:25,060 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,060 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,060 - INFO -   True actions shape: tensor([-1.0861,  0.1327, -1.4901, -0.1453,  0.2066,  0.7038, -0.1560],
       device='cuda:0'), range: [-3.1953, 3.6344]
2025-04-13 12:52:25,061 - INFO -   Noise shape: tensor([-0.9017, -0.6410, -0.6416, -0.9335,  0.4200,  0.7176, -0.6847],
       device='cuda:0'), range: [-2.9756, 3.1710]
2025-04-13 12:52:25,061 - INFO -   Noisy actions shape: tensor([-1.3193, -0.4928, -1.2916, -0.8842,  0.4673,  0.9710, -0.6729],
       device='cuda:0'), range: [-3.2712, 3.3725]
2025-04-13 12:52:25,103 - INFO - 
=== Epoch 9 Summary ===
2025-04-13 12:52:25,103 - INFO -   Avg total loss: 2.581885
2025-04-13 12:52:25,103 - INFO -   Avg diffusion loss: 1.886766
2025-04-13 12:52:25,103 - INFO -   Avg grasp loss: 1.390239
2025-04-13 12:52:25,103 - INFO - 
=== EPOCH 10/20 ===
2025-04-13 12:52:25,104 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:25,108 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:25,108 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2838, 3.3550]
2025-04-13 12:52:25,108 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9908, 2.8384]
2025-04-13 12:52:25,108 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,108 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,109 - INFO -   True actions shape: tensor([ 1.9334, -1.1645, -0.4857,  0.4306,  0.0890,  0.1671,  0.2456],
       device='cuda:0'), range: [-3.2838, 3.3550]
2025-04-13 12:52:25,110 - INFO -   Noise shape: tensor([-0.3292,  0.3986, -0.1990, -0.1402, -1.4488, -1.2436,  0.2419],
       device='cuda:0'), range: [-3.7098, 3.5597]
2025-04-13 12:52:25,111 - INFO -   Noisy actions shape: tensor([ 1.1862, -0.5775, -0.4905,  0.2185, -0.9253, -0.7281,  0.3446],
       device='cuda:0'), range: [-3.2295, 3.3384]
2025-04-13 12:52:25,111 - INFO -   Diffusion: timestep range [18, 931], noise range [-3.7098, 3.5597]
2025-04-13 12:52:25,111 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.2295, 3.3384]
2025-04-13 12:52:25,131 - INFO -   Model output shapes:
2025-04-13 12:52:25,131 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:25,131 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4240, 0.5631]
2025-04-13 12:52:25,131 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5336
2025-04-13 12:52:25,131 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1552, 0.2730]
2025-04-13 12:52:25,154 - INFO -   Loss components:
2025-04-13 12:52:25,154 - INFO -     Diffusion loss: 1.961645 (coef: 1.0)
2025-04-13 12:52:25,154 - INFO -     Grasp quality loss: 0.692779 (coef: 0.5)
2025-04-13 12:52:25,154 - INFO -     Grasp rotation loss: 0.547228 (coef: 0.5)
2025-04-13 12:52:25,154 - INFO -     Grasp width loss: 9.476905 (coef: 0.005)
2025-04-13 12:52:25,154 - INFO -     TOTAL loss: 2.629033
2025-04-13 12:52:25,163 - INFO -   Gradients: avg norm: 0.465743, max norm: 3.602494, non-zero params: 250
2025-04-13 12:52:25,163 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:52:25,163 - INFO - --- Gradient Check @ Epoch 10, Batch 0 ---
2025-04-13 12:52:25,181 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:25,181 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:25,181 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.5291e-01, MaxNorm=3.2667e+00
2025-04-13 12:52:25,181 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=9.1019e-03, MaxNorm=1.6302e-02
2025-04-13 12:52:25,181 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0781e-02, MaxNorm=2.6957e-02
2025-04-13 12:52:25,181 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.4845e-01, MaxNorm=3.5365e-01
2025-04-13 12:52:25,181 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5491e+00, MaxNorm=2.8866e+00
2025-04-13 12:52:25,182 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3517e+00, MaxNorm=2.4125e+00
2025-04-13 12:52:25,182 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.2077e-01, MaxNorm=5.5206e-01
2025-04-13 12:52:25,182 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.6443e-01, MaxNorm=5.0088e-01
2025-04-13 12:52:25,182 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0852e+00, MaxNorm=1.1315e+00
2025-04-13 12:52:25,182 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9852e+00, MaxNorm=3.6025e+00
2025-04-13 12:52:25,182 - INFO - --- End Gradient Check ---
2025-04-13 12:52:25,185 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:25,185 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8851, 4.2530]
2025-04-13 12:52:25,185 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.1200, 2.8454]
2025-04-13 12:52:25,185 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,185 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,186 - INFO -   True actions shape: tensor([ 0.0227, -2.0043, -0.3952, -0.0834, -0.0960,  0.2384,  0.8089],
       device='cuda:0'), range: [-3.8851, 4.2530]
2025-04-13 12:52:25,186 - INFO -   Noise shape: tensor([-0.2672, -1.1814, -0.7345,  0.2466,  0.7166,  0.3626,  0.7400],
       device='cuda:0'), range: [-3.2749, 3.6837]
2025-04-13 12:52:25,187 - INFO -   Noisy actions shape: tensor([-0.1358, -2.3186, -0.7467,  0.0743,  0.3353,  0.4040,  1.0877],
       device='cuda:0'), range: [-3.1207, 4.1656]
2025-04-13 12:52:25,230 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:25,230 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0482, 3.3895]
2025-04-13 12:52:25,230 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6581, 3.2377]
2025-04-13 12:52:25,230 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,230 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,231 - INFO -   True actions shape: tensor([-1.3904,  1.1924,  1.3650, -0.0190,  0.0234, -0.5748, -0.4789],
       device='cuda:0'), range: [-3.0482, 3.3895]
2025-04-13 12:52:25,232 - INFO -   Noise shape: tensor([ 0.4852, -1.6987,  1.2148, -2.4217, -0.1517, -0.5190, -0.2605],
       device='cuda:0'), range: [-3.4847, 3.9112]
2025-04-13 12:52:25,232 - INFO -   Noisy actions shape: tensor([ 0.2024, -1.4310,  1.4595, -2.3781, -0.1442, -0.6219, -0.3495],
       device='cuda:0'), range: [-3.4466, 3.3526]
2025-04-13 12:52:25,274 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:25,274 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5765, 3.4363]
2025-04-13 12:52:25,274 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1712, 3.4343]
2025-04-13 12:52:25,274 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,274 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,275 - INFO -   True actions shape: tensor([ 1.4556, -1.4079, -1.9572,  0.5132,  1.4193, -1.1874,  0.1922],
       device='cuda:0'), range: [-3.5765, 3.4363]
2025-04-13 12:52:25,276 - INFO -   Noise shape: tensor([ 1.7389,  0.8652,  0.6828, -0.1054, -0.5923,  2.1808,  0.5621],
       device='cuda:0'), range: [-3.1260, 3.4926]
2025-04-13 12:52:25,276 - INFO -   Noisy actions shape: tensor([ 2.2656, -0.3109, -0.8160,  0.2684,  0.5200,  0.8092,  0.5446],
       device='cuda:0'), range: [-3.1282, 3.5986]
2025-04-13 12:52:25,318 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:25,318 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2189, 3.6768]
2025-04-13 12:52:25,318 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2362, 2.8766]
2025-04-13 12:52:25,318 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,318 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,319 - INFO -   True actions shape: tensor([ 1.8652,  0.6073, -0.8823, -1.1895, -0.2542,  0.5616,  0.2333],
       device='cuda:0'), range: [-4.2189, 3.6768]
2025-04-13 12:52:25,320 - INFO -   Noise shape: tensor([ 0.1526,  0.1560,  1.5385, -0.4679, -0.0418,  0.6354, -1.0587],
       device='cuda:0'), range: [-3.4741, 3.3340]
2025-04-13 12:52:25,320 - INFO -   Noisy actions shape: tensor([ 1.5337,  0.5672,  0.3020, -1.2145, -0.2224,  0.8379, -0.4957],
       device='cuda:0'), range: [-3.6418, 3.3338]
2025-04-13 12:52:25,362 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:25,362 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1404, 3.4267]
2025-04-13 12:52:25,363 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9221, 2.8091]
2025-04-13 12:52:25,363 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,363 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,363 - INFO -   True actions shape: tensor([-0.3574, -1.4830,  0.9512, -1.1145,  1.2365, -0.6945, -1.6472],
       device='cuda:0'), range: [-4.1404, 3.4267]
2025-04-13 12:52:25,364 - INFO -   Noise shape: tensor([-1.6422, -0.4999,  1.7174,  2.0231,  0.0846, -0.9971, -0.9195],
       device='cuda:0'), range: [-3.3526, 3.4813]
2025-04-13 12:52:25,365 - INFO -   Noisy actions shape: tensor([-1.3514, -1.4446,  1.8474,  0.4958,  0.9855, -1.1796, -1.8448],
       device='cuda:0'), range: [-3.3336, 3.8783]
2025-04-13 12:52:25,406 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:25,406 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4292, 3.3143]
2025-04-13 12:52:25,406 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4624, 2.8931]
2025-04-13 12:52:25,406 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,406 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,407 - INFO -   True actions shape: tensor([ 1.3443, -0.8899,  0.8235, -0.5812, -0.2749, -0.3164,  0.1413],
       device='cuda:0'), range: [-3.4292, 3.3143]
2025-04-13 12:52:25,408 - INFO -   Noise shape: tensor([ 0.3498, -0.1159, -1.3576, -1.0039,  0.9262,  0.8093, -0.4147],
       device='cuda:0'), range: [-3.2679, 3.3844]
2025-04-13 12:52:25,408 - INFO -   Noisy actions shape: tensor([ 1.3879, -0.8942,  0.5153, -0.7817, -0.0712, -0.1367,  0.0497],
       device='cuda:0'), range: [-3.4151, 3.6837]
2025-04-13 12:52:25,449 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:25,449 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.5248, 2.9866]
2025-04-13 12:52:25,450 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9171, 2.9520]
2025-04-13 12:52:25,450 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,450 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,450 - INFO -   True actions shape: tensor([-0.8293,  2.1913,  0.0167, -0.3094, -1.0073,  0.1983, -0.2182],
       device='cuda:0'), range: [-4.5248, 2.9866]
2025-04-13 12:52:25,451 - INFO -   Noise shape: tensor([-0.8633, -1.1371, -0.1634,  1.2779, -1.7285, -1.1084,  0.6509],
       device='cuda:0'), range: [-3.2172, 3.2518]
2025-04-13 12:52:25,452 - INFO -   Noisy actions shape: tensor([-1.1718,  0.1993, -0.1296,  0.9188, -1.9996, -0.8341,  0.4359],
       device='cuda:0'), range: [-4.9272, 3.0429]
2025-04-13 12:52:25,493 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:25,493 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6329, 3.7667]
2025-04-13 12:52:25,493 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0156, 3.1440]
2025-04-13 12:52:25,493 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,493 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,494 - INFO -   True actions shape: tensor([ 1.3101, -1.6513, -0.5013,  0.2434,  2.4349,  0.9860,  0.1971],
       device='cuda:0'), range: [-3.6329, 3.7667]
2025-04-13 12:52:25,495 - INFO -   Noise shape: tensor([-1.6774, -0.8434,  0.5872, -0.2489, -0.5388, -1.1573,  0.3701],
       device='cuda:0'), range: [-3.5310, 3.6967]
2025-04-13 12:52:25,495 - INFO -   Noisy actions shape: tensor([-1.5881, -0.9496,  0.5532, -0.2325, -0.3784, -1.0903,  0.3822],
       device='cuda:0'), range: [-3.7541, 3.0126]
2025-04-13 12:52:25,536 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:25,537 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5171, 3.0069]
2025-04-13 12:52:25,537 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6211, 2.8569]
2025-04-13 12:52:25,537 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,537 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,538 - INFO -   True actions shape: tensor([ 0.0694,  0.5641,  1.1180,  1.5408, -0.6228, -0.7115,  1.1449],
       device='cuda:0'), range: [-3.5171, 3.0069]
2025-04-13 12:52:25,538 - INFO -   Noise shape: tensor([ 1.3598, -0.4102, -0.2042,  0.7863,  0.5421, -1.2883, -1.4590],
       device='cuda:0'), range: [-3.7184, 3.3804]
2025-04-13 12:52:25,539 - INFO -   Noisy actions shape: tensor([ 1.2265, -0.0894,  0.3571,  1.4290,  0.1769, -1.4717, -0.7310],
       device='cuda:0'), range: [-3.6706, 3.3845]
2025-04-13 12:52:25,580 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:25,580 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9519, 4.0267]
2025-04-13 12:52:25,580 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8809, 3.1985]
2025-04-13 12:52:25,580 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,580 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,581 - INFO -   True actions shape: tensor([-1.3856, -0.8585, -0.8500,  0.0368, -1.4168, -0.4477, -0.4917],
       device='cuda:0'), range: [-3.9519, 4.0267]
2025-04-13 12:52:25,581 - INFO -   Noise shape: tensor([-0.5233,  0.9351,  0.2372, -1.2978,  1.1138, -0.9960, -0.6933],
       device='cuda:0'), range: [-3.9111, 3.2325]
2025-04-13 12:52:25,582 - INFO -   Noisy actions shape: tensor([-1.4610, -0.6600, -0.7876, -0.2166, -1.1729, -0.6330, -0.6173],
       device='cuda:0'), range: [-3.6554, 4.1845]
2025-04-13 12:52:25,621 - INFO -   Loss components:
2025-04-13 12:52:25,621 - INFO -     Diffusion loss: 2.051531 (coef: 1.0)
2025-04-13 12:52:25,621 - INFO -     Grasp quality loss: 0.692090 (coef: 0.5)
2025-04-13 12:52:25,621 - INFO -     Grasp rotation loss: 0.580061 (coef: 0.5)
2025-04-13 12:52:25,621 - INFO -     Grasp width loss: 9.809259 (coef: 0.005)
2025-04-13 12:52:25,621 - INFO -     TOTAL loss: 2.736653
2025-04-13 12:52:25,629 - INFO -   Gradients: avg norm: 0.511779, max norm: 3.939814, non-zero params: 250
2025-04-13 12:52:25,629 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-13 12:52:25,632 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:25,632 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5043, 3.7242]
2025-04-13 12:52:25,632 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5425, 2.7497]
2025-04-13 12:52:25,632 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,632 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,633 - INFO -   True actions shape: tensor([ 0.5332,  0.0981,  0.2911, -0.6380,  0.3648, -0.4268, -0.8735],
       device='cuda:0'), range: [-3.5043, 3.7242]
2025-04-13 12:52:25,634 - INFO -   Noise shape: tensor([-0.2416,  0.8685,  1.3152, -0.4087, -0.2819,  1.0805,  0.2800],
       device='cuda:0'), range: [-3.2409, 3.5693]
2025-04-13 12:52:25,634 - INFO -   Noisy actions shape: tensor([ 0.3888,  0.4430,  0.8010, -0.7491,  0.2185,  0.0498, -0.6840],
       device='cuda:0'), range: [-3.1597, 3.4541]
2025-04-13 12:52:25,679 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:25,679 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1455, 3.7103]
2025-04-13 12:52:25,679 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7952, 2.9071]
2025-04-13 12:52:25,679 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,679 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,680 - INFO -   True actions shape: tensor([ 0.1731, -1.2183, -0.6365,  0.7002, -0.9904,  0.4885,  1.6741],
       device='cuda:0'), range: [-3.1455, 3.7103]
2025-04-13 12:52:25,681 - INFO -   Noise shape: tensor([-0.0920,  3.3661,  1.3741,  1.0099, -0.2989,  0.6413,  0.4098],
       device='cuda:0'), range: [-3.8791, 3.3661]
2025-04-13 12:52:25,681 - INFO -   Noisy actions shape: tensor([ 0.0743,  1.2144,  0.3887,  1.1840, -0.9527,  0.7856,  1.5495],
       device='cuda:0'), range: [-3.5301, 3.9871]
2025-04-13 12:52:25,723 - INFO - 
=== Epoch 10 Summary ===
2025-04-13 12:52:25,723 - INFO -   Avg total loss: 2.540023
2025-04-13 12:52:25,723 - INFO -   Avg diffusion loss: 1.863353
2025-04-13 12:52:25,723 - INFO -   Avg grasp loss: 1.353341
2025-04-13 12:52:25,896 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125218/ckpt_epoch_10.pth
2025-04-13 12:52:25,896 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:52:25,896 - INFO - 
=== EPOCH 11/20 ===
2025-04-13 12:52:25,897 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:25,901 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:25,901 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8769, 3.0857]
2025-04-13 12:52:25,901 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3767, 2.9168]
2025-04-13 12:52:25,901 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,901 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,902 - INFO -   True actions shape: tensor([-0.2806,  1.8420, -0.7161,  0.9327, -1.3141, -0.0507,  2.2162],
       device='cuda:0'), range: [-3.8769, 3.0857]
2025-04-13 12:52:25,902 - INFO -   Noise shape: tensor([-1.2085, -1.3811,  0.6058, -0.5680,  0.4019, -1.5027,  0.3599],
       device='cuda:0'), range: [-3.2249, 3.4598]
2025-04-13 12:52:25,903 - INFO -   Noisy actions shape: tensor([-1.2146, -0.4802,  0.2492, -0.1239, -0.1869, -1.3851,  1.2570],
       device='cuda:0'), range: [-3.9723, 3.1583]
2025-04-13 12:52:25,903 - INFO -   Diffusion: timestep range [18, 899], noise range [-3.2249, 3.4598]
2025-04-13 12:52:25,903 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.9723, 3.1583]
2025-04-13 12:52:25,922 - INFO -   Model output shapes:
2025-04-13 12:52:25,922 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:25,922 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4518, 0.5779]
2025-04-13 12:52:25,922 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5303
2025-04-13 12:52:25,922 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1624, 0.2254]
2025-04-13 12:52:25,943 - INFO -   Loss components:
2025-04-13 12:52:25,943 - INFO -     Diffusion loss: 1.815257 (coef: 1.0)
2025-04-13 12:52:25,943 - INFO -     Grasp quality loss: 0.694029 (coef: 0.5)
2025-04-13 12:52:25,943 - INFO -     Grasp rotation loss: 0.559127 (coef: 0.5)
2025-04-13 12:52:25,943 - INFO -     Grasp width loss: 8.868094 (coef: 0.005)
2025-04-13 12:52:25,943 - INFO -     TOTAL loss: 2.486175
2025-04-13 12:52:25,951 - INFO -   Gradients: avg norm: 0.459337, max norm: 3.527113, non-zero params: 250
2025-04-13 12:52:25,951 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:52:25,951 - INFO - --- Gradient Check @ Epoch 11, Batch 0 ---
2025-04-13 12:52:25,968 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:25,968 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:25,968 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.5250e-01, MaxNorm=3.2561e+00
2025-04-13 12:52:25,968 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.4652e-02, MaxNorm=3.1226e-02
2025-04-13 12:52:25,968 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.3655e-02, MaxNorm=3.3700e-02
2025-04-13 12:52:25,968 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.2253e-01, MaxNorm=2.7791e-01
2025-04-13 12:52:25,969 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5311e+00, MaxNorm=2.9421e+00
2025-04-13 12:52:25,969 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.2500e+00, MaxNorm=2.2705e+00
2025-04-13 12:52:25,969 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.1152e-01, MaxNorm=5.0113e-01
2025-04-13 12:52:25,969 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.2648e-01, MaxNorm=4.7537e-01
2025-04-13 12:52:25,969 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=9.9706e-01, MaxNorm=1.0581e+00
2025-04-13 12:52:25,969 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9364e+00, MaxNorm=3.5271e+00
2025-04-13 12:52:25,969 - INFO - --- End Gradient Check ---
2025-04-13 12:52:25,971 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:25,971 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2348, 3.3650]
2025-04-13 12:52:25,971 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3491, 2.4115]
2025-04-13 12:52:25,972 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:25,972 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:25,972 - INFO -   True actions shape: tensor([ 0.1477, -1.1788, -1.5181, -1.5026, -0.2569,  0.2158, -0.1144],
       device='cuda:0'), range: [-3.2348, 3.3650]
2025-04-13 12:52:25,973 - INFO -   Noise shape: tensor([ 0.4219,  0.8581, -1.9334,  1.0465, -1.8425, -1.8715,  0.8565],
       device='cuda:0'), range: [-3.6696, 3.1366]
2025-04-13 12:52:25,974 - INFO -   Noisy actions shape: tensor([ 0.3504, -0.5375, -2.3165, -0.7105, -1.2020, -0.8181,  0.3612],
       device='cuda:0'), range: [-3.1426, 3.3177]
2025-04-13 12:52:26,015 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:26,015 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5536, 3.5012]
2025-04-13 12:52:26,015 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0468, 2.9141]
2025-04-13 12:52:26,015 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,015 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,016 - INFO -   True actions shape: tensor([-0.7521, -0.1987,  0.2804,  1.4192,  0.1468,  0.2147,  0.5152],
       device='cuda:0'), range: [-3.5536, 3.5012]
2025-04-13 12:52:26,017 - INFO -   Noise shape: tensor([ 0.4586, -0.6816,  0.6085,  1.2739, -1.4147,  0.9276, -0.0024],
       device='cuda:0'), range: [-3.9706, 3.4205]
2025-04-13 12:52:26,017 - INFO -   Noisy actions shape: tensor([-0.3706, -0.5439,  0.5711,  1.8878, -0.6638,  0.6938,  0.4271],
       device='cuda:0'), range: [-3.9692, 3.8624]
2025-04-13 12:52:26,058 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:26,058 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8504, 3.5337]
2025-04-13 12:52:26,059 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7091, 2.9740]
2025-04-13 12:52:26,059 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,059 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,059 - INFO -   True actions shape: tensor([-0.7649,  1.8136,  1.5304, -1.2218, -0.7343,  0.3229,  1.9294],
       device='cuda:0'), range: [-3.8504, 3.5337]
2025-04-13 12:52:26,060 - INFO -   Noise shape: tensor([ 0.3983,  0.9581, -0.9892, -0.3216,  0.8003,  0.1544,  0.6821],
       device='cuda:0'), range: [-3.3929, 3.0919]
2025-04-13 12:52:26,061 - INFO -   Noisy actions shape: tensor([-0.0791,  1.7873, -0.0034, -0.9318,  0.2755,  0.3046,  1.6179],
       device='cuda:0'), range: [-3.4563, 3.8224]
2025-04-13 12:52:26,102 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:26,102 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3172, 2.8483]
2025-04-13 12:52:26,102 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8510, 3.4864]
2025-04-13 12:52:26,102 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,102 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,103 - INFO -   True actions shape: tensor([-0.4561, -1.8973, -1.2278, -0.2519,  0.7080,  0.9517,  1.6694],
       device='cuda:0'), range: [-3.3172, 2.8483]
2025-04-13 12:52:26,104 - INFO -   Noise shape: tensor([-1.5480,  0.2427,  0.6752, -0.2533,  0.6300,  1.3967,  0.5049],
       device='cuda:0'), range: [-3.3703, 4.4245]
2025-04-13 12:52:26,104 - INFO -   Noisy actions shape: tensor([-1.5975, -0.5678,  0.1039, -0.3350,  0.8672,  1.6659,  1.1530],
       device='cuda:0'), range: [-3.4473, 3.5310]
2025-04-13 12:52:26,146 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:26,146 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3669, 2.8936]
2025-04-13 12:52:26,146 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.8884, 3.2136]
2025-04-13 12:52:26,146 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,146 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,147 - INFO -   True actions shape: tensor([ 0.8280, -1.2793, -0.1759, -0.4523,  1.1164, -0.1238,  0.0883],
       device='cuda:0'), range: [-3.3669, 2.8936]
2025-04-13 12:52:26,147 - INFO -   Noise shape: tensor([ 1.2402,  0.0411,  1.3979, -1.1772, -0.4399, -0.3720, -1.5988],
       device='cuda:0'), range: [-3.4343, 2.9314]
2025-04-13 12:52:26,148 - INFO -   Noisy actions shape: tensor([ 1.1357, -1.2192,  0.2132, -0.7571,  0.9535, -0.2209, -0.3524],
       device='cuda:0'), range: [-3.6293, 3.4445]
2025-04-13 12:52:26,189 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:26,189 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3836, 3.5361]
2025-04-13 12:52:26,189 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0199, 3.4050]
2025-04-13 12:52:26,189 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,189 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,190 - INFO -   True actions shape: tensor([-0.6592,  1.1482,  0.1253, -1.3618,  0.0714, -1.3284,  0.9628],
       device='cuda:0'), range: [-3.3836, 3.5361]
2025-04-13 12:52:26,191 - INFO -   Noise shape: tensor([-1.8263,  0.2219,  0.7426, -1.0063, -0.5438,  0.1503, -1.5873],
       device='cuda:0'), range: [-3.4993, 4.0085]
2025-04-13 12:52:26,191 - INFO -   Noisy actions shape: tensor([-1.4740,  1.1083,  0.4752, -1.6810, -0.2061, -1.0815,  0.0548],
       device='cuda:0'), range: [-3.5158, 3.3306]
2025-04-13 12:52:26,232 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:26,232 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6103, 3.4771]
2025-04-13 12:52:26,232 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8635, 2.8498]
2025-04-13 12:52:26,233 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,233 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,233 - INFO -   True actions shape: tensor([ 6.2684e-01, -8.3193e-04, -5.7087e-01, -3.4264e-01, -1.0461e-01,
        -2.6833e-01,  1.6092e+00], device='cuda:0'), range: [-3.6103, 3.4771]
2025-04-13 12:52:26,234 - INFO -   Noise shape: tensor([ 0.3238,  0.8204,  0.7131,  1.9347,  0.4772, -0.9503,  0.4705],
       device='cuda:0'), range: [-3.6078, 3.3479]
2025-04-13 12:52:26,234 - INFO -   Noisy actions shape: tensor([ 0.5997,  0.7036,  0.3188,  1.4842,  0.3558, -0.9532,  1.2300],
       device='cuda:0'), range: [-3.5580, 3.5132]
2025-04-13 12:52:26,276 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:26,276 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3640, 3.7080]
2025-04-13 12:52:26,276 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0708, 3.8326]
2025-04-13 12:52:26,276 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,276 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,277 - INFO -   True actions shape: tensor([ 2.8327,  2.0690, -1.3668, -0.9791, -0.5809, -0.4172, -0.2617],
       device='cuda:0'), range: [-3.3640, 3.7080]
2025-04-13 12:52:26,277 - INFO -   Noise shape: tensor([-0.9845,  1.4169,  0.1571,  0.1963,  0.3100, -0.7998, -0.9204],
       device='cuda:0'), range: [-3.7379, 3.9267]
2025-04-13 12:52:26,278 - INFO -   Noisy actions shape: tensor([ 1.6561,  2.5044, -0.9918, -0.6597, -0.2741, -0.8167, -0.7661],
       device='cuda:0'), range: [-3.7924, 3.3097]
2025-04-13 12:52:26,319 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:26,319 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7569, 3.3498]
2025-04-13 12:52:26,320 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3070, 4.4414]
2025-04-13 12:52:26,320 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,320 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,320 - INFO -   True actions shape: tensor([ 2.6724,  1.1098, -0.8076, -1.1704,  0.6006,  1.6524,  0.6939],
       device='cuda:0'), range: [-3.7569, 3.3498]
2025-04-13 12:52:26,321 - INFO -   Noise shape: tensor([-1.0714, -0.3711,  0.4762,  1.2327, -0.3543, -1.2713, -0.6670],
       device='cuda:0'), range: [-3.4658, 3.4695]
2025-04-13 12:52:26,322 - INFO -   Noisy actions shape: tensor([ 1.9695,  0.8491, -0.5308, -0.5401,  0.3947,  0.9607,  0.3471],
       device='cuda:0'), range: [-3.8775, 3.2273]
2025-04-13 12:52:26,363 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:26,363 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7878, 3.7096]
2025-04-13 12:52:26,363 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7371, 3.3563]
2025-04-13 12:52:26,363 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,363 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,364 - INFO -   True actions shape: tensor([ 0.3184,  1.3692,  0.0539,  0.6500, -0.1055,  1.3614,  1.0722],
       device='cuda:0'), range: [-3.7878, 3.7096]
2025-04-13 12:52:26,365 - INFO -   Noise shape: tensor([ 0.4583,  0.5895,  0.4139,  0.3994, -0.5964,  0.2587, -1.6596],
       device='cuda:0'), range: [-3.4503, 3.5403]
2025-04-13 12:52:26,365 - INFO -   Noisy actions shape: tensor([ 0.5442,  1.4086,  0.3189,  0.7493, -0.4802,  1.1797, -0.3275],
       device='cuda:0'), range: [-3.8451, 3.1779]
2025-04-13 12:52:26,405 - INFO -   Loss components:
2025-04-13 12:52:26,405 - INFO -     Diffusion loss: 1.561451 (coef: 1.0)
2025-04-13 12:52:26,405 - INFO -     Grasp quality loss: 0.694146 (coef: 0.5)
2025-04-13 12:52:26,405 - INFO -     Grasp rotation loss: 0.571455 (coef: 0.5)
2025-04-13 12:52:26,405 - INFO -     Grasp width loss: 7.540060 (coef: 0.005)
2025-04-13 12:52:26,405 - INFO -     TOTAL loss: 2.231952
2025-04-13 12:52:26,414 - INFO -   Gradients: avg norm: 0.403994, max norm: 3.298923, non-zero params: 250
2025-04-13 12:52:26,414 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:52:26,416 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:26,416 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8620, 3.3847]
2025-04-13 12:52:26,416 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2561, 2.7349]
2025-04-13 12:52:26,417 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,417 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,417 - INFO -   True actions shape: tensor([ 0.3627, -0.7527,  0.9084, -1.0328,  1.0242,  1.3073,  0.3179],
       device='cuda:0'), range: [-3.8620, 3.3847]
2025-04-13 12:52:26,418 - INFO -   Noise shape: tensor([ 0.7248, -0.4763, -0.5917, -0.7109,  1.4021,  0.9146, -0.3190],
       device='cuda:0'), range: [-3.6180, 3.6231]
2025-04-13 12:52:26,418 - INFO -   Noisy actions shape: tensor([ 0.7660, -0.5705, -0.4680, -0.8397,  1.5238,  1.0774, -0.2748],
       device='cuda:0'), range: [-3.8489, 3.6600]
2025-04-13 12:52:26,460 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:26,460 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3188, 3.6251]
2025-04-13 12:52:26,460 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2210, 2.6774]
2025-04-13 12:52:26,460 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,460 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,461 - INFO -   True actions shape: tensor([ 1.7411, -0.4493, -1.0078,  1.4353,  1.2312, -0.0421, -1.7985],
       device='cuda:0'), range: [-3.3188, 3.6251]
2025-04-13 12:52:26,461 - INFO -   Noise shape: tensor([ 0.1768,  0.8053,  2.5638, -1.0316,  0.1386, -0.3426,  0.1534],
       device='cuda:0'), range: [-3.0383, 3.9903]
2025-04-13 12:52:26,462 - INFO -   Noisy actions shape: tensor([ 0.9379,  0.5188,  1.8409, -0.2794,  0.6754, -0.3252, -0.6684],
       device='cuda:0'), range: [-3.0364, 3.4242]
2025-04-13 12:52:26,501 - INFO - 
=== Epoch 11 Summary ===
2025-04-13 12:52:26,501 - INFO -   Avg total loss: 2.392419
2025-04-13 12:52:26,501 - INFO -   Avg diffusion loss: 1.715272
2025-04-13 12:52:26,501 - INFO -   Avg grasp loss: 1.354294
2025-04-13 12:52:26,501 - INFO - 
=== EPOCH 12/20 ===
2025-04-13 12:52:26,502 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:26,505 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:26,505 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3824, 3.6950]
2025-04-13 12:52:26,505 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1553, 2.9933]
2025-04-13 12:52:26,505 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,505 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,506 - INFO -   True actions shape: tensor([ 1.4447, -0.7335,  0.5133,  0.0262,  1.1381, -0.6863, -0.7101],
       device='cuda:0'), range: [-3.3824, 3.6950]
2025-04-13 12:52:26,507 - INFO -   Noise shape: tensor([-0.6145,  0.4923, -0.3495, -0.3219, -0.3299,  0.0231, -0.0620],
       device='cuda:0'), range: [-3.4436, 3.8679]
2025-04-13 12:52:26,507 - INFO -   Noisy actions shape: tensor([ 1.3792, -0.6830,  0.4775, -0.0047,  1.1013, -0.6810, -0.7127],
       device='cuda:0'), range: [-3.2407, 3.8476]
2025-04-13 12:52:26,507 - INFO -   Diffusion: timestep range [53, 761], noise range [-3.4436, 3.8679]
2025-04-13 12:52:26,507 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.2407, 3.8476]
2025-04-13 12:52:26,526 - INFO -   Model output shapes:
2025-04-13 12:52:26,526 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:26,526 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4410, 0.5596]
2025-04-13 12:52:26,526 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5826
2025-04-13 12:52:26,526 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1317, 0.2600]
2025-04-13 12:52:26,547 - INFO -   Loss components:
2025-04-13 12:52:26,547 - INFO -     Diffusion loss: 1.512738 (coef: 1.0)
2025-04-13 12:52:26,547 - INFO -     Grasp quality loss: 0.696882 (coef: 0.5)
2025-04-13 12:52:26,547 - INFO -     Grasp rotation loss: 0.590162 (coef: 0.5)
2025-04-13 12:52:26,547 - INFO -     Grasp width loss: 7.983416 (coef: 0.005)
2025-04-13 12:52:26,547 - INFO -     TOTAL loss: 2.196177
2025-04-13 12:52:26,555 - INFO -   Gradients: avg norm: 0.387000, max norm: 3.059236, non-zero params: 250
2025-04-13 12:52:26,555 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:52:26,555 - INFO - --- Gradient Check @ Epoch 12, Batch 0 ---
2025-04-13 12:52:26,573 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:26,573 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:26,573 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.3134e-01, MaxNorm=2.6797e+00
2025-04-13 12:52:26,573 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.3543e-02, MaxNorm=2.9949e-02
2025-04-13 12:52:26,573 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.6186e-02, MaxNorm=5.3593e-02
2025-04-13 12:52:26,573 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=9.3935e-02, MaxNorm=2.4223e-01
2025-04-13 12:52:26,573 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.1214e+00, MaxNorm=2.0833e+00
2025-04-13 12:52:26,573 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.2158e+00, MaxNorm=2.2250e+00
2025-04-13 12:52:26,573 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.0038e-01, MaxNorm=4.4748e-01
2025-04-13 12:52:26,573 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.5693e-01, MaxNorm=3.9957e-01
2025-04-13 12:52:26,573 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=9.6384e-01, MaxNorm=9.6648e-01
2025-04-13 12:52:26,573 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6943e+00, MaxNorm=3.0592e+00
2025-04-13 12:52:26,573 - INFO - --- End Gradient Check ---
2025-04-13 12:52:26,576 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:26,576 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0291, 3.7549]
2025-04-13 12:52:26,576 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2691, 3.1693]
2025-04-13 12:52:26,576 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,576 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,577 - INFO -   True actions shape: tensor([ 1.4130, -1.7806, -0.4305,  0.2513, -0.3753, -0.7337, -0.3648],
       device='cuda:0'), range: [-3.0291, 3.7549]
2025-04-13 12:52:26,577 - INFO -   Noise shape: tensor([-0.6754, -0.4188,  1.3719,  2.0938,  0.4238,  1.7061, -0.4904],
       device='cuda:0'), range: [-3.5982, 3.4962]
2025-04-13 12:52:26,578 - INFO -   Noisy actions shape: tensor([ 1.2746, -1.8262, -0.1864,  0.6102, -0.2962, -0.4271, -0.4442],
       device='cuda:0'), range: [-3.2404, 3.6676]
2025-04-13 12:52:26,620 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:26,620 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2019, 3.5770]
2025-04-13 12:52:26,620 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9165, 2.8087]
2025-04-13 12:52:26,620 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,620 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,621 - INFO -   True actions shape: tensor([ 1.5296, -0.4276, -0.3526,  0.6742, -0.8347,  0.1668,  2.7463],
       device='cuda:0'), range: [-4.2019, 3.5770]
2025-04-13 12:52:26,622 - INFO -   Noise shape: tensor([ 0.8864, -1.6210,  0.6017,  0.5026, -0.9057, -2.0203, -1.9936],
       device='cuda:0'), range: [-3.7904, 3.3441]
2025-04-13 12:52:26,622 - INFO -   Noisy actions shape: tensor([ 1.6478, -1.5329,  0.2495,  0.8136, -1.2286, -1.4733,  0.1591],
       device='cuda:0'), range: [-3.7559, 3.3478]
2025-04-13 12:52:26,668 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:26,668 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7495, 3.5497]
2025-04-13 12:52:26,668 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5864, 3.3889]
2025-04-13 12:52:26,668 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,668 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,669 - INFO -   True actions shape: tensor([ 1.7269, -1.2418,  0.1215, -0.3268,  0.2774,  0.4613, -1.0402],
       device='cuda:0'), range: [-3.7495, 3.5497]
2025-04-13 12:52:26,670 - INFO -   Noise shape: tensor([-0.2605,  1.0458, -2.3602,  1.0030,  0.3715,  0.1310, -2.1990],
       device='cuda:0'), range: [-3.2214, 3.1200]
2025-04-13 12:52:26,670 - INFO -   Noisy actions shape: tensor([ 0.5068,  0.4107, -2.0789,  0.7652,  0.4546,  0.3165, -2.4326],
       device='cuda:0'), range: [-3.8523, 3.2037]
2025-04-13 12:52:26,714 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:26,714 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5679, 3.4770]
2025-04-13 12:52:26,714 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8444, 2.9749]
2025-04-13 12:52:26,714 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,714 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,715 - INFO -   True actions shape: tensor([-0.1429,  0.2537, -0.2572, -0.2195,  0.0432,  0.8530, -1.4443],
       device='cuda:0'), range: [-3.5679, 3.4770]
2025-04-13 12:52:26,715 - INFO -   Noise shape: tensor([-1.1792,  0.1328, -0.2462, -0.2486,  1.0264,  0.5550, -0.6111],
       device='cuda:0'), range: [-3.1828, 3.1594]
2025-04-13 12:52:26,716 - INFO -   Noisy actions shape: tensor([-0.5555,  0.2844, -0.3283, -0.2939,  0.4077,  0.9951, -1.5673],
       device='cuda:0'), range: [-3.6359, 4.1981]
2025-04-13 12:52:26,759 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:26,759 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5833, 3.6587]
2025-04-13 12:52:26,759 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5298, 3.4679]
2025-04-13 12:52:26,759 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,759 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,760 - INFO -   True actions shape: tensor([-1.3280, -0.3646, -1.8588,  0.9511,  0.0927,  0.2069, -1.2940],
       device='cuda:0'), range: [-3.5833, 3.6587]
2025-04-13 12:52:26,761 - INFO -   Noise shape: tensor([ 0.1912,  0.2330, -0.3258,  0.1879, -1.4860, -1.7766, -1.0827],
       device='cuda:0'), range: [-3.7986, 4.0951]
2025-04-13 12:52:26,761 - INFO -   Noisy actions shape: tensor([-1.3021, -0.3394, -1.8821,  0.9652, -0.0569,  0.0276, -1.3961],
       device='cuda:0'), range: [-3.6166, 3.5742]
2025-04-13 12:52:26,803 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:26,803 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2191, 3.1615]
2025-04-13 12:52:26,803 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1680, 3.2361]
2025-04-13 12:52:26,803 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,804 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,804 - INFO -   True actions shape: tensor([-0.9839,  0.6815,  1.3714, -0.5444,  2.1075, -1.5049, -1.7623],
       device='cuda:0'), range: [-3.2191, 3.1615]
2025-04-13 12:52:26,805 - INFO -   Noise shape: tensor([ 0.8690,  0.4575,  1.1738,  0.2714, -0.2970, -1.2470,  0.3653],
       device='cuda:0'), range: [-3.2104, 3.3587]
2025-04-13 12:52:26,805 - INFO -   Noisy actions shape: tensor([-0.8169,  0.7510,  1.5554, -0.4886,  2.0232, -1.6996, -1.6714],
       device='cuda:0'), range: [-3.3306, 3.4874]
2025-04-13 12:52:26,847 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:26,847 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4294, 3.8097]
2025-04-13 12:52:26,847 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8529, 3.6088]
2025-04-13 12:52:26,848 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,848 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,848 - INFO -   True actions shape: tensor([ 0.8609,  0.9755,  0.0487,  1.5760, -0.5409, -1.6104, -0.7954],
       device='cuda:0'), range: [-3.4294, 3.8097]
2025-04-13 12:52:26,849 - INFO -   Noise shape: tensor([ 1.4762, -1.6370,  1.0084,  0.8318, -0.3784, -1.0558, -0.8428],
       device='cuda:0'), range: [-3.4710, 4.2231]
2025-04-13 12:52:26,849 - INFO -   Noisy actions shape: tensor([ 1.4550,  0.0889,  0.5182,  1.7820, -0.6554, -1.9179, -1.0987],
       device='cuda:0'), range: [-3.3915, 3.1813]
2025-04-13 12:52:26,891 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:26,891 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2826, 3.6615]
2025-04-13 12:52:26,891 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1630, 3.2522]
2025-04-13 12:52:26,891 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,892 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,892 - INFO -   True actions shape: tensor([-1.2870, -2.6494, -0.3337, -0.3971, -0.1618, -0.2590,  0.1598],
       device='cuda:0'), range: [-3.2826, 3.6615]
2025-04-13 12:52:26,893 - INFO -   Noise shape: tensor([ 1.3410,  1.1624,  0.3985,  0.3827,  0.4937, -0.6410,  1.3651],
       device='cuda:0'), range: [-3.3388, 3.6910]
2025-04-13 12:52:26,893 - INFO -   Noisy actions shape: tensor([-8.0638e-01, -2.1568e+00, -1.9329e-01, -2.5850e-01, -2.9261e-04,
        -4.4542e-01,  5.7628e-01], device='cuda:0'), range: [-4.4053, 3.6092]
2025-04-13 12:52:26,935 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:26,935 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5591, 3.4774]
2025-04-13 12:52:26,935 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7217, 2.4676]
2025-04-13 12:52:26,935 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,935 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,936 - INFO -   True actions shape: tensor([-0.5239, -0.2242, -0.8244, -0.6201,  0.0085,  1.4118,  1.4662],
       device='cuda:0'), range: [-3.5591, 3.4774]
2025-04-13 12:52:26,936 - INFO -   Noise shape: tensor([-0.2898, -0.8346, -0.2599,  0.4080,  0.6411, -0.9991, -0.7096],
       device='cuda:0'), range: [-3.5048, 3.1553]
2025-04-13 12:52:26,937 - INFO -   Noisy actions shape: tensor([-0.5594, -0.7823, -0.7305, -0.0884,  0.4953,  0.1476,  0.4039],
       device='cuda:0'), range: [-3.5548, 3.6357]
2025-04-13 12:52:26,980 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:26,980 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1887, 3.3167]
2025-04-13 12:52:26,980 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7367, 3.0822]
2025-04-13 12:52:26,980 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:26,980 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:26,981 - INFO -   True actions shape: tensor([ 1.0120,  0.8623, -1.7087,  1.1632, -1.4187, -0.0400,  0.9095],
       device='cuda:0'), range: [-3.1887, 3.3167]
2025-04-13 12:52:26,982 - INFO -   Noise shape: tensor([-0.9960,  0.6374, -0.2098,  1.4948,  0.6832, -0.7122,  0.0370],
       device='cuda:0'), range: [-3.1519, 3.6312]
2025-04-13 12:52:26,982 - INFO -   Noisy actions shape: tensor([-0.6098,  0.8846, -0.7576,  1.7932,  0.1811, -0.6860,  0.3327],
       device='cuda:0'), range: [-3.4318, 3.5233]
2025-04-13 12:52:27,021 - INFO -   Loss components:
2025-04-13 12:52:27,021 - INFO -     Diffusion loss: 1.644201 (coef: 1.0)
2025-04-13 12:52:27,021 - INFO -     Grasp quality loss: 0.693859 (coef: 0.5)
2025-04-13 12:52:27,021 - INFO -     Grasp rotation loss: 0.580976 (coef: 0.5)
2025-04-13 12:52:27,021 - INFO -     Grasp width loss: 7.504336 (coef: 0.005)
2025-04-13 12:52:27,022 - INFO -     TOTAL loss: 2.319141
2025-04-13 12:52:27,030 - INFO -   Gradients: avg norm: 0.397246, max norm: 3.111957, non-zero params: 250
2025-04-13 12:52:27,030 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:52:27,032 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:27,032 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6939, 3.8022]
2025-04-13 12:52:27,032 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7776, 3.3156]
2025-04-13 12:52:27,033 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,033 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,033 - INFO -   True actions shape: tensor([-0.7751,  0.3871,  0.6251,  0.7716,  0.6460,  0.9162, -0.8705],
       device='cuda:0'), range: [-3.6939, 3.8022]
2025-04-13 12:52:27,034 - INFO -   Noise shape: tensor([ 0.2765, -1.8669, -1.4428, -1.5332, -0.5663,  0.3228,  0.4654],
       device='cuda:0'), range: [-4.5937, 3.2459]
2025-04-13 12:52:27,034 - INFO -   Noisy actions shape: tensor([ 0.2607, -1.8587, -1.4299, -1.5172, -0.5531,  0.3413,  0.4477],
       device='cuda:0'), range: [-3.1736, 3.3221]
2025-04-13 12:52:27,076 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:27,076 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4450, 3.7270]
2025-04-13 12:52:27,076 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7495, 2.9032]
2025-04-13 12:52:27,076 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,076 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,077 - INFO -   True actions shape: tensor([-0.2924, -0.6121, -1.0557, -0.5365,  0.3199,  0.2453, -1.4236],
       device='cuda:0'), range: [-3.4450, 3.7270]
2025-04-13 12:52:27,077 - INFO -   Noise shape: tensor([-0.7317, -1.1517, -0.4578, -0.2937, -1.2579,  0.4902, -2.3846],
       device='cuda:0'), range: [-3.5552, 3.2207]
2025-04-13 12:52:27,078 - INFO -   Noisy actions shape: tensor([-0.7743, -1.3002, -0.9534, -0.5360, -0.8890,  0.5452, -2.7761],
       device='cuda:0'), range: [-3.6421, 3.6631]
2025-04-13 12:52:27,117 - INFO - 
=== Epoch 12 Summary ===
2025-04-13 12:52:27,117 - INFO -   Avg total loss: 2.314782
2025-04-13 12:52:27,117 - INFO -   Avg diffusion loss: 1.644269
2025-04-13 12:52:27,117 - INFO -   Avg grasp loss: 1.341026
2025-04-13 12:52:27,117 - INFO - 
=== EPOCH 13/20 ===
2025-04-13 12:52:27,118 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:27,121 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:27,121 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3176, 3.7105]
2025-04-13 12:52:27,121 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0294, 4.5012]
2025-04-13 12:52:27,121 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,121 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,122 - INFO -   True actions shape: tensor([-0.2476, -0.0251, -0.6090, -1.8006, -1.1993,  0.3222, -0.1627],
       device='cuda:0'), range: [-3.3176, 3.7105]
2025-04-13 12:52:27,122 - INFO -   Noise shape: tensor([ 0.3731, -0.6993,  0.3766, -0.7143, -0.9482, -1.6265,  0.8809],
       device='cuda:0'), range: [-3.9254, 3.5483]
2025-04-13 12:52:27,123 - INFO -   Noisy actions shape: tensor([ 0.2430, -0.6510,  0.1017, -1.3748, -1.3487, -1.3619,  0.7423],
       device='cuda:0'), range: [-3.5403, 3.3710]
2025-04-13 12:52:27,123 - INFO -   Diffusion: timestep range [122, 957], noise range [-3.9254, 3.5483]
2025-04-13 12:52:27,123 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5403, 3.3710]
2025-04-13 12:52:27,142 - INFO -   Model output shapes:
2025-04-13 12:52:27,142 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:27,142 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4596, 0.5602]
2025-04-13 12:52:27,142 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6301
2025-04-13 12:52:27,142 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1231, 0.2273]
2025-04-13 12:52:27,162 - INFO -   Loss components:
2025-04-13 12:52:27,162 - INFO -     Diffusion loss: 1.503034 (coef: 1.0)
2025-04-13 12:52:27,162 - INFO -     Grasp quality loss: 0.694375 (coef: 0.5)
2025-04-13 12:52:27,163 - INFO -     Grasp rotation loss: 0.579446 (coef: 0.5)
2025-04-13 12:52:27,163 - INFO -     Grasp width loss: 7.256444 (coef: 0.005)
2025-04-13 12:52:27,163 - INFO -     TOTAL loss: 2.176227
2025-04-13 12:52:27,171 - INFO -   Gradients: avg norm: 0.408083, max norm: 3.214547, non-zero params: 250
2025-04-13 12:52:27,171 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:52:27,171 - INFO - --- Gradient Check @ Epoch 13, Batch 0 ---
2025-04-13 12:52:27,188 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:27,188 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:27,188 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.5547e-01, MaxNorm=2.6255e+00
2025-04-13 12:52:27,188 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=7.3722e-03, MaxNorm=1.4872e-02
2025-04-13 12:52:27,188 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0640e-02, MaxNorm=2.3249e-02
2025-04-13 12:52:27,188 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.4524e-01, MaxNorm=3.6868e-01
2025-04-13 12:52:27,188 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3921e+00, MaxNorm=2.5783e+00
2025-04-13 12:52:27,188 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1935e+00, MaxNorm=2.1475e+00
2025-04-13 12:52:27,188 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=9.7934e-02, MaxNorm=4.3522e-01
2025-04-13 12:52:27,188 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.1979e-01, MaxNorm=4.4541e-01
2025-04-13 12:52:27,188 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.5961e-01, MaxNorm=9.0997e-01
2025-04-13 12:52:27,188 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7708e+00, MaxNorm=3.2145e+00
2025-04-13 12:52:27,188 - INFO - --- End Gradient Check ---
2025-04-13 12:52:27,191 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:27,191 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1384, 3.1400]
2025-04-13 12:52:27,191 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7726, 2.9663]
2025-04-13 12:52:27,191 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,191 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,192 - INFO -   True actions shape: tensor([-1.2712, -1.1480, -0.2889,  0.7963,  0.1890, -0.2003,  0.9424],
       device='cuda:0'), range: [-3.1384, 3.1400]
2025-04-13 12:52:27,192 - INFO -   Noise shape: tensor([ 2.7417e-01,  8.9922e-01, -1.4817e-01,  4.8098e-01,  1.0514e+00,
         9.7672e-01,  3.1246e-04], device='cuda:0'), range: [-3.3202, 3.8789]
2025-04-13 12:52:27,193 - INFO -   Noisy actions shape: tensor([ 0.0695,  0.7062, -0.1920,  0.6010,  1.0681,  0.9327,  0.1495],
       device='cuda:0'), range: [-3.4609, 3.7014]
2025-04-13 12:52:27,235 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:27,235 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4680, 3.9423]
2025-04-13 12:52:27,235 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2120, 3.0739]
2025-04-13 12:52:27,235 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,235 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,236 - INFO -   True actions shape: tensor([ 0.1586,  0.6819,  1.2044, -1.1007, -0.4671, -0.5952, -1.0035],
       device='cuda:0'), range: [-3.4680, 3.9423]
2025-04-13 12:52:27,237 - INFO -   Noise shape: tensor([-2.7392,  1.4430,  1.7648, -1.2223, -0.3378, -1.4196, -0.2779],
       device='cuda:0'), range: [-3.8390, 3.7394]
2025-04-13 12:52:27,237 - INFO -   Noisy actions shape: tensor([-2.6982,  1.5166,  1.9009, -1.3496, -0.3932, -1.4826, -0.4005],
       device='cuda:0'), range: [-3.1913, 3.9581]
2025-04-13 12:52:27,281 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:27,281 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9801, 3.5507]
2025-04-13 12:52:27,282 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2112, 2.9644]
2025-04-13 12:52:27,282 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,282 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,283 - INFO -   True actions shape: tensor([-1.7246,  1.2746,  0.3858, -0.0454,  0.3423,  1.8769, -0.2661],
       device='cuda:0'), range: [-3.9801, 3.5507]
2025-04-13 12:52:27,283 - INFO -   Noise shape: tensor([-0.3668,  1.3404,  0.6630,  0.4760, -1.4748,  0.9448, -0.7354],
       device='cuda:0'), range: [-3.3766, 3.4797]
2025-04-13 12:52:27,284 - INFO -   Noisy actions shape: tensor([-1.7631,  1.5309,  0.5181,  0.0570,  0.0202,  2.0351, -0.4167],
       device='cuda:0'), range: [-3.7116, 3.7064]
2025-04-13 12:52:27,329 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:27,329 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4478, 3.8150]
2025-04-13 12:52:27,329 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1174, 3.1805]
2025-04-13 12:52:27,330 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,330 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,330 - INFO -   True actions shape: tensor([-1.3924, -0.5081,  0.2843,  2.1494,  0.2744,  0.8105, -2.3941],
       device='cuda:0'), range: [-3.4478, 3.8150]
2025-04-13 12:52:27,331 - INFO -   Noise shape: tensor([-0.7768, -1.6627,  1.0585, -0.0481,  0.7344, -1.2378, -0.7419],
       device='cuda:0'), range: [-3.3909, 4.0402]
2025-04-13 12:52:27,332 - INFO -   Noisy actions shape: tensor([-1.5897, -1.3426,  0.8221,  1.7645,  0.6346, -0.0090, -2.4051],
       device='cuda:0'), range: [-3.6675, 4.4828]
2025-04-13 12:52:27,376 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:27,377 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6376, 4.2574]
2025-04-13 12:52:27,377 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0214, 3.5350]
2025-04-13 12:52:27,377 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,377 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,378 - INFO -   True actions shape: tensor([ 0.0865,  0.3995, -1.4678,  0.2204,  2.5276, -0.8567,  0.4902],
       device='cuda:0'), range: [-3.6376, 4.2574]
2025-04-13 12:52:27,378 - INFO -   Noise shape: tensor([0.7936, 2.0234, 0.3302, 0.7282, 0.6829, 0.2261, 1.0770],
       device='cuda:0'), range: [-3.3851, 3.4184]
2025-04-13 12:52:27,379 - INFO -   Noisy actions shape: tensor([ 0.1091,  0.4571, -1.4578,  0.2411,  2.5460, -0.8499,  0.5207],
       device='cuda:0'), range: [-3.6223, 4.1801]
2025-04-13 12:52:27,421 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:27,421 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2927, 3.4756]
2025-04-13 12:52:27,422 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7119, 2.6459]
2025-04-13 12:52:27,422 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,422 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,422 - INFO -   True actions shape: tensor([-0.9081, -1.7661, -1.4085, -1.3057,  0.5938,  1.2449,  0.1669],
       device='cuda:0'), range: [-3.2927, 3.4756]
2025-04-13 12:52:27,423 - INFO -   Noise shape: tensor([-0.8592,  2.1469,  1.0908,  0.5258, -0.5456, -0.3766,  1.2785],
       device='cuda:0'), range: [-4.0877, 3.5049]
2025-04-13 12:52:27,424 - INFO -   Noisy actions shape: tensor([-0.9485, -1.6604, -1.3542, -1.2788,  0.5668,  1.2253,  0.2284],
       device='cuda:0'), range: [-3.6837, 3.0976]
2025-04-13 12:52:27,465 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:27,466 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5386, 3.4767]
2025-04-13 12:52:27,466 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3025, 3.9249]
2025-04-13 12:52:27,466 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,466 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,467 - INFO -   True actions shape: tensor([ 0.4871,  2.4124, -1.6392, -0.5262, -0.3609, -0.8922, -0.1389],
       device='cuda:0'), range: [-3.5386, 3.4767]
2025-04-13 12:52:27,467 - INFO -   Noise shape: tensor([ 0.5655, -0.0135,  0.3220, -0.1308,  0.2355,  0.5054,  1.0788],
       device='cuda:0'), range: [-3.3427, 3.1584]
2025-04-13 12:52:27,468 - INFO -   Noisy actions shape: tensor([ 0.7231,  1.9707, -1.1601, -0.5064, -0.1612, -0.4425,  0.5034],
       device='cuda:0'), range: [-3.2198, 3.3139]
2025-04-13 12:52:27,509 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:27,510 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3436, 4.2465]
2025-04-13 12:52:27,510 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0856, 2.7388]
2025-04-13 12:52:27,510 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,510 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,511 - INFO -   True actions shape: tensor([ 0.1410, -0.5100,  0.2308,  1.1567,  0.8618, -0.7909, -0.4010],
       device='cuda:0'), range: [-3.3436, 4.2465]
2025-04-13 12:52:27,511 - INFO -   Noise shape: tensor([-1.1140, -2.2846,  0.8317,  1.1023,  1.5278, -0.4873,  0.4769],
       device='cuda:0'), range: [-3.0727, 3.9158]
2025-04-13 12:52:27,512 - INFO -   Noisy actions shape: tensor([-0.8398, -2.1736,  0.8168,  1.5629,  1.7476, -0.8488,  0.1672],
       device='cuda:0'), range: [-3.0941, 3.3130]
2025-04-13 12:52:27,553 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:27,553 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0515, 3.3135]
2025-04-13 12:52:27,554 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0543, 2.8607]
2025-04-13 12:52:27,554 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,554 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,554 - INFO -   True actions shape: tensor([ 0.3202, -0.9024, -1.8852, -0.4918, -1.3842, -1.3720,  1.5831],
       device='cuda:0'), range: [-3.0515, 3.3135]
2025-04-13 12:52:27,555 - INFO -   Noise shape: tensor([-1.1935, -0.0899,  0.2142, -0.4289, -0.1852, -0.0490, -0.5073],
       device='cuda:0'), range: [-3.5075, 3.2882]
2025-04-13 12:52:27,556 - INFO -   Noisy actions shape: tensor([ 0.1490, -0.9060, -1.8363, -0.5473, -1.3965, -1.3653,  1.4959],
       device='cuda:0'), range: [-2.9815, 3.1639]
2025-04-13 12:52:27,598 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:27,598 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2926, 3.7072]
2025-04-13 12:52:27,598 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1046, 2.9683]
2025-04-13 12:52:27,598 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,598 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,599 - INFO -   True actions shape: tensor([-0.5285,  2.5603, -0.7803, -1.1069,  1.2490,  0.0099,  1.2253],
       device='cuda:0'), range: [-3.2926, 3.7072]
2025-04-13 12:52:27,599 - INFO -   Noise shape: tensor([-0.1480, -0.7642, -1.1474,  0.5395, -1.7700, -0.0672,  1.6389],
       device='cuda:0'), range: [-3.6351, 3.1586]
2025-04-13 12:52:27,600 - INFO -   Noisy actions shape: tensor([-0.4711,  1.2075, -1.3695, -0.3703, -0.4247, -0.0419,  2.0324],
       device='cuda:0'), range: [-3.2721, 3.3207]
2025-04-13 12:52:27,639 - INFO -   Loss components:
2025-04-13 12:52:27,639 - INFO -     Diffusion loss: 1.398442 (coef: 1.0)
2025-04-13 12:52:27,639 - INFO -     Grasp quality loss: 0.695636 (coef: 0.5)
2025-04-13 12:52:27,639 - INFO -     Grasp rotation loss: 0.586255 (coef: 0.5)
2025-04-13 12:52:27,639 - INFO -     Grasp width loss: 5.972489 (coef: 0.005)
2025-04-13 12:52:27,639 - INFO -     TOTAL loss: 2.069249
2025-04-13 12:52:27,647 - INFO -   Gradients: avg norm: 0.374902, max norm: 3.342590, non-zero params: 250
2025-04-13 12:52:27,647 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:52:27,650 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:27,650 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5236, 3.4521]
2025-04-13 12:52:27,650 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5861, 2.8628]
2025-04-13 12:52:27,650 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,650 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,651 - INFO -   True actions shape: tensor([ 1.3042,  1.0532,  0.5683, -0.0100, -1.1155, -0.8827,  0.3296],
       device='cuda:0'), range: [-3.5236, 3.4521]
2025-04-13 12:52:27,651 - INFO -   Noise shape: tensor([-0.1380, -0.6995, -1.0733,  0.4924,  1.6858,  0.3243, -0.9807],
       device='cuda:0'), range: [-3.4752, 3.2648]
2025-04-13 12:52:27,652 - INFO -   Noisy actions shape: tensor([ 1.2422,  0.8743,  0.3192,  0.0982, -0.7189, -0.7901,  0.1066],
       device='cuda:0'), range: [-3.5912, 3.0978]
2025-04-13 12:52:27,695 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:27,695 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9863, 3.0278]
2025-04-13 12:52:27,695 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8424, 3.6171]
2025-04-13 12:52:27,695 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,695 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,696 - INFO -   True actions shape: tensor([-0.1070,  1.1413, -1.1480, -1.6221, -0.4321,  1.0633, -0.4733],
       device='cuda:0'), range: [-3.9863, 3.0278]
2025-04-13 12:52:27,697 - INFO -   Noise shape: tensor([-1.2279, -0.8728, -0.2018, -0.0853,  0.3411,  0.0333, -1.2810],
       device='cuda:0'), range: [-3.3350, 3.5570]
2025-04-13 12:52:27,697 - INFO -   Noisy actions shape: tensor([-1.0886, -0.1117, -0.7937, -0.9538,  0.0512,  0.6062, -1.3324],
       device='cuda:0'), range: [-4.0150, 3.2536]
2025-04-13 12:52:27,739 - INFO - 
=== Epoch 13 Summary ===
2025-04-13 12:52:27,739 - INFO -   Avg total loss: 2.294333
2025-04-13 12:52:27,739 - INFO -   Avg diffusion loss: 1.625686
2025-04-13 12:52:27,739 - INFO -   Avg grasp loss: 1.337295
2025-04-13 12:52:27,739 - INFO - 
=== EPOCH 14/20 ===
2025-04-13 12:52:27,740 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:27,743 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:27,743 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5313, 3.3048]
2025-04-13 12:52:27,743 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8848, 2.8889]
2025-04-13 12:52:27,744 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,744 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,744 - INFO -   True actions shape: tensor([-1.0662,  1.2770,  1.7094, -0.1156,  0.9360, -0.0501, -0.7416],
       device='cuda:0'), range: [-3.5313, 3.3048]
2025-04-13 12:52:27,745 - INFO -   Noise shape: tensor([-1.2723,  1.6864,  0.4714,  0.2161,  0.7542, -0.0241,  1.4527],
       device='cuda:0'), range: [-4.0382, 2.9895]
2025-04-13 12:52:27,746 - INFO -   Noisy actions shape: tensor([-1.6058,  2.0172,  1.6670,  0.0308,  1.1998, -0.0548,  0.2356],
       device='cuda:0'), range: [-3.8086, 3.1149]
2025-04-13 12:52:27,746 - INFO -   Diffusion: timestep range [327, 872], noise range [-4.0382, 2.9895]
2025-04-13 12:52:27,746 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8086, 3.1149]
2025-04-13 12:52:27,766 - INFO -   Model output shapes:
2025-04-13 12:52:27,766 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:27,766 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4534, 0.5543]
2025-04-13 12:52:27,766 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6485
2025-04-13 12:52:27,766 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1257, 0.2018]
2025-04-13 12:52:27,788 - INFO -   Loss components:
2025-04-13 12:52:27,788 - INFO -     Diffusion loss: 1.220317 (coef: 1.0)
2025-04-13 12:52:27,788 - INFO -     Grasp quality loss: 0.692527 (coef: 0.5)
2025-04-13 12:52:27,788 - INFO -     Grasp rotation loss: 0.587285 (coef: 0.5)
2025-04-13 12:52:27,788 - INFO -     Grasp width loss: 6.864042 (coef: 0.005)
2025-04-13 12:52:27,788 - INFO -     TOTAL loss: 1.894543
2025-04-13 12:52:27,796 - INFO -   Gradients: avg norm: 0.310985, max norm: 2.483446, non-zero params: 250
2025-04-13 12:52:27,797 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:52:27,797 - INFO - --- Gradient Check @ Epoch 14, Batch 0 ---
2025-04-13 12:52:27,815 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:27,815 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:27,815 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=5.0541e-01, MaxNorm=1.9721e+00
2025-04-13 12:52:27,816 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.0689e-02, MaxNorm=2.1106e-02
2025-04-13 12:52:27,816 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.2682e-03, MaxNorm=2.8689e-02
2025-04-13 12:52:27,816 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=7.5678e-02, MaxNorm=1.9240e-01
2025-04-13 12:52:27,816 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.1316e+00, MaxNorm=2.1548e+00
2025-04-13 12:52:27,816 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.4008e-01, MaxNorm=1.6717e+00
2025-04-13 12:52:27,816 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=7.0927e-02, MaxNorm=3.2203e-01
2025-04-13 12:52:27,816 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.6731e-01, MaxNorm=2.9148e-01
2025-04-13 12:52:27,816 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.4530e-01, MaxNorm=6.6919e-01
2025-04-13 12:52:27,816 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3701e+00, MaxNorm=2.4834e+00
2025-04-13 12:52:27,816 - INFO - --- End Gradient Check ---
2025-04-13 12:52:27,819 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:27,819 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.8863, 3.8424]
2025-04-13 12:52:27,819 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1358, 3.2512]
2025-04-13 12:52:27,819 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,819 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,820 - INFO -   True actions shape: tensor([-0.7062, -1.4470,  0.1619,  0.2669,  0.3819,  0.8132, -1.2716],
       device='cuda:0'), range: [-2.8863, 3.8424]
2025-04-13 12:52:27,820 - INFO -   Noise shape: tensor([ 0.8363,  1.6893, -1.7795,  1.1371,  2.4270, -0.3029, -1.3454],
       device='cuda:0'), range: [-2.9263, 3.3797]
2025-04-13 12:52:27,821 - INFO -   Noisy actions shape: tensor([-0.2187, -0.4598, -0.7112,  0.7795,  1.4988,  0.5684, -1.7610],
       device='cuda:0'), range: [-3.1345, 3.4236]
2025-04-13 12:52:27,865 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:27,865 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2409, 3.5979]
2025-04-13 12:52:27,865 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1714, 3.0011]
2025-04-13 12:52:27,865 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,865 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,867 - INFO -   True actions shape: tensor([-2.4844, -1.6788,  0.3234, -0.9985, -0.5588,  1.2561,  0.4675],
       device='cuda:0'), range: [-3.2409, 3.5979]
2025-04-13 12:52:27,867 - INFO -   Noise shape: tensor([-0.2530, -1.0536,  0.1965, -0.2337,  0.0784, -0.0640,  0.2365],
       device='cuda:0'), range: [-3.1375, 3.6458]
2025-04-13 12:52:27,868 - INFO -   Noisy actions shape: tensor([-1.1536, -1.5997,  0.3022, -0.5863, -0.1337,  0.4050,  0.3926],
       device='cuda:0'), range: [-3.2521, 3.5572]
2025-04-13 12:52:27,924 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:27,925 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1897, 3.3208]
2025-04-13 12:52:27,925 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3891, 3.0816]
2025-04-13 12:52:27,925 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,925 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,926 - INFO -   True actions shape: tensor([-1.1242, -0.9509,  0.4396, -0.2023,  0.5764,  0.6363,  0.6081],
       device='cuda:0'), range: [-3.1897, 3.3208]
2025-04-13 12:52:27,927 - INFO -   Noise shape: tensor([ 0.1564, -0.6814, -0.2916,  0.5162,  2.4115,  1.7003, -0.7909],
       device='cuda:0'), range: [-3.2158, 3.3987]
2025-04-13 12:52:27,927 - INFO -   Noisy actions shape: tensor([-0.8607, -1.1684,  0.2119,  0.1092,  1.7896,  1.4552,  0.0834],
       device='cuda:0'), range: [-3.0223, 3.5888]
2025-04-13 12:52:27,975 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:27,975 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3962, 3.5150]
2025-04-13 12:52:27,975 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5206, 3.5056]
2025-04-13 12:52:27,975 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:27,975 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:27,976 - INFO -   True actions shape: tensor([ 0.2261,  0.2389, -0.9792,  0.5415, -0.7755,  0.8063, -1.3166],
       device='cuda:0'), range: [-3.3962, 3.5150]
2025-04-13 12:52:27,977 - INFO -   Noise shape: tensor([-0.2366, -0.8724, -2.4141, -0.7081,  0.3307,  0.0468,  0.2140],
       device='cuda:0'), range: [-4.0367, 3.5299]
2025-04-13 12:52:27,977 - INFO -   Noisy actions shape: tensor([-0.1278, -0.7067, -2.6045, -0.4361, -0.0031,  0.3620, -0.3244],
       device='cuda:0'), range: [-4.2333, 3.4909]
2025-04-13 12:52:28,022 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:28,022 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9091, 3.3063]
2025-04-13 12:52:28,022 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8174, 3.3546]
2025-04-13 12:52:28,022 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,023 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,023 - INFO -   True actions shape: tensor([ 0.0634,  1.2886, -0.3248,  0.7730,  0.3977, -1.8049,  0.2123],
       device='cuda:0'), range: [-3.9091, 3.3063]
2025-04-13 12:52:28,024 - INFO -   Noise shape: tensor([-0.2941, -0.3874, -0.0487,  0.0960, -0.0545, -0.4246,  0.4233],
       device='cuda:0'), range: [-4.1627, 3.2493]
2025-04-13 12:52:28,025 - INFO -   Noisy actions shape: tensor([-0.1853,  0.5278, -0.2455,  0.5688,  0.2128, -1.4820,  0.4611],
       device='cuda:0'), range: [-4.3911, 3.9324]
2025-04-13 12:52:28,069 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:28,069 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4749, 3.4364]
2025-04-13 12:52:28,069 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8549, 3.1541]
2025-04-13 12:52:28,069 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,069 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,070 - INFO -   True actions shape: tensor([ 1.4395,  0.0574,  1.2510, -0.8878,  0.1129, -1.0357,  1.5975],
       device='cuda:0'), range: [-3.4749, 3.4364]
2025-04-13 12:52:28,071 - INFO -   Noise shape: tensor([-0.3992, -0.0218, -0.4255, -0.4394,  0.2491, -1.1624,  0.2945],
       device='cuda:0'), range: [-3.5683, 3.3923]
2025-04-13 12:52:28,071 - INFO -   Noisy actions shape: tensor([ 0.0033, -0.0055, -0.0728, -0.6622,  0.2703, -1.3985,  0.7140],
       device='cuda:0'), range: [-3.3871, 4.1411]
2025-04-13 12:52:28,115 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:28,115 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8857, 3.6955]
2025-04-13 12:52:28,115 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8942, 2.6790]
2025-04-13 12:52:28,116 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,116 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,117 - INFO -   True actions shape: tensor([ 2.2074,  0.1401, -1.6587,  0.5870, -0.6744, -1.2965,  1.5649],
       device='cuda:0'), range: [-3.8857, 3.6955]
2025-04-13 12:52:28,117 - INFO -   Noise shape: tensor([ 0.3985,  1.0279, -0.8731, -0.3760, -1.7804, -0.3641,  1.9662],
       device='cuda:0'), range: [-3.6790, 3.3988]
2025-04-13 12:52:28,118 - INFO -   Noisy actions shape: tensor([ 1.7464,  0.8687, -1.7459,  0.1001, -1.7873, -1.1241,  2.5107],
       device='cuda:0'), range: [-3.6607, 4.0402]
2025-04-13 12:52:28,163 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:28,163 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9167, 3.1321]
2025-04-13 12:52:28,163 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3060, 2.6651]
2025-04-13 12:52:28,163 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,163 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,164 - INFO -   True actions shape: tensor([ 1.6029,  0.4741,  2.4268,  0.5845,  0.4546, -0.8637,  0.6260],
       device='cuda:0'), range: [-3.9167, 3.1321]
2025-04-13 12:52:28,164 - INFO -   Noise shape: tensor([ 0.9173, -0.2961,  1.4479, -0.0312,  0.2862, -1.1880,  1.3929],
       device='cuda:0'), range: [-3.4848, 3.4824]
2025-04-13 12:52:28,165 - INFO -   Noisy actions shape: tensor([ 1.7535,  0.4056,  2.6667,  0.5665,  0.5025, -1.0831,  0.8911],
       device='cuda:0'), range: [-3.8153, 3.1342]
2025-04-13 12:52:28,211 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:28,211 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3429, 3.2839]
2025-04-13 12:52:28,211 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1210, 3.0823]
2025-04-13 12:52:28,211 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,211 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,212 - INFO -   True actions shape: tensor([ 0.0426, -1.1791, -1.1512, -0.3972, -0.7927, -0.5434,  0.3769],
       device='cuda:0'), range: [-4.3429, 3.2839]
2025-04-13 12:52:28,212 - INFO -   Noise shape: tensor([ 1.2503, -0.1625,  2.6899,  2.3982, -0.3976, -0.6544, -1.3866],
       device='cuda:0'), range: [-4.3354, 3.2618]
2025-04-13 12:52:28,213 - INFO -   Noisy actions shape: tensor([ 0.7705, -1.0488,  0.6530,  1.0908, -0.8748, -0.8245, -0.5116],
       device='cuda:0'), range: [-4.4130, 3.4291]
2025-04-13 12:52:28,255 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:28,256 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7904, 3.7543]
2025-04-13 12:52:28,256 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4254, 3.5068]
2025-04-13 12:52:28,256 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,256 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,257 - INFO -   True actions shape: tensor([-0.4350,  1.0832, -0.0922,  1.1583,  0.6501,  1.0803,  0.6225],
       device='cuda:0'), range: [-3.7904, 3.7543]
2025-04-13 12:52:28,257 - INFO -   Noise shape: tensor([ 0.1390,  1.3737, -0.1371, -1.1715, -0.3810, -0.2502,  0.5258],
       device='cuda:0'), range: [-3.4884, 3.0537]
2025-04-13 12:52:28,258 - INFO -   Noisy actions shape: tensor([ 0.0719,  1.5211, -0.1494, -0.9837, -0.2788, -0.0847,  0.6136],
       device='cuda:0'), range: [-4.4164, 3.1281]
2025-04-13 12:52:28,297 - INFO -   Loss components:
2025-04-13 12:52:28,297 - INFO -     Diffusion loss: 1.440667 (coef: 1.0)
2025-04-13 12:52:28,297 - INFO -     Grasp quality loss: 0.696071 (coef: 0.5)
2025-04-13 12:52:28,297 - INFO -     Grasp rotation loss: 0.563369 (coef: 0.5)
2025-04-13 12:52:28,297 - INFO -     Grasp width loss: 6.538230 (coef: 0.005)
2025-04-13 12:52:28,297 - INFO -     TOTAL loss: 2.103078
2025-04-13 12:52:28,305 - INFO -   Gradients: avg norm: 0.288385, max norm: 2.408172, non-zero params: 250
2025-04-13 12:52:28,305 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:52:28,308 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:28,308 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4816, 3.2983]
2025-04-13 12:52:28,308 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2705, 2.9738]
2025-04-13 12:52:28,308 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,308 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,309 - INFO -   True actions shape: tensor([ 0.4758, -0.5400, -0.9632, -1.7863,  1.7540,  0.8717,  0.6365],
       device='cuda:0'), range: [-3.4816, 3.2983]
2025-04-13 12:52:28,309 - INFO -   Noise shape: tensor([-1.0284,  0.0410, -0.1646, -0.9601,  0.5287, -0.6208, -0.7293],
       device='cuda:0'), range: [-3.2446, 4.0005]
2025-04-13 12:52:28,310 - INFO -   Noisy actions shape: tensor([-0.7283, -0.1926, -0.5588, -1.6289,  1.2247, -0.1909, -0.3892],
       device='cuda:0'), range: [-3.3321, 3.2636]
2025-04-13 12:52:28,352 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:28,352 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3737, 3.1803]
2025-04-13 12:52:28,352 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6624, 2.9090]
2025-04-13 12:52:28,352 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,352 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,353 - INFO -   True actions shape: tensor([ 2.4332, -1.2664, -1.0473,  0.0996,  0.6411, -1.4167,  0.0355],
       device='cuda:0'), range: [-3.3737, 3.1803]
2025-04-13 12:52:28,353 - INFO -   Noise shape: tensor([-1.3240, -0.1566,  0.9723, -1.1521, -0.0951,  1.1627, -1.5495],
       device='cuda:0'), range: [-3.5025, 2.7788]
2025-04-13 12:52:28,354 - INFO -   Noisy actions shape: tensor([ 0.7721, -1.0026, -0.0464, -0.7483,  0.3836, -0.1712, -1.0757],
       device='cuda:0'), range: [-3.5025, 2.9593]
2025-04-13 12:52:28,394 - INFO - 
=== Epoch 14 Summary ===
2025-04-13 12:52:28,394 - INFO -   Avg total loss: 2.171826
2025-04-13 12:52:28,394 - INFO -   Avg diffusion loss: 1.502420
2025-04-13 12:52:28,394 - INFO -   Avg grasp loss: 1.338812
2025-04-13 12:52:28,394 - INFO - 
=== EPOCH 15/20 ===
2025-04-13 12:52:28,395 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:28,397 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:28,398 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3759, 3.4512]
2025-04-13 12:52:28,398 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8029, 3.3655]
2025-04-13 12:52:28,398 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,398 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,399 - INFO -   True actions shape: tensor([ 0.9781, -0.1744,  1.8328, -0.0736, -0.6797, -1.0647,  0.0418],
       device='cuda:0'), range: [-3.3759, 3.4512]
2025-04-13 12:52:28,399 - INFO -   Noise shape: tensor([-1.6003, -0.2430, -0.2373, -0.3625,  0.6770,  0.7737, -0.2835],
       device='cuda:0'), range: [-3.7087, 3.3416]
2025-04-13 12:52:28,400 - INFO -   Noisy actions shape: tensor([-1.2756, -0.2811,  0.2680, -0.3689,  0.4676,  0.4564, -0.2616],
       device='cuda:0'), range: [-4.1682, 3.1810]
2025-04-13 12:52:28,400 - INFO -   Diffusion: timestep range [168, 823], noise range [-3.7087, 3.3416]
2025-04-13 12:52:28,400 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.1682, 3.1810]
2025-04-13 12:52:28,419 - INFO -   Model output shapes:
2025-04-13 12:52:28,419 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:28,419 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4552, 0.5575]
2025-04-13 12:52:28,419 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5743
2025-04-13 12:52:28,419 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1782, 0.2078]
2025-04-13 12:52:28,440 - INFO -   Loss components:
2025-04-13 12:52:28,440 - INFO -     Diffusion loss: 1.418777 (coef: 1.0)
2025-04-13 12:52:28,440 - INFO -     Grasp quality loss: 0.694889 (coef: 0.5)
2025-04-13 12:52:28,440 - INFO -     Grasp rotation loss: 0.583767 (coef: 0.5)
2025-04-13 12:52:28,441 - INFO -     Grasp width loss: 5.937675 (coef: 0.005)
2025-04-13 12:52:28,441 - INFO -     TOTAL loss: 2.087793
2025-04-13 12:52:28,449 - INFO -   Gradients: avg norm: 0.335007, max norm: 2.736855, non-zero params: 250
2025-04-13 12:52:28,449 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:52:28,449 - INFO - --- Gradient Check @ Epoch 15, Batch 0 ---
2025-04-13 12:52:28,467 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:28,468 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:28,468 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=5.5398e-01, MaxNorm=2.1819e+00
2025-04-13 12:52:28,468 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.2209e-02, MaxNorm=2.8038e-02
2025-04-13 12:52:28,468 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0330e-02, MaxNorm=2.5531e-02
2025-04-13 12:52:28,468 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.8265e-02, MaxNorm=1.2862e-01
2025-04-13 12:52:28,468 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2722e+00, MaxNorm=2.4085e+00
2025-04-13 12:52:28,468 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.8735e-01, MaxNorm=1.8622e+00
2025-04-13 12:52:28,468 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=7.2989e-02, MaxNorm=3.3678e-01
2025-04-13 12:52:28,468 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.9195e-01, MaxNorm=2.4761e-01
2025-04-13 12:52:28,468 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=7.1277e-01, MaxNorm=7.2462e-01
2025-04-13 12:52:28,468 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4986e+00, MaxNorm=2.7369e+00
2025-04-13 12:52:28,468 - INFO - --- End Gradient Check ---
2025-04-13 12:52:28,472 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:28,472 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8777, 2.8775]
2025-04-13 12:52:28,472 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0950, 3.2048]
2025-04-13 12:52:28,472 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,472 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,474 - INFO -   True actions shape: tensor([ 1.1431,  0.0169,  0.6891, -1.4702, -1.2247, -0.6205,  0.5358],
       device='cuda:0'), range: [-3.8777, 2.8775]
2025-04-13 12:52:28,474 - INFO -   Noise shape: tensor([-1.4666, -1.1724, -0.7986, -0.4408, -1.1257,  0.2907,  1.0136],
       device='cuda:0'), range: [-3.6936, 3.2749]
2025-04-13 12:52:28,475 - INFO -   Noisy actions shape: tensor([-0.9023, -1.0723, -0.4652, -0.9810, -1.5152,  0.0247,  1.1425],
       device='cuda:0'), range: [-3.2322, 3.1906]
2025-04-13 12:52:28,521 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:28,521 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8513, 3.7578]
2025-04-13 12:52:28,521 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9705, 3.0437]
2025-04-13 12:52:28,522 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,522 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,522 - INFO -   True actions shape: tensor([-2.2398,  0.6424, -0.3330, -0.0340, -0.9993, -0.9907,  0.3120],
       device='cuda:0'), range: [-3.8513, 3.7578]
2025-04-13 12:52:28,523 - INFO -   Noise shape: tensor([-0.6849,  0.8935,  1.0442, -1.2190, -1.6593, -1.1912,  0.0613],
       device='cuda:0'), range: [-3.8157, 4.1271]
2025-04-13 12:52:28,524 - INFO -   Noisy actions shape: tensor([-2.0200,  1.0925,  0.5433, -0.9204, -1.8979, -1.5474,  0.2563],
       device='cuda:0'), range: [-3.4242, 3.9212]
2025-04-13 12:52:28,569 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:28,570 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3011, 3.7991]
2025-04-13 12:52:28,570 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1102, 3.2494]
2025-04-13 12:52:28,570 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,570 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,571 - INFO -   True actions shape: tensor([ 0.2138,  0.0817, -0.0683, -1.5119,  0.9771, -0.2873, -0.0930],
       device='cuda:0'), range: [-3.3011, 3.7991]
2025-04-13 12:52:28,571 - INFO -   Noise shape: tensor([-0.8477, -0.7772,  1.5942,  0.3841,  1.2244,  0.3675,  0.0285],
       device='cuda:0'), range: [-3.3720, 3.3937]
2025-04-13 12:52:28,572 - INFO -   Noisy actions shape: tensor([ 0.1372,  0.0119,  0.0745, -1.4715,  1.0827, -0.2533, -0.0901],
       device='cuda:0'), range: [-3.3301, 2.8710]
2025-04-13 12:52:28,615 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:28,615 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4378, 3.6660]
2025-04-13 12:52:28,615 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3653, 3.2957]
2025-04-13 12:52:28,615 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,615 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,616 - INFO -   True actions shape: tensor([ 0.0692,  1.4747,  0.2776,  0.4918, -0.2211,  0.2121,  1.2754],
       device='cuda:0'), range: [-3.4378, 3.6660]
2025-04-13 12:52:28,617 - INFO -   Noise shape: tensor([0.1298, 0.6620, 1.3128, 0.1203, 1.7616, 0.3028, 0.4784],
       device='cuda:0'), range: [-3.4288, 3.4938]
2025-04-13 12:52:28,617 - INFO -   Noisy actions shape: tensor([ 0.0718,  1.4875,  0.3035,  0.4941, -0.1862,  0.2180,  1.2846],
       device='cuda:0'), range: [-3.3451, 3.4835]
2025-04-13 12:52:28,660 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:28,660 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6042, 3.5883]
2025-04-13 12:52:28,660 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5897, 3.4194]
2025-04-13 12:52:28,660 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,660 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,661 - INFO -   True actions shape: tensor([-0.4513,  1.1419,  1.6299, -1.1176,  1.2218, -0.0959, -0.0430],
       device='cuda:0'), range: [-3.6042, 3.5883]
2025-04-13 12:52:28,661 - INFO -   Noise shape: tensor([-0.1341, -0.7037, -1.6395,  1.1690,  0.0968, -0.3630, -0.0508],
       device='cuda:0'), range: [-3.9890, 3.2855]
2025-04-13 12:52:28,662 - INFO -   Noisy actions shape: tensor([-0.4207,  0.3505,  0.0654, -0.0142,  0.9568, -0.3185, -0.0662],
       device='cuda:0'), range: [-3.4172, 3.1838]
2025-04-13 12:52:28,704 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:28,704 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.6666, 3.0483]
2025-04-13 12:52:28,704 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1790, 3.6919]
2025-04-13 12:52:28,704 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,704 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,705 - INFO -   True actions shape: tensor([-0.0076, -0.3023,  0.8151, -0.2446,  0.6564, -1.2406,  0.5602],
       device='cuda:0'), range: [-4.6666, 3.0483]
2025-04-13 12:52:28,706 - INFO -   Noise shape: tensor([ 0.9051, -0.7835,  2.4376, -1.3150,  0.0568, -1.5997,  1.8074],
       device='cuda:0'), range: [-3.2084, 3.8231]
2025-04-13 12:52:28,706 - INFO -   Noisy actions shape: tensor([ 0.9041, -0.7946,  2.4675, -1.3235,  0.0823, -1.6468,  1.8278],
       device='cuda:0'), range: [-4.3231, 3.3572]
2025-04-13 12:52:28,748 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:28,748 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7054, 3.7046]
2025-04-13 12:52:28,748 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2535, 3.3711]
2025-04-13 12:52:28,748 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,748 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,750 - INFO -   True actions shape: tensor([ 1.9582,  0.0407,  0.9704,  2.9482, -0.0254,  0.4501,  0.3648],
       device='cuda:0'), range: [-3.7054, 3.7046]
2025-04-13 12:52:28,750 - INFO -   Noise shape: tensor([-0.9021, -0.6986,  1.2869,  0.1138, -0.9478, -0.2800,  0.1369],
       device='cuda:0'), range: [-3.3339, 3.4374]
2025-04-13 12:52:28,751 - INFO -   Noisy actions shape: tensor([ 0.4141, -0.5427,  1.6114,  1.8171, -0.7835,  0.0362,  0.3245],
       device='cuda:0'), range: [-3.3340, 3.0422]
2025-04-13 12:52:28,794 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:28,794 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2920, 3.4654]
2025-04-13 12:52:28,794 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4222, 2.9525]
2025-04-13 12:52:28,795 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,795 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,795 - INFO -   True actions shape: tensor([ 0.0097,  0.6167, -2.1884, -0.1231, -0.5129, -0.3550,  0.1020],
       device='cuda:0'), range: [-3.2920, 3.4654]
2025-04-13 12:52:28,796 - INFO -   Noise shape: tensor([-0.6916, -0.3507, -0.3445,  0.1826, -0.3937, -0.1053, -0.9441],
       device='cuda:0'), range: [-3.1495, 3.4871]
2025-04-13 12:52:28,796 - INFO -   Noisy actions shape: tensor([-0.2971,  0.3981, -2.1152, -0.0297, -0.6341, -0.3650, -0.3259],
       device='cuda:0'), range: [-3.2839, 3.0292]
2025-04-13 12:52:28,839 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:28,839 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2602, 3.3253]
2025-04-13 12:52:28,839 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2647, 4.5474]
2025-04-13 12:52:28,839 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,839 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,840 - INFO -   True actions shape: tensor([-1.2877,  0.0844, -0.3304, -1.2633,  1.8534, -0.8776,  3.0281],
       device='cuda:0'), range: [-4.2602, 3.3253]
2025-04-13 12:52:28,840 - INFO -   Noise shape: tensor([ 0.2268,  1.5536, -0.6259, -0.1904,  0.7522, -0.1887,  0.2882],
       device='cuda:0'), range: [-3.3924, 4.0515]
2025-04-13 12:52:28,841 - INFO -   Noisy actions shape: tensor([-0.7028,  1.2023, -0.6847, -0.9939,  1.8068, -0.7320,  2.2584],
       device='cuda:0'), range: [-3.1382, 4.1777]
2025-04-13 12:52:28,883 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:28,883 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2612, 3.5629]
2025-04-13 12:52:28,883 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9653, 3.1319]
2025-04-13 12:52:28,883 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,883 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,884 - INFO -   True actions shape: tensor([-1.5936,  0.3539, -1.3338,  0.0646,  0.3321, -0.5810, -1.1752],
       device='cuda:0'), range: [-3.2612, 3.5629]
2025-04-13 12:52:28,884 - INFO -   Noise shape: tensor([-0.8408, -0.3025, -0.8470,  0.2917,  1.4562, -0.1444, -1.0609],
       device='cuda:0'), range: [-3.5064, 3.7801]
2025-04-13 12:52:28,885 - INFO -   Noisy actions shape: tensor([-1.7751,  0.2435, -1.5297,  0.1513,  0.7643, -0.5972, -1.4447],
       device='cuda:0'), range: [-3.4912, 3.4210]
2025-04-13 12:52:28,924 - INFO -   Loss components:
2025-04-13 12:52:28,924 - INFO -     Diffusion loss: 1.554351 (coef: 1.0)
2025-04-13 12:52:28,924 - INFO -     Grasp quality loss: 0.691649 (coef: 0.5)
2025-04-13 12:52:28,924 - INFO -     Grasp rotation loss: 0.586276 (coef: 0.5)
2025-04-13 12:52:28,924 - INFO -     Grasp width loss: 5.274664 (coef: 0.005)
2025-04-13 12:52:28,924 - INFO -     TOTAL loss: 2.219686
2025-04-13 12:52:28,932 - INFO -   Gradients: avg norm: 0.339376, max norm: 2.695700, non-zero params: 250
2025-04-13 12:52:28,932 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:52:28,935 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:28,935 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0482, 3.5867]
2025-04-13 12:52:28,935 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8683, 3.0658]
2025-04-13 12:52:28,935 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,935 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,936 - INFO -   True actions shape: tensor([-1.7646,  0.1745, -0.9750, -1.2418, -1.1941,  0.9336, -0.5735],
       device='cuda:0'), range: [-3.0482, 3.5867]
2025-04-13 12:52:28,937 - INFO -   Noise shape: tensor([ 2.0379,  1.7367, -0.0578, -1.3219,  0.4243, -0.1631,  1.0115],
       device='cuda:0'), range: [-3.4675, 3.5324]
2025-04-13 12:52:28,937 - INFO -   Noisy actions shape: tensor([ 0.5053,  1.4709, -0.6498, -1.8070, -0.4073,  0.4507,  0.4382],
       device='cuda:0'), range: [-3.5782, 3.4789]
2025-04-13 12:52:28,979 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:28,980 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5751, 3.7311]
2025-04-13 12:52:28,980 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5095, 3.4078]
2025-04-13 12:52:28,980 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:28,980 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:28,981 - INFO -   True actions shape: tensor([ 1.5086, -0.3618, -0.1768,  0.8180,  1.3599, -1.5745,  0.9831],
       device='cuda:0'), range: [-3.5751, 3.7311]
2025-04-13 12:52:28,981 - INFO -   Noise shape: tensor([-1.0235,  0.3714,  1.1515, -0.5628, -1.3751, -0.4965,  1.3055],
       device='cuda:0'), range: [-3.8854, 3.8757]
2025-04-13 12:52:28,982 - INFO -   Noisy actions shape: tensor([ 0.0781,  0.0824,  0.8189,  0.0361, -0.2928, -1.3375,  1.6342],
       device='cuda:0'), range: [-4.0176, 3.5975]
2025-04-13 12:52:29,022 - INFO - 
=== Epoch 15 Summary ===
2025-04-13 12:52:29,022 - INFO -   Avg total loss: 2.172224
2025-04-13 12:52:29,022 - INFO -   Avg diffusion loss: 1.510481
2025-04-13 12:52:29,022 - INFO -   Avg grasp loss: 1.323486
2025-04-13 12:52:29,201 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125218/ckpt_epoch_15.pth
2025-04-13 12:52:29,202 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:52:29,202 - INFO - 
=== EPOCH 16/20 ===
2025-04-13 12:52:29,203 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:29,206 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:29,206 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1855, 2.9245]
2025-04-13 12:52:29,206 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0456, 3.2491]
2025-04-13 12:52:29,206 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,206 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,207 - INFO -   True actions shape: tensor([-0.3716,  0.0779,  0.1925, -0.9796,  0.5279,  0.2519,  1.6655],
       device='cuda:0'), range: [-3.1855, 2.9245]
2025-04-13 12:52:29,208 - INFO -   Noise shape: tensor([ 0.9008, -0.3093, -0.3258,  0.9588,  0.4088, -0.1323,  0.2970],
       device='cuda:0'), range: [-3.4637, 3.1620]
2025-04-13 12:52:29,208 - INFO -   Noisy actions shape: tensor([-0.0428, -0.0320,  0.0701, -0.5948,  0.6355,  0.1918,  1.6671],
       device='cuda:0'), range: [-3.6814, 3.3797]
2025-04-13 12:52:29,208 - INFO -   Diffusion: timestep range [214, 895], noise range [-3.4637, 3.1620]
2025-04-13 12:52:29,209 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6814, 3.3797]
2025-04-13 12:52:29,227 - INFO -   Model output shapes:
2025-04-13 12:52:29,227 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:29,228 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4349, 0.5526]
2025-04-13 12:52:29,228 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6083
2025-04-13 12:52:29,228 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1147, 0.1910]
2025-04-13 12:52:29,249 - INFO -   Loss components:
2025-04-13 12:52:29,249 - INFO -     Diffusion loss: 1.234719 (coef: 1.0)
2025-04-13 12:52:29,249 - INFO -     Grasp quality loss: 0.696222 (coef: 0.5)
2025-04-13 12:52:29,249 - INFO -     Grasp rotation loss: 0.581334 (coef: 0.5)
2025-04-13 12:52:29,249 - INFO -     Grasp width loss: 5.309519 (coef: 0.005)
2025-04-13 12:52:29,249 - INFO -     TOTAL loss: 1.900045
2025-04-13 12:52:29,258 - INFO -   Gradients: avg norm: 0.316980, max norm: 2.567487, non-zero params: 250
2025-04-13 12:52:29,258 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:52:29,258 - INFO - --- Gradient Check @ Epoch 16, Batch 0 ---
2025-04-13 12:52:29,275 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:29,275 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:29,275 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=5.1336e-01, MaxNorm=2.0510e+00
2025-04-13 12:52:29,275 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.4186e-02, MaxNorm=2.9648e-02
2025-04-13 12:52:29,275 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.2874e-02, MaxNorm=3.6596e-02
2025-04-13 12:52:29,275 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=6.2292e-02, MaxNorm=2.1543e-01
2025-04-13 12:52:29,275 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2365e+00, MaxNorm=2.3338e+00
2025-04-13 12:52:29,275 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.9999e-01, MaxNorm=1.7981e+00
2025-04-13 12:52:29,275 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=6.9334e-02, MaxNorm=3.2379e-01
2025-04-13 12:52:29,275 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.3920e-01, MaxNorm=2.6712e-01
2025-04-13 12:52:29,275 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.8633e-01, MaxNorm=7.0776e-01
2025-04-13 12:52:29,275 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4179e+00, MaxNorm=2.5675e+00
2025-04-13 12:52:29,275 - INFO - --- End Gradient Check ---
2025-04-13 12:52:29,278 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:29,278 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2697, 3.3763]
2025-04-13 12:52:29,278 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5226, 3.0199]
2025-04-13 12:52:29,278 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,278 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,279 - INFO -   True actions shape: tensor([ 0.9690, -0.4903, -0.7131, -1.0937, -0.8800,  0.2389,  0.5984],
       device='cuda:0'), range: [-3.2697, 3.3763]
2025-04-13 12:52:29,280 - INFO -   Noise shape: tensor([-0.4604,  1.4283, -0.7802,  0.3162, -0.1519,  0.3950, -1.2779],
       device='cuda:0'), range: [-3.9547, 2.9168]
2025-04-13 12:52:29,280 - INFO -   Noisy actions shape: tensor([-0.0729,  1.1488, -0.9874, -0.1071, -0.4641,  0.4551, -0.9693],
       device='cuda:0'), range: [-3.2955, 3.2151]
2025-04-13 12:52:29,322 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:29,322 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0143, 3.9885]
2025-04-13 12:52:29,322 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6130, 3.1745]
2025-04-13 12:52:29,322 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,322 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,323 - INFO -   True actions shape: tensor([-0.0453,  0.2727,  0.8093,  0.9175,  0.6376,  0.2331,  0.4464],
       device='cuda:0'), range: [-4.0143, 3.9885]
2025-04-13 12:52:29,324 - INFO -   Noise shape: tensor([-0.5454, -2.3166,  0.0821,  0.5186, -0.1946, -1.3716, -0.1847],
       device='cuda:0'), range: [-3.2702, 3.3085]
2025-04-13 12:52:29,324 - INFO -   Noisy actions shape: tensor([-0.4621, -1.6819,  0.5541,  0.9673,  0.2299, -0.9526,  0.1223],
       device='cuda:0'), range: [-3.9959, 3.2339]
2025-04-13 12:52:29,367 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:29,367 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4740, 3.2184]
2025-04-13 12:52:29,367 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9636, 3.1113]
2025-04-13 12:52:29,367 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,367 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,368 - INFO -   True actions shape: tensor([-0.2411, -0.2285, -0.5365, -2.2355, -1.0394,  0.5406, -1.0439],
       device='cuda:0'), range: [-3.4740, 3.2184]
2025-04-13 12:52:29,369 - INFO -   Noise shape: tensor([-0.4993,  0.4011,  0.4216, -0.7426, -0.2587, -0.2658, -1.5150],
       device='cuda:0'), range: [-2.9524, 3.1335]
2025-04-13 12:52:29,369 - INFO -   Noisy actions shape: tensor([-0.4177, -0.0527, -0.3279, -2.3475, -1.0575,  0.3928, -1.5548],
       device='cuda:0'), range: [-3.0561, 3.3964]
2025-04-13 12:52:29,412 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:29,412 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1028, 3.3409]
2025-04-13 12:52:29,412 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6837, 3.8463]
2025-04-13 12:52:29,412 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,412 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,413 - INFO -   True actions shape: tensor([-0.4099,  1.2812,  0.4144,  0.7494, -1.1992, -0.7159,  1.0855],
       device='cuda:0'), range: [-3.1028, 3.3409]
2025-04-13 12:52:29,414 - INFO -   Noise shape: tensor([ 1.3804,  0.0193, -1.3793,  0.1927,  0.2469,  0.9355, -0.9252],
       device='cuda:0'), range: [-3.9539, 3.3291]
2025-04-13 12:52:29,414 - INFO -   Noisy actions shape: tensor([ 1.1297,  0.4934, -1.1270,  0.4571, -0.2159,  0.6030, -0.4562],
       device='cuda:0'), range: [-3.1071, 4.1405]
2025-04-13 12:52:29,456 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:29,456 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4264, 3.8412]
2025-04-13 12:52:29,456 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3227, 3.1580]
2025-04-13 12:52:29,457 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,457 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,457 - INFO -   True actions shape: tensor([ 0.0154, -1.0294, -0.6073,  0.7223,  0.6200,  0.4063, -0.5722],
       device='cuda:0'), range: [-3.4264, 3.8412]
2025-04-13 12:52:29,458 - INFO -   Noise shape: tensor([ 0.1507,  0.0167,  0.5330,  0.0894, -0.4086, -1.0159,  0.3553],
       device='cuda:0'), range: [-3.3867, 3.8573]
2025-04-13 12:52:29,458 - INFO -   Noisy actions shape: tensor([ 0.0449, -1.0058, -0.4899,  0.7257,  0.5269,  0.1973, -0.4906],
       device='cuda:0'), range: [-3.1361, 3.5592]
2025-04-13 12:52:29,500 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:29,501 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2012, 4.0115]
2025-04-13 12:52:29,501 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8450, 2.5157]
2025-04-13 12:52:29,501 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,501 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,501 - INFO -   True actions shape: tensor([-1.0262,  0.9458,  0.4305, -1.4697,  1.2917,  1.0388,  0.8951],
       device='cuda:0'), range: [-3.2012, 4.0115]
2025-04-13 12:52:29,502 - INFO -   Noise shape: tensor([-0.4918,  0.5713, -0.6422,  1.6612,  0.4040, -0.5139,  0.5257],
       device='cuda:0'), range: [-3.4292, 3.8071]
2025-04-13 12:52:29,503 - INFO -   Noisy actions shape: tensor([-1.1077,  1.0949, -0.0674, -0.1032,  1.2595,  0.4869,  1.0269],
       device='cuda:0'), range: [-3.3978, 3.4404]
2025-04-13 12:52:29,545 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:29,545 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0337, 3.5933]
2025-04-13 12:52:29,545 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0368, 3.2949]
2025-04-13 12:52:29,545 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,545 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,546 - INFO -   True actions shape: tensor([ 1.1338,  1.0816, -0.4783,  1.7006, -0.3080, -2.8054, -0.4110],
       device='cuda:0'), range: [-4.0337, 3.5933]
2025-04-13 12:52:29,546 - INFO -   Noise shape: tensor([-0.1017, -1.3661,  0.0705,  0.6273, -0.4193,  1.6454,  1.2663],
       device='cuda:0'), range: [-4.1854, 3.3765]
2025-04-13 12:52:29,547 - INFO -   Noisy actions shape: tensor([ 0.8567,  0.0701, -0.3451,  1.7439, -0.4959, -1.2991,  0.4132],
       device='cuda:0'), range: [-3.7225, 3.1145]
2025-04-13 12:52:29,589 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:29,589 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4689, 3.1744]
2025-04-13 12:52:29,590 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5122, 2.9321]
2025-04-13 12:52:29,590 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,590 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,590 - INFO -   True actions shape: tensor([ 1.5552, -1.2518, -0.2422,  3.1744, -0.2556,  1.4130,  1.2217],
       device='cuda:0'), range: [-3.4689, 3.1744]
2025-04-13 12:52:29,591 - INFO -   Noise shape: tensor([-0.8437, -3.0939, -0.8267,  1.0478,  0.6085, -0.1010, -1.7023],
       device='cuda:0'), range: [-3.0939, 4.0243]
2025-04-13 12:52:29,592 - INFO -   Noisy actions shape: tensor([ 1.3142, -1.9420, -0.4292,  3.3316, -0.1059,  1.3500,  0.7888],
       device='cuda:0'), range: [-3.2753, 3.3865]
2025-04-13 12:52:29,634 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:29,634 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7214, 3.2471]
2025-04-13 12:52:29,634 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2705, 3.3636]
2025-04-13 12:52:29,634 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,634 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,635 - INFO -   True actions shape: tensor([ 0.2358, -0.8946, -2.1402,  1.3807,  0.2990, -1.9477,  0.5346],
       device='cuda:0'), range: [-3.7214, 3.2471]
2025-04-13 12:52:29,635 - INFO -   Noise shape: tensor([ 0.7679, -0.6229,  0.5651, -0.6805, -0.8033,  1.2231,  0.7546],
       device='cuda:0'), range: [-3.3630, 3.1991]
2025-04-13 12:52:29,636 - INFO -   Noisy actions shape: tensor([ 0.7990, -0.7843,  0.1401, -0.4003, -0.7302,  0.8229,  0.8438],
       device='cuda:0'), range: [-3.6493, 3.3021]
2025-04-13 12:52:29,683 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:29,683 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6298, 3.7329]
2025-04-13 12:52:29,683 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7543, 2.7225]
2025-04-13 12:52:29,684 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,684 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,685 - INFO -   True actions shape: tensor([-0.1750,  0.3622,  1.2090, -0.3410,  0.3982, -0.9645, -1.1599],
       device='cuda:0'), range: [-3.6298, 3.7329]
2025-04-13 12:52:29,685 - INFO -   Noise shape: tensor([-0.4440, -0.7986,  0.5678, -0.7831,  1.4229,  0.2392, -0.1478],
       device='cuda:0'), range: [-3.6942, 3.7084]
2025-04-13 12:52:29,686 - INFO -   Noisy actions shape: tensor([-0.2025,  0.3114,  1.2422, -0.3893,  0.4866, -0.9476, -1.1669],
       device='cuda:0'), range: [-3.5834, 3.7420]
2025-04-13 12:52:29,728 - INFO -   Loss components:
2025-04-13 12:52:29,728 - INFO -     Diffusion loss: 1.509867 (coef: 1.0)
2025-04-13 12:52:29,728 - INFO -     Grasp quality loss: 0.693968 (coef: 0.5)
2025-04-13 12:52:29,728 - INFO -     Grasp rotation loss: 0.579026 (coef: 0.5)
2025-04-13 12:52:29,728 - INFO -     Grasp width loss: 5.874517 (coef: 0.005)
2025-04-13 12:52:29,728 - INFO -     TOTAL loss: 2.175736
2025-04-13 12:52:29,737 - INFO -   Gradients: avg norm: 0.320193, max norm: 2.576875, non-zero params: 250
2025-04-13 12:52:29,737 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:52:29,740 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:29,740 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4634, 3.5827]
2025-04-13 12:52:29,740 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8268, 2.8527]
2025-04-13 12:52:29,740 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,740 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,741 - INFO -   True actions shape: tensor([-0.0884,  1.6346,  0.0220, -1.1868,  2.6422, -1.8139, -0.2404],
       device='cuda:0'), range: [-3.4634, 3.5827]
2025-04-13 12:52:29,742 - INFO -   Noise shape: tensor([ 0.1369,  1.4837,  0.0685, -0.7833, -1.4130, -0.5244,  0.0196],
       device='cuda:0'), range: [-2.9026, 3.2512]
2025-04-13 12:52:29,742 - INFO -   Noisy actions shape: tensor([-0.0340,  2.0548,  0.0449, -1.3875,  1.9686, -1.8819, -0.2178],
       device='cuda:0'), range: [-3.2577, 3.3575]
2025-04-13 12:52:29,787 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:29,787 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5357, 3.2848]
2025-04-13 12:52:29,787 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4086, 3.0944]
2025-04-13 12:52:29,787 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,787 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,788 - INFO -   True actions shape: tensor([-0.2643,  0.5226,  0.8182,  1.3585,  0.3792, -0.3523,  1.3688],
       device='cuda:0'), range: [-3.5357, 3.2848]
2025-04-13 12:52:29,788 - INFO -   Noise shape: tensor([ 1.1501, -0.0911,  0.0278, -0.3564, -0.3626, -0.3478,  0.7454],
       device='cuda:0'), range: [-3.5700, 3.4884]
2025-04-13 12:52:29,789 - INFO -   Noisy actions shape: tensor([ 0.9227,  0.1439,  0.3789,  0.2662, -0.1629, -0.4659,  1.2641],
       device='cuda:0'), range: [-3.8750, 3.2398]
2025-04-13 12:52:29,830 - INFO - 
=== Epoch 16 Summary ===
2025-04-13 12:52:29,830 - INFO -   Avg total loss: 2.046468
2025-04-13 12:52:29,830 - INFO -   Avg diffusion loss: 1.383699
2025-04-13 12:52:29,830 - INFO -   Avg grasp loss: 1.325538
2025-04-13 12:52:29,830 - INFO - 
=== EPOCH 17/20 ===
2025-04-13 12:52:29,831 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:29,833 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:29,834 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1093, 3.5194]
2025-04-13 12:52:29,834 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2356, 3.8083]
2025-04-13 12:52:29,834 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,834 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,835 - INFO -   True actions shape: tensor([-7.4906e-04,  1.4841e+00, -1.9482e+00,  1.5925e+00, -1.8024e-02,
         1.8651e+00, -6.9921e-02], device='cuda:0'), range: [-4.1093, 3.5194]
2025-04-13 12:52:29,835 - INFO -   Noise shape: tensor([ 0.3892,  0.7190,  0.7808, -1.0562,  0.5367, -1.3863, -0.5757],
       device='cuda:0'), range: [-3.5423, 3.4040]
2025-04-13 12:52:29,836 - INFO -   Noisy actions shape: tensor([ 0.3659,  1.1797,  0.0739, -0.4536,  0.4988, -0.6717, -0.5653],
       device='cuda:0'), range: [-3.4045, 3.2218]
2025-04-13 12:52:29,836 - INFO -   Diffusion: timestep range [17, 817], noise range [-3.5423, 3.4040]
2025-04-13 12:52:29,836 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4045, 3.2218]
2025-04-13 12:52:29,854 - INFO -   Model output shapes:
2025-04-13 12:52:29,854 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:29,855 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4512, 0.5675]
2025-04-13 12:52:29,855 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6128
2025-04-13 12:52:29,855 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1165, 0.2399]
2025-04-13 12:52:29,876 - INFO -   Loss components:
2025-04-13 12:52:29,876 - INFO -     Diffusion loss: 1.466538 (coef: 1.0)
2025-04-13 12:52:29,876 - INFO -     Grasp quality loss: 0.693695 (coef: 0.5)
2025-04-13 12:52:29,876 - INFO -     Grasp rotation loss: 0.582004 (coef: 0.5)
2025-04-13 12:52:29,876 - INFO -     Grasp width loss: 5.407812 (coef: 0.005)
2025-04-13 12:52:29,876 - INFO -     TOTAL loss: 2.131427
2025-04-13 12:52:29,884 - INFO -   Gradients: avg norm: 0.299623, max norm: 2.546703, non-zero params: 250
2025-04-13 12:52:29,884 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:52:29,884 - INFO - --- Gradient Check @ Epoch 17, Batch 0 ---
2025-04-13 12:52:29,901 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:29,902 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:29,902 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.8820e-01, MaxNorm=1.9375e+00
2025-04-13 12:52:29,902 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.9115e-02, MaxNorm=4.4460e-02
2025-04-13 12:52:29,902 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=7.6846e-03, MaxNorm=2.3833e-02
2025-04-13 12:52:29,902 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.4137e-02, MaxNorm=1.0749e-01
2025-04-13 12:52:29,902 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.0748e+00, MaxNorm=2.0544e+00
2025-04-13 12:52:29,902 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.0064e+00, MaxNorm=1.8175e+00
2025-04-13 12:52:29,902 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=7.1442e-02, MaxNorm=3.2350e-01
2025-04-13 12:52:29,902 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.1161e-01, MaxNorm=2.5760e-01
2025-04-13 12:52:29,902 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.7762e-01, MaxNorm=6.9906e-01
2025-04-13 12:52:29,902 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4031e+00, MaxNorm=2.5467e+00
2025-04-13 12:52:29,902 - INFO - --- End Gradient Check ---
2025-04-13 12:52:29,904 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:29,904 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2538, 4.0119]
2025-04-13 12:52:29,905 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6024, 3.2782]
2025-04-13 12:52:29,905 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,905 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,905 - INFO -   True actions shape: tensor([ 0.1685,  1.4382, -1.3443, -0.3006,  1.1377, -0.6735,  0.0793],
       device='cuda:0'), range: [-4.2538, 4.0119]
2025-04-13 12:52:29,906 - INFO -   Noise shape: tensor([ 2.2566,  1.3666, -0.1020,  1.3007, -0.0982,  1.7293,  0.0952],
       device='cuda:0'), range: [-4.1294, 3.5213]
2025-04-13 12:52:29,907 - INFO -   Noisy actions shape: tensor([ 2.0652,  1.8861, -0.7290,  1.0013,  0.4547,  1.2010,  0.1214],
       device='cuda:0'), range: [-3.7177, 3.3382]
2025-04-13 12:52:29,949 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:29,949 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4856, 3.4253]
2025-04-13 12:52:29,949 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0055, 3.7131]
2025-04-13 12:52:29,949 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,949 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,950 - INFO -   True actions shape: tensor([-0.1958, -1.9079,  0.7690,  0.2381,  0.8125, -1.3068,  0.0105],
       device='cuda:0'), range: [-3.4856, 3.4253]
2025-04-13 12:52:29,951 - INFO -   Noise shape: tensor([ 0.3843,  0.7838,  0.4460, -0.8966,  0.6627, -0.7817, -0.7798],
       device='cuda:0'), range: [-3.2719, 3.6210]
2025-04-13 12:52:29,951 - INFO -   Noisy actions shape: tensor([ 0.1716, -0.6108,  0.8336, -0.5396,  1.0284, -1.4349, -0.5946],
       device='cuda:0'), range: [-3.9451, 3.3197]
2025-04-13 12:52:29,995 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:29,995 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1785, 3.5955]
2025-04-13 12:52:29,996 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0860, 4.3295]
2025-04-13 12:52:29,996 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:29,996 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:29,997 - INFO -   True actions shape: tensor([ 1.1112, -0.4200,  0.4384,  0.0627,  0.5478, -0.4184, -0.0936],
       device='cuda:0'), range: [-4.1785, 3.5955]
2025-04-13 12:52:29,997 - INFO -   Noise shape: tensor([ 1.3143, -1.0916, -1.7555,  1.1507, -0.3964, -1.4241,  0.0245],
       device='cuda:0'), range: [-3.4313, 3.5566]
2025-04-13 12:52:29,998 - INFO -   Noisy actions shape: tensor([ 1.6543, -1.1678, -1.4216,  1.0753, -0.1370, -1.4704, -0.0160],
       device='cuda:0'), range: [-3.2736, 3.5326]
2025-04-13 12:52:30,040 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:30,040 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7738, 3.1563]
2025-04-13 12:52:30,040 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9400, 3.1460]
2025-04-13 12:52:30,040 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,040 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,041 - INFO -   True actions shape: tensor([ 1.4114, -0.2609, -0.7288,  0.3110, -1.5456, -1.8223, -2.6487],
       device='cuda:0'), range: [-3.7738, 3.1563]
2025-04-13 12:52:30,041 - INFO -   Noise shape: tensor([ 0.6897,  2.0992, -0.2613,  1.5719, -0.1870,  1.0810,  0.2446],
       device='cuda:0'), range: [-4.1369, 3.8164]
2025-04-13 12:52:30,042 - INFO -   Noisy actions shape: tensor([ 1.5699,  0.7592, -0.7659,  1.0151, -1.4513, -1.0978, -2.2208],
       device='cuda:0'), range: [-3.8100, 3.7838]
2025-04-13 12:52:30,084 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:30,084 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0578, 4.0067]
2025-04-13 12:52:30,084 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0646, 3.2031]
2025-04-13 12:52:30,084 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,084 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,085 - INFO -   True actions shape: tensor([-0.4815, -0.4472,  0.5791,  0.2345, -1.1984, -1.6994, -0.7555],
       device='cuda:0'), range: [-4.0578, 4.0067]
2025-04-13 12:52:30,085 - INFO -   Noise shape: tensor([ 0.3258,  1.1452,  0.2715,  3.0360,  1.0520, -0.6725,  0.5957],
       device='cuda:0'), range: [-4.7119, 3.2245]
2025-04-13 12:52:30,086 - INFO -   Noisy actions shape: tensor([ 0.1458,  0.9295,  0.4497,  2.9394,  0.5902, -1.2025,  0.3085],
       device='cuda:0'), range: [-5.5946, 3.4286]
2025-04-13 12:52:30,128 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:30,128 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2539, 3.3912]
2025-04-13 12:52:30,128 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7121, 3.9131]
2025-04-13 12:52:30,128 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,128 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,129 - INFO -   True actions shape: tensor([ 0.3518, -1.5883, -0.4245,  0.2006, -0.1185,  0.1759,  0.4246],
       device='cuda:0'), range: [-4.2539, 3.3912]
2025-04-13 12:52:30,129 - INFO -   Noise shape: tensor([ 1.2896, -0.7424,  0.7960,  0.0059, -0.3004, -0.3224,  0.2767],
       device='cuda:0'), range: [-3.7527, 3.2765]
2025-04-13 12:52:30,130 - INFO -   Noisy actions shape: tensor([ 1.1382, -1.6668,  0.2343,  0.1504, -0.2918, -0.0920,  0.4990],
       device='cuda:0'), range: [-3.1793, 3.4123]
2025-04-13 12:52:30,172 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:30,172 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6103, 3.9009]
2025-04-13 12:52:30,172 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1493, 2.9822]
2025-04-13 12:52:30,172 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,172 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,173 - INFO -   True actions shape: tensor([-1.3933, -0.0876, -1.7217,  0.5664,  0.3372,  0.4323, -0.5000],
       device='cuda:0'), range: [-3.6103, 3.9009]
2025-04-13 12:52:30,173 - INFO -   Noise shape: tensor([-0.2723,  0.3716, -0.7070,  0.7456, -1.5563,  0.3370,  0.4871],
       device='cuda:0'), range: [-3.4482, 3.5434]
2025-04-13 12:52:30,174 - INFO -   Noisy actions shape: tensor([-1.4187e+00, -4.9941e-04, -1.8376e+00,  7.2164e-01, -2.7005e-02,
         4.9779e-01, -3.7563e-01], device='cuda:0'), range: [-3.4802, 3.6848]
2025-04-13 12:52:30,216 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:30,216 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1192, 3.2093]
2025-04-13 12:52:30,216 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2279, 2.8989]
2025-04-13 12:52:30,216 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,216 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,217 - INFO -   True actions shape: tensor([-1.4069, -1.1291, -0.5390,  1.1825,  2.1452, -1.6860, -1.6875],
       device='cuda:0'), range: [-4.1192, 3.2093]
2025-04-13 12:52:30,217 - INFO -   Noise shape: tensor([ 1.3936, -0.0794,  0.5766, -0.6920,  0.4607,  0.8111,  0.7899],
       device='cuda:0'), range: [-3.5980, 3.4456]
2025-04-13 12:52:30,218 - INFO -   Noisy actions shape: tensor([ 0.7604, -0.4991,  0.3309, -0.1952,  1.2353,  0.1157,  0.0955],
       device='cuda:0'), range: [-3.8742, 4.1057]
2025-04-13 12:52:30,261 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:30,261 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5124, 3.2838]
2025-04-13 12:52:30,261 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8804, 2.9867]
2025-04-13 12:52:30,261 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,261 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,262 - INFO -   True actions shape: tensor([0.2522, 0.2447, 0.4092, 1.5062, 1.5901, 0.3483, 0.1175],
       device='cuda:0'), range: [-3.5124, 3.2838]
2025-04-13 12:52:30,263 - INFO -   Noise shape: tensor([ 1.6170,  0.4793,  0.2310, -0.1156, -1.0276, -0.0031, -0.6712],
       device='cuda:0'), range: [-3.5439, 4.1375]
2025-04-13 12:52:30,263 - INFO -   Noisy actions shape: tensor([ 0.8580,  0.4110,  0.4667,  1.3442,  1.0688,  0.3200, -0.1513],
       device='cuda:0'), range: [-3.2832, 3.2967]
2025-04-13 12:52:30,305 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:30,306 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2911, 3.5711]
2025-04-13 12:52:30,306 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0232, 3.1104]
2025-04-13 12:52:30,306 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,306 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,307 - INFO -   True actions shape: tensor([-1.6497, -0.5222, -1.2327, -1.0499, -1.4238, -0.7073,  1.4662],
       device='cuda:0'), range: [-3.2911, 3.5711]
2025-04-13 12:52:30,307 - INFO -   Noise shape: tensor([ 0.7183, -1.4010, -1.7808, -0.7472,  0.5737,  1.8595,  0.6426],
       device='cuda:0'), range: [-3.6862, 3.0338]
2025-04-13 12:52:30,308 - INFO -   Noisy actions shape: tensor([-1.6182, -0.5803, -1.3061, -1.0803, -1.3986, -0.6289,  1.4918],
       device='cuda:0'), range: [-3.4784, 3.5539]
2025-04-13 12:52:30,347 - INFO -   Loss components:
2025-04-13 12:52:30,347 - INFO -     Diffusion loss: 1.452959 (coef: 1.0)
2025-04-13 12:52:30,347 - INFO -     Grasp quality loss: 0.695017 (coef: 0.5)
2025-04-13 12:52:30,347 - INFO -     Grasp rotation loss: 0.565643 (coef: 0.5)
2025-04-13 12:52:30,347 - INFO -     Grasp width loss: 5.852210 (coef: 0.005)
2025-04-13 12:52:30,347 - INFO -     TOTAL loss: 2.112550
2025-04-13 12:52:30,355 - INFO -   Gradients: avg norm: 0.325616, max norm: 2.617517, non-zero params: 250
2025-04-13 12:52:30,355 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:52:30,358 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:30,358 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4361, 2.7484]
2025-04-13 12:52:30,358 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0795, 2.9930]
2025-04-13 12:52:30,358 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,358 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,359 - INFO -   True actions shape: tensor([ 0.3799,  0.0389,  1.5059,  0.2924, -1.8910, -1.2294, -1.1066],
       device='cuda:0'), range: [-3.4361, 2.7484]
2025-04-13 12:52:30,360 - INFO -   Noise shape: tensor([ 0.6009, -0.2862, -0.1579,  0.2050,  0.7271,  1.1612, -0.3108],
       device='cuda:0'), range: [-3.4093, 3.9194]
2025-04-13 12:52:30,360 - INFO -   Noisy actions shape: tensor([ 0.6030, -0.0891,  1.2884,  0.3524, -1.3885, -0.6041, -1.1319],
       device='cuda:0'), range: [-3.1793, 3.9164]
2025-04-13 12:52:30,403 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:30,403 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1321, 3.4466]
2025-04-13 12:52:30,403 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8198, 2.9397]
2025-04-13 12:52:30,403 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,403 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,404 - INFO -   True actions shape: tensor([-0.6853,  0.6110,  0.7775,  1.4277, -2.6280, -0.4348,  0.0718],
       device='cuda:0'), range: [-4.1321, 3.4466]
2025-04-13 12:52:30,405 - INFO -   Noise shape: tensor([-0.0426, -0.2438, -2.0003,  0.0660, -0.6130, -0.5184, -0.1939],
       device='cuda:0'), range: [-2.9208, 3.6038]
2025-04-13 12:52:30,405 - INFO -   Noisy actions shape: tensor([-0.6654,  0.5069,  0.1272,  1.3793, -2.6894, -0.5727,  0.0090],
       device='cuda:0'), range: [-3.4480, 3.3889]
2025-04-13 12:52:30,451 - INFO - 
=== Epoch 17 Summary ===
2025-04-13 12:52:30,451 - INFO -   Avg total loss: 2.075624
2025-04-13 12:52:30,451 - INFO -   Avg diffusion loss: 1.409455
2025-04-13 12:52:30,451 - INFO -   Avg grasp loss: 1.332339
2025-04-13 12:52:30,451 - INFO - 
=== EPOCH 18/20 ===
2025-04-13 12:52:30,452 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:30,456 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:30,456 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5390, 3.1905]
2025-04-13 12:52:30,456 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3122, 2.6877]
2025-04-13 12:52:30,456 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,456 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,457 - INFO -   True actions shape: tensor([-1.3896,  0.9521, -0.7003,  0.4529, -0.6614,  1.4205,  1.2780],
       device='cuda:0'), range: [-3.5390, 3.1905]
2025-04-13 12:52:30,457 - INFO -   Noise shape: tensor([ 0.1479, -0.2039, -2.1920, -1.0663, -0.8599, -1.1035, -0.3006],
       device='cuda:0'), range: [-3.1680, 3.5315]
2025-04-13 12:52:30,458 - INFO -   Noisy actions shape: tensor([ 0.0502, -0.1367, -2.2356, -1.0319, -0.9041, -1.0013, -0.2103],
       device='cuda:0'), range: [-3.8493, 3.3629]
2025-04-13 12:52:30,458 - INFO -   Diffusion: timestep range [188, 954], noise range [-3.1680, 3.5315]
2025-04-13 12:52:30,458 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8493, 3.3629]
2025-04-13 12:52:30,477 - INFO -   Model output shapes:
2025-04-13 12:52:30,477 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:30,478 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4548, 0.5505]
2025-04-13 12:52:30,478 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6500
2025-04-13 12:52:30,478 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1283, 0.1970]
2025-04-13 12:52:30,500 - INFO -   Loss components:
2025-04-13 12:52:30,500 - INFO -     Diffusion loss: 1.230556 (coef: 1.0)
2025-04-13 12:52:30,500 - INFO -     Grasp quality loss: 0.695170 (coef: 0.5)
2025-04-13 12:52:30,500 - INFO -     Grasp rotation loss: 0.580207 (coef: 0.5)
2025-04-13 12:52:30,500 - INFO -     Grasp width loss: 5.594944 (coef: 0.005)
2025-04-13 12:52:30,500 - INFO -     TOTAL loss: 1.896219
2025-04-13 12:52:30,508 - INFO -   Gradients: avg norm: 0.290984, max norm: 2.592431, non-zero params: 250
2025-04-13 12:52:30,508 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-13 12:52:30,508 - INFO - --- Gradient Check @ Epoch 18, Batch 0 ---
2025-04-13 12:52:30,526 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:30,526 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:30,526 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.6979e-01, MaxNorm=1.6645e+00
2025-04-13 12:52:30,526 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.8986e-02, MaxNorm=4.1529e-02
2025-04-13 12:52:30,526 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0351e-02, MaxNorm=2.0880e-02
2025-04-13 12:52:30,526 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.8406e-02, MaxNorm=1.0559e-01
2025-04-13 12:52:30,526 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3396e+00, MaxNorm=2.5924e+00
2025-04-13 12:52:30,526 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.8721e-01, MaxNorm=1.6313e+00
2025-04-13 12:52:30,526 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.7576e-02, MaxNorm=2.6548e-01
2025-04-13 12:52:30,526 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.8187e-01, MaxNorm=2.1789e-01
2025-04-13 12:52:30,526 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.6981e-01, MaxNorm=5.7639e-01
2025-04-13 12:52:30,526 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2556e+00, MaxNorm=2.2615e+00
2025-04-13 12:52:30,526 - INFO - --- End Gradient Check ---
2025-04-13 12:52:30,529 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:30,529 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9363, 3.7558]
2025-04-13 12:52:30,529 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3633, 2.6901]
2025-04-13 12:52:30,529 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,529 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,530 - INFO -   True actions shape: tensor([ 0.5449,  0.4111, -0.5775, -0.1963, -2.2129, -0.6952, -0.4522],
       device='cuda:0'), range: [-3.9363, 3.7558]
2025-04-13 12:52:30,531 - INFO -   Noise shape: tensor([-0.0378,  1.3433, -0.5906,  0.5836, -1.2886,  0.9230,  1.1724],
       device='cuda:0'), range: [-3.2605, 3.5974]
2025-04-13 12:52:30,532 - INFO -   Noisy actions shape: tensor([ 0.3495,  1.2546, -0.8260,  0.2858, -2.4611,  0.1859,  0.5341],
       device='cuda:0'), range: [-3.1914, 3.5285]
2025-04-13 12:52:30,576 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:30,576 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4731, 3.8071]
2025-04-13 12:52:30,576 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9615, 2.9040]
2025-04-13 12:52:30,576 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,576 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,577 - INFO -   True actions shape: tensor([ 2.0878,  0.6308, -1.0940,  1.4387, -0.0256, -0.8002, -0.4294],
       device='cuda:0'), range: [-3.4731, 3.8071]
2025-04-13 12:52:30,578 - INFO -   Noise shape: tensor([ 0.1544,  0.3758, -0.5558,  1.6773,  0.5113, -0.8832, -1.5044],
       device='cuda:0'), range: [-3.5202, 3.4909]
2025-04-13 12:52:30,578 - INFO -   Noisy actions shape: tensor([ 0.3647,  0.4377, -0.6636,  1.8142,  0.5060, -0.9596, -1.5401],
       device='cuda:0'), range: [-3.0796, 3.5322]
2025-04-13 12:52:30,621 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:30,621 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9149, 3.5485]
2025-04-13 12:52:30,621 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9490, 3.9976]
2025-04-13 12:52:30,621 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,621 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,622 - INFO -   True actions shape: tensor([-0.9606,  0.2583,  0.3441,  0.1257, -0.6404, -1.4179,  0.2985],
       device='cuda:0'), range: [-2.9149, 3.5485]
2025-04-13 12:52:30,623 - INFO -   Noise shape: tensor([-0.1342,  0.8682,  0.4690,  0.7726,  3.9486, -0.1921,  0.4768],
       device='cuda:0'), range: [-3.2683, 3.9486]
2025-04-13 12:52:30,623 - INFO -   Noisy actions shape: tensor([-0.5021,  0.8997,  0.5667,  0.7596,  3.3764, -0.7355,  0.5559],
       device='cuda:0'), range: [-3.0278, 3.9338]
2025-04-13 12:52:30,666 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:30,666 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1282, 3.3880]
2025-04-13 12:52:30,666 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6287, 3.8246]
2025-04-13 12:52:30,666 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,666 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,667 - INFO -   True actions shape: tensor([-0.3382, -0.5237,  0.0312,  0.3221, -0.6923,  1.3900, -0.3022],
       device='cuda:0'), range: [-3.1282, 3.3880]
2025-04-13 12:52:30,667 - INFO -   Noise shape: tensor([-2.6126, -1.3947,  1.0079,  0.4013,  0.8190,  1.4168,  1.0272],
       device='cuda:0'), range: [-3.3471, 2.9794]
2025-04-13 12:52:30,668 - INFO -   Noisy actions shape: tensor([-1.3719, -1.0459,  0.4386,  0.4575, -0.2992,  1.8462,  0.1419],
       device='cuda:0'), range: [-3.1290, 3.5715]
2025-04-13 12:52:30,710 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:30,710 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1748, 4.3428]
2025-04-13 12:52:30,710 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9097, 3.9269]
2025-04-13 12:52:30,710 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,710 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,711 - INFO -   True actions shape: tensor([ 0.2989,  0.6733,  1.1320, -0.3047,  0.6653, -0.6511,  0.9426],
       device='cuda:0'), range: [-3.1748, 4.3428]
2025-04-13 12:52:30,712 - INFO -   Noise shape: tensor([-1.5840,  0.3514,  0.7493,  1.0047, -0.0649,  1.5099, -1.2769],
       device='cuda:0'), range: [-3.7107, 3.4948]
2025-04-13 12:52:30,712 - INFO -   Noisy actions shape: tensor([-1.0270,  0.7007,  1.2999,  0.5778,  0.3754,  0.7449, -0.3794],
       device='cuda:0'), range: [-3.5838, 3.7213]
2025-04-13 12:52:30,754 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:30,755 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4100, 3.2217]
2025-04-13 12:52:30,755 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7529, 2.9190]
2025-04-13 12:52:30,755 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,755 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,756 - INFO -   True actions shape: tensor([ 0.7032, -0.3193, -0.4478,  1.4862,  0.4034, -0.1537,  0.6847],
       device='cuda:0'), range: [-3.4100, 3.2217]
2025-04-13 12:52:30,756 - INFO -   Noise shape: tensor([-2.1626, -0.9370, -1.3019, -0.4261,  0.5476,  0.4576, -0.8243],
       device='cuda:0'), range: [-4.7223, 3.3202]
2025-04-13 12:52:30,757 - INFO -   Noisy actions shape: tensor([-0.7751, -0.8279, -1.1537,  0.9101,  0.6548,  0.1602,  0.0331],
       device='cuda:0'), range: [-3.6040, 3.4494]
2025-04-13 12:52:30,799 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:30,799 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1872, 2.9359]
2025-04-13 12:52:30,799 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.6868, 3.9101]
2025-04-13 12:52:30,800 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,800 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,800 - INFO -   True actions shape: tensor([ 1.2429, -0.1856, -0.2448, -0.4880, -0.0695,  0.7409,  1.0353],
       device='cuda:0'), range: [-3.1872, 2.9359]
2025-04-13 12:52:30,801 - INFO -   Noise shape: tensor([ 1.1171, -0.5298, -1.3024, -1.1000,  1.3304,  1.2405, -0.5602],
       device='cuda:0'), range: [-3.2392, 3.5093]
2025-04-13 12:52:30,802 - INFO -   Noisy actions shape: tensor([ 1.6576, -0.4539, -0.9417, -1.0267,  0.6990,  1.3147,  0.5334],
       device='cuda:0'), range: [-3.2355, 3.8038]
2025-04-13 12:52:30,844 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:30,845 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5222, 3.8409]
2025-04-13 12:52:30,845 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0853, 3.5519]
2025-04-13 12:52:30,845 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,845 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,846 - INFO -   True actions shape: tensor([-0.3608,  1.9359, -0.7142,  0.5226, -1.3464,  0.5424,  0.0201],
       device='cuda:0'), range: [-3.5222, 3.8409]
2025-04-13 12:52:30,846 - INFO -   Noise shape: tensor([ 0.8564,  1.4081,  0.4879,  0.9260, -0.5570,  0.5281, -0.6781],
       device='cuda:0'), range: [-3.1719, 3.6401]
2025-04-13 12:52:30,847 - INFO -   Noisy actions shape: tensor([ 0.7931,  1.6809,  0.3760,  0.9936, -0.7514,  0.6030, -0.6675],
       device='cuda:0'), range: [-3.5931, 3.7515]
2025-04-13 12:52:30,889 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:30,889 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5225, 3.3437]
2025-04-13 12:52:30,889 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2965, 3.6200]
2025-04-13 12:52:30,889 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,889 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,890 - INFO -   True actions shape: tensor([-0.0240, -1.2477,  0.0433, -0.5132,  0.0124,  0.7403, -1.9620],
       device='cuda:0'), range: [-3.5225, 3.3437]
2025-04-13 12:52:30,890 - INFO -   Noise shape: tensor([-0.2373, -0.6783,  0.7209,  1.0269, -0.2663,  0.4631,  2.6733],
       device='cuda:0'), range: [-4.0062, 2.9295]
2025-04-13 12:52:30,891 - INFO -   Noisy actions shape: tensor([-0.0608, -1.3383,  0.1554, -0.3465, -0.0294,  0.8036, -1.5202],
       device='cuda:0'), range: [-3.6293, 3.1418]
2025-04-13 12:52:30,934 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:30,934 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7641, 3.4852]
2025-04-13 12:52:30,934 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8711, 4.0705]
2025-04-13 12:52:30,934 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,934 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,935 - INFO -   True actions shape: tensor([-1.1159,  0.6591, -0.8387,  1.5540, -0.0221, -0.6477,  1.0105],
       device='cuda:0'), range: [-3.7641, 3.4852]
2025-04-13 12:52:30,935 - INFO -   Noise shape: tensor([ 0.4742, -0.1185,  0.2691,  1.3259, -0.8966, -0.1592,  1.3612],
       device='cuda:0'), range: [-4.1897, 3.6941]
2025-04-13 12:52:30,936 - INFO -   Noisy actions shape: tensor([-0.4433,  0.3771, -0.3955,  2.0348, -0.6553, -0.5674,  1.6793],
       device='cuda:0'), range: [-3.8436, 3.1313]
2025-04-13 12:52:30,975 - INFO -   Loss components:
2025-04-13 12:52:30,976 - INFO -     Diffusion loss: 1.285801 (coef: 1.0)
2025-04-13 12:52:30,976 - INFO -     Grasp quality loss: 0.692397 (coef: 0.5)
2025-04-13 12:52:30,976 - INFO -     Grasp rotation loss: 0.569360 (coef: 0.5)
2025-04-13 12:52:30,976 - INFO -     Grasp width loss: 5.470515 (coef: 0.005)
2025-04-13 12:52:30,976 - INFO -     TOTAL loss: 1.944032
2025-04-13 12:52:30,984 - INFO -   Gradients: avg norm: 0.291516, max norm: 2.316540, non-zero params: 250
2025-04-13 12:52:30,984 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:52:30,986 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:30,987 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8864, 3.2329]
2025-04-13 12:52:30,987 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8514, 2.8393]
2025-04-13 12:52:30,987 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:30,987 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:30,988 - INFO -   True actions shape: tensor([-0.4916,  0.3255, -0.2943,  2.5124,  1.2693,  0.6950, -0.2484],
       device='cuda:0'), range: [-3.8864, 3.2329]
2025-04-13 12:52:30,988 - INFO -   Noise shape: tensor([ 0.2033, -1.1614, -0.7778, -0.7681, -0.9077,  0.1485,  0.1679],
       device='cuda:0'), range: [-3.9586, 4.0641]
2025-04-13 12:52:30,989 - INFO -   Noisy actions shape: tensor([-0.1476, -0.7050, -0.7916,  0.9661,  0.0819,  0.5495, -0.0237],
       device='cuda:0'), range: [-3.2293, 3.1593]
2025-04-13 12:52:31,030 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:31,031 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8124, 3.9026]
2025-04-13 12:52:31,031 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1174, 3.5391]
2025-04-13 12:52:31,031 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,031 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,032 - INFO -   True actions shape: tensor([ 0.2453, -0.0878,  1.0245,  1.2732, -0.6296,  1.2775,  0.0956],
       device='cuda:0'), range: [-3.8124, 3.9026]
2025-04-13 12:52:31,032 - INFO -   Noise shape: tensor([-0.0271,  0.7537,  1.5756, -0.4422,  0.4569,  1.2511,  0.1885],
       device='cuda:0'), range: [-3.1412, 3.2518]
2025-04-13 12:52:31,033 - INFO -   Noisy actions shape: tensor([ 0.1411,  0.5096,  1.8605,  0.5051, -0.0705,  1.7827,  0.2048],
       device='cuda:0'), range: [-3.3085, 4.0987]
2025-04-13 12:52:31,073 - INFO - 
=== Epoch 18 Summary ===
2025-04-13 12:52:31,073 - INFO -   Avg total loss: 1.874436
2025-04-13 12:52:31,073 - INFO -   Avg diffusion loss: 1.214707
2025-04-13 12:52:31,073 - INFO -   Avg grasp loss: 1.319457
2025-04-13 12:52:31,073 - INFO - 
=== EPOCH 19/20 ===
2025-04-13 12:52:31,074 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:31,077 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:31,077 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6612, 3.4577]
2025-04-13 12:52:31,077 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0776, 3.1247]
2025-04-13 12:52:31,077 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,077 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,078 - INFO -   True actions shape: tensor([-0.6934, -0.0958, -0.1690,  0.8046, -0.6345, -1.8336,  0.2175],
       device='cuda:0'), range: [-3.6612, 3.4577]
2025-04-13 12:52:31,078 - INFO -   Noise shape: tensor([-0.7831, -0.3936,  0.8887, -0.9230, -0.7903, -0.4867, -0.2883],
       device='cuda:0'), range: [-3.8965, 3.8873]
2025-04-13 12:52:31,079 - INFO -   Noisy actions shape: tensor([-0.9322, -0.2334,  0.1686,  0.4102, -0.8801, -1.8844,  0.0967],
       device='cuda:0'), range: [-4.1285, 3.8039]
2025-04-13 12:52:31,079 - INFO -   Diffusion: timestep range [232, 835], noise range [-3.8965, 3.8873]
2025-04-13 12:52:31,079 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.1285, 3.8039]
2025-04-13 12:52:31,098 - INFO -   Model output shapes:
2025-04-13 12:52:31,098 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:31,098 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4463, 0.5515]
2025-04-13 12:52:31,098 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6655
2025-04-13 12:52:31,098 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0981, 0.1946]
2025-04-13 12:52:31,121 - INFO -   Loss components:
2025-04-13 12:52:31,122 - INFO -     Diffusion loss: 1.197873 (coef: 1.0)
2025-04-13 12:52:31,122 - INFO -     Grasp quality loss: 0.691105 (coef: 0.5)
2025-04-13 12:52:31,122 - INFO -     Grasp rotation loss: 0.562511 (coef: 0.5)
2025-04-13 12:52:31,122 - INFO -     Grasp width loss: 5.294568 (coef: 0.005)
2025-04-13 12:52:31,122 - INFO -     TOTAL loss: 1.851153
2025-04-13 12:52:31,132 - INFO -   Gradients: avg norm: 0.243279, max norm: 2.283187, non-zero params: 250
2025-04-13 12:52:31,132 - INFO -   Optimizer step complete, current LR: 7.596123e-07
2025-04-13 12:52:31,132 - INFO - --- Gradient Check @ Epoch 19, Batch 0 ---
2025-04-13 12:52:31,151 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:31,151 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:31,152 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=3.8504e-01, MaxNorm=1.4807e+00
2025-04-13 12:52:31,152 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.4926e-02, MaxNorm=3.5256e-02
2025-04-13 12:52:31,152 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.9918e-02, MaxNorm=4.8845e-02
2025-04-13 12:52:31,152 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.9857e-02, MaxNorm=1.0753e-01
2025-04-13 12:52:31,152 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.1602e+00, MaxNorm=2.2832e+00
2025-04-13 12:52:31,152 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=7.5891e-01, MaxNorm=1.4299e+00
2025-04-13 12:52:31,152 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=4.6369e-02, MaxNorm=2.1389e-01
2025-04-13 12:52:31,152 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.9234e-01, MaxNorm=2.1269e-01
2025-04-13 12:52:31,152 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=4.2916e-01, MaxNorm=4.6163e-01
2025-04-13 12:52:31,152 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0835e+00, MaxNorm=1.9713e+00
2025-04-13 12:52:31,152 - INFO - --- End Gradient Check ---
2025-04-13 12:52:31,155 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:31,155 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7291, 4.0464]
2025-04-13 12:52:31,155 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9066, 3.5041]
2025-04-13 12:52:31,155 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,155 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,156 - INFO -   True actions shape: tensor([-0.6534,  1.9309, -0.5763, -0.3478,  0.7916, -0.1747,  0.0432],
       device='cuda:0'), range: [-3.7291, 4.0464]
2025-04-13 12:52:31,157 - INFO -   Noise shape: tensor([ 0.6988, -0.7107,  0.0457,  1.0087,  1.1225, -1.0147,  1.3545],
       device='cuda:0'), range: [-3.3423, 3.0875]
2025-04-13 12:52:31,157 - INFO -   Noisy actions shape: tensor([-0.6248,  1.9008, -0.5740, -0.3070,  0.8360, -0.2153,  0.0976],
       device='cuda:0'), range: [-3.7239, 3.9978]
2025-04-13 12:52:31,201 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:31,201 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5345, 3.5308]
2025-04-13 12:52:31,202 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5365, 3.5425]
2025-04-13 12:52:31,202 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,202 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,203 - INFO -   True actions shape: tensor([-0.7911, -0.0906, -0.1936,  0.6193,  0.7068, -0.4804,  2.2153],
       device='cuda:0'), range: [-3.5345, 3.5308]
2025-04-13 12:52:31,203 - INFO -   Noise shape: tensor([-0.3448, -0.2042, -0.0135, -1.1703,  0.1198, -2.1279, -0.5426],
       device='cuda:0'), range: [-3.5513, 3.3807]
2025-04-13 12:52:31,204 - INFO -   Noisy actions shape: tensor([-0.7615, -0.2163, -0.1308, -0.5325,  0.5329, -1.9660,  0.9506],
       device='cuda:0'), range: [-4.0572, 3.4153]
2025-04-13 12:52:31,247 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:31,247 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8279, 3.6945]
2025-04-13 12:52:31,247 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9884, 3.2551]
2025-04-13 12:52:31,248 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,248 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,248 - INFO -   True actions shape: tensor([-1.0947, -0.4953, -0.7813,  0.0665, -0.7871,  1.7597, -0.3582],
       device='cuda:0'), range: [-3.8279, 3.6945]
2025-04-13 12:52:31,249 - INFO -   Noise shape: tensor([-1.5169, -0.1911,  0.8585,  0.1621, -1.3724,  0.2110,  1.0795],
       device='cuda:0'), range: [-3.1586, 3.3621]
2025-04-13 12:52:31,250 - INFO -   Noisy actions shape: tensor([-1.5933, -0.5308, -0.3918,  0.1236, -1.2537,  1.7058,  0.0837],
       device='cuda:0'), range: [-3.4111, 3.8640]
2025-04-13 12:52:31,292 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:31,292 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2827, 3.3550]
2025-04-13 12:52:31,292 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6599, 3.0143]
2025-04-13 12:52:31,292 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,292 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,293 - INFO -   True actions shape: tensor([ 1.5824, -0.0830, -0.0964,  1.8990,  1.2223,  0.0522, -0.2329],
       device='cuda:0'), range: [-3.2827, 3.3550]
2025-04-13 12:52:31,294 - INFO -   Noise shape: tensor([ 1.1959, -0.2646, -0.5746,  0.4352, -0.5993, -0.3487, -1.0722],
       device='cuda:0'), range: [-3.2583, 3.5896]
2025-04-13 12:52:31,294 - INFO -   Noisy actions shape: tensor([ 1.8060, -0.1390, -0.2200,  1.9483,  1.0612, -0.0255, -0.4622],
       device='cuda:0'), range: [-3.8919, 3.5592]
2025-04-13 12:52:31,337 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:31,337 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2418, 3.5207]
2025-04-13 12:52:31,337 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6758, 3.2869]
2025-04-13 12:52:31,337 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,337 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,338 - INFO -   True actions shape: tensor([1.2915, 1.2208, 0.2949, 0.7754, 0.0461, 1.5610, 0.7453],
       device='cuda:0'), range: [-3.2418, 3.5207]
2025-04-13 12:52:31,339 - INFO -   Noise shape: tensor([ 0.5650,  0.2285,  0.9340, -0.7947, -0.2803,  0.9977, -0.2058],
       device='cuda:0'), range: [-3.4310, 3.9330]
2025-04-13 12:52:31,339 - INFO -   Noisy actions shape: tensor([ 1.3659,  1.1033,  0.8069,  0.1229, -0.1360,  1.8446,  0.4612],
       device='cuda:0'), range: [-3.2027, 3.6961]
2025-04-13 12:52:31,381 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:31,381 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1193, 4.2367]
2025-04-13 12:52:31,381 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3788, 3.2943]
2025-04-13 12:52:31,382 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,382 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,382 - INFO -   True actions shape: tensor([ 0.2024, -0.5984,  0.1272,  0.3774, -1.5574,  0.3200,  1.3647],
       device='cuda:0'), range: [-3.1193, 4.2367]
2025-04-13 12:52:31,383 - INFO -   Noise shape: tensor([-0.4153, -0.9567,  0.1358,  1.6044,  0.3525, -0.6663,  0.3354],
       device='cuda:0'), range: [-3.1566, 3.4970]
2025-04-13 12:52:31,383 - INFO -   Noisy actions shape: tensor([-0.2980, -1.1170,  0.1756,  1.6200, -0.3071, -0.4801,  0.8584],
       device='cuda:0'), range: [-3.5948, 3.7079]
2025-04-13 12:52:31,425 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:31,425 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6115, 2.9547]
2025-04-13 12:52:31,426 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3779, 2.8611]
2025-04-13 12:52:31,426 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,426 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,426 - INFO -   True actions shape: tensor([ 0.0732, -0.1722, -0.3813, -0.6461, -0.1337,  0.3953, -0.0209],
       device='cuda:0'), range: [-3.6115, 2.9547]
2025-04-13 12:52:31,427 - INFO -   Noise shape: tensor([ 0.2872,  0.3289, -1.5356, -0.6294,  0.2598,  0.9189,  0.0544],
       device='cuda:0'), range: [-4.0278, 3.9206]
2025-04-13 12:52:31,428 - INFO -   Noisy actions shape: tensor([ 0.2929,  0.2348, -1.5620, -0.8326,  0.1864,  1.0003,  0.0418],
       device='cuda:0'), range: [-4.3084, 3.2958]
2025-04-13 12:52:31,470 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:31,470 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4213, 4.0305]
2025-04-13 12:52:31,470 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2329, 2.5389]
2025-04-13 12:52:31,470 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,470 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,471 - INFO -   True actions shape: tensor([-0.0452, -0.9287, -0.2060,  0.6427,  1.0740,  0.2581,  0.5839],
       device='cuda:0'), range: [-3.4213, 4.0305]
2025-04-13 12:52:31,471 - INFO -   Noise shape: tensor([-0.3554, -1.3599, -1.9597, -0.1919,  0.3265, -0.6080, -2.1020],
       device='cuda:0'), range: [-2.8276, 3.1228]
2025-04-13 12:52:31,472 - INFO -   Noisy actions shape: tensor([-0.3259, -1.6452, -1.7742,  0.1755,  0.8433, -0.3809, -1.4791],
       device='cuda:0'), range: [-3.5328, 3.7753]
2025-04-13 12:52:31,514 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:31,514 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7944, 3.9945]
2025-04-13 12:52:31,514 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0156, 3.4623]
2025-04-13 12:52:31,514 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,514 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,515 - INFO -   True actions shape: tensor([ 1.5066,  1.2825,  0.5753,  0.4247, -0.6312, -2.4328,  0.7281],
       device='cuda:0'), range: [-3.7944, 3.9945]
2025-04-13 12:52:31,515 - INFO -   Noise shape: tensor([ 0.2024, -0.3236, -1.6153,  0.6410,  0.0233, -0.6522,  1.1256],
       device='cuda:0'), range: [-3.9402, 3.7478]
2025-04-13 12:52:31,516 - INFO -   Noisy actions shape: tensor([ 0.9547,  0.3887, -1.0824,  0.7683, -0.3076, -1.8197,  1.3400],
       device='cuda:0'), range: [-4.0977, 3.2929]
2025-04-13 12:52:31,558 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:31,558 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3115, 3.1210]
2025-04-13 12:52:31,558 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5788, 3.3733]
2025-04-13 12:52:31,558 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,558 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,559 - INFO -   True actions shape: tensor([-0.2057, -0.6514, -0.4980,  0.0044, -0.2940,  1.1146,  0.9646],
       device='cuda:0'), range: [-3.3115, 3.1210]
2025-04-13 12:52:31,559 - INFO -   Noise shape: tensor([-0.7451, -0.3251, -1.4968, -0.4459, -0.2987, -0.5604,  0.5651],
       device='cuda:0'), range: [-3.5005, 3.3676]
2025-04-13 12:52:31,560 - INFO -   Noisy actions shape: tensor([-0.3141, -0.6924, -0.7148, -0.0619, -0.3351,  1.0190,  1.0378],
       device='cuda:0'), range: [-3.6702, 3.0231]
2025-04-13 12:52:31,599 - INFO -   Loss components:
2025-04-13 12:52:31,599 - INFO -     Diffusion loss: 1.114437 (coef: 1.0)
2025-04-13 12:52:31,599 - INFO -     Grasp quality loss: 0.693113 (coef: 0.5)
2025-04-13 12:52:31,600 - INFO -     Grasp rotation loss: 0.560434 (coef: 0.5)
2025-04-13 12:52:31,600 - INFO -     Grasp width loss: 5.255796 (coef: 0.005)
2025-04-13 12:52:31,600 - INFO -     TOTAL loss: 1.767489
2025-04-13 12:52:31,608 - INFO -   Gradients: avg norm: 0.239978, max norm: 2.003740, non-zero params: 250
2025-04-13 12:52:31,608 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:52:31,610 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:31,610 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9228, 3.3660]
2025-04-13 12:52:31,611 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8689, 3.4042]
2025-04-13 12:52:31,611 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,611 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,611 - INFO -   True actions shape: tensor([-0.5921,  0.5429,  0.7978, -0.2122, -1.2535,  0.7386,  0.6237],
       device='cuda:0'), range: [-3.9228, 3.3660]
2025-04-13 12:52:31,612 - INFO -   Noise shape: tensor([-1.2614,  0.2900, -0.2944, -1.3559,  1.1039,  0.0079,  0.8134],
       device='cuda:0'), range: [-3.5248, 3.3840]
2025-04-13 12:52:31,613 - INFO -   Noisy actions shape: tensor([-1.1102,  0.6155,  0.5698, -0.8176, -0.5975,  0.6578,  0.9301],
       device='cuda:0'), range: [-3.7950, 3.5319]
2025-04-13 12:52:31,654 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:31,655 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6106, 3.2615]
2025-04-13 12:52:31,655 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1337, 3.3932]
2025-04-13 12:52:31,655 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,655 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,656 - INFO -   True actions shape: tensor([-0.2904,  0.3597,  2.3290, -0.2979,  1.2461, -1.3806, -0.2379],
       device='cuda:0'), range: [-3.6106, 3.2615]
2025-04-13 12:52:31,656 - INFO -   Noise shape: tensor([-0.8814, -0.6249,  1.5751, -1.3332, -0.5677, -1.9415,  0.3019],
       device='cuda:0'), range: [-3.2348, 3.4495]
2025-04-13 12:52:31,657 - INFO -   Noisy actions shape: tensor([-0.9205, -0.4088,  2.4253, -1.3313,  0.0250, -2.3470,  0.1699],
       device='cuda:0'), range: [-3.6219, 3.6982]
2025-04-13 12:52:31,697 - INFO - 
=== Epoch 19 Summary ===
2025-04-13 12:52:31,697 - INFO -   Avg total loss: 1.903211
2025-04-13 12:52:31,697 - INFO -   Avg diffusion loss: 1.245828
2025-04-13 12:52:31,697 - INFO -   Avg grasp loss: 1.314766
2025-04-13 12:52:31,697 - INFO - 
=== EPOCH 20/20 ===
2025-04-13 12:52:31,698 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:52:31,701 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:52:31,701 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7766, 4.0390]
2025-04-13 12:52:31,701 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3560, 3.4462]
2025-04-13 12:52:31,701 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,701 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,702 - INFO -   True actions shape: tensor([-0.7262,  1.8070, -1.5227, -0.9329,  1.6418,  0.4506,  1.1737],
       device='cuda:0'), range: [-3.7766, 4.0390]
2025-04-13 12:52:31,702 - INFO -   Noise shape: tensor([ 0.7833, -0.2851, -0.6346,  0.1388, -0.0182, -0.4832,  0.8902],
       device='cuda:0'), range: [-3.1328, 3.8258]
2025-04-13 12:52:31,703 - INFO -   Noisy actions shape: tensor([ 0.5460,  0.2376, -1.0394, -0.1307,  0.4469, -0.3361,  1.1858],
       device='cuda:0'), range: [-3.4988, 3.8237]
2025-04-13 12:52:31,703 - INFO -   Diffusion: timestep range [64, 815], noise range [-3.1328, 3.8258]
2025-04-13 12:52:31,703 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4988, 3.8237]
2025-04-13 12:52:31,721 - INFO -   Model output shapes:
2025-04-13 12:52:31,721 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:52:31,721 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4383, 0.5605]
2025-04-13 12:52:31,721 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6897
2025-04-13 12:52:31,722 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0927, 0.2033]
2025-04-13 12:52:31,743 - INFO -   Loss components:
2025-04-13 12:52:31,743 - INFO -     Diffusion loss: 1.359094 (coef: 1.0)
2025-04-13 12:52:31,743 - INFO -     Grasp quality loss: 0.693477 (coef: 0.5)
2025-04-13 12:52:31,743 - INFO -     Grasp rotation loss: 0.572053 (coef: 0.5)
2025-04-13 12:52:31,743 - INFO -     Grasp width loss: 5.026010 (coef: 0.005)
2025-04-13 12:52:31,743 - INFO -     TOTAL loss: 2.016989
2025-04-13 12:52:31,752 - INFO -   Gradients: avg norm: 0.230160, max norm: 1.976014, non-zero params: 250
2025-04-13 12:52:31,752 - INFO -   Optimizer step complete, current LR: 7.500000e-05
2025-04-13 12:52:31,752 - INFO - --- Gradient Check @ Epoch 20, Batch 0 ---
2025-04-13 12:52:31,770 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:52:31,770 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:52:31,770 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=3.6758e-01, MaxNorm=1.2735e+00
2025-04-13 12:52:31,770 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.5574e-02, MaxNorm=3.7586e-02
2025-04-13 12:52:31,770 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=6.9103e-03, MaxNorm=1.5428e-02
2025-04-13 12:52:31,770 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.6128e-02, MaxNorm=9.8905e-02
2025-04-13 12:52:31,770 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=9.7269e-01, MaxNorm=1.7847e+00
2025-04-13 12:52:31,770 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=7.7558e-01, MaxNorm=1.4311e+00
2025-04-13 12:52:31,770 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=4.5944e-02, MaxNorm=2.0767e-01
2025-04-13 12:52:31,770 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.7486e-01, MaxNorm=2.0744e-01
2025-04-13 12:52:31,770 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=4.6610e-01, MaxNorm=5.2427e-01
2025-04-13 12:52:31,770 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0896e+00, MaxNorm=1.9760e+00
2025-04-13 12:52:31,770 - INFO - --- End Gradient Check ---
2025-04-13 12:52:31,773 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:52:31,773 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0399, 3.5436]
2025-04-13 12:52:31,773 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8721, 2.8675]
2025-04-13 12:52:31,773 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,773 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,774 - INFO -   True actions shape: tensor([-0.9045,  0.3916,  0.4695,  0.1840,  0.4050,  0.4513, -1.5319],
       device='cuda:0'), range: [-3.0399, 3.5436]
2025-04-13 12:52:31,774 - INFO -   Noise shape: tensor([-0.9127, -1.0724,  0.9167,  1.0429,  0.2391,  0.2093, -0.6543],
       device='cuda:0'), range: [-4.4660, 3.1072]
2025-04-13 12:52:31,775 - INFO -   Noisy actions shape: tensor([-0.9239, -1.0674,  0.9225,  1.0451,  0.2442,  0.2149, -0.6733],
       device='cuda:0'), range: [-3.3931, 3.2614]
2025-04-13 12:52:31,817 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:52:31,818 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6973, 3.3833]
2025-04-13 12:52:31,818 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6615, 2.7834]
2025-04-13 12:52:31,818 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,818 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,819 - INFO -   True actions shape: tensor([ 0.6595,  0.4236, -0.9040, -0.0368,  0.0794, -1.0226,  0.3163],
       device='cuda:0'), range: [-3.6973, 3.3833]
2025-04-13 12:52:31,819 - INFO -   Noise shape: tensor([-0.4226,  0.7425, -0.1520,  0.0652, -1.6678,  0.9358, -0.4241],
       device='cuda:0'), range: [-3.0643, 3.9565]
2025-04-13 12:52:31,820 - INFO -   Noisy actions shape: tensor([ 0.5902,  0.5281, -0.9165, -0.0268, -0.1666, -0.8740,  0.2505],
       device='cuda:0'), range: [-3.6348, 3.9941]
2025-04-13 12:52:31,862 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:52:31,862 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1622, 3.5254]
2025-04-13 12:52:31,862 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8183, 3.1992]
2025-04-13 12:52:31,862 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,862 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,863 - INFO -   True actions shape: tensor([ 0.3429, -1.0198, -0.3715, -0.6821,  1.8505, -0.6937,  0.0573],
       device='cuda:0'), range: [-3.1622, 3.5254]
2025-04-13 12:52:31,863 - INFO -   Noise shape: tensor([-0.2489,  1.3575,  0.4162,  0.1828, -0.5922,  0.5492, -0.1710],
       device='cuda:0'), range: [-3.2208, 3.8014]
2025-04-13 12:52:31,864 - INFO -   Noisy actions shape: tensor([ 0.2300, -0.4613, -0.1963, -0.5702,  1.5122, -0.4489, -0.0083],
       device='cuda:0'), range: [-3.5854, 3.7591]
2025-04-13 12:52:31,906 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:52:31,906 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9390, 3.5505]
2025-04-13 12:52:31,906 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3415, 2.9539]
2025-04-13 12:52:31,906 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,906 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,907 - INFO -   True actions shape: tensor([-0.8857,  0.2768,  0.5947,  0.7711,  0.7839, -1.1846, -0.7715],
       device='cuda:0'), range: [-3.9390, 3.5505]
2025-04-13 12:52:31,907 - INFO -   Noise shape: tensor([ 0.4730, -0.1005,  1.5356, -0.4080, -0.2616, -0.3572,  2.3375],
       device='cuda:0'), range: [-3.5778, 3.2179]
2025-04-13 12:52:31,908 - INFO -   Noisy actions shape: tensor([-0.6017,  0.2081,  1.1896,  0.5254,  0.5991, -1.2244,  0.2921],
       device='cuda:0'), range: [-3.9540, 3.1450]
2025-04-13 12:52:31,950 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:52:31,950 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6468, 3.1026]
2025-04-13 12:52:31,950 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8722, 4.8315]
2025-04-13 12:52:31,950 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,950 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,951 - INFO -   True actions shape: tensor([ 1.7581, -0.0203,  2.1263,  0.6872,  0.7789, -0.5494, -0.8320],
       device='cuda:0'), range: [-3.6468, 3.1026]
2025-04-13 12:52:31,952 - INFO -   Noise shape: tensor([ 0.6152,  0.3438, -1.4517,  0.7021,  0.2634,  0.0511, -0.1854],
       device='cuda:0'), range: [-3.6436, 3.2971]
2025-04-13 12:52:31,952 - INFO -   Noisy actions shape: tensor([ 1.0493,  0.3268, -0.8518,  0.8560,  0.4560, -0.0929, -0.3945],
       device='cuda:0'), range: [-4.2078, 3.4760]
2025-04-13 12:52:31,995 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:52:31,995 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7052, 3.8147]
2025-04-13 12:52:31,995 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3551, 3.4833]
2025-04-13 12:52:31,995 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:31,995 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:31,996 - INFO -   True actions shape: tensor([ 0.8604,  0.9893, -0.4404, -1.7666, -0.0800, -0.7348,  0.2068],
       device='cuda:0'), range: [-3.7052, 3.8147]
2025-04-13 12:52:31,996 - INFO -   Noise shape: tensor([-0.1783, -0.0235,  1.3194, -0.0261, -1.3805,  0.9384, -0.0306],
       device='cuda:0'), range: [-3.5974, 3.2199]
2025-04-13 12:52:31,997 - INFO -   Noisy actions shape: tensor([-0.1393,  0.0213,  1.2981, -0.1059, -1.3827,  0.9043, -0.0212],
       device='cuda:0'), range: [-3.5902, 3.2983]
2025-04-13 12:52:32,040 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:52:32,040 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3471, 3.4084]
2025-04-13 12:52:32,040 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6089, 3.0714]
2025-04-13 12:52:32,040 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,040 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,041 - INFO -   True actions shape: tensor([-1.0749,  0.1514,  0.7528, -0.8375,  0.3339, -0.1544,  0.4754],
       device='cuda:0'), range: [-3.3471, 3.4084]
2025-04-13 12:52:32,041 - INFO -   Noise shape: tensor([ 0.0040,  0.8678, -0.8665, -1.7795,  1.4030, -0.3727,  0.9278],
       device='cuda:0'), range: [-3.6809, 3.9151]
2025-04-13 12:52:32,042 - INFO -   Noisy actions shape: tensor([-0.3082,  0.8743, -0.6106, -1.9460,  1.4395, -0.4014,  1.0259],
       device='cuda:0'), range: [-3.0588, 3.5286]
2025-04-13 12:52:32,091 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:52:32,091 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5655, 3.6530]
2025-04-13 12:52:32,091 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7234, 3.4332]
2025-04-13 12:52:32,091 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,091 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,092 - INFO -   True actions shape: tensor([-0.7882, -0.3392,  0.3110, -0.1154,  1.4312, -1.6958, -1.4966],
       device='cuda:0'), range: [-3.5655, 3.6530]
2025-04-13 12:52:32,093 - INFO -   Noise shape: tensor([-2.1639,  1.5413, -1.7568, -0.1214, -0.1476, -0.8322, -0.3159],
       device='cuda:0'), range: [-3.6113, 3.2498]
2025-04-13 12:52:32,094 - INFO -   Noisy actions shape: tensor([-2.3027,  1.3440, -1.5568, -0.1526,  0.3312, -1.3436, -0.7905],
       device='cuda:0'), range: [-3.2640, 3.3113]
2025-04-13 12:52:32,141 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:52:32,141 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8280, 3.7130]
2025-04-13 12:52:32,141 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8056, 3.3608]
2025-04-13 12:52:32,141 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,141 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,142 - INFO -   True actions shape: tensor([ 0.4550,  0.0765, -0.4097,  1.6451,  1.1652, -0.0622, -0.2815],
       device='cuda:0'), range: [-3.8280, 3.7130]
2025-04-13 12:52:32,143 - INFO -   Noise shape: tensor([-0.1725, -1.6869, -0.7815,  0.7994, -0.4741, -0.3226, -0.5736],
       device='cuda:0'), range: [-3.1129, 3.6559]
2025-04-13 12:52:32,143 - INFO -   Noisy actions shape: tensor([ 0.3438, -0.6239, -0.6948,  1.8283,  0.8672, -0.1893, -0.4924],
       device='cuda:0'), range: [-3.1613, 3.6944]
2025-04-13 12:52:32,188 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:52:32,188 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0947, 3.7417]
2025-04-13 12:52:32,188 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3553, 3.8516]
2025-04-13 12:52:32,189 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,189 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,189 - INFO -   True actions shape: tensor([-1.2817,  0.8347, -1.4236, -1.2000,  2.1801, -0.6789, -0.2213],
       device='cuda:0'), range: [-3.0947, 3.7417]
2025-04-13 12:52:32,190 - INFO -   Noise shape: tensor([ 0.8332, -0.4020,  0.8011,  0.8260,  0.0729, -0.6615,  1.5679],
       device='cuda:0'), range: [-3.9532, 3.9199]
2025-04-13 12:52:32,191 - INFO -   Noisy actions shape: tensor([-0.8695,  0.6196, -1.0129, -0.7966,  2.0446, -0.8792,  0.3905],
       device='cuda:0'), range: [-3.4529, 3.9239]
2025-04-13 12:52:32,231 - INFO -   Loss components:
2025-04-13 12:52:32,231 - INFO -     Diffusion loss: 1.037356 (coef: 1.0)
2025-04-13 12:52:32,231 - INFO -     Grasp quality loss: 0.696976 (coef: 0.5)
2025-04-13 12:52:32,231 - INFO -     Grasp rotation loss: 0.587849 (coef: 0.5)
2025-04-13 12:52:32,231 - INFO -     Grasp width loss: 5.367626 (coef: 0.005)
2025-04-13 12:52:32,231 - INFO -     TOTAL loss: 1.706607
2025-04-13 12:52:32,239 - INFO -   Gradients: avg norm: 0.224766, max norm: 1.971431, non-zero params: 250
2025-04-13 12:52:32,239 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-13 12:52:32,242 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:52:32,242 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7034, 3.5175]
2025-04-13 12:52:32,242 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.4078, 3.4138]
2025-04-13 12:52:32,242 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,242 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,243 - INFO -   True actions shape: tensor([ 0.6637,  0.4425, -0.9264, -0.4830, -0.9688,  1.8114,  1.0133],
       device='cuda:0'), range: [-3.7034, 3.5175]
2025-04-13 12:52:32,244 - INFO -   Noise shape: tensor([ 0.1586, -1.7117, -0.2835, -0.8256, -1.2756,  0.7770,  0.5744],
       device='cuda:0'), range: [-3.4497, 3.5612]
2025-04-13 12:52:32,244 - INFO -   Noisy actions shape: tensor([ 0.6745, -0.2350, -0.9650, -0.7584, -1.3780,  1.9706,  1.1551],
       device='cuda:0'), range: [-3.2613, 3.5121]
2025-04-13 12:52:32,286 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:52:32,287 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3525, 2.8460]
2025-04-13 12:52:32,287 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1472, 3.4448]
2025-04-13 12:52:32,287 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:52:32,287 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:52:32,288 - INFO -   True actions shape: tensor([ 0.3292, -0.9338, -2.9865, -0.2303, -1.1246,  0.6192,  0.1026],
       device='cuda:0'), range: [-3.3525, 2.8460]
2025-04-13 12:52:32,288 - INFO -   Noise shape: tensor([ 0.5061, -0.1658,  1.3002,  0.7508, -1.7519, -1.4104,  0.5974],
       device='cuda:0'), range: [-3.4690, 3.4799]
2025-04-13 12:52:32,289 - INFO -   Noisy actions shape: tensor([ 0.5500, -0.8761, -1.8163,  0.2102, -1.8910, -0.2378,  0.4081],
       device='cuda:0'), range: [-3.6137, 3.0405]
2025-04-13 12:52:32,328 - INFO - 
=== Epoch 20 Summary ===
2025-04-13 12:52:32,328 - INFO -   Avg total loss: 1.818573
2025-04-13 12:52:32,328 - INFO -   Avg diffusion loss: 1.159184
2025-04-13 12:52:32,328 - INFO -   Avg grasp loss: 1.318779
2025-04-13 12:52:32,503 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125218/ckpt_epoch_20.pth
2025-04-13 12:52:32,503 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:52:32,530 - INFO - 
=== Training Complete ===
2025-04-13 12:52:32,530 - INFO - Total training time: 0.23 minutes
2025-04-13 12:52:32,530 - INFO - Final global step: 260
2025-04-13 12:52:32,530 - INFO - ----------------------

2025-04-13 12:52:32,531 - INFO - 
=== Model Configuration ===
2025-04-13 12:52:32,531 - INFO - Model: PrestoGIGA with depth=12, heads=4, hidden=256
2025-04-13 12:52:32,531 - INFO - Sequence length: 50, patch size: 1
2025-04-13 12:52:32,531 - INFO - GIGA encoder: voxel_simple_local, decoder: simple_local, c_dim: 32
2025-04-13 12:52:32,531 - INFO - Diffusion: beta_schedule=squaredcos_cap_v2, steps=1000, type=epsilon
2025-04-13 12:52:32,531 - INFO - x0_type: step, x0_iter: 1
2025-04-13 12:52:32,531 - INFO - Optimizer: AdamW with lr=0.0001, weight_decay=0.01
