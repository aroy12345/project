2025-04-18 11:35:11,966 - INFO - --- Logging Initialized ---

2025-04-18 11:35:14,464 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,466 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,467 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,656 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,658 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,662 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,663 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,797 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,799 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,808 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,808 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,809 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,810 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,811 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,813 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,814 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,856 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,857 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:14,858 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,101 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,103 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,218 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-18 11:35:15,218 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-18 11:35:15,328 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,328 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,329 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,330 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,330 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,331 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,334 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-18 11:35:15,334 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,335 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,337 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,339 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,340 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,340 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,342 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,343 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,344 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,345 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,351 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,469 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,475 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,476 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,478 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,600 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,609 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,610 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,614 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,622 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,622 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,628 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,629 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,630 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,631 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,631 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,633 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,634 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,635 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,636 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,637 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,637 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,639 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,643 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,648 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,649 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,651 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,652 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,653 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,654 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,655 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,655 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,660 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,660 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,661 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,662 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,663 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,664 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,664 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,666 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,667 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,671 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,672 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,676 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,678 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,869 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,870 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:15,871 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-18 11:35:16,474 - INFO - Starting training loop with: epochs=20, batch_size=8
2025-04-18 11:35:16,474 - INFO - Loss coefficients: diffusion=1.0, grasp=0.5, tsdf=0.0, collision=0.0, distance=0.0, euclidean=0.0
2025-04-18 11:35:16,474 - INFO - Model settings: seq_len=50, obs_dim=7, cond_dim=104, tsdf_dim=32, num_grasp_points=64, num_tsdf_points=32
2025-04-18 11:35:16,500 - INFO - 
=== EPOCH 1/20 ===
2025-04-18 11:35:16,501 - INFO - GPU Memory: 0.08GB allocated, 0.09GB reserved
2025-04-18 11:35:16,505 - INFO - Batch 1/13: Generated dummy data
2025-04-18 11:35:16,512 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4725, 3.1592]
2025-04-18 11:35:16,512 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7544, 3.1561]
2025-04-18 11:35:16,521 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:16,521 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:16,587 - INFO -   True actions shape: tensor([-0.2650, -1.2753,  1.9849,  0.7287,  1.0833, -0.5282,  0.7589],
       device='cuda:0'), range: [-3.4725, 3.1592]
2025-04-18 11:35:16,588 - INFO -   Noise shape: tensor([ 0.4425, -0.5317,  0.8507,  0.7279,  0.5471, -1.3388,  0.3176],
       device='cuda:0'), range: [-3.7805, 3.5022]
2025-04-18 11:35:16,588 - INFO -   Noisy actions shape: tensor([ 0.0214, -1.3578,  2.1261,  1.0086,  1.2058, -1.1764,  0.8087],
       device='cuda:0'), range: [-3.8443, 3.1898]
2025-04-18 11:35:16,588 - INFO -   Diffusion: timestep range [178, 921], noise range [-3.7805, 3.5022]
2025-04-18 11:35:16,589 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8443, 3.1898]
2025-04-18 11:35:17,072 - INFO -   Model output shapes:
2025-04-18 11:35:17,072 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-18 11:35:17,075 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4333, 0.5130]
2025-04-18 11:35:17,075 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 0.7712
2025-04-18 11:35:17,075 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1298, 0.2173]
2025-04-18 11:35:17,191 - INFO -   Loss components:
2025-04-18 11:35:17,191 - INFO -     Diffusion loss: 3.733460 (coef: 1.0)
2025-04-18 11:35:17,191 - INFO -     Grasp quality loss: 0.699805 (coef: 0.5)
2025-04-18 11:35:17,191 - INFO -     Grasp rotation loss: 0.576371 (coef: 0.5)
2025-04-18 11:35:17,191 - INFO -     Grasp width loss: 8.186138 (coef: 0.005)
2025-04-18 11:35:17,191 - INFO -     TOTAL loss: 4.412479
2025-04-18 11:35:17,199 - INFO -   Gradients: avg norm: 0.896703, max norm: 6.801833, non-zero params: 250
2025-04-18 11:35:17,199 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-18 11:35:17,199 - INFO - --- Gradient Check @ Epoch 1, Batch 0 ---
2025-04-18 11:35:17,217 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-18 11:35:17,217 - INFO -   --- Gradient Stats by Component ---
2025-04-18 11:35:17,217 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.4798e+00, MaxNorm=6.5221e+00
2025-04-18 11:35:17,217 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=3.6362e-02, MaxNorm=8.6893e-02
2025-04-18 11:35:17,217 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=5.0292e-02, MaxNorm=1.0553e-01
2025-04-18 11:35:17,217 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.0600e-01, MaxNorm=4.4646e-01
2025-04-18 11:35:17,217 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.3050e+00, MaxNorm=4.2604e+00
2025-04-18 11:35:17,217 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.4885e+00, MaxNorm=4.4857e+00
2025-04-18 11:35:17,217 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.8865e-01, MaxNorm=1.3163e+00
2025-04-18 11:35:17,217 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.6407e-01, MaxNorm=8.5411e-01
2025-04-18 11:35:17,217 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=2.4086e+00, MaxNorm=2.4651e+00
2025-04-18 11:35:17,217 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.7432e+00, MaxNorm=6.8018e+00
2025-04-18 11:35:17,217 - INFO - --- End Gradient Check ---
2025-04-18 11:35:17,220 - INFO - Batch 2/13: Generated dummy data
2025-04-18 11:35:17,220 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4076, 3.8509]
2025-04-18 11:35:17,221 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6196, 3.3698]
2025-04-18 11:35:17,221 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,221 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,222 - INFO -   True actions shape: tensor([ 0.7344, -0.5621, -0.7640,  1.3489,  1.1091,  0.9972, -0.2773],
       device='cuda:0'), range: [-3.4076, 3.8509]
2025-04-18 11:35:17,222 - INFO -   Noise shape: tensor([ 0.9293, -0.1511,  1.7406, -0.1061,  0.2869, -0.5691, -0.5151],
       device='cuda:0'), range: [-3.2879, 3.5564]
2025-04-18 11:35:17,223 - INFO -   Noisy actions shape: tensor([ 1.1634, -0.3936,  1.1911,  0.5288,  0.7666, -0.0443, -0.5850],
       device='cuda:0'), range: [-3.2603, 3.3801]
2025-04-18 11:35:17,276 - INFO - Batch 3/13: Generated dummy data
2025-04-18 11:35:17,276 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3417, 3.1334]
2025-04-18 11:35:17,276 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9493, 3.3560]
2025-04-18 11:35:17,276 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,276 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,277 - INFO -   True actions shape: tensor([-1.3655,  0.7362, -0.7481, -0.0090,  0.2812, -1.5216,  0.2855],
       device='cuda:0'), range: [-4.3417, 3.1334]
2025-04-18 11:35:17,277 - INFO -   Noise shape: tensor([ 0.1300, -1.6514, -0.7744,  0.5610, -0.3770,  2.0489, -0.2449],
       device='cuda:0'), range: [-3.4509, 3.3411]
2025-04-18 11:35:17,278 - INFO -   Noisy actions shape: tensor([-1.3639,  0.7167, -0.7572, -0.0024,  0.2767, -1.4974,  0.2826],
       device='cuda:0'), range: [-4.3838, 3.5297]
2025-04-18 11:35:17,328 - INFO - Batch 4/13: Generated dummy data
2025-04-18 11:35:17,329 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3455, 3.4304]
2025-04-18 11:35:17,329 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9514, 2.8203]
2025-04-18 11:35:17,329 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,329 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,330 - INFO -   True actions shape: tensor([-0.1955, -0.2218,  0.0357,  0.2938,  2.6643,  1.4175, -0.7316],
       device='cuda:0'), range: [-3.3455, 3.4304]
2025-04-18 11:35:17,330 - INFO -   Noise shape: tensor([ 0.5876,  1.6731, -1.6888, -0.0872, -1.8820, -0.6029, -0.3206],
       device='cuda:0'), range: [-3.3379, 3.2688]
2025-04-18 11:35:17,331 - INFO -   Noisy actions shape: tensor([-0.0398,  0.2105, -0.3945,  0.2620,  2.0988,  1.2179, -0.7890],
       device='cuda:0'), range: [-3.3179, 3.7113]
2025-04-18 11:35:17,381 - INFO - Batch 5/13: Generated dummy data
2025-04-18 11:35:17,381 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.5040, 3.3778]
2025-04-18 11:35:17,381 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8283, 3.1437]
2025-04-18 11:35:17,382 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,382 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,382 - INFO -   True actions shape: tensor([ 0.5173,  1.0988, -0.9567,  1.6057,  0.6530, -0.3058, -0.9922],
       device='cuda:0'), range: [-4.5040, 3.3778]
2025-04-18 11:35:17,383 - INFO -   Noise shape: tensor([ 0.4090, -1.0128, -0.1062,  1.5405,  0.5992, -0.0521, -0.5277],
       device='cuda:0'), range: [-3.3122, 3.1314]
2025-04-18 11:35:17,384 - INFO -   Noisy actions shape: tensor([ 0.6074,  0.7897, -0.9505,  1.9577,  0.7889, -0.3086, -1.0968],
       device='cuda:0'), range: [-3.2832, 3.3822]
2025-04-18 11:35:17,434 - INFO - Batch 6/13: Generated dummy data
2025-04-18 11:35:17,434 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4202, 4.0709]
2025-04-18 11:35:17,434 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0431, 2.6374]
2025-04-18 11:35:17,434 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,434 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,435 - INFO -   True actions shape: tensor([ 1.3128e-01,  1.4564e+00,  7.1574e-04,  2.1246e-01, -1.4151e+00,
        -4.0527e-01, -1.5231e+00], device='cuda:0'), range: [-3.4202, 4.0709]
2025-04-18 11:35:17,436 - INFO -   Noise shape: tensor([-0.7015,  0.2166,  0.6727, -0.0493,  1.8723, -1.2418, -0.4209],
       device='cuda:0'), range: [-3.5038, 3.6836]
2025-04-18 11:35:17,436 - INFO -   Noisy actions shape: tensor([-0.0345,  1.4670,  0.1563,  0.1953, -0.9437, -0.6815, -1.5791],
       device='cuda:0'), range: [-3.5910, 3.7140]
2025-04-18 11:35:17,488 - INFO - Batch 7/13: Generated dummy data
2025-04-18 11:35:17,488 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6086, 3.5005]
2025-04-18 11:35:17,488 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8670, 3.3841]
2025-04-18 11:35:17,488 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,488 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,489 - INFO -   True actions shape: tensor([ 0.9859, -1.2828,  0.2161,  0.9035,  0.8460, -0.5355, -1.3977],
       device='cuda:0'), range: [-3.6086, 3.5005]
2025-04-18 11:35:17,489 - INFO -   Noise shape: tensor([ 0.4686,  0.0786, -0.1981,  0.1005,  0.2029,  1.0050,  3.4816],
       device='cuda:0'), range: [-2.8138, 3.4816]
2025-04-18 11:35:17,490 - INFO -   Noisy actions shape: tensor([ 0.5439, -0.0215, -0.1807,  0.1705,  0.2681,  0.9602,  3.3622],
       device='cuda:0'), range: [-3.7337, 3.5922]
2025-04-18 11:35:17,540 - INFO - Batch 8/13: Generated dummy data
2025-04-18 11:35:17,541 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4819, 3.5166]
2025-04-18 11:35:17,541 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4707, 3.5700]
2025-04-18 11:35:17,541 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,541 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,542 - INFO -   True actions shape: tensor([-0.3646,  0.1495, -0.9435,  0.5128,  0.8271, -0.9455,  0.1734],
       device='cuda:0'), range: [-3.4819, 3.5166]
2025-04-18 11:35:17,542 - INFO -   Noise shape: tensor([-0.9060,  0.0445, -0.8545, -0.9276,  1.3745,  0.8846,  3.3884],
       device='cuda:0'), range: [-3.7383, 4.3909]
2025-04-18 11:35:17,543 - INFO -   Noisy actions shape: tensor([-0.4658,  0.1536, -1.0351,  0.4033,  0.9789, -0.8381,  0.5599],
       device='cuda:0'), range: [-3.8129, 4.0017]
2025-04-18 11:35:17,593 - INFO - Batch 9/13: Generated dummy data
2025-04-18 11:35:17,593 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4944, 4.3194]
2025-04-18 11:35:17,593 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5729, 3.3624]
2025-04-18 11:35:17,594 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,594 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,594 - INFO -   True actions shape: tensor([-0.3490,  0.5290,  1.7322,  2.0201, -0.4449, -0.7545, -0.1888],
       device='cuda:0'), range: [-3.4944, 4.3194]
2025-04-18 11:35:17,595 - INFO -   Noise shape: tensor([ 1.1740,  1.3577, -2.1819, -0.1500,  0.0567, -0.7604,  1.5791],
       device='cuda:0'), range: [-3.6699, 3.6461]
2025-04-18 11:35:17,595 - INFO -   Noisy actions shape: tensor([ 0.4784,  1.2723, -0.0536,  1.4622, -0.3070, -1.0660,  0.8599],
       device='cuda:0'), range: [-3.3649, 3.4693]
2025-04-18 11:35:17,646 - INFO - Batch 10/13: Generated dummy data
2025-04-18 11:35:17,646 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1200, 3.5009]
2025-04-18 11:35:17,646 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0812, 3.3509]
2025-04-18 11:35:17,646 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,646 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,647 - INFO -   True actions shape: tensor([ 0.7187, -1.8156,  0.8900,  0.6052,  0.8459, -0.3805,  1.7820],
       device='cuda:0'), range: [-3.1200, 3.5009]
2025-04-18 11:35:17,648 - INFO -   Noise shape: tensor([ 1.2671, -0.7641,  2.0049, -0.0341,  0.4969, -0.3250,  1.3651],
       device='cuda:0'), range: [-3.1951, 3.4441]
2025-04-18 11:35:17,648 - INFO -   Noisy actions shape: tensor([ 1.4454, -1.6977,  2.1394,  0.3343,  0.9039, -0.4880,  2.1595],
       device='cuda:0'), range: [-2.9575, 3.3946]
2025-04-18 11:35:17,700 - INFO - Batch 11/13: Generated dummy data
2025-04-18 11:35:17,700 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9822, 3.2467]
2025-04-18 11:35:17,700 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8119, 3.6866]
2025-04-18 11:35:17,700 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,700 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,701 - INFO -   True actions shape: tensor([ 0.8213, -0.9250,  0.0995, -0.2147,  0.8083, -0.8827,  0.5541],
       device='cuda:0'), range: [-3.9822, 3.2467]
2025-04-18 11:35:17,702 - INFO -   Noise shape: tensor([-0.6347, -0.4840, -0.8164,  0.7487, -1.2217,  0.1341,  0.8848],
       device='cuda:0'), range: [-3.4090, 3.4063]
2025-04-18 11:35:17,702 - INFO -   Noisy actions shape: tensor([ 0.6242, -1.0200, -0.1200, -0.0089,  0.4562, -0.8158,  0.7685],
       device='cuda:0'), range: [-4.2891, 3.5353]
2025-04-18 11:35:17,750 - INFO -   Loss components:
2025-04-18 11:35:17,750 - INFO -     Diffusion loss: 3.602959 (coef: 1.0)
2025-04-18 11:35:17,750 - INFO -     Grasp quality loss: 0.694493 (coef: 0.5)
2025-04-18 11:35:17,750 - INFO -     Grasp rotation loss: 0.563632 (coef: 0.5)
2025-04-18 11:35:17,751 - INFO -     Grasp width loss: 4.419188 (coef: 0.005)
2025-04-18 11:35:17,751 - INFO -     TOTAL loss: 4.254118
2025-04-18 11:35:17,759 - INFO -   Gradients: avg norm: 0.889446, max norm: 6.990025, non-zero params: 250
2025-04-18 11:35:17,759 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-18 11:35:17,761 - INFO - Batch 12/13: Generated dummy data
2025-04-18 11:35:17,761 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3563, 3.2682]
2025-04-18 11:35:17,762 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9870, 3.3990]
2025-04-18 11:35:17,762 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,762 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,763 - INFO -   True actions shape: tensor([ 1.6037,  0.9054,  0.8597, -2.1491,  0.1132, -0.2229,  2.9194],
       device='cuda:0'), range: [-4.3563, 3.2682]
2025-04-18 11:35:17,763 - INFO -   Noise shape: tensor([-0.0507,  1.4251, -0.1721,  0.2277,  0.9914, -0.1453, -0.0591],
       device='cuda:0'), range: [-4.4197, 4.0019]
2025-04-18 11:35:17,764 - INFO -   Noisy actions shape: tensor([ 0.7580,  1.6869,  0.2808, -0.8775,  0.9152, -0.2373,  1.4087],
       device='cuda:0'), range: [-3.5748, 3.2344]
2025-04-18 11:35:17,814 - INFO - Batch 13/13: Generated dummy data
2025-04-18 11:35:17,814 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5820, 3.5859]
2025-04-18 11:35:17,814 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2780, 2.8957]
2025-04-18 11:35:17,814 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,814 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,815 - INFO -   True actions shape: tensor([-0.2403, -0.8844,  0.4088, -0.6294, -0.7489,  1.7302,  1.5127],
       device='cuda:0'), range: [-3.5820, 3.5859]
2025-04-18 11:35:17,815 - INFO -   Noise shape: tensor([-1.2765, -0.5201, -1.4841,  2.0782,  0.9578, -0.3160, -0.0816],
       device='cuda:0'), range: [-3.3289, 3.6829]
2025-04-18 11:35:17,816 - INFO -   Noisy actions shape: tensor([-0.4861, -0.9692,  0.1096, -0.2094, -0.5464,  1.6345,  1.4672],
       device='cuda:0'), range: [-3.8479, 3.6538]
2025-04-18 11:35:17,891 - INFO - 
=== Epoch 1 Summary ===
2025-04-18 11:35:17,891 - INFO -   Avg total loss: 4.126595
2025-04-18 11:35:17,891 - INFO -   Avg diffusion loss: 3.464885
2025-04-18 11:35:17,891 - INFO -   Avg grasp loss: 1.323419
2025-04-18 11:35:17,892 - INFO - 
=== EPOCH 2/20 ===
2025-04-18 11:35:17,893 - INFO - GPU Memory: 0.36GB allocated, 0.68GB reserved
2025-04-18 11:35:17,895 - INFO - Batch 1/13: Generated dummy data
2025-04-18 11:35:17,896 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6239, 3.4368]
2025-04-18 11:35:17,896 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2088, 3.0523]
2025-04-18 11:35:17,896 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,896 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,897 - INFO -   True actions shape: tensor([-0.7769, -1.2040, -0.9333, -0.5336, -0.4285, -0.6966, -2.3630],
       device='cuda:0'), range: [-3.6239, 3.4368]
2025-04-18 11:35:17,897 - INFO -   Noise shape: tensor([ 0.0527, -0.8773, -3.0649,  0.6286, -0.1121, -0.2457,  2.7015],
       device='cuda:0'), range: [-3.2693, 3.5132]
2025-04-18 11:35:17,898 - INFO -   Noisy actions shape: tensor([-0.0261, -0.9946, -3.1436,  0.5714, -0.1549, -0.3149,  2.4487],
       device='cuda:0'), range: [-3.3520, 4.2453]
2025-04-18 11:35:17,898 - INFO -   Diffusion: timestep range [51, 934], noise range [-3.2693, 3.5132]
2025-04-18 11:35:17,898 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3520, 4.2453]
2025-04-18 11:35:17,922 - INFO -   Model output shapes:
2025-04-18 11:35:17,922 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-18 11:35:17,922 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4602, 0.5569]
2025-04-18 11:35:17,922 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 0.9143
2025-04-18 11:35:17,923 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0640, 0.1734]
2025-04-18 11:35:17,947 - INFO -   Loss components:
2025-04-18 11:35:17,947 - INFO -     Diffusion loss: 2.987241 (coef: 1.0)
2025-04-18 11:35:17,947 - INFO -     Grasp quality loss: 0.692822 (coef: 0.5)
2025-04-18 11:35:17,947 - INFO -     Grasp rotation loss: 0.576995 (coef: 0.5)
2025-04-18 11:35:17,947 - INFO -     Grasp width loss: 4.293859 (coef: 0.005)
2025-04-18 11:35:17,947 - INFO -     TOTAL loss: 3.643619
2025-04-18 11:35:17,955 - INFO -   Gradients: avg norm: 0.759111, max norm: 6.132216, non-zero params: 250
2025-04-18 11:35:17,955 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-18 11:35:17,955 - INFO - --- Gradient Check @ Epoch 2, Batch 0 ---
2025-04-18 11:35:17,973 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-18 11:35:17,973 - INFO -   --- Gradient Stats by Component ---
2025-04-18 11:35:17,973 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.2817e+00, MaxNorm=5.6572e+00
2025-04-18 11:35:17,973 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=6.6473e-03, MaxNorm=1.1522e-02
2025-04-18 11:35:17,973 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.5401e-02, MaxNorm=4.5953e-02
2025-04-18 11:35:17,973 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.1152e-01, MaxNorm=2.4888e-01
2025-04-18 11:35:17,973 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.9284e+00, MaxNorm=3.5491e+00
2025-04-18 11:35:17,973 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.1218e+00, MaxNorm=3.8018e+00
2025-04-18 11:35:17,973 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.4004e-01, MaxNorm=1.0939e+00
2025-04-18 11:35:17,973 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.4671e-01, MaxNorm=7.1933e-01
2025-04-18 11:35:17,973 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9631e+00, MaxNorm=2.0688e+00
2025-04-18 11:35:17,973 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.3582e+00, MaxNorm=6.1322e+00
2025-04-18 11:35:17,973 - INFO - --- End Gradient Check ---
2025-04-18 11:35:17,976 - INFO - Batch 2/13: Generated dummy data
2025-04-18 11:35:17,976 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4789, 3.5952]
2025-04-18 11:35:17,976 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1424, 3.1113]
2025-04-18 11:35:17,976 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:17,976 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:17,977 - INFO -   True actions shape: tensor([ 1.0531,  0.5067,  0.7928,  1.4341, -0.0680,  1.0704, -0.4884],
       device='cuda:0'), range: [-3.4789, 3.5952]
2025-04-18 11:35:17,977 - INFO -   Noise shape: tensor([-0.4957, -1.5163, -1.5577,  1.5311,  1.4092,  1.4466,  1.4530],
       device='cuda:0'), range: [-3.3253, 3.4806]
2025-04-18 11:35:17,978 - INFO -   Noisy actions shape: tensor([ 0.4011, -0.7048, -0.5304,  2.0962,  0.9418,  1.7781,  0.6734],
       device='cuda:0'), range: [-3.3410, 3.6977]
2025-04-18 11:35:18,029 - INFO - Batch 3/13: Generated dummy data
2025-04-18 11:35:18,029 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8067, 3.2185]
2025-04-18 11:35:18,029 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7593, 3.2079]
2025-04-18 11:35:18,029 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,030 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,030 - INFO -   True actions shape: tensor([-0.4183,  1.0928,  0.3989,  1.7578, -0.5238, -0.5931, -0.8368],
       device='cuda:0'), range: [-3.8067, 3.2185]
2025-04-18 11:35:18,031 - INFO -   Noise shape: tensor([-1.4158,  0.2427,  0.2457, -1.1995, -1.5904, -0.0610, -1.4217],
       device='cuda:0'), range: [-3.6066, 3.9040]
2025-04-18 11:35:18,032 - INFO -   Noisy actions shape: tensor([-1.1688,  1.0276,  0.4672,  0.7210, -1.3567, -0.5162, -1.5113],
       device='cuda:0'), range: [-3.6526, 3.6164]
2025-04-18 11:35:18,083 - INFO - Batch 4/13: Generated dummy data
2025-04-18 11:35:18,083 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2474, 3.4130]
2025-04-18 11:35:18,083 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4971, 4.3220]
2025-04-18 11:35:18,083 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,083 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,084 - INFO -   True actions shape: tensor([ 1.7208, -0.3102, -0.1431, -1.3745,  0.5494, -0.8956, -0.2023],
       device='cuda:0'), range: [-3.2474, 3.4130]
2025-04-18 11:35:18,084 - INFO -   Noise shape: tensor([-0.0072,  0.4646,  0.2862, -0.3525,  1.3178, -0.7977,  1.3261],
       device='cuda:0'), range: [-3.7373, 3.2159]
2025-04-18 11:35:18,085 - INFO -   Noisy actions shape: tensor([ 0.9254,  0.2228,  0.1632, -1.0404,  1.4054, -1.1555,  1.0056],
       device='cuda:0'), range: [-3.4159, 3.3280]
2025-04-18 11:35:18,135 - INFO - Batch 5/13: Generated dummy data
2025-04-18 11:35:18,136 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4051, 3.1691]
2025-04-18 11:35:18,136 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1555, 3.1069]
2025-04-18 11:35:18,136 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,136 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,137 - INFO -   True actions shape: tensor([-0.3761,  0.2415,  0.6593, -0.0565, -0.3440, -0.7092, -1.9156],
       device='cuda:0'), range: [-3.4051, 3.1691]
2025-04-18 11:35:18,137 - INFO -   Noise shape: tensor([ 1.0482,  0.3134, -0.7825,  0.1507, -1.0261, -0.6366,  1.5389],
       device='cuda:0'), range: [-3.6241, 3.0694]
2025-04-18 11:35:18,138 - INFO -   Noisy actions shape: tensor([ 0.7496,  0.3901, -0.3822,  0.1066, -1.0677, -0.8948,  0.4616],
       device='cuda:0'), range: [-3.0374, 3.5610]
2025-04-18 11:35:18,189 - INFO - Batch 6/13: Generated dummy data
2025-04-18 11:35:18,189 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4143, 3.5191]
2025-04-18 11:35:18,189 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4216, 2.9631]
2025-04-18 11:35:18,189 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,189 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,190 - INFO -   True actions shape: tensor([ 4.1059e-02, -7.6859e-01, -7.3903e-01,  1.6614e-03, -6.9078e-01,
         8.8551e-01, -1.7276e+00], device='cuda:0'), range: [-3.4143, 3.5191]
2025-04-18 11:35:18,190 - INFO -   Noise shape: tensor([ 1.5373,  0.5413,  0.6824,  0.9986,  0.5535,  0.1727, -0.0910],
       device='cuda:0'), range: [-3.7693, 3.3128]
2025-04-18 11:35:18,191 - INFO -   Noisy actions shape: tensor([ 1.4994,  0.3335,  0.4775,  0.9678,  0.3647,  0.3872, -0.5171],
       device='cuda:0'), range: [-3.5740, 4.0826]
2025-04-18 11:35:18,241 - INFO - Batch 7/13: Generated dummy data
2025-04-18 11:35:18,242 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5451, 3.2692]
2025-04-18 11:35:18,242 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4296, 3.0065]
2025-04-18 11:35:18,242 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,242 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,243 - INFO -   True actions shape: tensor([ 0.8996, -0.1241, -1.2317, -1.1281,  0.3582, -0.1235,  0.8868],
       device='cuda:0'), range: [-3.5451, 3.2692]
2025-04-18 11:35:18,243 - INFO -   Noise shape: tensor([-0.8593,  0.9863, -1.3580, -1.2096,  0.5174,  0.8733, -0.1828],
       device='cuda:0'), range: [-4.0648, 3.9020]
2025-04-18 11:35:18,244 - INFO -   Noisy actions shape: tensor([-0.1398,  0.7102, -1.8264, -1.6456,  0.6286,  0.6205,  0.3910],
       device='cuda:0'), range: [-3.7361, 3.4420]
2025-04-18 11:35:18,294 - INFO - Batch 8/13: Generated dummy data
2025-04-18 11:35:18,294 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4573, 3.9419]
2025-04-18 11:35:18,295 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8222, 3.1421]
2025-04-18 11:35:18,295 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,295 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,295 - INFO -   True actions shape: tensor([-0.7969,  0.9921, -0.7860,  0.7791, -0.2319, -0.2969, -1.8532],
       device='cuda:0'), range: [-3.4573, 3.9419]
2025-04-18 11:35:18,296 - INFO -   Noise shape: tensor([-0.4378, -1.5413,  1.1844,  0.1688,  1.4564, -0.7098,  0.2754],
       device='cuda:0'), range: [-3.2418, 4.1394]
2025-04-18 11:35:18,297 - INFO -   Noisy actions shape: tensor([-0.8853,  0.5408, -0.4384,  0.7958,  0.1685, -0.4770, -1.7108],
       device='cuda:0'), range: [-3.3723, 3.6021]
2025-04-18 11:35:18,347 - INFO - Batch 9/13: Generated dummy data
2025-04-18 11:35:18,347 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2961, 3.2999]
2025-04-18 11:35:18,347 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4231, 2.9501]
2025-04-18 11:35:18,347 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,347 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,348 - INFO -   True actions shape: tensor([-0.6551, -0.3894, -1.1234, -1.1591,  1.1160,  0.7797,  1.2615],
       device='cuda:0'), range: [-3.2961, 3.2999]
2025-04-18 11:35:18,349 - INFO -   Noise shape: tensor([-1.1847, -0.9036,  1.3468, -0.7139,  0.8721, -1.3651,  0.9995],
       device='cuda:0'), range: [-3.5583, 3.3348]
2025-04-18 11:35:18,349 - INFO -   Noisy actions shape: tensor([-1.3450, -0.9620,  0.4456, -1.2539,  1.3577, -0.6599,  1.5459],
       device='cuda:0'), range: [-3.3885, 3.3361]
2025-04-18 11:35:18,399 - INFO - Batch 10/13: Generated dummy data
2025-04-18 11:35:18,399 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0523, 3.6116]
2025-04-18 11:35:18,400 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8537, 3.6933]
2025-04-18 11:35:18,400 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,400 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,400 - INFO -   True actions shape: tensor([-0.6701,  0.0105, -0.4964,  1.2626, -1.0025, -1.2742, -0.5112],
       device='cuda:0'), range: [-3.0523, 3.6116]
2025-04-18 11:35:18,401 - INFO -   Noise shape: tensor([-0.5373, -0.3380, -0.2787, -0.4734, -0.2401,  1.0816, -0.0738],
       device='cuda:0'), range: [-3.2120, 4.0795]
2025-04-18 11:35:18,402 - INFO -   Noisy actions shape: tensor([-0.8025, -0.0936, -0.5579,  1.0568, -1.0279, -0.8815, -0.5092],
       device='cuda:0'), range: [-3.1753, 3.3782]
2025-04-18 11:35:18,453 - INFO - Batch 11/13: Generated dummy data
2025-04-18 11:35:18,453 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6589, 3.2167]
2025-04-18 11:35:18,454 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8438, 3.4956]
2025-04-18 11:35:18,454 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,454 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,455 - INFO -   True actions shape: tensor([-1.2295,  1.8045, -0.6846,  0.6243,  0.3040,  1.3727,  0.0061],
       device='cuda:0'), range: [-3.6589, 3.2167]
2025-04-18 11:35:18,455 - INFO -   Noise shape: tensor([ 1.2598, -2.0476, -0.0392, -0.0728, -0.9656, -0.3317, -0.1724],
       device='cuda:0'), range: [-3.0858, 3.6192]
2025-04-18 11:35:18,456 - INFO -   Noisy actions shape: tensor([ 0.0103, -0.1547, -0.5147,  0.3931, -0.4621,  0.7437, -0.1168],
       device='cuda:0'), range: [-3.5084, 3.4848]
2025-04-18 11:35:18,505 - INFO -   Loss components:
2025-04-18 11:35:18,505 - INFO -     Diffusion loss: 3.076929 (coef: 1.0)
2025-04-18 11:35:18,505 - INFO -     Grasp quality loss: 0.698733 (coef: 0.5)
2025-04-18 11:35:18,505 - INFO -     Grasp rotation loss: 0.578180 (coef: 0.5)
2025-04-18 11:35:18,505 - INFO -     Grasp width loss: 3.511720 (coef: 0.005)
2025-04-18 11:35:18,505 - INFO -     TOTAL loss: 3.732944
2025-04-18 11:35:18,513 - INFO -   Gradients: avg norm: 0.779265, max norm: 6.476150, non-zero params: 250
2025-04-18 11:35:18,513 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-18 11:35:18,516 - INFO - Batch 12/13: Generated dummy data
2025-04-18 11:35:18,516 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5888, 3.2483]
2025-04-18 11:35:18,516 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.3438, 3.6141]
2025-04-18 11:35:18,516 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,516 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,517 - INFO -   True actions shape: tensor([ 0.2932,  0.9095, -0.9234,  0.9879,  0.3383,  0.0238,  0.1209],
       device='cuda:0'), range: [-3.5888, 3.2483]
2025-04-18 11:35:18,517 - INFO -   Noise shape: tensor([ 1.6633, -0.4057,  2.2370, -0.2046,  0.5935,  0.2370,  0.0078],
       device='cuda:0'), range: [-3.2475, 3.7419]
2025-04-18 11:35:18,518 - INFO -   Noisy actions shape: tensor([1.4506, 0.2873, 1.0898, 0.4908, 0.6704, 0.1950, 0.0850],
       device='cuda:0'), range: [-3.2264, 3.6794]
2025-04-18 11:35:18,569 - INFO - Batch 13/13: Generated dummy data
2025-04-18 11:35:18,569 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4450, 3.5264]
2025-04-18 11:35:18,569 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0172, 3.7040]
2025-04-18 11:35:18,569 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,569 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,570 - INFO -   True actions shape: tensor([ 0.3185, -1.0996, -1.2538,  1.4516, -1.2158,  0.2982,  0.5845],
       device='cuda:0'), range: [-3.4450, 3.5264]
2025-04-18 11:35:18,571 - INFO -   Noise shape: tensor([-1.1343, -0.7013,  0.8533,  1.3167,  0.7589,  1.4385,  0.0500],
       device='cuda:0'), range: [-3.3467, 3.4438]
2025-04-18 11:35:18,571 - INFO -   Noisy actions shape: tensor([-1.0324, -0.9327,  0.5463,  1.6120,  0.4629,  1.4686,  0.1814],
       device='cuda:0'), range: [-3.6224, 3.3809]
2025-04-18 11:35:18,620 - INFO - 
=== Epoch 2 Summary ===
2025-04-18 11:35:18,620 - INFO -   Avg total loss: 3.693870
2025-04-18 11:35:18,620 - INFO -   Avg diffusion loss: 3.037638
2025-04-18 11:35:18,620 - INFO -   Avg grasp loss: 1.312465
2025-04-18 11:35:18,620 - INFO - 
=== EPOCH 3/20 ===
2025-04-18 11:35:18,621 - INFO - GPU Memory: 0.36GB allocated, 0.68GB reserved
2025-04-18 11:35:18,624 - INFO - Batch 1/13: Generated dummy data
2025-04-18 11:35:18,624 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4665, 3.2245]
2025-04-18 11:35:18,624 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2246, 4.0553]
2025-04-18 11:35:18,624 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,624 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,625 - INFO -   True actions shape: tensor([ 1.8156,  0.8990, -0.0151,  0.1007, -0.7542, -0.5374,  2.1253],
       device='cuda:0'), range: [-3.4665, 3.2245]
2025-04-18 11:35:18,626 - INFO -   Noise shape: tensor([-0.1403, -1.0307, -0.7237,  1.0141, -1.2287,  0.7755, -1.3351],
       device='cuda:0'), range: [-3.7529, 3.4498]
2025-04-18 11:35:18,626 - INFO -   Noisy actions shape: tensor([-0.0582, -0.9890, -0.7236,  1.0176, -1.2615,  0.7505, -1.2377],
       device='cuda:0'), range: [-3.3562, 3.6861]
2025-04-18 11:35:18,626 - INFO -   Diffusion: timestep range [45, 970], noise range [-3.7529, 3.4498]
2025-04-18 11:35:18,626 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3562, 3.6861]
2025-04-18 11:35:18,651 - INFO -   Model output shapes:
2025-04-18 11:35:18,651 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-18 11:35:18,651 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4525, 0.5532]
2025-04-18 11:35:18,651 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 0.9210
2025-04-18 11:35:18,651 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0489, 0.1437]
2025-04-18 11:35:18,675 - INFO -   Loss components:
2025-04-18 11:35:18,675 - INFO -     Diffusion loss: 2.721145 (coef: 1.0)
2025-04-18 11:35:18,675 - INFO -     Grasp quality loss: 0.696685 (coef: 0.5)
2025-04-18 11:35:18,675 - INFO -     Grasp rotation loss: 0.584200 (coef: 0.5)
2025-04-18 11:35:18,675 - INFO -     Grasp width loss: 3.447844 (coef: 0.005)
2025-04-18 11:35:18,675 - INFO -     TOTAL loss: 3.378827
2025-04-18 11:35:18,685 - INFO -   Gradients: avg norm: 0.644031, max norm: 4.926764, non-zero params: 250
2025-04-18 11:35:18,685 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-18 11:35:18,685 - INFO - --- Gradient Check @ Epoch 3, Batch 0 ---
2025-04-18 11:35:18,702 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-18 11:35:18,702 - INFO -   --- Gradient Stats by Component ---
2025-04-18 11:35:18,702 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.0835e+00, MaxNorm=4.6037e+00
2025-04-18 11:35:18,702 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.5644e-02, MaxNorm=3.6523e-02
2025-04-18 11:35:18,702 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=3.2859e-02, MaxNorm=6.5405e-02
2025-04-18 11:35:18,702 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=6.9997e-02, MaxNorm=1.5224e-01
2025-04-18 11:35:18,702 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.8305e+00, MaxNorm=3.4466e+00
2025-04-18 11:35:18,702 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.8274e+00, MaxNorm=3.2371e+00
2025-04-18 11:35:18,702 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.9796e-01, MaxNorm=8.9665e-01
2025-04-18 11:35:18,702 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.5505e-01, MaxNorm=5.6849e-01
2025-04-18 11:35:18,702 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7000e+00, MaxNorm=1.7933e+00
2025-04-18 11:35:18,702 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.7221e+00, MaxNorm=4.9268e+00
2025-04-18 11:35:18,702 - INFO - --- End Gradient Check ---
2025-04-18 11:35:18,705 - INFO - Batch 2/13: Generated dummy data
2025-04-18 11:35:18,705 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4610, 3.6737]
2025-04-18 11:35:18,705 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8593, 2.9248]
2025-04-18 11:35:18,705 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,705 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,706 - INFO -   True actions shape: tensor([ 0.1045, -2.5389, -1.6449, -0.2015, -1.0332,  1.5510,  1.1105],
       device='cuda:0'), range: [-3.4610, 3.6737]
2025-04-18 11:35:18,707 - INFO -   Noise shape: tensor([-0.2137,  0.4335, -0.3688,  0.6627, -1.0806, -0.0610,  0.5948],
       device='cuda:0'), range: [-3.0706, 3.7067]
2025-04-18 11:35:18,707 - INFO -   Noisy actions shape: tensor([ 0.0207, -2.2136, -1.6676,  0.0501, -1.3525,  1.4254,  1.2500],
       device='cuda:0'), range: [-3.0907, 3.5949]
2025-04-18 11:35:18,758 - INFO - Batch 3/13: Generated dummy data
2025-04-18 11:35:18,758 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5145, 3.7389]
2025-04-18 11:35:18,758 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0492, 2.9685]
2025-04-18 11:35:18,759 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,759 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,759 - INFO -   True actions shape: tensor([ 0.1460, -1.3432,  0.3876,  0.7910, -0.7747,  0.3983,  0.0856],
       device='cuda:0'), range: [-3.5145, 3.7389]
2025-04-18 11:35:18,760 - INFO -   Noise shape: tensor([-0.5512,  0.7032,  0.9266,  1.2238, -1.0014, -2.1749,  0.4322],
       device='cuda:0'), range: [-3.7461, 3.0931]
2025-04-18 11:35:18,760 - INFO -   Noisy actions shape: tensor([ 0.0457, -1.1967,  0.5462,  0.9960, -0.9405,  0.0052,  0.1611],
       device='cuda:0'), range: [-3.1518, 3.8278]
2025-04-18 11:35:18,810 - INFO - Batch 4/13: Generated dummy data
2025-04-18 11:35:18,811 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4946, 3.4703]
2025-04-18 11:35:18,811 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0955, 2.8911]
2025-04-18 11:35:18,811 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,811 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,812 - INFO -   True actions shape: tensor([ 0.5601,  0.5846,  0.1663,  0.4065, -1.3392,  0.2580, -2.0446],
       device='cuda:0'), range: [-3.4946, 3.4703]
2025-04-18 11:35:18,812 - INFO -   Noise shape: tensor([-1.5724,  1.4474,  0.1166,  2.6028,  0.5761, -1.7909,  0.6579],
       device='cuda:0'), range: [-3.8919, 3.3225]
2025-04-18 11:35:18,813 - INFO -   Noisy actions shape: tensor([-0.3621,  1.2649,  0.2029,  1.7287, -0.8276, -0.7342, -1.3814],
       device='cuda:0'), range: [-3.6949, 3.3324]
2025-04-18 11:35:18,863 - INFO - Batch 5/13: Generated dummy data
2025-04-18 11:35:18,863 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7792, 3.8452]
2025-04-18 11:35:18,863 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0781, 3.6312]
2025-04-18 11:35:18,863 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,863 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,864 - INFO -   True actions shape: tensor([ 0.5103, -0.3633,  1.6138, -0.2018,  1.0175,  0.5543, -1.3763],
       device='cuda:0'), range: [-3.7792, 3.8452]
2025-04-18 11:35:18,865 - INFO -   Noise shape: tensor([-1.6926,  0.3545, -0.1116,  0.4819,  0.0383,  0.8918,  0.4522],
       device='cuda:0'), range: [-2.9819, 3.3304]
2025-04-18 11:35:18,865 - INFO -   Noisy actions shape: tensor([-0.8017, -0.0173,  1.0886,  0.1874,  0.7615,  1.0171, -0.6816],
       device='cuda:0'), range: [-3.4464, 3.2983]
2025-04-18 11:35:18,916 - INFO - Batch 6/13: Generated dummy data
2025-04-18 11:35:18,916 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7214, 3.1710]
2025-04-18 11:35:18,916 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1812, 3.5388]
2025-04-18 11:35:18,917 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-18 11:35:18,917 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-18 11:35:18,917 - INFO -   True actions shape: tensor([ 1.7272, -0.3130, -0.3897, -0.0477, -0.0074, -1.6333,  1.2596],
       device='cuda:0'), range: [-3.7214, 3.1710]
2025-04-18 11:35:18,918 - INFO -   Noise shape: tensor([-2.0038,  1.3894,  0.1690, -0.1682,  0.0957, -1.7935, -0.2379],
       device='cuda:0'), range: [-3.2392, 3.7281]
2025-04-18 11:35:18,919 - INFO -   Noisy actions shape: tensor([-1.6766,  1.3148,  0.0994, -0.1739,  0.0930, -2.0479, -0.0175],
       device='cuda:0'), range: [-3.4060, 3.7940]
