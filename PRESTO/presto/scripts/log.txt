2025-04-13 12:50:47,527 - INFO - --- Logging Initialized ---

2025-04-13 12:50:50,049 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,050 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,051 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,236 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,239 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,242 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,243 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,376 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,377 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,386 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,387 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,387 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,388 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,390 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,391 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,392 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,433 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,435 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,436 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,670 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,672 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,787 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:50:50,787 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:50:50,892 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,893 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,894 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,894 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,895 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,896 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,899 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-13 12:50:50,899 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,900 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,902 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,903 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,904 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,905 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,907 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,908 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,909 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,910 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:50,916 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,032 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,039 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,040 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,042 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,160 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,169 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,170 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,174 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,182 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,182 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,188 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,189 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,190 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,191 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,191 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,193 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,194 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,194 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,196 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,196 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,197 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,198 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,203 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,208 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,209 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,211 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,212 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,213 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,213 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,214 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,214 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,219 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,220 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,221 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,222 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,223 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,223 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,224 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,226 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,227 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,231 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,232 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,236 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,238 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,426 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,427 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,428 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-13 12:50:51,984 - INFO - Starting training loop with: epochs=20, batch_size=8
2025-04-13 12:50:51,984 - INFO - Loss coefficients: diffusion=1.0, grasp=0.5, tsdf=0.0, collision=0.0, distance=0.0, euclidean=0.0
2025-04-13 12:50:51,984 - INFO - Model settings: seq_len=50, obs_dim=7, cond_dim=104, tsdf_dim=32, num_grasp_points=64, num_tsdf_points=32
2025-04-13 12:50:52,011 - INFO - 
=== EPOCH 1/20 ===
2025-04-13 12:50:52,012 - INFO - GPU Memory: 0.06GB allocated, 0.08GB reserved
2025-04-13 12:50:52,015 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:52,024 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1022, 3.4113]
2025-04-13 12:50:52,024 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8243, 3.0379]
2025-04-13 12:50:52,034 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,034 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,083 - INFO -   True actions shape: tensor([ 1.1824, -0.1533,  0.8399, -1.0945,  0.7079,  1.0322,  0.3827],
       device='cuda:0'), range: [-4.1022, 3.4113]
2025-04-13 12:50:52,084 - INFO -   Noise shape: tensor([-1.2504,  1.1919,  1.5725,  1.1328,  1.0361, -0.3528, -0.2566],
       device='cuda:0'), range: [-3.5705, 3.4932]
2025-04-13 12:50:52,084 - INFO -   Noisy actions shape: tensor([ 1.0659, -0.0462,  0.9772, -0.9888,  0.7977,  0.9965,  0.3582],
       device='cuda:0'), range: [-4.1060, 3.0751]
2025-04-13 12:50:52,085 - INFO -   Diffusion: timestep range [49, 889], noise range [-3.5705, 3.4932]
2025-04-13 12:50:52,085 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.1060, 3.0751]
2025-04-13 12:50:52,529 - INFO -   Model output shapes:
2025-04-13 12:50:52,529 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:52,532 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.2892, 0.5144]
2025-04-13 12:50:52,532 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.1989
2025-04-13 12:50:52,532 - INFO -     Grasp width: torch.Size([8, 64]), range: [-1.5266, -0.6429]
2025-04-13 12:50:52,652 - INFO -   Loss components:
2025-04-13 12:50:52,653 - INFO -     Diffusion loss: 3.773811 (coef: 1.0)
2025-04-13 12:50:52,653 - INFO -     Grasp quality loss: 0.719963 (coef: 0.5)
2025-04-13 12:50:52,653 - INFO -     Grasp rotation loss: 0.580831 (coef: 0.5)
2025-04-13 12:50:52,653 - INFO -     Grasp width loss: 2065.374023 (coef: 0.005)
2025-04-13 12:50:52,653 - INFO -     TOTAL loss: 14.751078
2025-04-13 12:50:52,661 - INFO -   Gradients: avg norm: 5.450196, max norm: 89.682930, non-zero params: 250
2025-04-13 12:50:52,661 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:50:52,661 - INFO - --- Gradient Check @ Epoch 1, Batch 0 ---
2025-04-13 12:50:52,683 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:52,683 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:52,683 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.2694e+00, MaxNorm=5.0783e+00
2025-04-13 12:50:52,683 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=9.6720e-02, MaxNorm=2.3501e-01
2025-04-13 12:50:52,683 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.4609e-02, MaxNorm=3.3676e-02
2025-04-13 12:50:52,683 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.9758e+01, MaxNorm=8.2489e+01
2025-04-13 12:50:52,683 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.2486e+00, MaxNorm=4.0999e+00
2025-04-13 12:50:52,683 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.4554e+00, MaxNorm=4.4203e+00
2025-04-13 12:50:52,683 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.8285e-01, MaxNorm=1.2965e+00
2025-04-13 12:50:52,683 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=8.0358e+01, MaxNorm=8.9683e+01
2025-04-13 12:50:52,683 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=2.1175e+00, MaxNorm=2.2383e+00
2025-04-13 12:50:52,683 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.4654e+00, MaxNorm=6.2471e+00
2025-04-13 12:50:52,683 - INFO - --- End Gradient Check ---
2025-04-13 12:50:52,686 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:52,686 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1628, 3.7521]
2025-04-13 12:50:52,686 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7938, 2.8553]
2025-04-13 12:50:52,687 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,687 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,687 - INFO -   True actions shape: tensor([-0.1082, -1.8512, -1.9008, -0.1962, -0.5353,  0.6570,  0.2339],
       device='cuda:0'), range: [-3.1628, 3.7521]
2025-04-13 12:50:52,688 - INFO -   Noise shape: tensor([ 0.8205, -1.6013, -1.6595, -0.4076,  2.4357, -0.1176,  2.0638],
       device='cuda:0'), range: [-3.1821, 3.3908]
2025-04-13 12:50:52,689 - INFO -   Noisy actions shape: tensor([ 0.2949, -2.3899, -2.4611, -0.3664,  0.6870,  0.5221,  1.1869],
       device='cuda:0'), range: [-3.4264, 3.5877]
2025-04-13 12:50:52,731 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:52,731 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5973, 3.1751]
2025-04-13 12:50:52,731 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9602, 3.1978]
2025-04-13 12:50:52,731 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,731 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,732 - INFO -   True actions shape: tensor([ 0.6714, -0.2945,  0.6714,  0.8389,  0.0424, -0.4360,  1.4225],
       device='cuda:0'), range: [-3.5973, 3.1751]
2025-04-13 12:50:52,733 - INFO -   Noise shape: tensor([ 1.3414,  0.7466,  0.4803, -2.0647, -1.8311, -0.5705, -1.3493],
       device='cuda:0'), range: [-3.1976, 3.7185]
2025-04-13 12:50:52,733 - INFO -   Noisy actions shape: tensor([ 0.7847, -0.2290,  0.7104,  0.6576, -0.1157, -0.4836,  1.3008],
       device='cuda:0'), range: [-3.2287, 3.4486]
2025-04-13 12:50:52,777 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:52,777 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3890, 3.8063]
2025-04-13 12:50:52,777 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1546, 3.0278]
2025-04-13 12:50:52,777 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,778 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,778 - INFO -   True actions shape: tensor([ 1.1471,  1.2454, -0.6262,  0.9082, -1.1647, -1.7677, -1.1422],
       device='cuda:0'), range: [-3.3890, 3.8063]
2025-04-13 12:50:52,779 - INFO -   Noise shape: tensor([-1.1993,  0.9367, -1.1331, -1.6392, -1.3045, -0.1050,  0.8600],
       device='cuda:0'), range: [-3.1641, 3.7349]
2025-04-13 12:50:52,780 - INFO -   Noisy actions shape: tensor([ 0.1131,  1.5564, -1.2065, -0.3520, -1.7299, -1.4250, -0.3267],
       device='cuda:0'), range: [-3.1158, 3.6055]
2025-04-13 12:50:52,823 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:52,823 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2690, 3.9126]
2025-04-13 12:50:52,823 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3964, 3.4617]
2025-04-13 12:50:52,823 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,823 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,824 - INFO -   True actions shape: tensor([-0.2312,  0.4148,  1.1768, -1.5401,  2.1973, -1.1582, -0.1613],
       device='cuda:0'), range: [-3.2690, 3.9126]
2025-04-13 12:50:52,825 - INFO -   Noise shape: tensor([ 0.8513,  2.1362, -0.0344,  1.0039, -1.2427,  0.0631, -0.0228],
       device='cuda:0'), range: [-3.1103, 3.5795]
2025-04-13 12:50:52,825 - INFO -   Noisy actions shape: tensor([ 0.7071,  2.1394,  0.3997,  0.3690, -0.3501, -0.3661, -0.0804],
       device='cuda:0'), range: [-3.3638, 3.9431]
2025-04-13 12:50:52,867 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:52,867 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6160, 3.5809]
2025-04-13 12:50:52,867 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3144, 3.4988]
2025-04-13 12:50:52,867 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,867 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,868 - INFO -   True actions shape: tensor([ 0.5648, -1.5667,  0.8265, -0.1067,  0.6868,  0.7985,  1.4279],
       device='cuda:0'), range: [-3.6160, 3.5809]
2025-04-13 12:50:52,869 - INFO -   Noise shape: tensor([ 0.2445, -0.5708,  0.1334,  0.3780,  0.1554,  1.1022,  0.5211],
       device='cuda:0'), range: [-3.5741, 3.9020]
2025-04-13 12:50:52,869 - INFO -   Noisy actions shape: tensor([ 0.3617, -0.8986,  0.3104,  0.3456,  0.3013,  1.2497,  0.8199],
       device='cuda:0'), range: [-2.9247, 3.3763]
2025-04-13 12:50:52,911 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:52,911 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6261, 3.5409]
2025-04-13 12:50:52,911 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2758, 2.7170]
2025-04-13 12:50:52,911 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,911 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,912 - INFO -   True actions shape: tensor([-0.9450, -0.4713,  0.8671, -1.1294,  0.1941,  1.1138,  1.1027],
       device='cuda:0'), range: [-3.6261, 3.5409]
2025-04-13 12:50:52,912 - INFO -   Noise shape: tensor([ 0.2722,  0.6647, -0.9492,  0.9748, -0.2789, -0.2394,  0.3622],
       device='cuda:0'), range: [-3.8876, 4.2559]
2025-04-13 12:50:52,913 - INFO -   Noisy actions shape: tensor([-0.6622, -0.0531,  0.2411, -0.4512,  0.0192,  0.8232,  1.1290],
       device='cuda:0'), range: [-3.5275, 4.3353]
2025-04-13 12:50:52,954 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:52,955 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0587, 3.4897]
2025-04-13 12:50:52,955 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7993, 3.0116]
2025-04-13 12:50:52,955 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,955 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,956 - INFO -   True actions shape: tensor([ 1.2229, -2.2668,  1.5921, -0.2760, -1.8180,  0.4968, -1.2544],
       device='cuda:0'), range: [-3.0587, 3.4897]
2025-04-13 12:50:52,956 - INFO -   Noise shape: tensor([ 1.3823,  1.2856,  1.1540, -0.7008, -0.0947,  1.3772, -0.6125],
       device='cuda:0'), range: [-3.6419, 5.0443]
2025-04-13 12:50:52,957 - INFO -   Noisy actions shape: tensor([ 1.2687, -2.2223,  1.6300, -0.2994, -1.8202,  0.5428, -1.2742],
       device='cuda:0'), range: [-3.8419, 3.6440]
2025-04-13 12:50:52,998 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:52,998 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9345, 3.6172]
2025-04-13 12:50:52,998 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1214, 3.5630]
2025-04-13 12:50:52,998 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:52,998 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:52,999 - INFO -   True actions shape: tensor([-0.3704, -0.5696, -0.0699,  0.8221,  2.0093,  1.3220,  0.2439],
       device='cuda:0'), range: [-3.9345, 3.6172]
2025-04-13 12:50:53,000 - INFO -   Noise shape: tensor([ 0.8558,  0.9268, -0.0251,  0.2504, -1.3574,  0.1201, -0.1460],
       device='cuda:0'), range: [-3.5543, 3.7889]
2025-04-13 12:50:53,000 - INFO -   Noisy actions shape: tensor([-0.2910, -0.4829, -0.0719,  0.8415,  1.8775,  1.3274,  0.2296],
       device='cuda:0'), range: [-3.4665, 3.7365]
2025-04-13 12:50:53,042 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:53,042 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0430, 3.7727]
2025-04-13 12:50:53,042 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1173, 2.8333]
2025-04-13 12:50:53,042 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,042 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,043 - INFO -   True actions shape: tensor([ 1.4217, -0.6906, -0.2390, -1.3769, -0.0051, -0.5878, -1.1791],
       device='cuda:0'), range: [-3.0430, 3.7727]
2025-04-13 12:50:53,043 - INFO -   Noise shape: tensor([ 0.4382, -0.0598,  2.1414, -0.7311, -0.3060, -0.9635,  0.6368],
       device='cuda:0'), range: [-3.4664, 3.4953]
2025-04-13 12:50:53,044 - INFO -   Noisy actions shape: tensor([ 1.4764, -0.6904,  0.1389, -1.4835, -0.0585, -0.7471, -1.0497],
       device='cuda:0'), range: [-3.2198, 3.7546]
2025-04-13 12:50:53,085 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:53,086 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9906, 3.8552]
2025-04-13 12:50:53,086 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0914, 3.2437]
2025-04-13 12:50:53,086 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,086 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,086 - INFO -   True actions shape: tensor([ 0.9541, -0.2686, -0.0274, -0.8830,  0.1423, -0.1579, -0.1700],
       device='cuda:0'), range: [-3.9906, 3.8552]
2025-04-13 12:50:53,087 - INFO -   Noise shape: tensor([-2.1814, -0.5921,  0.2989,  0.6732,  0.8005,  1.8254, -0.4402],
       device='cuda:0'), range: [-3.8113, 3.4172]
2025-04-13 12:50:53,088 - INFO -   Noisy actions shape: tensor([-0.4548, -0.5575,  0.1474, -0.3439,  0.5721,  0.9076, -0.3900],
       device='cuda:0'), range: [-4.5208, 4.2999]
2025-04-13 12:50:53,126 - INFO -   Loss components:
2025-04-13 12:50:53,127 - INFO -     Diffusion loss: 3.093989 (coef: 1.0)
2025-04-13 12:50:53,127 - INFO -     Grasp quality loss: 0.696329 (coef: 0.5)
2025-04-13 12:50:53,127 - INFO -     Grasp rotation loss: 0.591503 (coef: 0.5)
2025-04-13 12:50:53,127 - INFO -     Grasp width loss: 626.888367 (coef: 0.005)
2025-04-13 12:50:53,127 - INFO -     TOTAL loss: 6.872347
2025-04-13 12:50:53,134 - INFO -   Gradients: avg norm: 3.225048, max norm: 49.470367, non-zero params: 250
2025-04-13 12:50:53,134 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:50:53,137 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:53,137 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2439, 3.7710]
2025-04-13 12:50:53,137 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1068, 3.8205]
2025-04-13 12:50:53,137 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,137 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,138 - INFO -   True actions shape: tensor([-0.6038,  1.1353,  1.5497, -0.0629, -0.2323,  0.6991, -0.9777],
       device='cuda:0'), range: [-3.2439, 3.7710]
2025-04-13 12:50:53,139 - INFO -   Noise shape: tensor([-2.3176,  0.8391, -0.2639, -0.8379, -0.7974,  0.0577, -0.0494],
       device='cuda:0'), range: [-3.3887, 3.5404]
2025-04-13 12:50:53,139 - INFO -   Noisy actions shape: tensor([-2.0148,  1.4035,  0.9605, -0.6142, -0.7113,  0.5531, -0.7523],
       device='cuda:0'), range: [-3.3661, 3.7884]
2025-04-13 12:50:53,181 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:53,181 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7371, 3.7276]
2025-04-13 12:50:53,181 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6531, 2.7061]
2025-04-13 12:50:53,181 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,181 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,182 - INFO -   True actions shape: tensor([ 0.4894,  0.9310,  0.6660, -0.7496, -0.1266,  0.8057, -1.1468],
       device='cuda:0'), range: [-3.7371, 3.7276]
2025-04-13 12:50:53,182 - INFO -   Noise shape: tensor([-1.2054,  0.6126,  1.4490, -0.3787,  0.2706,  1.6956,  2.7994],
       device='cuda:0'), range: [-4.0656, 3.2448]
2025-04-13 12:50:53,183 - INFO -   Noisy actions shape: tensor([ 0.4110,  0.9684,  0.7577, -0.7724, -0.1090,  0.9129, -0.9647],
       device='cuda:0'), range: [-3.9845, 3.7683]
2025-04-13 12:50:53,250 - INFO - 
=== Epoch 1 Summary ===
2025-04-13 12:50:53,250 - INFO -   Avg total loss: 9.930379
2025-04-13 12:50:53,250 - INFO -   Avg diffusion loss: 3.255584
2025-04-13 12:50:53,250 - INFO -   Avg grasp loss: 13.349591
2025-04-13 12:50:53,250 - INFO - 
=== EPOCH 2/20 ===
2025-04-13 12:50:53,251 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:53,254 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:53,254 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9898, 3.0684]
2025-04-13 12:50:53,254 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3174, 2.9869]
2025-04-13 12:50:53,254 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,254 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,255 - INFO -   True actions shape: tensor([-1.7761, -1.6168,  0.5958,  0.6165,  1.0150, -0.1430, -0.8476],
       device='cuda:0'), range: [-2.9898, 3.0684]
2025-04-13 12:50:53,256 - INFO -   Noise shape: tensor([-0.2090, -0.0258, -2.1476,  0.5523,  1.0093, -1.2124,  0.1060],
       device='cuda:0'), range: [-3.5059, 3.5133]
2025-04-13 12:50:53,256 - INFO -   Noisy actions shape: tensor([-1.7853, -1.6155,  0.4705,  0.6474,  1.0717, -0.2129, -0.8400],
       device='cuda:0'), range: [-3.6161, 3.6715]
2025-04-13 12:50:53,256 - INFO -   Diffusion: timestep range [29, 934], noise range [-3.5059, 3.5133]
2025-04-13 12:50:53,256 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6161, 3.6715]
2025-04-13 12:50:53,275 - INFO -   Model output shapes:
2025-04-13 12:50:53,275 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:53,275 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.3949, 0.6138]
2025-04-13 12:50:53,275 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.1703
2025-04-13 12:50:53,275 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.8994, 0.0204]
2025-04-13 12:50:53,296 - INFO -   Loss components:
2025-04-13 12:50:53,296 - INFO -     Diffusion loss: 3.015135 (coef: 1.0)
2025-04-13 12:50:53,296 - INFO -     Grasp quality loss: 0.694254 (coef: 0.5)
2025-04-13 12:50:53,296 - INFO -     Grasp rotation loss: 0.572667 (coef: 0.5)
2025-04-13 12:50:53,296 - INFO -     Grasp width loss: 460.386902 (coef: 0.005)
2025-04-13 12:50:53,296 - INFO -     TOTAL loss: 5.950529
2025-04-13 12:50:53,304 - INFO -   Gradients: avg norm: 2.789816, max norm: 40.961857, non-zero params: 250
2025-04-13 12:50:53,304 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:50:53,304 - INFO - --- Gradient Check @ Epoch 2, Batch 0 ---
2025-04-13 12:50:53,321 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:53,321 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:53,321 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1685e+00, MaxNorm=4.8906e+00
2025-04-13 12:50:53,321 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.9699e-02, MaxNorm=5.1934e-02
2025-04-13 12:50:53,321 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.9987e-03, MaxNorm=1.9730e-02
2025-04-13 12:50:53,321 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.3330e+01, MaxNorm=3.6981e+01
2025-04-13 12:50:53,321 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.9724e+00, MaxNorm=3.5852e+00
2025-04-13 12:50:53,321 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.1186e+00, MaxNorm=3.7787e+00
2025-04-13 12:50:53,321 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.2577e-01, MaxNorm=1.0150e+00
2025-04-13 12:50:53,321 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.6741e+01, MaxNorm=4.0962e+01
2025-04-13 12:50:53,321 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6543e+00, MaxNorm=1.8196e+00
2025-04-13 12:50:53,321 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.3674e+00, MaxNorm=6.1421e+00
2025-04-13 12:50:53,321 - INFO - --- End Gradient Check ---
2025-04-13 12:50:53,323 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:53,324 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5565, 3.3190]
2025-04-13 12:50:53,324 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7739, 4.4256]
2025-04-13 12:50:53,324 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,324 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,324 - INFO -   True actions shape: tensor([ 0.9735, -0.3271,  0.2023,  0.8050,  0.0827,  1.4471,  0.8682],
       device='cuda:0'), range: [-3.5565, 3.3190]
2025-04-13 12:50:53,325 - INFO -   Noise shape: tensor([ 0.8826, -1.5730, -0.9225, -1.0223,  0.3813, -1.1833, -0.1927],
       device='cuda:0'), range: [-3.8429, 3.8149]
2025-04-13 12:50:53,326 - INFO -   Noisy actions shape: tensor([ 1.3139, -1.3154, -0.4842, -0.1132,  0.3213,  0.2445,  0.5008],
       device='cuda:0'), range: [-3.9616, 3.4785]
2025-04-13 12:50:53,368 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:53,368 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0321, 3.3697]
2025-04-13 12:50:53,368 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3262, 3.0752]
2025-04-13 12:50:53,368 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,368 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,369 - INFO -   True actions shape: tensor([-0.3059, -0.7924,  0.5353, -1.0298, -0.8749, -0.4139,  1.2064],
       device='cuda:0'), range: [-3.0321, 3.3697]
2025-04-13 12:50:53,370 - INFO -   Noise shape: tensor([-0.6432,  0.5977,  1.1735, -0.3995, -1.7337,  1.3470, -0.6412],
       device='cuda:0'), range: [-3.4118, 3.4736]
2025-04-13 12:50:53,370 - INFO -   Noisy actions shape: tensor([-0.5839, -0.3932,  1.0456, -1.0926, -1.6177,  0.3063,  0.7315],
       device='cuda:0'), range: [-3.3872, 3.3766]
2025-04-13 12:50:53,412 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:53,413 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0788, 3.1744]
2025-04-13 12:50:53,413 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1278, 2.8683]
2025-04-13 12:50:53,413 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,413 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,413 - INFO -   True actions shape: tensor([ 0.5627, -0.0874,  1.0261, -0.0342,  0.5909, -0.9657,  1.2535],
       device='cuda:0'), range: [-3.0788, 3.1744]
2025-04-13 12:50:53,414 - INFO -   Noise shape: tensor([-1.8138,  0.7383, -0.6355, -0.2899,  0.8444,  0.0710, -2.0074],
       device='cuda:0'), range: [-3.4756, 3.3696]
2025-04-13 12:50:53,415 - INFO -   Noisy actions shape: tensor([-1.1464,  0.5492,  0.0812, -0.2555,  1.0306, -0.5048, -0.9015],
       device='cuda:0'), range: [-3.4962, 3.6196]
2025-04-13 12:50:53,456 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:53,456 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3241, 3.4239]
2025-04-13 12:50:53,457 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8374, 2.8286]
2025-04-13 12:50:53,457 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,457 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,457 - INFO -   True actions shape: tensor([ 0.3590,  0.3612,  0.7131, -1.8124, -1.7480, -0.7197,  0.6051],
       device='cuda:0'), range: [-3.3241, 3.4239]
2025-04-13 12:50:53,458 - INFO -   Noise shape: tensor([-1.0659,  0.7612,  0.9163, -0.5302, -0.4087,  0.4604, -0.5960],
       device='cuda:0'), range: [-3.1897, 3.5578]
2025-04-13 12:50:53,459 - INFO -   Noisy actions shape: tensor([-0.4019,  0.7632,  1.1333, -1.7351, -1.6080, -0.2618,  0.0871],
       device='cuda:0'), range: [-2.9908, 3.7624]
2025-04-13 12:50:53,500 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:53,500 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5636, 3.2901]
2025-04-13 12:50:53,500 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3378, 3.2547]
2025-04-13 12:50:53,501 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,501 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,501 - INFO -   True actions shape: tensor([ 1.8321,  0.6642,  0.3112, -1.0731, -0.5305,  0.4281, -2.4705],
       device='cuda:0'), range: [-3.5636, 3.2901]
2025-04-13 12:50:53,502 - INFO -   Noise shape: tensor([-0.8549, -1.6215,  1.1198,  0.5007,  1.0247, -0.1805, -1.6070],
       device='cuda:0'), range: [-3.9515, 3.7647]
2025-04-13 12:50:53,502 - INFO -   Noisy actions shape: tensor([ 0.6674, -0.6969,  1.0189, -0.3910,  0.3630,  0.1697, -2.8754],
       device='cuda:0'), range: [-3.1937, 3.4005]
2025-04-13 12:50:53,544 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:53,544 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6087, 3.5667]
2025-04-13 12:50:53,544 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0790, 3.3643]
2025-04-13 12:50:53,544 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,544 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,545 - INFO -   True actions shape: tensor([-1.2438,  0.0680, -1.4040, -1.4005, -0.8178,  1.7318,  1.6341],
       device='cuda:0'), range: [-3.6087, 3.5667]
2025-04-13 12:50:53,545 - INFO -   Noise shape: tensor([ 0.2683,  0.2475, -0.2567,  1.0417, -0.9854,  0.9382, -0.8579],
       device='cuda:0'), range: [-4.2985, 4.6305]
2025-04-13 12:50:53,546 - INFO -   Noisy actions shape: tensor([-1.2268,  0.0818, -1.4162, -1.3397, -0.8719,  1.7818,  1.5833],
       device='cuda:0'), range: [-4.1351, 4.2027]
2025-04-13 12:50:53,588 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:53,588 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4087, 3.7244]
2025-04-13 12:50:53,588 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1093, 3.3947]
2025-04-13 12:50:53,588 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,588 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,589 - INFO -   True actions shape: tensor([ 0.5331,  1.0080, -0.5945,  0.3357, -1.9966,  0.9983, -1.2907],
       device='cuda:0'), range: [-3.4087, 3.7244]
2025-04-13 12:50:53,589 - INFO -   Noise shape: tensor([ 0.2894, -0.7485, -0.0081,  1.2524,  0.1951, -1.0071,  0.9390],
       device='cuda:0'), range: [-3.5060, 3.4610]
2025-04-13 12:50:53,590 - INFO -   Noisy actions shape: tensor([ 0.5546,  0.9449, -0.5932,  0.4348, -1.9746,  0.9146, -1.2115],
       device='cuda:0'), range: [-3.4077, 3.6817]
2025-04-13 12:50:53,631 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:53,632 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2539, 3.6464]
2025-04-13 12:50:53,632 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0052, 3.2337]
2025-04-13 12:50:53,632 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,632 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,633 - INFO -   True actions shape: tensor([ 0.6763, -0.3616, -2.0902,  1.1725, -0.7758,  0.2767,  0.3090],
       device='cuda:0'), range: [-3.2539, 3.6464]
2025-04-13 12:50:53,633 - INFO -   Noise shape: tensor([ 0.8578,  1.1553, -0.0274, -0.7460,  0.4418,  0.1986, -2.3602],
       device='cuda:0'), range: [-3.9875, 3.4331]
2025-04-13 12:50:53,634 - INFO -   Noisy actions shape: tensor([ 1.0665,  0.4515, -1.6353,  0.4353, -0.3208,  0.3399, -1.2551],
       device='cuda:0'), range: [-3.3375, 3.9034]
2025-04-13 12:50:53,675 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:53,675 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2765, 3.5640]
2025-04-13 12:50:53,675 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8484, 3.0550]
2025-04-13 12:50:53,675 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,675 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,676 - INFO -   True actions shape: tensor([-0.7584, -0.1963, -0.6384, -0.5051, -0.0096, -0.5209, -0.9418],
       device='cuda:0'), range: [-3.2765, 3.5640]
2025-04-13 12:50:53,677 - INFO -   Noise shape: tensor([-1.6296, -0.6410,  0.9718,  0.1650,  0.3224,  0.8213,  0.1930],
       device='cuda:0'), range: [-3.3150, 3.3629]
2025-04-13 12:50:53,677 - INFO -   Noisy actions shape: tensor([-1.7947, -0.6579,  0.5561, -0.0926,  0.2797,  0.4787, -0.2738],
       device='cuda:0'), range: [-3.0562, 3.5090]
2025-04-13 12:50:53,721 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:53,721 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4998, 3.3044]
2025-04-13 12:50:53,721 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9801, 3.5518]
2025-04-13 12:50:53,721 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,721 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,722 - INFO -   True actions shape: tensor([ 0.1338,  1.4049,  0.0368,  0.2566,  1.4320, -0.6002, -0.0096],
       device='cuda:0'), range: [-3.4998, 3.3044]
2025-04-13 12:50:53,723 - INFO -   Noise shape: tensor([ 1.5076, -0.4703, -0.1152, -0.7442,  0.6407,  0.3054, -0.8547],
       device='cuda:0'), range: [-3.2553, 4.1486]
2025-04-13 12:50:53,723 - INFO -   Noisy actions shape: tensor([ 5.9366e-01,  1.1904e+00, -6.5325e-04,  1.3727e-02,  1.5600e+00,
        -4.7628e-01, -2.7354e-01], device='cuda:0'), range: [-3.1554, 4.1571]
2025-04-13 12:50:53,763 - INFO -   Loss components:
2025-04-13 12:50:53,763 - INFO -     Diffusion loss: 2.923071 (coef: 1.0)
2025-04-13 12:50:53,763 - INFO -     Grasp quality loss: 0.694355 (coef: 0.5)
2025-04-13 12:50:53,763 - INFO -     Grasp rotation loss: 0.572657 (coef: 0.5)
2025-04-13 12:50:53,763 - INFO -     Grasp width loss: 382.582733 (coef: 0.005)
2025-04-13 12:50:53,763 - INFO -     TOTAL loss: 5.469490
2025-04-13 12:50:53,771 - INFO -   Gradients: avg norm: 2.485287, max norm: 36.454742, non-zero params: 250
2025-04-13 12:50:53,771 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:50:53,773 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:53,774 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1947, 4.1340]
2025-04-13 12:50:53,774 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8725, 3.8432]
2025-04-13 12:50:53,774 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,774 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,775 - INFO -   True actions shape: tensor([-0.3675,  1.1932,  0.7467, -0.1204, -0.4671, -0.3574, -0.1502],
       device='cuda:0'), range: [-3.1947, 4.1340]
2025-04-13 12:50:53,775 - INFO -   Noise shape: tensor([-0.3234, -1.4582,  1.5505,  0.1445, -0.8748, -0.5920,  1.8473],
       device='cuda:0'), range: [-3.2262, 3.5904]
2025-04-13 12:50:53,776 - INFO -   Noisy actions shape: tensor([-0.4141, -1.0612,  1.6984,  0.1046, -0.9712, -0.6689,  1.7294],
       device='cuda:0'), range: [-3.1795, 3.6859]
2025-04-13 12:50:53,818 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:53,819 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1634, 3.0764]
2025-04-13 12:50:53,819 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9986, 3.4152]
2025-04-13 12:50:53,819 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,819 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,820 - INFO -   True actions shape: tensor([ 0.6117,  0.6571, -0.4802,  0.0332,  0.1381,  0.8677,  2.1341],
       device='cuda:0'), range: [-4.1634, 3.0764]
2025-04-13 12:50:53,820 - INFO -   Noise shape: tensor([-0.1462, -0.4795, -0.9112, -0.3843, -1.0227,  0.7697, -0.6358],
       device='cuda:0'), range: [-3.9437, 4.1734]
2025-04-13 12:50:53,821 - INFO -   Noisy actions shape: tensor([ 0.3979,  0.2319, -0.9343, -0.2066, -0.5101,  1.1567,  1.3119],
       device='cuda:0'), range: [-3.9936, 3.7670]
2025-04-13 12:50:53,866 - INFO - 
=== Epoch 2 Summary ===
2025-04-13 12:50:53,866 - INFO -   Avg total loss: 5.600576
2025-04-13 12:50:53,866 - INFO -   Avg diffusion loss: 2.979638
2025-04-13 12:50:53,866 - INFO -   Avg grasp loss: 5.241877
2025-04-13 12:50:53,866 - INFO - 
=== EPOCH 3/20 ===
2025-04-13 12:50:53,867 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:53,870 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:53,870 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5162, 3.0439]
2025-04-13 12:50:53,870 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8034, 2.8985]
2025-04-13 12:50:53,870 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,871 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,871 - INFO -   True actions shape: tensor([-1.2717, -0.2828, -0.6122,  1.3362,  2.1582, -1.0528,  0.0655],
       device='cuda:0'), range: [-3.5162, 3.0439]
2025-04-13 12:50:53,872 - INFO -   Noise shape: tensor([-0.9490,  0.1893, -0.1968,  1.7726,  1.6589, -0.2895, -0.2106],
       device='cuda:0'), range: [-3.9632, 3.4351]
2025-04-13 12:50:53,872 - INFO -   Noisy actions shape: tensor([-1.3672,  0.0651, -0.4184,  2.1516,  2.3649, -0.6744, -0.1689],
       device='cuda:0'), range: [-3.4538, 3.7131]
2025-04-13 12:50:53,873 - INFO -   Diffusion: timestep range [62, 872], noise range [-3.9632, 3.4351]
2025-04-13 12:50:53,873 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4538, 3.7131]
2025-04-13 12:50:53,891 - INFO -   Model output shapes:
2025-04-13 12:50:53,891 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:53,891 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4043, 0.6114]
2025-04-13 12:50:53,891 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.1730
2025-04-13 12:50:53,892 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.7752, 0.0640]
2025-04-13 12:50:53,912 - INFO -   Loss components:
2025-04-13 12:50:53,912 - INFO -     Diffusion loss: 2.799199 (coef: 1.0)
2025-04-13 12:50:53,912 - INFO -     Grasp quality loss: 0.697629 (coef: 0.5)
2025-04-13 12:50:53,912 - INFO -     Grasp rotation loss: 0.584431 (coef: 0.5)
2025-04-13 12:50:53,912 - INFO -     Grasp width loss: 347.759003 (coef: 0.005)
2025-04-13 12:50:53,912 - INFO -     TOTAL loss: 5.179024
2025-04-13 12:50:53,920 - INFO -   Gradients: avg norm: 2.362203, max norm: 34.260189, non-zero params: 250
2025-04-13 12:50:53,920 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:50:53,920 - INFO - --- Gradient Check @ Epoch 3, Batch 0 ---
2025-04-13 12:50:53,937 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:53,937 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:53,937 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.0198e+00, MaxNorm=4.4013e+00
2025-04-13 12:50:53,937 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.0347e-02, MaxNorm=5.7983e-02
2025-04-13 12:50:53,937 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.3567e-02, MaxNorm=3.1105e-02
2025-04-13 12:50:53,937 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.1154e+01, MaxNorm=3.1429e+01
2025-04-13 12:50:53,937 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.7335e+00, MaxNorm=3.2267e+00
2025-04-13 12:50:53,937 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.8486e+00, MaxNorm=3.4735e+00
2025-04-13 12:50:53,937 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.0583e-01, MaxNorm=9.4803e-01
2025-04-13 12:50:53,937 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.0696e+01, MaxNorm=3.4260e+01
2025-04-13 12:50:53,937 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7020e+00, MaxNorm=1.7510e+00
2025-04-13 12:50:53,937 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.8906e+00, MaxNorm=5.2751e+00
2025-04-13 12:50:53,937 - INFO - --- End Gradient Check ---
2025-04-13 12:50:53,940 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:53,940 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5846, 4.0371]
2025-04-13 12:50:53,940 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8588, 3.9117]
2025-04-13 12:50:53,940 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,940 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,941 - INFO -   True actions shape: tensor([-0.1864,  0.1809, -1.0184, -2.5454,  0.2065,  1.9922,  1.2936],
       device='cuda:0'), range: [-3.5846, 4.0371]
2025-04-13 12:50:53,942 - INFO -   Noise shape: tensor([ 0.9814, -1.5024, -0.5078, -1.3020,  0.9675,  0.1750,  0.4884],
       device='cuda:0'), range: [-3.7996, 3.3183]
2025-04-13 12:50:53,942 - INFO -   Noisy actions shape: tensor([ 0.8005, -1.2713, -0.9027, -2.2856,  0.9602,  1.0301,  1.0058],
       device='cuda:0'), range: [-3.1311, 3.3624]
2025-04-13 12:50:53,985 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:53,985 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5945, 4.0018]
2025-04-13 12:50:53,985 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2134, 3.6301]
2025-04-13 12:50:53,985 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:53,985 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:53,986 - INFO -   True actions shape: tensor([ 1.8117, -0.6924,  1.8418,  0.3361,  1.3893, -0.7685,  1.3419],
       device='cuda:0'), range: [-3.5945, 4.0018]
2025-04-13 12:50:53,987 - INFO -   Noise shape: tensor([-1.9673,  1.6961,  1.2995,  0.1372,  0.6114,  0.0689,  0.5830],
       device='cuda:0'), range: [-3.7052, 3.7511]
2025-04-13 12:50:53,987 - INFO -   Noisy actions shape: tensor([-0.3960,  0.8867,  2.1673,  0.3177,  1.3476, -0.4283,  1.2957],
       device='cuda:0'), range: [-3.3046, 2.9349]
2025-04-13 12:50:54,029 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:54,029 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1929, 3.0684]
2025-04-13 12:50:54,029 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0691, 3.1059]
2025-04-13 12:50:54,029 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,029 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,030 - INFO -   True actions shape: tensor([-0.2264, -0.3179, -1.2820,  0.4301,  0.5519,  0.4163, -0.3640],
       device='cuda:0'), range: [-3.1929, 3.0684]
2025-04-13 12:50:54,031 - INFO -   Noise shape: tensor([-0.4651,  1.8347, -0.1095, -0.4355,  0.5361, -0.2348,  0.4697],
       device='cuda:0'), range: [-3.5261, 3.8064]
2025-04-13 12:50:54,031 - INFO -   Noisy actions shape: tensor([-0.4770,  1.8140, -0.1812, -0.4107,  0.5662, -0.2111,  0.4485],
       device='cuda:0'), range: [-3.5582, 3.6871]
2025-04-13 12:50:54,073 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:54,073 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9586, 3.6690]
2025-04-13 12:50:54,073 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7430, 3.3894]
2025-04-13 12:50:54,073 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,073 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,074 - INFO -   True actions shape: tensor([0.1634, 1.9717, 0.0108, 1.2192, 1.2505, 0.1698, 0.0385],
       device='cuda:0'), range: [-2.9586, 3.6690]
2025-04-13 12:50:54,075 - INFO -   Noise shape: tensor([-1.2234, -0.2924, -0.9418,  0.6845, -0.3545,  0.0504, -2.3677],
       device='cuda:0'), range: [-3.3512, 3.2244]
2025-04-13 12:50:54,075 - INFO -   Noisy actions shape: tensor([-0.7812,  1.1346, -0.6800,  1.3330,  0.5962,  0.1529, -1.7016],
       device='cuda:0'), range: [-3.1155, 3.5177]
2025-04-13 12:50:54,117 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:54,117 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6627, 3.9744]
2025-04-13 12:50:54,117 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9676, 3.3105]
2025-04-13 12:50:54,117 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,117 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,118 - INFO -   True actions shape: tensor([-0.5898,  1.7050,  1.5904, -0.0864,  0.4248,  0.2404, -1.4471],
       device='cuda:0'), range: [-3.6627, 3.9744]
2025-04-13 12:50:54,118 - INFO -   Noise shape: tensor([-0.1378, -1.5129,  0.2552,  1.1048, -1.3143, -0.1663,  0.9490],
       device='cuda:0'), range: [-3.9722, 3.6491]
2025-04-13 12:50:54,119 - INFO -   Noisy actions shape: tensor([-0.5639,  0.5464,  1.4547,  0.5553, -0.3954,  0.1037, -0.6538],
       device='cuda:0'), range: [-3.4402, 4.0958]
2025-04-13 12:50:54,161 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:54,161 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8967, 2.8702]
2025-04-13 12:50:54,161 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1760, 2.7865]
2025-04-13 12:50:54,161 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,161 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,162 - INFO -   True actions shape: tensor([-0.5566, -0.0436, -0.3347, -0.4952,  1.2681,  0.5425, -1.2856],
       device='cuda:0'), range: [-3.8967, 2.8702]
2025-04-13 12:50:54,162 - INFO -   Noise shape: tensor([-1.3717, -1.1546,  0.1135,  0.8891, -0.2496,  1.4204,  1.4151],
       device='cuda:0'), range: [-3.7021, 3.3396]
2025-04-13 12:50:54,163 - INFO -   Noisy actions shape: tensor([-1.4721, -1.0388, -0.0577,  0.5507,  0.3777,  1.5084,  0.6419],
       device='cuda:0'), range: [-3.7509, 3.1484]
2025-04-13 12:50:54,205 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:54,205 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8856, 3.8481]
2025-04-13 12:50:54,205 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3253, 3.1110]
2025-04-13 12:50:54,205 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,205 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,206 - INFO -   True actions shape: tensor([ 0.2376,  0.0377, -2.0591, -0.1605, -1.2816,  1.3084, -1.8885],
       device='cuda:0'), range: [-3.8856, 3.8481]
2025-04-13 12:50:54,206 - INFO -   Noise shape: tensor([-0.1636, -0.5810, -0.2086, -1.1606, -0.0954, -0.9842, -0.1006],
       device='cuda:0'), range: [-3.6303, 3.8541]
2025-04-13 12:50:54,207 - INFO -   Noisy actions shape: tensor([ 0.2137, -0.0400, -2.0686, -0.3135, -1.2829,  1.1659, -1.8851],
       device='cuda:0'), range: [-3.7536, 3.6744]
2025-04-13 12:50:54,248 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:54,248 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8557, 3.4923]
2025-04-13 12:50:54,249 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.7361, 3.8833]
2025-04-13 12:50:54,249 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,249 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,249 - INFO -   True actions shape: tensor([ 0.0520, -0.9227, -0.0934, -2.1582, -0.8993,  0.6626,  0.6959],
       device='cuda:0'), range: [-3.8557, 3.4923]
2025-04-13 12:50:54,250 - INFO -   Noise shape: tensor([-0.4465,  1.4702, -1.4344, -1.0932,  0.5522,  0.6842, -1.0355],
       device='cuda:0'), range: [-3.1471, 3.8709]
2025-04-13 12:50:54,251 - INFO -   Noisy actions shape: tensor([-0.4437,  1.4270, -1.4371, -1.1896,  0.5110,  0.7135, -1.0030],
       device='cuda:0'), range: [-3.0305, 3.6173]
2025-04-13 12:50:54,292 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:54,292 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5629, 3.5693]
2025-04-13 12:50:54,293 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2293, 2.7443]
2025-04-13 12:50:54,293 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,293 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,293 - INFO -   True actions shape: tensor([-1.0731,  0.3462, -1.0009, -1.3048, -0.1698, -0.0153, -0.5304],
       device='cuda:0'), range: [-3.5629, 3.5693]
2025-04-13 12:50:54,294 - INFO -   Noise shape: tensor([-4.9124e-04,  7.3949e-01, -3.5558e-01, -2.3074e-01,  2.0764e+00,
        -2.2687e-01,  7.5635e-02], device='cuda:0'), range: [-3.5093, 3.1404]
2025-04-13 12:50:54,294 - INFO -   Noisy actions shape: tensor([-0.5428,  0.8131, -0.8127, -0.8586,  1.7058, -0.2035, -0.2028],
       device='cuda:0'), range: [-3.8764, 4.0881]
2025-04-13 12:50:54,336 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:54,336 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.8638, 3.7314]
2025-04-13 12:50:54,336 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0791, 2.8622]
2025-04-13 12:50:54,336 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,336 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,337 - INFO -   True actions shape: tensor([ 0.4448, -0.8288, -0.6351,  0.3321,  1.2702,  0.6672,  0.5433],
       device='cuda:0'), range: [-2.8638, 3.7314]
2025-04-13 12:50:54,338 - INFO -   Noise shape: tensor([ 0.1094, -0.7586,  0.4661, -0.1571, -1.1612, -0.3247,  0.0621],
       device='cuda:0'), range: [-3.2299, 3.5952]
2025-04-13 12:50:54,338 - INFO -   Noisy actions shape: tensor([ 0.3386, -1.0916,  0.0335,  0.0545, -0.2571,  0.1019,  0.3542],
       device='cuda:0'), range: [-2.9756, 3.4080]
2025-04-13 12:50:54,377 - INFO -   Loss components:
2025-04-13 12:50:54,377 - INFO -     Diffusion loss: 2.692535 (coef: 1.0)
2025-04-13 12:50:54,377 - INFO -     Grasp quality loss: 0.692187 (coef: 0.5)
2025-04-13 12:50:54,377 - INFO -     Grasp rotation loss: 0.568683 (coef: 0.5)
2025-04-13 12:50:54,377 - INFO -     Grasp width loss: 96.030182 (coef: 0.005)
2025-04-13 12:50:54,378 - INFO -     TOTAL loss: 3.803121
2025-04-13 12:50:54,385 - INFO -   Gradients: avg norm: 1.316849, max norm: 13.230085, non-zero params: 250
2025-04-13 12:50:54,385 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:50:54,388 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:54,388 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3860, 3.4588]
2025-04-13 12:50:54,388 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9500, 3.0034]
2025-04-13 12:50:54,388 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,388 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,389 - INFO -   True actions shape: tensor([ 0.3253,  0.2992, -0.0506, -0.2511,  0.1058,  0.5331, -0.3462],
       device='cuda:0'), range: [-3.3860, 3.4588]
2025-04-13 12:50:54,390 - INFO -   Noise shape: tensor([-0.3633, -0.4672,  2.4955, -1.1500,  0.4543,  0.9752, -0.5800],
       device='cuda:0'), range: [-3.2856, 3.1121]
2025-04-13 12:50:54,390 - INFO -   Noisy actions shape: tensor([ 0.0619, -0.0185,  1.3734, -0.8590,  0.3447,  0.9922, -0.6140],
       device='cuda:0'), range: [-3.0839, 3.5113]
2025-04-13 12:50:54,432 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:54,432 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9429, 3.3310]
2025-04-13 12:50:54,432 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2537, 3.3129]
2025-04-13 12:50:54,432 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,432 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,433 - INFO -   True actions shape: tensor([ 1.3579, -0.9381,  1.2956, -1.5649, -0.8815, -2.2104,  0.0964],
       device='cuda:0'), range: [-2.9429, 3.3310]
2025-04-13 12:50:54,433 - INFO -   Noise shape: tensor([-1.0466,  1.1269, -0.2657,  0.1239,  0.5808, -1.4365,  0.7126],
       device='cuda:0'), range: [-3.2898, 4.0438]
2025-04-13 12:50:54,434 - INFO -   Noisy actions shape: tensor([ 1.3130, -0.8902,  1.2834, -1.5584, -0.8565, -2.2685,  0.1261],
       device='cuda:0'), range: [-2.9991, 3.3776]
2025-04-13 12:50:54,473 - INFO - 
=== Epoch 3 Summary ===
2025-04-13 12:50:54,474 - INFO -   Avg total loss: 4.391500
2025-04-13 12:50:54,474 - INFO -   Avg diffusion loss: 2.738984
2025-04-13 12:50:54,474 - INFO -   Avg grasp loss: 3.305032
2025-04-13 12:50:54,474 - INFO - 
=== EPOCH 4/20 ===
2025-04-13 12:50:54,475 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:54,477 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:54,477 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6149, 4.0272]
2025-04-13 12:50:54,477 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5557, 2.9128]
2025-04-13 12:50:54,478 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,478 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,478 - INFO -   True actions shape: tensor([-0.0481, -0.5416,  0.1482, -0.0854, -1.2133, -0.2683, -0.4527],
       device='cuda:0'), range: [-3.6149, 4.0272]
2025-04-13 12:50:54,479 - INFO -   Noise shape: tensor([-2.4527,  0.6890, -0.1229, -0.5936,  1.0594, -1.7085, -1.8430],
       device='cuda:0'), range: [-3.6150, 3.6881]
2025-04-13 12:50:54,479 - INFO -   Noisy actions shape: tensor([-0.6989, -0.3387,  0.1102, -0.2403, -0.8877, -0.7132, -0.9267],
       device='cuda:0'), range: [-4.0191, 3.6945]
2025-04-13 12:50:54,480 - INFO -   Diffusion: timestep range [164, 928], noise range [-3.6150, 3.6881]
2025-04-13 12:50:54,480 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.0191, 3.6945]
2025-04-13 12:50:54,498 - INFO -   Model output shapes:
2025-04-13 12:50:54,498 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:54,498 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4014, 0.6066]
2025-04-13 12:50:54,498 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.2044
2025-04-13 12:50:54,498 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.4874, 0.4434]
2025-04-13 12:50:54,519 - INFO -   Loss components:
2025-04-13 12:50:54,519 - INFO -     Diffusion loss: 2.515658 (coef: 1.0)
2025-04-13 12:50:54,519 - INFO -     Grasp quality loss: 0.697838 (coef: 0.5)
2025-04-13 12:50:54,519 - INFO -     Grasp rotation loss: 0.577855 (coef: 0.5)
2025-04-13 12:50:54,519 - INFO -     Grasp width loss: 57.407738 (coef: 0.005)
2025-04-13 12:50:54,519 - INFO -     TOTAL loss: 3.440543
2025-04-13 12:50:54,527 - INFO -   Gradients: avg norm: 0.823927, max norm: 4.853333, non-zero params: 250
2025-04-13 12:50:54,527 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:50:54,527 - INFO - --- Gradient Check @ Epoch 4, Batch 0 ---
2025-04-13 12:50:54,544 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:54,544 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:54,544 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.0058e+00, MaxNorm=4.2850e+00
2025-04-13 12:50:54,544 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.2420e-02, MaxNorm=5.5054e-02
2025-04-13 12:50:54,544 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.1359e-02, MaxNorm=5.5427e-02
2025-04-13 12:50:54,544 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.4895e+00, MaxNorm=4.4989e+00
2025-04-13 12:50:54,544 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.7228e+00, MaxNorm=3.1501e+00
2025-04-13 12:50:54,544 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.7987e+00, MaxNorm=3.2134e+00
2025-04-13 12:50:54,544 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.8157e-01, MaxNorm=8.1931e-01
2025-04-13 12:50:54,544 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.2029e+00, MaxNorm=4.6432e+00
2025-04-13 12:50:54,544 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3965e+00, MaxNorm=1.4579e+00
2025-04-13 12:50:54,544 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.6637e+00, MaxNorm=4.8533e+00
2025-04-13 12:50:54,544 - INFO - --- End Gradient Check ---
2025-04-13 12:50:54,547 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:54,547 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3491, 3.7050]
2025-04-13 12:50:54,547 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1991, 2.7087]
2025-04-13 12:50:54,547 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,547 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,548 - INFO -   True actions shape: tensor([-0.9700, -1.1425,  0.8339, -2.0779,  0.0311, -0.5477,  0.4082],
       device='cuda:0'), range: [-3.3491, 3.7050]
2025-04-13 12:50:54,548 - INFO -   Noise shape: tensor([ 0.8739,  0.6502,  0.5199,  0.2197,  0.2867,  0.2082, -1.4649],
       device='cuda:0'), range: [-3.8067, 3.6481]
2025-04-13 12:50:54,549 - INFO -   Noisy actions shape: tensor([-0.3251, -0.5925,  0.9823, -1.6100,  0.1844, -0.3412, -0.4698],
       device='cuda:0'), range: [-3.9696, 3.5015]
2025-04-13 12:50:54,592 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:54,592 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8719, 3.5693]
2025-04-13 12:50:54,592 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2366, 3.7082]
2025-04-13 12:50:54,592 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,592 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,593 - INFO -   True actions shape: tensor([ 0.5150, -0.2839,  0.8321,  0.3735,  1.5960, -1.2910,  1.1170],
       device='cuda:0'), range: [-3.8719, 3.5693]
2025-04-13 12:50:54,593 - INFO -   Noise shape: tensor([-0.9763, -0.6759, -0.6237, -1.7184,  1.8271,  0.2808,  1.4240],
       device='cuda:0'), range: [-3.3427, 3.6147]
2025-04-13 12:50:54,594 - INFO -   Noisy actions shape: tensor([-0.8855, -0.7115, -0.4884, -1.6405,  2.0507,  0.0790,  1.5788],
       device='cuda:0'), range: [-3.8749, 3.3733]
2025-04-13 12:50:54,636 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:54,636 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2803, 3.5715]
2025-04-13 12:50:54,636 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9841, 3.4247]
2025-04-13 12:50:54,636 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,636 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,637 - INFO -   True actions shape: tensor([-0.6307, -0.3448, -0.6446, -0.4962, -1.5089,  0.7050, -0.9358],
       device='cuda:0'), range: [-3.2803, 3.5715]
2025-04-13 12:50:54,637 - INFO -   Noise shape: tensor([-0.3793,  0.0338, -0.7808,  1.1254,  0.4198,  0.5886,  0.2170],
       device='cuda:0'), range: [-3.4076, 3.0507]
2025-04-13 12:50:54,638 - INFO -   Noisy actions shape: tensor([-0.7017, -0.3275, -0.8087, -0.2206, -1.3697,  0.8227, -0.8596],
       device='cuda:0'), range: [-3.5920, 3.7816]
2025-04-13 12:50:54,684 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:54,684 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6542, 3.6929]
2025-04-13 12:50:54,684 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7353, 3.2510]
2025-04-13 12:50:54,684 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,684 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,686 - INFO -   True actions shape: tensor([ 1.5161, -0.2427,  0.5105, -0.4629, -2.2559, -0.0580, -1.1802],
       device='cuda:0'), range: [-3.6542, 3.6929]
2025-04-13 12:50:54,687 - INFO -   Noise shape: tensor([-0.0860, -0.6969,  0.1623, -0.5378,  1.3606, -0.5341,  1.9157],
       device='cuda:0'), range: [-3.1546, 3.4800]
2025-04-13 12:50:54,688 - INFO -   Noisy actions shape: tensor([ 0.2535, -0.7335,  0.2718, -0.6273,  0.8245, -0.5336,  1.6051],
       device='cuda:0'), range: [-3.4490, 3.2632]
2025-04-13 12:50:54,740 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:54,740 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8971, 3.7270]
2025-04-13 12:50:54,740 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0852, 3.2003]
2025-04-13 12:50:54,740 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,740 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,741 - INFO -   True actions shape: tensor([ 0.0219,  0.2547,  0.5860,  1.9632, -1.7120,  0.2020,  2.2607],
       device='cuda:0'), range: [-3.8971, 3.7270]
2025-04-13 12:50:54,742 - INFO -   Noise shape: tensor([ 1.3490,  0.7644,  1.0509, -0.0541, -0.6518, -0.2258, -2.2751],
       device='cuda:0'), range: [-3.6531, 3.3575]
2025-04-13 12:50:54,742 - INFO -   Noisy actions shape: tensor([ 9.6642e-01,  7.1945e-01,  1.1565e+00,  1.3545e+00, -1.6738e+00,
        -1.5859e-02,  5.0783e-05], device='cuda:0'), range: [-4.1646, 4.2818]
2025-04-13 12:50:54,792 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:54,793 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8848, 3.0953]
2025-04-13 12:50:54,793 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1932, 3.6370]
2025-04-13 12:50:54,793 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,793 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,794 - INFO -   True actions shape: tensor([ 0.6246, -1.0202, -1.4512,  2.1370, -0.4628,  0.7394, -0.7669],
       device='cuda:0'), range: [-3.8848, 3.0953]
2025-04-13 12:50:54,794 - INFO -   Noise shape: tensor([ 0.2685,  1.4234, -0.1627,  0.3718, -0.7865,  0.6558, -1.6836],
       device='cuda:0'), range: [-3.5569, 3.6687]
2025-04-13 12:50:54,795 - INFO -   Noisy actions shape: tensor([ 0.6799, -0.3769, -1.3979,  2.1106, -0.7353,  0.9380, -1.3682],
       device='cuda:0'), range: [-3.1520, 3.3698]
2025-04-13 12:50:54,837 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:54,837 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5428, 3.2879]
2025-04-13 12:50:54,837 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1471, 3.3803]
2025-04-13 12:50:54,837 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,837 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,838 - INFO -   True actions shape: tensor([-0.1339, -0.9657,  1.7615, -2.9476,  1.1157,  1.0786,  1.8077],
       device='cuda:0'), range: [-3.5428, 3.2879]
2025-04-13 12:50:54,839 - INFO -   Noise shape: tensor([ 0.3467,  1.2175, -1.4987,  0.3495, -1.0249, -0.9603,  0.5027],
       device='cuda:0'), range: [-3.4056, 2.9200]
2025-04-13 12:50:54,839 - INFO -   Noisy actions shape: tensor([ 0.1672,  0.2547,  0.0708, -1.7188, -0.0112,  0.0118,  1.5857],
       device='cuda:0'), range: [-3.5884, 3.2332]
2025-04-13 12:50:54,881 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:54,881 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3588, 3.9646]
2025-04-13 12:50:54,882 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2279, 3.0082]
2025-04-13 12:50:54,882 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,882 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,882 - INFO -   True actions shape: tensor([ 1.3356, -0.1248,  0.5079,  0.2527, -0.7070,  2.8152, -0.2841],
       device='cuda:0'), range: [-3.3588, 3.9646]
2025-04-13 12:50:54,883 - INFO -   Noise shape: tensor([ 1.0780,  0.1036,  1.9113,  0.0647, -0.0645, -0.6106,  0.1703],
       device='cuda:0'), range: [-3.4510, 3.2398]
2025-04-13 12:50:54,884 - INFO -   Noisy actions shape: tensor([ 1.3861, -0.1197,  0.5995,  0.2555, -0.7093,  2.7825, -0.2756],
       device='cuda:0'), range: [-3.5832, 3.5194]
2025-04-13 12:50:54,925 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:54,926 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0791, 3.5812]
2025-04-13 12:50:54,926 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4455, 3.7757]
2025-04-13 12:50:54,926 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,926 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,927 - INFO -   True actions shape: tensor([-0.0091,  0.7396, -0.9665, -1.2079, -1.3544,  0.8363, -0.1973],
       device='cuda:0'), range: [-3.0791, 3.5812]
2025-04-13 12:50:54,927 - INFO -   Noise shape: tensor([ 1.4146, -1.6087, -1.2520, -1.4494, -0.1005,  1.3103,  1.6415],
       device='cuda:0'), range: [-2.8801, 2.9520]
2025-04-13 12:50:54,928 - INFO -   Noisy actions shape: tensor([ 0.9890, -0.6066, -1.5678, -1.8782, -1.0330,  1.5162,  1.0150],
       device='cuda:0'), range: [-3.1188, 3.9198]
2025-04-13 12:50:54,969 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:54,970 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5357, 3.5906]
2025-04-13 12:50:54,970 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1988, 3.3747]
2025-04-13 12:50:54,970 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:54,970 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:54,971 - INFO -   True actions shape: tensor([-0.0861,  0.8494,  0.1355,  0.3451,  0.2023, -0.5678,  1.2676],
       device='cuda:0'), range: [-3.5357, 3.5906]
2025-04-13 12:50:54,971 - INFO -   Noise shape: tensor([ 1.9654, -0.2167,  0.4356,  1.6942, -0.8241,  0.4928, -1.1477],
       device='cuda:0'), range: [-3.4220, 3.2536]
2025-04-13 12:50:54,972 - INFO -   Noisy actions shape: tensor([ 1.3219,  0.4510,  0.4028,  1.4375, -0.4363, -0.0566,  0.0929],
       device='cuda:0'), range: [-3.8005, 3.4123]
2025-04-13 12:50:55,011 - INFO -   Loss components:
2025-04-13 12:50:55,011 - INFO -     Diffusion loss: 2.122397 (coef: 1.0)
2025-04-13 12:50:55,011 - INFO -     Grasp quality loss: 0.698692 (coef: 0.5)
2025-04-13 12:50:55,011 - INFO -     Grasp rotation loss: 0.582348 (coef: 0.5)
2025-04-13 12:50:55,011 - INFO -     Grasp width loss: 60.025238 (coef: 0.005)
2025-04-13 12:50:55,011 - INFO -     TOTAL loss: 3.063043
2025-04-13 12:50:55,019 - INFO -   Gradients: avg norm: 0.861759, max norm: 6.855939, non-zero params: 250
2025-04-13 12:50:55,019 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:50:55,021 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:55,021 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2278, 4.1178]
2025-04-13 12:50:55,021 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4733, 2.9685]
2025-04-13 12:50:55,022 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,022 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,022 - INFO -   True actions shape: tensor([ 0.3263,  2.5948,  1.1345,  0.5170, -0.0723, -1.9171, -0.6334],
       device='cuda:0'), range: [-3.2278, 4.1178]
2025-04-13 12:50:55,023 - INFO -   Noise shape: tensor([-0.7231, -1.3471,  0.5510, -0.2966,  0.7779, -0.1243,  0.2983],
       device='cuda:0'), range: [-3.8675, 3.2176]
2025-04-13 12:50:55,023 - INFO -   Noisy actions shape: tensor([-0.4975, -0.0286,  1.0044, -0.0308,  0.6612, -0.9776, -0.0203],
       device='cuda:0'), range: [-3.6596, 3.9534]
2025-04-13 12:50:55,065 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:55,065 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4022, 4.0400]
2025-04-13 12:50:55,065 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3521, 3.8002]
2025-04-13 12:50:55,066 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,066 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,066 - INFO -   True actions shape: tensor([ 1.1596, -0.3653,  0.9138,  0.1446, -1.0950,  0.0879,  0.2011],
       device='cuda:0'), range: [-3.4022, 4.0400]
2025-04-13 12:50:55,067 - INFO -   Noise shape: tensor([-0.3823,  0.3464, -0.4402,  0.5970, -0.1029, -0.1648,  0.5431],
       device='cuda:0'), range: [-3.4745, 3.4810]
2025-04-13 12:50:55,067 - INFO -   Noisy actions shape: tensor([ 0.0868,  0.1817, -0.0601,  0.6072, -0.5111, -0.1191,  0.5788],
       device='cuda:0'), range: [-3.4492, 3.1237]
2025-04-13 12:50:55,107 - INFO - 
=== Epoch 4 Summary ===
2025-04-13 12:50:55,107 - INFO -   Avg total loss: 3.289955
2025-04-13 12:50:55,107 - INFO -   Avg diffusion loss: 2.376457
2025-04-13 12:50:55,107 - INFO -   Avg grasp loss: 1.826995
2025-04-13 12:50:55,107 - INFO - 
=== EPOCH 5/20 ===
2025-04-13 12:50:55,108 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:55,111 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:55,111 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9473, 3.5635]
2025-04-13 12:50:55,111 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2523, 3.3507]
2025-04-13 12:50:55,111 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,111 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,112 - INFO -   True actions shape: tensor([-0.0374,  0.1287,  0.8274,  0.3515, -0.5721,  0.5254,  0.1566],
       device='cuda:0'), range: [-3.9473, 3.5635]
2025-04-13 12:50:55,112 - INFO -   Noise shape: tensor([-1.6754, -1.2304, -0.1910, -0.7722,  0.3965, -1.7445, -0.9975],
       device='cuda:0'), range: [-3.4521, 3.4251]
2025-04-13 12:50:55,113 - INFO -   Noisy actions shape: tensor([-0.4492, -0.1785,  0.7548,  0.1504, -0.4568,  0.0792, -0.0940],
       device='cuda:0'), range: [-3.5141, 3.7068]
2025-04-13 12:50:55,113 - INFO -   Diffusion: timestep range [102, 955], noise range [-3.4521, 3.4251]
2025-04-13 12:50:55,113 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5141, 3.7068]
2025-04-13 12:50:55,131 - INFO -   Model output shapes:
2025-04-13 12:50:55,131 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:55,132 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4313, 0.5999]
2025-04-13 12:50:55,132 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.2508
2025-04-13 12:50:55,132 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3587, 0.5139]
2025-04-13 12:50:55,153 - INFO -   Loss components:
2025-04-13 12:50:55,153 - INFO -     Diffusion loss: 2.573275 (coef: 1.0)
2025-04-13 12:50:55,153 - INFO -     Grasp quality loss: 0.694749 (coef: 0.5)
2025-04-13 12:50:55,153 - INFO -     Grasp rotation loss: 0.601852 (coef: 0.5)
2025-04-13 12:50:55,153 - INFO -     Grasp width loss: 61.252846 (coef: 0.005)
2025-04-13 12:50:55,153 - INFO -     TOTAL loss: 3.527839
2025-04-13 12:50:55,161 - INFO -   Gradients: avg norm: 0.987338, max norm: 6.873493, non-zero params: 250
2025-04-13 12:50:55,161 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:50:55,161 - INFO - --- Gradient Check @ Epoch 5, Batch 0 ---
2025-04-13 12:50:55,179 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:55,179 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:55,179 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1212e+00, MaxNorm=4.8422e+00
2025-04-13 12:50:55,179 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.1233e-02, MaxNorm=5.9632e-02
2025-04-13 12:50:55,179 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.4744e-02, MaxNorm=4.1761e-02
2025-04-13 12:50:55,179 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.1641e+00, MaxNorm=6.8735e+00
2025-04-13 12:50:55,179 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.8502e+00, MaxNorm=3.4640e+00
2025-04-13 12:50:55,179 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.9822e+00, MaxNorm=3.5670e+00
2025-04-13 12:50:55,179 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.9204e-01, MaxNorm=8.7157e-01
2025-04-13 12:50:55,179 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.1667e+00, MaxNorm=5.7390e+00
2025-04-13 12:50:55,179 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.5486e+00, MaxNorm=1.6364e+00
2025-04-13 12:50:55,179 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.0173e+00, MaxNorm=5.4821e+00
2025-04-13 12:50:55,179 - INFO - --- End Gradient Check ---
2025-04-13 12:50:55,182 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:55,182 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7123, 3.4183]
2025-04-13 12:50:55,182 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2156, 2.8842]
2025-04-13 12:50:55,182 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,182 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,183 - INFO -   True actions shape: tensor([-1.3149, -0.0492, -0.7636, -0.3557,  0.1334, -0.2909, -0.6578],
       device='cuda:0'), range: [-3.7123, 3.4183]
2025-04-13 12:50:55,184 - INFO -   Noise shape: tensor([ 0.0895,  0.0948, -1.0468, -1.3436,  0.9678,  0.9044, -1.5402],
       device='cuda:0'), range: [-3.8635, 3.4803]
2025-04-13 12:50:55,184 - INFO -   Noisy actions shape: tensor([-0.9793,  0.0198, -1.2469, -1.1092,  0.7024,  0.3295, -1.4683],
       device='cuda:0'), range: [-3.9896, 3.5641]
2025-04-13 12:50:55,226 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:55,226 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1109, 3.4690]
2025-04-13 12:50:55,226 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8569, 3.0664]
2025-04-13 12:50:55,227 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,227 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,227 - INFO -   True actions shape: tensor([0.6751, 1.5024, 0.9206, 0.6999, 0.4405, 1.5736, 0.2943],
       device='cuda:0'), range: [-3.1109, 3.4690]
2025-04-13 12:50:55,228 - INFO -   Noise shape: tensor([-1.2410,  0.4716,  0.7098, -0.1181, -2.3698,  1.4839, -0.1424],
       device='cuda:0'), range: [-3.6550, 3.5031]
2025-04-13 12:50:55,228 - INFO -   Noisy actions shape: tensor([ 0.1469,  1.5683,  1.1226,  0.6009, -0.5032,  2.0227,  0.2171],
       device='cuda:0'), range: [-3.3164, 3.8502]
2025-04-13 12:50:55,270 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:55,270 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2753, 3.5029]
2025-04-13 12:50:55,270 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4399, 3.1941]
2025-04-13 12:50:55,271 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,271 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,271 - INFO -   True actions shape: tensor([-1.3489,  0.8103, -0.7922,  0.6201, -0.6232, -1.5510,  0.5489],
       device='cuda:0'), range: [-3.2753, 3.5029]
2025-04-13 12:50:55,272 - INFO -   Noise shape: tensor([ 0.3652, -0.4925, -0.3043,  0.2117, -0.0535, -0.1573, -0.1296],
       device='cuda:0'), range: [-3.6613, 3.5729]
2025-04-13 12:50:55,272 - INFO -   Noisy actions shape: tensor([ 0.3145, -0.4618, -0.3337,  0.2348, -0.0767, -0.2152, -0.1090],
       device='cuda:0'), range: [-3.0927, 3.3494]
2025-04-13 12:50:55,314 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:55,314 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1262, 3.4959]
2025-04-13 12:50:55,314 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0929, 3.1645]
2025-04-13 12:50:55,314 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,314 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,315 - INFO -   True actions shape: tensor([ 0.9885,  1.4098,  0.1766, -1.1423,  0.3749, -0.0185,  1.1255],
       device='cuda:0'), range: [-4.1262, 3.4959]
2025-04-13 12:50:55,315 - INFO -   Noise shape: tensor([ 1.2154,  0.7055, -1.0342, -0.5683, -1.6476,  0.0805, -0.0639],
       device='cuda:0'), range: [-3.9242, 3.1029]
2025-04-13 12:50:55,316 - INFO -   Noisy actions shape: tensor([ 1.4794,  1.1435, -0.9123, -0.9234, -1.4214,  0.0694,  0.3233],
       device='cuda:0'), range: [-4.3473, 2.9674]
2025-04-13 12:50:55,357 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:55,358 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5714, 3.1810]
2025-04-13 12:50:55,358 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3631, 3.0657]
2025-04-13 12:50:55,358 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,358 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,359 - INFO -   True actions shape: tensor([ 0.3797,  0.1464, -0.0830,  1.3955,  0.7968,  1.4827,  0.6844],
       device='cuda:0'), range: [-3.5714, 3.1810]
2025-04-13 12:50:55,359 - INFO -   Noise shape: tensor([-0.4763,  1.1336,  0.7062,  0.1213,  0.6534,  0.2217,  0.6400],
       device='cuda:0'), range: [-3.7027, 3.1988]
2025-04-13 12:50:55,360 - INFO -   Noisy actions shape: tensor([-0.3281,  1.1201,  0.6416,  0.5655,  0.8757,  0.6887,  0.8267],
       device='cuda:0'), range: [-3.6415, 3.4798]
2025-04-13 12:50:55,401 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:55,401 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6733, 3.2340]
2025-04-13 12:50:55,401 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6584, 3.4595]
2025-04-13 12:50:55,401 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,401 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,402 - INFO -   True actions shape: tensor([ 1.3069, -0.9499,  0.3483, -1.0416,  0.8784, -1.1382,  0.0998],
       device='cuda:0'), range: [-3.6733, 3.2340]
2025-04-13 12:50:55,403 - INFO -   Noise shape: tensor([ 1.4690, -1.8422, -1.7670,  1.7413, -0.1393,  1.4536, -0.9827],
       device='cuda:0'), range: [-3.6103, 3.3378]
2025-04-13 12:50:55,403 - INFO -   Noisy actions shape: tensor([ 1.9087, -1.8255, -0.7126,  0.1263,  0.6454, -0.1161, -0.4737],
       device='cuda:0'), range: [-3.6709, 3.2108]
2025-04-13 12:50:55,445 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:55,445 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0797, 3.4719]
2025-04-13 12:50:55,445 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0741, 3.4753]
2025-04-13 12:50:55,445 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,445 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,446 - INFO -   True actions shape: tensor([-1.1801,  0.7631, -0.0112,  0.6494, -0.3209, -1.9610, -0.5323],
       device='cuda:0'), range: [-3.0797, 3.4719]
2025-04-13 12:50:55,446 - INFO -   Noise shape: tensor([ 0.1026, -1.2248,  1.2590,  1.6316, -0.2441, -0.9502, -0.5972],
       device='cuda:0'), range: [-3.5373, 3.2496]
2025-04-13 12:50:55,447 - INFO -   Noisy actions shape: tensor([-0.8549, -0.1736,  0.7808,  1.5290, -0.4030, -2.1234, -0.7892],
       device='cuda:0'), range: [-3.8426, 3.1817]
2025-04-13 12:50:55,488 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:55,488 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0029, 3.3855]
2025-04-13 12:50:55,488 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0855, 3.1475]
2025-04-13 12:50:55,488 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,488 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,489 - INFO -   True actions shape: tensor([ 2.1077, -2.0414,  0.4617, -1.0202, -0.4059,  0.0844, -1.1184],
       device='cuda:0'), range: [-3.0029, 3.3855]
2025-04-13 12:50:55,490 - INFO -   Noise shape: tensor([-0.7405,  1.0836, -0.6667, -0.8435, -0.7100, -0.8469, -0.4873],
       device='cuda:0'), range: [-3.4964, 3.3705]
2025-04-13 12:50:55,490 - INFO -   Noisy actions shape: tensor([ 2.0389, -1.9443,  0.4047, -1.0868, -0.4635,  0.0137, -1.1550],
       device='cuda:0'), range: [-2.8682, 3.5033]
2025-04-13 12:50:55,532 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:55,532 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8028, 3.4623]
2025-04-13 12:50:55,532 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2110, 3.4392]
2025-04-13 12:50:55,532 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,532 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,533 - INFO -   True actions shape: tensor([-0.7833, -0.4854,  1.5145, -0.3336, -0.3851,  0.5229, -0.1980],
       device='cuda:0'), range: [-3.8028, 3.4623]
2025-04-13 12:50:55,533 - INFO -   Noise shape: tensor([-0.5178, -0.4581, -0.4887,  0.3566, -1.0462, -0.1985, -0.3367],
       device='cuda:0'), range: [-3.0899, 3.4873]
2025-04-13 12:50:55,534 - INFO -   Noisy actions shape: tensor([-0.6941, -0.5631, -0.1023,  0.2639, -1.1087, -0.0642, -0.3749],
       device='cuda:0'), range: [-3.6255, 3.4826]
2025-04-13 12:50:55,575 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:55,575 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1331, 3.7172]
2025-04-13 12:50:55,575 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7474, 3.1190]
2025-04-13 12:50:55,576 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,576 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,576 - INFO -   True actions shape: tensor([-0.6474,  0.6649, -0.2861, -0.2511,  0.6453, -1.8642, -0.8164],
       device='cuda:0'), range: [-4.1331, 3.7172]
2025-04-13 12:50:55,577 - INFO -   Noise shape: tensor([-0.6548, -0.1770,  1.3661,  0.7710,  0.2917,  0.4770, -0.4727],
       device='cuda:0'), range: [-3.8089, 3.7413]
2025-04-13 12:50:55,577 - INFO -   Noisy actions shape: tensor([-0.8329,  0.5638,  0.2002,  0.0288,  0.7063, -1.5872, -0.9290],
       device='cuda:0'), range: [-3.4358, 3.6730]
2025-04-13 12:50:55,616 - INFO -   Loss components:
2025-04-13 12:50:55,616 - INFO -     Diffusion loss: 2.316607 (coef: 1.0)
2025-04-13 12:50:55,616 - INFO -     Grasp quality loss: 0.701344 (coef: 0.5)
2025-04-13 12:50:55,616 - INFO -     Grasp rotation loss: 0.574074 (coef: 0.5)
2025-04-13 12:50:55,616 - INFO -     Grasp width loss: 56.232422 (coef: 0.005)
2025-04-13 12:50:55,616 - INFO -     TOTAL loss: 3.235478
2025-04-13 12:50:55,624 - INFO -   Gradients: avg norm: 0.865219, max norm: 7.381819, non-zero params: 250
2025-04-13 12:50:55,624 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:50:55,627 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:55,627 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5747, 3.6709]
2025-04-13 12:50:55,627 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0401, 2.7720]
2025-04-13 12:50:55,627 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,627 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,628 - INFO -   True actions shape: tensor([ 0.4460,  0.4961,  0.4352, -1.0828,  0.6694, -0.4500,  0.1805],
       device='cuda:0'), range: [-3.5747, 3.6709]
2025-04-13 12:50:55,628 - INFO -   Noise shape: tensor([-0.5837,  0.0225,  0.0687,  0.8478,  0.6978, -0.3199,  0.2564],
       device='cuda:0'), range: [-3.5621, 3.2579]
2025-04-13 12:50:55,629 - INFO -   Noisy actions shape: tensor([-0.3998,  0.1879,  0.2110,  0.4344,  0.8823, -0.4525,  0.3021],
       device='cuda:0'), range: [-3.1466, 3.5843]
2025-04-13 12:50:55,670 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:55,670 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5515, 3.4394]
2025-04-13 12:50:55,671 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9399, 3.5373]
2025-04-13 12:50:55,671 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,671 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,671 - INFO -   True actions shape: tensor([ 0.8041,  0.1231, -2.7052,  0.2780, -1.3180,  0.1020,  0.2263],
       device='cuda:0'), range: [-3.5515, 3.4394]
2025-04-13 12:50:55,672 - INFO -   Noise shape: tensor([-1.2517,  0.3811, -1.8471,  0.2156, -1.5679, -0.2028, -0.4033],
       device='cuda:0'), range: [-3.9973, 3.5285]
2025-04-13 12:50:55,673 - INFO -   Noisy actions shape: tensor([ 0.3436,  0.2425, -3.1646,  0.3338, -1.7633,  0.0290,  0.0798],
       device='cuda:0'), range: [-3.4000, 3.4379]
2025-04-13 12:50:55,712 - INFO - 
=== Epoch 5 Summary ===
2025-04-13 12:50:55,712 - INFO -   Avg total loss: 3.310054
2025-04-13 12:50:55,712 - INFO -   Avg diffusion loss: 2.374564
2025-04-13 12:50:55,712 - INFO -   Avg grasp loss: 1.870980
2025-04-13 12:50:55,910 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125051/ckpt_epoch_5.pth
2025-04-13 12:50:55,910 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:50:55,910 - INFO - 
=== EPOCH 6/20 ===
2025-04-13 12:50:55,911 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:55,915 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:55,915 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7315, 3.2044]
2025-04-13 12:50:55,915 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4421, 2.8611]
2025-04-13 12:50:55,915 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,915 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,916 - INFO -   True actions shape: tensor([ 1.1513, -0.4255, -0.9003,  0.2144,  3.2044, -0.6843,  0.0620],
       device='cuda:0'), range: [-3.7315, 3.2044]
2025-04-13 12:50:55,916 - INFO -   Noise shape: tensor([-1.2083,  0.4767, -1.4303, -1.0011, -1.1732,  0.2498,  0.1962],
       device='cuda:0'), range: [-4.0164, 4.3788]
2025-04-13 12:50:55,917 - INFO -   Noisy actions shape: tensor([ 0.1676, -0.0435, -1.5885, -0.4450,  1.8103, -0.3870,  0.1694],
       device='cuda:0'), range: [-3.7468, 4.3657]
2025-04-13 12:50:55,917 - INFO -   Diffusion: timestep range [160, 973], noise range [-4.0164, 4.3788]
2025-04-13 12:50:55,917 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.7468, 4.3657]
2025-04-13 12:50:55,936 - INFO -   Model output shapes:
2025-04-13 12:50:55,936 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:55,936 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4175, 0.5950]
2025-04-13 12:50:55,936 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.2615
2025-04-13 12:50:55,936 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3119, 0.5849]
2025-04-13 12:50:55,957 - INFO -   Loss components:
2025-04-13 12:50:55,957 - INFO -     Diffusion loss: 2.308842 (coef: 1.0)
2025-04-13 12:50:55,957 - INFO -     Grasp quality loss: 0.696136 (coef: 0.5)
2025-04-13 12:50:55,957 - INFO -     Grasp rotation loss: 0.563728 (coef: 0.5)
2025-04-13 12:50:55,957 - INFO -     Grasp width loss: 55.364086 (coef: 0.005)
2025-04-13 12:50:55,957 - INFO -     TOTAL loss: 3.215594
2025-04-13 12:50:55,965 - INFO -   Gradients: avg norm: 0.844596, max norm: 6.045103, non-zero params: 250
2025-04-13 12:50:55,965 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:50:55,965 - INFO - --- Gradient Check @ Epoch 6, Batch 0 ---
2025-04-13 12:50:55,982 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:55,982 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:55,982 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=9.3750e-01, MaxNorm=4.1277e+00
2025-04-13 12:50:55,982 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.2138e-02, MaxNorm=2.5096e-02
2025-04-13 12:50:55,982 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=7.9831e-03, MaxNorm=2.0523e-02
2025-04-13 12:50:55,982 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.9006e+00, MaxNorm=6.0451e+00
2025-04-13 12:50:55,982 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.6991e+00, MaxNorm=3.1553e+00
2025-04-13 12:50:55,982 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.7990e+00, MaxNorm=3.2255e+00
2025-04-13 12:50:55,982 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.6453e-01, MaxNorm=7.3187e-01
2025-04-13 12:50:55,982 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.4925e+00, MaxNorm=4.9752e+00
2025-04-13 12:50:55,982 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3611e+00, MaxNorm=1.4035e+00
2025-04-13 12:50:55,982 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.6706e+00, MaxNorm=4.8593e+00
2025-04-13 12:50:55,982 - INFO - --- End Gradient Check ---
2025-04-13 12:50:55,985 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:55,985 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1753, 3.4610]
2025-04-13 12:50:55,985 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1351, 3.6264]
2025-04-13 12:50:55,985 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:55,985 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:55,986 - INFO -   True actions shape: tensor([-0.8538,  1.0729,  0.5779,  1.0181,  1.4694,  0.8699,  0.0300],
       device='cuda:0'), range: [-3.1753, 3.4610]
2025-04-13 12:50:55,986 - INFO -   Noise shape: tensor([ 1.5485,  0.4338, -0.1737, -0.5770,  0.2111,  0.5100, -0.9866],
       device='cuda:0'), range: [-3.7902, 4.0101]
2025-04-13 12:50:55,987 - INFO -   Noisy actions shape: tensor([ 1.4938,  0.4982, -0.1383, -0.5141,  0.2999,  0.5619, -0.9830],
       device='cuda:0'), range: [-3.4492, 4.1733]
2025-04-13 12:50:56,028 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:56,028 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2570, 3.0878]
2025-04-13 12:50:56,029 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2384, 2.7978]
2025-04-13 12:50:56,029 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,029 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,029 - INFO -   True actions shape: tensor([-0.0137,  1.6455,  0.9972, -0.1781,  1.4143,  0.5563, -0.8558],
       device='cuda:0'), range: [-3.2570, 3.0878]
2025-04-13 12:50:56,030 - INFO -   Noise shape: tensor([ 0.6572, -0.1393,  1.1190,  0.8713, -0.4269,  0.1973,  0.8020],
       device='cuda:0'), range: [-3.7846, 3.4139]
2025-04-13 12:50:56,031 - INFO -   Noisy actions shape: tensor([ 0.1854,  1.5266,  1.2885,  0.0933,  1.2194,  0.5899, -0.5737],
       device='cuda:0'), range: [-3.8774, 3.2005]
2025-04-13 12:50:56,072 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:56,073 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6831, 3.3694]
2025-04-13 12:50:56,073 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1525, 3.0443]
2025-04-13 12:50:56,073 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,073 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,073 - INFO -   True actions shape: tensor([-1.5942,  0.4632,  0.5507, -0.8678, -0.0879, -1.5383, -1.1056],
       device='cuda:0'), range: [-3.6831, 3.3694]
2025-04-13 12:50:56,074 - INFO -   Noise shape: tensor([ 0.3324, -1.5631, -0.4271, -0.3993, -0.7206,  0.7234,  0.4028],
       device='cuda:0'), range: [-3.5976, 3.1885]
2025-04-13 12:50:56,075 - INFO -   Noisy actions shape: tensor([-1.4169, -0.0355,  0.3942, -0.9482, -0.3034, -1.2445, -0.9301],
       device='cuda:0'), range: [-3.8910, 3.2932]
2025-04-13 12:50:56,116 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:56,116 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7358, 3.9813]
2025-04-13 12:50:56,116 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1659, 3.0329]
2025-04-13 12:50:56,116 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,116 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,117 - INFO -   True actions shape: tensor([ 0.9169, -0.5353,  0.7771, -1.4934, -0.4006, -1.0604, -0.6563],
       device='cuda:0'), range: [-3.7358, 3.9813]
2025-04-13 12:50:56,118 - INFO -   Noise shape: tensor([ 0.4333, -0.9752,  0.8678, -1.0781, -0.3850, -0.9613, -0.6594],
       device='cuda:0'), range: [-4.4934, 3.3442]
2025-04-13 12:50:56,118 - INFO -   Noisy actions shape: tensor([ 0.9797, -0.7016,  0.9201, -1.6625, -0.4631, -1.2157, -0.7639],
       device='cuda:0'), range: [-3.5163, 3.3618]
2025-04-13 12:50:56,160 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:56,160 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7873, 3.4037]
2025-04-13 12:50:56,160 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9856, 3.1989]
2025-04-13 12:50:56,160 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,160 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,161 - INFO -   True actions shape: tensor([-1.2580, -0.6201,  1.3959, -0.4868,  1.5202,  0.3281,  0.6513],
       device='cuda:0'), range: [-3.7873, 3.4037]
2025-04-13 12:50:56,161 - INFO -   Noise shape: tensor([ 0.3420, -0.3768,  0.0483, -1.9827,  0.0472, -0.3776,  0.1771],
       device='cuda:0'), range: [-3.2394, 3.2182]
2025-04-13 12:50:56,162 - INFO -   Noisy actions shape: tensor([-1.0340, -0.7167,  1.3097, -1.2030,  1.4243,  0.1602,  0.6697],
       device='cuda:0'), range: [-3.3532, 3.6067]
2025-04-13 12:50:56,203 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:56,203 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3868, 3.2046]
2025-04-13 12:50:56,203 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2859, 2.8414]
2025-04-13 12:50:56,203 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,204 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,204 - INFO -   True actions shape: tensor([-1.0541, -0.0385,  1.3674,  0.3894,  0.4952,  0.0551, -3.0008],
       device='cuda:0'), range: [-3.3868, 3.2046]
2025-04-13 12:50:56,205 - INFO -   Noise shape: tensor([-0.8585,  0.3610,  1.4255,  0.6458,  0.0621,  0.9154, -0.3310],
       device='cuda:0'), range: [-3.1407, 3.5545]
2025-04-13 12:50:56,205 - INFO -   Noisy actions shape: tensor([-1.2696,  0.0762,  1.7442,  0.5716,  0.4898,  0.3383, -2.9541],
       device='cuda:0'), range: [-3.9906, 3.7921]
2025-04-13 12:50:56,247 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:56,247 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6879, 3.3806]
2025-04-13 12:50:56,247 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3474, 2.9299]
2025-04-13 12:50:56,247 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,247 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,248 - INFO -   True actions shape: tensor([-0.7672,  0.0777,  0.6030, -0.7580,  1.9446, -0.1287, -1.0692],
       device='cuda:0'), range: [-3.6879, 3.3806]
2025-04-13 12:50:56,249 - INFO -   Noise shape: tensor([-0.0899, -1.5170,  0.2682,  0.2942,  0.3097, -2.0503, -0.7875],
       device='cuda:0'), range: [-4.0176, 3.7202]
2025-04-13 12:50:56,249 - INFO -   Noisy actions shape: tensor([-0.7429, -0.5107,  0.6597, -0.5869,  1.9145, -0.9061, -1.2896],
       device='cuda:0'), range: [-3.5435, 3.5527]
2025-04-13 12:50:56,290 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:56,291 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3684, 3.2415]
2025-04-13 12:50:56,291 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0296, 3.2957]
2025-04-13 12:50:56,291 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,291 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,292 - INFO -   True actions shape: tensor([ 0.5033,  0.9694,  1.2446, -0.4800,  1.0856, -0.6262, -0.4557],
       device='cuda:0'), range: [-3.3684, 3.2415]
2025-04-13 12:50:56,292 - INFO -   Noise shape: tensor([-1.0173, -0.0614, -1.5554, -0.5764, -0.7831,  0.4680, -1.3922],
       device='cuda:0'), range: [-3.2755, 3.4831]
2025-04-13 12:50:56,293 - INFO -   Noisy actions shape: tensor([-0.9517,  0.0520, -1.3996, -0.6284, -0.6511,  0.3918, -1.4358],
       device='cuda:0'), range: [-3.5604, 4.0731]
2025-04-13 12:50:56,334 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:56,334 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1439, 4.0087]
2025-04-13 12:50:56,334 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8226, 3.1627]
2025-04-13 12:50:56,334 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,334 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,335 - INFO -   True actions shape: tensor([ 0.2360,  1.3878, -0.6302, -0.1315,  2.3313,  0.1314,  1.1076],
       device='cuda:0'), range: [-3.1439, 4.0087]
2025-04-13 12:50:56,336 - INFO -   Noise shape: tensor([ 1.2042,  0.8937,  0.8857, -0.3822, -0.3278,  0.1310, -1.0620],
       device='cuda:0'), range: [-3.9708, 3.3484]
2025-04-13 12:50:56,336 - INFO -   Noisy actions shape: tensor([ 1.2271,  1.1454,  0.7470, -0.4004,  0.1297,  0.1540, -0.8275],
       device='cuda:0'), range: [-3.2381, 3.9980]
2025-04-13 12:50:56,379 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:56,379 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0079, 3.8632]
2025-04-13 12:50:56,379 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8803, 3.0741]
2025-04-13 12:50:56,379 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,379 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,380 - INFO -   True actions shape: tensor([ 0.4335,  0.0132, -0.2447,  1.0392,  0.7844, -2.0190,  0.8320],
       device='cuda:0'), range: [-3.0079, 3.8632]
2025-04-13 12:50:56,380 - INFO -   Noise shape: tensor([ 0.0477, -1.3502, -0.3702, -0.9528,  1.7075,  1.9512, -0.6049],
       device='cuda:0'), range: [-3.5756, 3.6719]
2025-04-13 12:50:56,381 - INFO -   Noisy actions shape: tensor([ 0.1900, -1.2679, -0.4307, -0.5501,  1.8716,  1.1629, -0.2915],
       device='cuda:0'), range: [-3.4506, 4.3110]
2025-04-13 12:50:56,420 - INFO -   Loss components:
2025-04-13 12:50:56,420 - INFO -     Diffusion loss: 2.222592 (coef: 1.0)
2025-04-13 12:50:56,420 - INFO -     Grasp quality loss: 0.692830 (coef: 0.5)
2025-04-13 12:50:56,420 - INFO -     Grasp rotation loss: 0.578649 (coef: 0.5)
2025-04-13 12:50:56,420 - INFO -     Grasp width loss: 38.711895 (coef: 0.005)
2025-04-13 12:50:56,420 - INFO -     TOTAL loss: 3.051891
2025-04-13 12:50:56,428 - INFO -   Gradients: avg norm: 0.669228, max norm: 4.943232, non-zero params: 250
2025-04-13 12:50:56,428 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:50:56,431 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:56,431 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6415, 2.9397]
2025-04-13 12:50:56,431 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2696, 3.2942]
2025-04-13 12:50:56,431 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,431 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,432 - INFO -   True actions shape: tensor([ 1.8793,  0.6108, -0.9387, -0.0830, -0.5113,  1.1325,  0.7660],
       device='cuda:0'), range: [-3.6415, 2.9397]
2025-04-13 12:50:56,432 - INFO -   Noise shape: tensor([-0.8600, -1.0771, -0.6817,  0.6910, -0.1502,  0.7381, -0.7206],
       device='cuda:0'), range: [-3.4221, 3.5666]
2025-04-13 12:50:56,433 - INFO -   Noisy actions shape: tensor([-0.6135, -0.9905, -0.7957,  0.6748, -0.2141,  0.8764, -0.6171],
       device='cuda:0'), range: [-3.6143, 3.2846]
2025-04-13 12:50:56,474 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:56,475 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3449, 3.4978]
2025-04-13 12:50:56,475 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5545, 2.8210]
2025-04-13 12:50:56,475 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,475 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,476 - INFO -   True actions shape: tensor([-1.1597, -0.8767, -1.7761,  1.4214, -1.2081, -0.4013,  0.2321],
       device='cuda:0'), range: [-3.3449, 3.4978]
2025-04-13 12:50:56,476 - INFO -   Noise shape: tensor([ 0.7107, -0.0182, -0.2024, -0.3088, -1.5277, -0.0263,  0.3047],
       device='cuda:0'), range: [-3.4176, 3.5878]
2025-04-13 12:50:56,477 - INFO -   Noisy actions shape: tensor([-1.1468, -0.8769, -1.7794,  1.4156, -1.2353, -0.4017,  0.2376],
       device='cuda:0'), range: [-3.1661, 3.4981]
2025-04-13 12:50:56,517 - INFO - 
=== Epoch 6 Summary ===
2025-04-13 12:50:56,517 - INFO -   Avg total loss: 3.035377
2025-04-13 12:50:56,517 - INFO -   Avg diffusion loss: 2.166174
2025-04-13 12:50:56,517 - INFO -   Avg grasp loss: 1.738406
2025-04-13 12:50:56,517 - INFO - 
=== EPOCH 7/20 ===
2025-04-13 12:50:56,519 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:56,521 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:56,521 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6659, 3.3272]
2025-04-13 12:50:56,521 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9834, 2.8690]
2025-04-13 12:50:56,522 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,522 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,522 - INFO -   True actions shape: tensor([-1.4228, -1.1836,  0.3998,  0.8355, -1.1678, -0.6905,  0.0017],
       device='cuda:0'), range: [-3.6659, 3.3272]
2025-04-13 12:50:56,523 - INFO -   Noise shape: tensor([-0.4489,  0.8178, -2.0723, -0.8740, -1.5933,  0.8790,  0.3369],
       device='cuda:0'), range: [-3.7291, 3.5562]
2025-04-13 12:50:56,524 - INFO -   Noisy actions shape: tensor([-0.8194,  0.4645, -1.8851, -0.6134, -1.8512,  0.6577,  0.3246],
       device='cuda:0'), range: [-4.0260, 3.2970]
2025-04-13 12:50:56,524 - INFO -   Diffusion: timestep range [60, 845], noise range [-3.7291, 3.5562]
2025-04-13 12:50:56,524 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.0260, 3.2970]
2025-04-13 12:50:56,542 - INFO -   Model output shapes:
2025-04-13 12:50:56,542 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:56,542 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4098, 0.5911]
2025-04-13 12:50:56,543 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.2947
2025-04-13 12:50:56,543 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3919, 0.4152]
2025-04-13 12:50:56,564 - INFO -   Loss components:
2025-04-13 12:50:56,564 - INFO -     Diffusion loss: 1.992802 (coef: 1.0)
2025-04-13 12:50:56,564 - INFO -     Grasp quality loss: 0.694740 (coef: 0.5)
2025-04-13 12:50:56,564 - INFO -     Grasp rotation loss: 0.589231 (coef: 0.5)
2025-04-13 12:50:56,564 - INFO -     Grasp width loss: 39.078346 (coef: 0.005)
2025-04-13 12:50:56,564 - INFO -     TOTAL loss: 2.830179
2025-04-13 12:50:56,572 - INFO -   Gradients: avg norm: 0.550008, max norm: 3.811363, non-zero params: 250
2025-04-13 12:50:56,572 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:50:56,572 - INFO - --- Gradient Check @ Epoch 7, Batch 0 ---
2025-04-13 12:50:56,590 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:56,591 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:56,591 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.8849e-01, MaxNorm=3.1840e+00
2025-04-13 12:50:56,591 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=8.3021e-03, MaxNorm=2.5174e-02
2025-04-13 12:50:56,591 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.2032e-02, MaxNorm=3.6789e-02
2025-04-13 12:50:56,591 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.4505e-01, MaxNorm=1.2989e+00
2025-04-13 12:50:56,591 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5406e+00, MaxNorm=2.7626e+00
2025-04-13 12:50:56,591 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.4663e+00, MaxNorm=2.6229e+00
2025-04-13 12:50:56,591 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.2565e-01, MaxNorm=5.8620e-01
2025-04-13 12:50:56,591 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.6380e+00, MaxNorm=1.7871e+00
2025-04-13 12:50:56,591 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1825e+00, MaxNorm=1.2094e+00
2025-04-13 12:50:56,591 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.1160e+00, MaxNorm=3.8114e+00
2025-04-13 12:50:56,591 - INFO - --- End Gradient Check ---
2025-04-13 12:50:56,594 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:56,594 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7769, 4.0645]
2025-04-13 12:50:56,594 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4309, 2.5541]
2025-04-13 12:50:56,594 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,594 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,595 - INFO -   True actions shape: tensor([-1.1394, -0.3986,  0.1559,  0.0927,  1.4407,  0.9476,  0.2865],
       device='cuda:0'), range: [-3.7769, 4.0645]
2025-04-13 12:50:56,596 - INFO -   Noise shape: tensor([-0.2566, -0.8437, -1.3328,  0.0523,  0.0702,  0.0920,  0.7795],
       device='cuda:0'), range: [-3.5830, 3.2264]
2025-04-13 12:50:56,596 - INFO -   Noisy actions shape: tensor([-0.5493, -0.9191, -1.2439,  0.0750,  0.4493,  0.3397,  0.8275],
       device='cuda:0'), range: [-3.8399, 3.2686]
2025-04-13 12:50:56,641 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:56,642 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6733, 3.7194]
2025-04-13 12:50:56,642 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6678, 3.3056]
2025-04-13 12:50:56,642 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,642 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,643 - INFO -   True actions shape: tensor([ 1.1017,  1.3510,  0.9546,  0.7650,  1.7516,  0.0955, -0.1460],
       device='cuda:0'), range: [-3.6733, 3.7194]
2025-04-13 12:50:56,643 - INFO -   Noise shape: tensor([-0.1656, -2.2940, -0.4491,  0.6030, -1.3370,  0.0863,  0.5254],
       device='cuda:0'), range: [-3.5273, 3.4879]
2025-04-13 12:50:56,644 - INFO -   Noisy actions shape: tensor([ 0.3978, -1.3327,  0.0786,  0.9013, -0.3024,  0.1222,  0.3856],
       device='cuda:0'), range: [-3.7554, 4.1955]
2025-04-13 12:50:56,688 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:56,688 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8655, 3.5003]
2025-04-13 12:50:56,688 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1227, 2.5309]
2025-04-13 12:50:56,688 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,688 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,689 - INFO -   True actions shape: tensor([-0.0467, -1.9580, -0.5036,  0.0329,  0.4389,  0.1399, -0.6845],
       device='cuda:0'), range: [-3.8655, 3.5003]
2025-04-13 12:50:56,690 - INFO -   Noise shape: tensor([-1.8205,  0.4715,  0.4545, -1.2505,  1.7880, -0.3497, -0.5622],
       device='cuda:0'), range: [-3.1391, 3.6582]
2025-04-13 12:50:56,690 - INFO -   Noisy actions shape: tensor([-1.7829,  0.0114,  0.3274, -1.2099,  1.8410, -0.3084, -0.7038],
       device='cuda:0'), range: [-3.7890, 3.6539]
2025-04-13 12:50:56,732 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:56,733 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6991, 3.5761]
2025-04-13 12:50:56,733 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7249, 3.2268]
2025-04-13 12:50:56,733 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,733 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,734 - INFO -   True actions shape: tensor([ 1.2224,  0.5549, -0.9271,  1.3688, -0.3282,  1.0912,  1.5175],
       device='cuda:0'), range: [-3.6991, 3.5761]
2025-04-13 12:50:56,734 - INFO -   Noise shape: tensor([ 0.6566, -0.0848,  0.1339, -0.0512, -0.3800,  0.5620, -1.7873],
       device='cuda:0'), range: [-3.3187, 3.4004]
2025-04-13 12:50:56,735 - INFO -   Noisy actions shape: tensor([ 1.2997,  0.3021, -0.5107,  0.8641, -0.5021,  1.1420, -0.3431],
       device='cuda:0'), range: [-3.8937, 3.4804]
2025-04-13 12:50:56,776 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:56,777 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1826, 4.3699]
2025-04-13 12:50:56,777 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2304, 3.0592]
2025-04-13 12:50:56,777 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,777 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,778 - INFO -   True actions shape: tensor([-1.0923,  0.4425, -0.2369,  0.2806, -0.6548,  0.2066, -1.7791],
       device='cuda:0'), range: [-4.1826, 4.3699]
2025-04-13 12:50:56,778 - INFO -   Noise shape: tensor([-0.4086, -0.4166, -0.4546,  1.7525, -1.9975,  0.0158,  0.7895],
       device='cuda:0'), range: [-3.7202, 3.4527]
2025-04-13 12:50:56,779 - INFO -   Noisy actions shape: tensor([-1.1174,  0.4135, -0.2670,  0.3980, -0.7879,  0.2072, -1.7219],
       device='cuda:0'), range: [-4.3102, 3.0411]
2025-04-13 12:50:56,820 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:56,820 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4723, 3.4566]
2025-04-13 12:50:56,820 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9470, 2.5638]
2025-04-13 12:50:56,820 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,820 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,821 - INFO -   True actions shape: tensor([ 0.8303, -1.8451, -1.4308,  0.6103,  0.0728, -0.0381,  0.0198],
       device='cuda:0'), range: [-3.4723, 3.4566]
2025-04-13 12:50:56,822 - INFO -   Noise shape: tensor([ 0.0912, -0.0067, -1.3861,  0.7127,  0.8840,  0.3648, -0.9350],
       device='cuda:0'), range: [-3.7688, 3.6686]
2025-04-13 12:50:56,822 - INFO -   Noisy actions shape: tensor([ 0.8244, -1.7797, -1.7495,  0.7788,  0.3067,  0.0609, -0.2311],
       device='cuda:0'), range: [-3.7565, 3.2449]
2025-04-13 12:50:56,864 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:56,864 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5667, 3.5160]
2025-04-13 12:50:56,864 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0967, 2.9878]
2025-04-13 12:50:56,864 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,864 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,865 - INFO -   True actions shape: tensor([ 0.8649,  0.4852,  0.3638,  0.1801,  1.8814,  0.3972, -0.1347],
       device='cuda:0'), range: [-3.5667, 3.5160]
2025-04-13 12:50:56,866 - INFO -   Noise shape: tensor([-0.1487,  0.6631,  0.3009, -0.3053, -0.4340,  0.2924, -0.8842],
       device='cuda:0'), range: [-3.1198, 3.4718]
2025-04-13 12:50:56,866 - INFO -   Noisy actions shape: tensor([ 0.7537,  0.6911,  0.4476,  0.0583,  1.5997,  0.4757, -0.4435],
       device='cuda:0'), range: [-3.0607, 3.0469]
2025-04-13 12:50:56,908 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:56,908 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5675, 3.1884]
2025-04-13 12:50:56,908 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1241, 2.9601]
2025-04-13 12:50:56,908 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,908 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,909 - INFO -   True actions shape: tensor([ 0.8821, -0.3108, -0.4594, -0.2879,  0.5210,  0.4031,  0.6198],
       device='cuda:0'), range: [-3.5675, 3.1884]
2025-04-13 12:50:56,909 - INFO -   Noise shape: tensor([-0.8793, -0.7233, -1.3120, -2.4850,  0.2773, -2.2259,  0.3241],
       device='cuda:0'), range: [-3.3922, 3.0230]
2025-04-13 12:50:56,910 - INFO -   Noisy actions shape: tensor([-0.7175, -0.7655, -1.3707, -2.4979,  0.3614, -2.1257,  0.4243],
       device='cuda:0'), range: [-3.6295, 3.1471]
2025-04-13 12:50:56,952 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:56,952 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.4404, 3.5954]
2025-04-13 12:50:56,952 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2760, 4.0243]
2025-04-13 12:50:56,952 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,952 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,953 - INFO -   True actions shape: tensor([-1.5288,  0.0228, -0.2121,  0.1172,  0.9734,  0.6785, -0.3000],
       device='cuda:0'), range: [-4.4404, 3.5954]
2025-04-13 12:50:56,953 - INFO -   Noise shape: tensor([-0.1035,  0.3809,  0.9334, -0.5409, -0.8282, -0.2994, -1.1832],
       device='cuda:0'), range: [-4.0346, 3.3885]
2025-04-13 12:50:56,954 - INFO -   Noisy actions shape: tensor([-0.1273,  0.3812,  0.9300, -0.5391, -0.8129, -0.2888, -1.1877],
       device='cuda:0'), range: [-3.9555, 3.4972]
2025-04-13 12:50:56,996 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:56,996 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2092, 3.5810]
2025-04-13 12:50:56,996 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9789, 3.2128]
2025-04-13 12:50:56,996 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:56,996 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:56,997 - INFO -   True actions shape: tensor([-1.0020,  0.5615, -0.9743, -0.3490,  0.4349,  1.4335, -0.5806],
       device='cuda:0'), range: [-3.2092, 3.5810]
2025-04-13 12:50:56,998 - INFO -   Noise shape: tensor([ 1.8086,  0.1029,  0.5865, -1.4483, -0.9271, -1.9674, -0.1707],
       device='cuda:0'), range: [-3.3574, 3.4381]
2025-04-13 12:50:56,998 - INFO -   Noisy actions shape: tensor([-0.5720,  0.5703, -0.8184, -0.6642,  0.2165,  0.9570, -0.6041],
       device='cuda:0'), range: [-3.3177, 3.4381]
2025-04-13 12:50:57,038 - INFO -   Loss components:
2025-04-13 12:50:57,038 - INFO -     Diffusion loss: 1.916374 (coef: 1.0)
2025-04-13 12:50:57,038 - INFO -     Grasp quality loss: 0.694911 (coef: 0.5)
2025-04-13 12:50:57,038 - INFO -     Grasp rotation loss: 0.567468 (coef: 0.5)
2025-04-13 12:50:57,038 - INFO -     Grasp width loss: 35.034561 (coef: 0.005)
2025-04-13 12:50:57,038 - INFO -     TOTAL loss: 2.722737
2025-04-13 12:50:57,046 - INFO -   Gradients: avg norm: 0.565727, max norm: 3.994902, non-zero params: 250
2025-04-13 12:50:57,046 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:50:57,048 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:57,048 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0782, 3.3956]
2025-04-13 12:50:57,048 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9992, 3.5859]
2025-04-13 12:50:57,049 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,049 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,049 - INFO -   True actions shape: tensor([-0.2840,  1.0894, -1.0872, -0.1974, -0.8788, -0.4732,  1.9481],
       device='cuda:0'), range: [-3.0782, 3.3956]
2025-04-13 12:50:57,050 - INFO -   Noise shape: tensor([-0.0674,  0.7476,  1.1262, -1.7184, -0.7319,  0.6357, -1.5350],
       device='cuda:0'), range: [-4.0262, 3.7368]
2025-04-13 12:50:57,050 - INFO -   Noisy actions shape: tensor([-0.2220,  1.2464,  0.2676, -1.5038, -1.1094,  0.2340, -0.0896],
       device='cuda:0'), range: [-3.5410, 3.4350]
2025-04-13 12:50:57,092 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:57,092 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4742, 3.9285]
2025-04-13 12:50:57,092 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2093, 2.4780]
2025-04-13 12:50:57,092 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,092 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,093 - INFO -   True actions shape: tensor([ 0.8997,  1.3838, -0.4497,  0.4521, -0.8341, -2.9042, -0.6822],
       device='cuda:0'), range: [-3.4742, 3.9285]
2025-04-13 12:50:57,093 - INFO -   Noise shape: tensor([ 2.7865, -0.9417,  0.7412,  0.7788, -0.5633,  0.4081, -0.8042],
       device='cuda:0'), range: [-3.2733, 3.2707]
2025-04-13 12:50:57,094 - INFO -   Noisy actions shape: tensor([ 2.7945,  0.0303,  0.3455,  0.8969, -0.9416, -1.3439, -1.0505],
       device='cuda:0'), range: [-3.3340, 3.1707]
2025-04-13 12:50:57,133 - INFO - 
=== Epoch 7 Summary ===
2025-04-13 12:50:57,133 - INFO -   Avg total loss: 2.793822
2025-04-13 12:50:57,133 - INFO -   Avg diffusion loss: 1.978193
2025-04-13 12:50:57,133 - INFO -   Avg grasp loss: 1.631258
2025-04-13 12:50:57,133 - INFO - 
=== EPOCH 8/20 ===
2025-04-13 12:50:57,134 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:57,137 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:57,137 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7682, 3.5519]
2025-04-13 12:50:57,137 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0044, 3.0535]
2025-04-13 12:50:57,137 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,137 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,138 - INFO -   True actions shape: tensor([ 0.2017, -0.3845,  0.2122,  2.0829, -0.6554,  0.7675, -0.4450],
       device='cuda:0'), range: [-3.7682, 3.5519]
2025-04-13 12:50:57,139 - INFO -   Noise shape: tensor([ 0.1730, -0.3229, -0.2226,  0.3200,  1.7640, -2.5595,  0.7571],
       device='cuda:0'), range: [-3.2271, 4.0764]
2025-04-13 12:50:57,139 - INFO -   Noisy actions shape: tensor([ 0.2211, -0.4206,  0.1838,  2.1063, -0.4379,  0.4531, -0.3504],
       device='cuda:0'), range: [-3.8615, 3.6306]
2025-04-13 12:50:57,139 - INFO -   Diffusion: timestep range [69, 822], noise range [-3.2271, 4.0764]
2025-04-13 12:50:57,140 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8615, 3.6306]
2025-04-13 12:50:57,158 - INFO -   Model output shapes:
2025-04-13 12:50:57,158 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:57,158 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4281, 0.5948]
2025-04-13 12:50:57,158 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3110
2025-04-13 12:50:57,158 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3109, 0.4494]
2025-04-13 12:50:57,179 - INFO -   Loss components:
2025-04-13 12:50:57,179 - INFO -     Diffusion loss: 2.136613 (coef: 1.0)
2025-04-13 12:50:57,179 - INFO -     Grasp quality loss: 0.692549 (coef: 0.5)
2025-04-13 12:50:57,179 - INFO -     Grasp rotation loss: 0.575667 (coef: 0.5)
2025-04-13 12:50:57,179 - INFO -     Grasp width loss: 32.677498 (coef: 0.005)
2025-04-13 12:50:57,179 - INFO -     TOTAL loss: 2.934109
2025-04-13 12:50:57,187 - INFO -   Gradients: avg norm: 0.559665, max norm: 4.171120, non-zero params: 250
2025-04-13 12:50:57,187 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-13 12:50:57,187 - INFO - --- Gradient Check @ Epoch 8, Batch 0 ---
2025-04-13 12:50:57,204 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:57,204 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:57,204 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.2805e-01, MaxNorm=3.5699e+00
2025-04-13 12:50:57,204 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=7.3618e-03, MaxNorm=1.5973e-02
2025-04-13 12:50:57,204 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.6911e-03, MaxNorm=2.1118e-02
2025-04-13 12:50:57,204 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.7799e-01, MaxNorm=9.7550e-01
2025-04-13 12:50:57,204 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.4272e+00, MaxNorm=2.6569e+00
2025-04-13 12:50:57,204 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.5457e+00, MaxNorm=2.7898e+00
2025-04-13 12:50:57,204 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.4129e-01, MaxNorm=6.5704e-01
2025-04-13 12:50:57,204 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.3848e+00, MaxNorm=1.4738e+00
2025-04-13 12:50:57,204 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2517e+00, MaxNorm=1.2785e+00
2025-04-13 12:50:57,204 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.2883e+00, MaxNorm=4.1711e+00
2025-04-13 12:50:57,204 - INFO - --- End Gradient Check ---
2025-04-13 12:50:57,206 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:57,207 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1095, 3.4661]
2025-04-13 12:50:57,207 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0675, 3.5966]
2025-04-13 12:50:57,207 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,207 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,207 - INFO -   True actions shape: tensor([ 0.1828, -1.0185,  0.9625, -1.2117, -1.2680, -0.3796, -0.4449],
       device='cuda:0'), range: [-4.1095, 3.4661]
2025-04-13 12:50:57,208 - INFO -   Noise shape: tensor([-0.6651,  1.5578,  1.8026, -0.9939,  0.1053, -0.4716,  0.0455],
       device='cuda:0'), range: [-3.1537, 2.7659]
2025-04-13 12:50:57,209 - INFO -   Noisy actions shape: tensor([ 0.1183, -0.8648,  1.1305, -1.3012, -1.2521, -0.4230, -0.4385],
       device='cuda:0'), range: [-3.3088, 2.8312]
2025-04-13 12:50:57,250 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:57,250 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5671, 3.6549]
2025-04-13 12:50:57,251 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7630, 3.1270]
2025-04-13 12:50:57,251 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,251 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,251 - INFO -   True actions shape: tensor([-0.0665,  0.3696,  0.4524, -1.4557, -0.2278,  1.2339, -1.7170],
       device='cuda:0'), range: [-3.5671, 3.6549]
2025-04-13 12:50:57,252 - INFO -   Noise shape: tensor([ 1.1024,  0.1545, -0.5598, -1.2806,  0.4802, -0.3172, -1.3847],
       device='cuda:0'), range: [-3.2615, 3.1447]
2025-04-13 12:50:57,253 - INFO -   Noisy actions shape: tensor([ 0.8158,  0.3524, -0.1512, -1.9110,  0.2304,  0.5286, -2.1561],
       device='cuda:0'), range: [-3.2121, 3.3076]
2025-04-13 12:50:57,294 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:57,294 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7863, 3.7842]
2025-04-13 12:50:57,294 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0498, 2.9997]
2025-04-13 12:50:57,294 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,294 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,295 - INFO -   True actions shape: tensor([-0.2580,  0.7254,  0.8893, -1.0395, -1.5959, -0.7129, -0.0078],
       device='cuda:0'), range: [-3.7863, 3.7842]
2025-04-13 12:50:57,296 - INFO -   Noise shape: tensor([-0.4615, -0.5171, -0.6605, -1.9069,  0.9578, -0.2773, -1.5021],
       device='cuda:0'), range: [-3.6002, 3.8617]
2025-04-13 12:50:57,296 - INFO -   Noisy actions shape: tensor([-0.5107, -0.3234, -0.4222, -2.1036,  0.5371, -0.4437, -1.4582],
       device='cuda:0'), range: [-3.8709, 3.9335]
2025-04-13 12:50:57,338 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:57,338 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6583, 2.9882]
2025-04-13 12:50:57,338 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4030, 2.7011]
2025-04-13 12:50:57,338 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,338 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,339 - INFO -   True actions shape: tensor([ 0.5367, -0.2187,  1.3413,  0.2965,  0.5360, -0.6397, -0.1303],
       device='cuda:0'), range: [-3.6583, 2.9882]
2025-04-13 12:50:57,340 - INFO -   Noise shape: tensor([-0.4591, -0.3783,  0.8997, -0.8164, -1.0360,  0.8707, -0.3126],
       device='cuda:0'), range: [-5.0184, 4.0344]
2025-04-13 12:50:57,340 - INFO -   Noisy actions shape: tensor([-0.2083, -0.4340,  1.3583, -0.6316, -0.7380,  0.5451, -0.3387],
       device='cuda:0'), range: [-4.2870, 3.5329]
2025-04-13 12:50:57,382 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:57,382 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6770, 3.3629]
2025-04-13 12:50:57,382 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4156, 3.1865]
2025-04-13 12:50:57,382 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,382 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,383 - INFO -   True actions shape: tensor([-0.7749,  0.3882,  0.5266,  1.9874,  0.0787,  1.9633, -0.5234],
       device='cuda:0'), range: [-3.6770, 3.3629]
2025-04-13 12:50:57,383 - INFO -   Noise shape: tensor([ 0.3484,  0.1759, -1.6015, -0.1245,  0.1717,  0.4119, -0.2967],
       device='cuda:0'), range: [-2.9676, 3.5124]
2025-04-13 12:50:57,384 - INFO -   Noisy actions shape: tensor([-0.7578,  0.3959,  0.4513,  1.9794,  0.0866,  1.9804, -0.5367],
       device='cuda:0'), range: [-3.7544, 3.3972]
2025-04-13 12:50:57,425 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:57,425 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3641, 4.2486]
2025-04-13 12:50:57,425 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.4996, 3.2532]
2025-04-13 12:50:57,426 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,426 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,426 - INFO -   True actions shape: tensor([-1.2615, -0.2056,  0.6989, -1.3813, -0.9349, -0.9398,  2.2732],
       device='cuda:0'), range: [-3.3641, 4.2486]
2025-04-13 12:50:57,427 - INFO -   Noise shape: tensor([-0.9046, -0.7431,  0.4955, -0.3767,  0.8344, -0.0525,  0.9892],
       device='cuda:0'), range: [-3.1158, 3.5356]
2025-04-13 12:50:57,427 - INFO -   Noisy actions shape: tensor([-1.5421, -0.6517,  0.8505, -1.2759, -0.1315, -0.7312,  2.3481],
       device='cuda:0'), range: [-3.2855, 4.4476]
2025-04-13 12:50:57,469 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:57,469 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9345, 3.1637]
2025-04-13 12:50:57,469 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9142, 2.7435]
2025-04-13 12:50:57,469 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,469 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,470 - INFO -   True actions shape: tensor([-0.6730,  0.6252,  0.8580, -0.6227,  0.4994,  1.9399,  0.5425],
       device='cuda:0'), range: [-3.9345, 3.1637]
2025-04-13 12:50:57,470 - INFO -   Noise shape: tensor([ 0.7820, -1.8435,  2.1091,  0.2129,  1.5620,  1.4209,  0.1455],
       device='cuda:0'), range: [-3.0861, 2.8107]
2025-04-13 12:50:57,471 - INFO -   Noisy actions shape: tensor([ 0.6717, -1.7283,  2.2142,  0.1167,  1.6194,  1.6968,  0.2255],
       device='cuda:0'), range: [-3.6675, 3.4009]
2025-04-13 12:50:57,512 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:57,513 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7379, 3.1883]
2025-04-13 12:50:57,513 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6355, 3.5125]
2025-04-13 12:50:57,513 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,513 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,514 - INFO -   True actions shape: tensor([-0.5173, -2.1589,  1.3009, -0.9761,  0.4636, -0.7538, -0.5229],
       device='cuda:0'), range: [-3.7379, 3.1883]
2025-04-13 12:50:57,514 - INFO -   Noise shape: tensor([-0.8492, -0.0290, -0.1999, -2.5565, -0.2787,  0.5319,  0.2177],
       device='cuda:0'), range: [-3.2231, 3.6740]
2025-04-13 12:50:57,515 - INFO -   Noisy actions shape: tensor([-0.9800, -1.4404,  0.7041, -2.5685,  0.0946, -0.0943, -0.1795],
       device='cuda:0'), range: [-3.7723, 3.5802]
2025-04-13 12:50:57,556 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:57,557 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8528, 3.4620]
2025-04-13 12:50:57,557 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4492, 3.7508]
2025-04-13 12:50:57,557 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,557 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,558 - INFO -   True actions shape: tensor([ 1.8054, -0.3731, -0.5167, -1.6764, -1.5976, -0.4844,  0.5896],
       device='cuda:0'), range: [-3.8528, 3.4620]
2025-04-13 12:50:57,558 - INFO -   Noise shape: tensor([ 0.3955,  0.3818, -0.1091,  0.1768, -0.8418,  0.5195,  0.1909],
       device='cuda:0'), range: [-3.3042, 3.3190]
2025-04-13 12:50:57,559 - INFO -   Noisy actions shape: tensor([ 1.8034, -0.1768, -0.5144, -1.4447, -1.8037, -0.2196,  0.6150],
       device='cuda:0'), range: [-4.0256, 3.0938]
2025-04-13 12:50:57,601 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:57,601 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3025, 2.9300]
2025-04-13 12:50:57,601 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7029, 2.8895]
2025-04-13 12:50:57,602 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,602 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,602 - INFO -   True actions shape: tensor([ 0.5631, -0.4713,  0.2736, -0.1836,  0.0469,  1.0909, -2.1965],
       device='cuda:0'), range: [-3.3025, 2.9300]
2025-04-13 12:50:57,603 - INFO -   Noise shape: tensor([-2.0904, -0.1781,  0.5288,  0.8682,  0.1194,  1.6646,  1.3409],
       device='cuda:0'), range: [-3.8752, 3.8265]
2025-04-13 12:50:57,603 - INFO -   Noisy actions shape: tensor([ 0.2598, -0.4918,  0.3461, -0.0581,  0.0634,  1.3168, -1.9832],
       device='cuda:0'), range: [-3.3542, 3.7589]
2025-04-13 12:50:57,642 - INFO -   Loss components:
2025-04-13 12:50:57,643 - INFO -     Diffusion loss: 1.832758 (coef: 1.0)
2025-04-13 12:50:57,643 - INFO -     Grasp quality loss: 0.696231 (coef: 0.5)
2025-04-13 12:50:57,643 - INFO -     Grasp rotation loss: 0.572131 (coef: 0.5)
2025-04-13 12:50:57,643 - INFO -     Grasp width loss: 31.157986 (coef: 0.005)
2025-04-13 12:50:57,643 - INFO -     TOTAL loss: 2.622729
2025-04-13 12:50:57,650 - INFO -   Gradients: avg norm: 0.570988, max norm: 3.804455, non-zero params: 250
2025-04-13 12:50:57,650 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:50:57,653 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:57,653 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9607, 3.5962]
2025-04-13 12:50:57,653 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4139, 3.0783]
2025-04-13 12:50:57,653 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,653 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,654 - INFO -   True actions shape: tensor([-0.9141,  0.4129,  0.5012, -0.5364, -0.4926, -0.2047,  1.1856],
       device='cuda:0'), range: [-2.9607, 3.5962]
2025-04-13 12:50:57,655 - INFO -   Noise shape: tensor([-0.8533, -1.2583,  0.1591, -1.0155,  0.4640,  0.3985, -0.7343],
       device='cuda:0'), range: [-3.4035, 3.1389]
2025-04-13 12:50:57,655 - INFO -   Noisy actions shape: tensor([-1.0587,  0.1682,  0.5222, -0.7183, -0.3962, -0.1259,  1.0258],
       device='cuda:0'), range: [-3.8402, 3.4716]
2025-04-13 12:50:57,699 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:57,699 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0565, 3.3170]
2025-04-13 12:50:57,699 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7411, 3.4821]
2025-04-13 12:50:57,699 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,700 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,700 - INFO -   True actions shape: tensor([-0.3053, -0.2768, -0.7099,  0.0710,  0.2412,  0.1906,  0.3153],
       device='cuda:0'), range: [-3.0565, 3.3170]
2025-04-13 12:50:57,701 - INFO -   Noise shape: tensor([-0.1601,  0.4803,  0.5146,  0.2938,  0.8344,  1.1411,  0.0321],
       device='cuda:0'), range: [-3.3403, 3.8731]
2025-04-13 12:50:57,701 - INFO -   Noisy actions shape: tensor([-0.3208, -0.2232, -0.6501,  0.1024,  0.3301,  0.3129,  0.3169],
       device='cuda:0'), range: [-3.3399, 3.4404]
2025-04-13 12:50:57,743 - INFO - 
=== Epoch 8 Summary ===
2025-04-13 12:50:57,743 - INFO -   Avg total loss: 2.807239
2025-04-13 12:50:57,743 - INFO -   Avg diffusion loss: 1.999731
2025-04-13 12:50:57,743 - INFO -   Avg grasp loss: 1.615016
2025-04-13 12:50:57,743 - INFO - 
=== EPOCH 9/20 ===
2025-04-13 12:50:57,744 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:57,747 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:57,748 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3231, 3.7234]
2025-04-13 12:50:57,748 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0042, 3.1135]
2025-04-13 12:50:57,748 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,748 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,749 - INFO -   True actions shape: tensor([-0.6673,  0.2172, -0.8477, -1.6229,  0.3309, -1.1397,  0.5296],
       device='cuda:0'), range: [-3.3231, 3.7234]
2025-04-13 12:50:57,749 - INFO -   Noise shape: tensor([ 0.1255, -1.2196,  0.8258, -0.1370, -0.4059,  0.3900, -0.8792],
       device='cuda:0'), range: [-3.0257, 3.4074]
2025-04-13 12:50:57,750 - INFO -   Noisy actions shape: tensor([-0.5096, -0.4361, -0.3071, -1.4653,  0.0772, -0.7808,  0.0064],
       device='cuda:0'), range: [-3.3542, 3.3626]
2025-04-13 12:50:57,750 - INFO -   Diffusion: timestep range [208, 984], noise range [-3.0257, 3.4074]
2025-04-13 12:50:57,750 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3542, 3.3626]
2025-04-13 12:50:57,769 - INFO -   Model output shapes:
2025-04-13 12:50:57,769 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:57,770 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4186, 0.5836]
2025-04-13 12:50:57,770 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3241
2025-04-13 12:50:57,770 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3014, 0.5044]
2025-04-13 12:50:57,793 - INFO -   Loss components:
2025-04-13 12:50:57,793 - INFO -     Diffusion loss: 1.835515 (coef: 1.0)
2025-04-13 12:50:57,793 - INFO -     Grasp quality loss: 0.688688 (coef: 0.5)
2025-04-13 12:50:57,793 - INFO -     Grasp rotation loss: 0.551279 (coef: 0.5)
2025-04-13 12:50:57,793 - INFO -     Grasp width loss: 29.125904 (coef: 0.005)
2025-04-13 12:50:57,793 - INFO -     TOTAL loss: 2.601127
2025-04-13 12:50:57,802 - INFO -   Gradients: avg norm: 0.544376, max norm: 3.713703, non-zero params: 250
2025-04-13 12:50:57,802 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:50:57,802 - INFO - --- Gradient Check @ Epoch 9, Batch 0 ---
2025-04-13 12:50:57,821 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:57,821 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:57,821 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.8072e-01, MaxNorm=3.5156e+00
2025-04-13 12:50:57,821 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=3.9325e-02, MaxNorm=1.2290e-01
2025-04-13 12:50:57,821 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.2977e-02, MaxNorm=5.8910e-02
2025-04-13 12:50:57,821 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.4633e-01, MaxNorm=1.1614e+00
2025-04-13 12:50:57,821 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3878e+00, MaxNorm=2.6584e+00
2025-04-13 12:50:57,821 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3105e+00, MaxNorm=2.4537e+00
2025-04-13 12:50:57,821 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.2477e-01, MaxNorm=5.5734e-01
2025-04-13 12:50:57,821 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.4683e+00, MaxNorm=1.5832e+00
2025-04-13 12:50:57,821 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0853e+00, MaxNorm=1.1088e+00
2025-04-13 12:50:57,821 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.0336e+00, MaxNorm=3.7137e+00
2025-04-13 12:50:57,821 - INFO - --- End Gradient Check ---
2025-04-13 12:50:57,824 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:57,824 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9990, 3.3726]
2025-04-13 12:50:57,824 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.3541, 3.4544]
2025-04-13 12:50:57,824 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,824 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,825 - INFO -   True actions shape: tensor([-2.2662, -0.4202, -0.2662,  0.3881,  0.1116,  0.6365, -0.4744],
       device='cuda:0'), range: [-2.9990, 3.3726]
2025-04-13 12:50:57,826 - INFO -   Noise shape: tensor([-0.0725, -0.4628, -0.8644,  1.9967,  0.6920, -0.4448,  1.8134],
       device='cuda:0'), range: [-3.8016, 3.3364]
2025-04-13 12:50:57,826 - INFO -   Noisy actions shape: tensor([-1.3958, -0.6216, -0.8550,  1.8410,  0.6245,  0.0165,  1.1841],
       device='cuda:0'), range: [-3.3164, 3.2352]
2025-04-13 12:50:57,871 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:57,871 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2284, 3.0816]
2025-04-13 12:50:57,871 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1259, 2.8340]
2025-04-13 12:50:57,871 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,871 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,872 - INFO -   True actions shape: tensor([ 1.4169,  0.7436, -1.9054,  0.6086, -0.9520,  0.0387,  0.8704],
       device='cuda:0'), range: [-3.2284, 3.0816]
2025-04-13 12:50:57,873 - INFO -   Noise shape: tensor([ 1.0670,  0.7503, -0.6296,  1.2675,  1.8503,  0.4560, -0.3962],
       device='cuda:0'), range: [-3.7428, 2.8100]
2025-04-13 12:50:57,873 - INFO -   Noisy actions shape: tensor([ 1.7566,  1.0142, -1.9717,  1.1470,  0.0648,  0.2550,  0.5691],
       device='cuda:0'), range: [-3.5250, 2.9477]
2025-04-13 12:50:57,917 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:57,917 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9332, 4.0328]
2025-04-13 12:50:57,917 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2830, 2.8142]
2025-04-13 12:50:57,917 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,917 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,918 - INFO -   True actions shape: tensor([ 0.3051, -0.3263,  0.0974, -1.2521, -1.5983, -0.7793, -0.7786],
       device='cuda:0'), range: [-3.9332, 4.0328]
2025-04-13 12:50:57,918 - INFO -   Noise shape: tensor([-0.5721, -0.0567,  0.9616, -0.1511,  1.3377,  2.1439, -0.1882],
       device='cuda:0'), range: [-3.1350, 3.6918]
2025-04-13 12:50:57,919 - INFO -   Noisy actions shape: tensor([-0.4944, -0.1246,  0.9604, -0.4130,  0.9686,  1.9301, -0.3489],
       device='cuda:0'), range: [-3.9055, 3.9816]
2025-04-13 12:50:57,963 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:57,963 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3878, 3.4320]
2025-04-13 12:50:57,963 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9389, 3.6192]
2025-04-13 12:50:57,963 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:57,963 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:57,964 - INFO -   True actions shape: tensor([-0.3824, -1.0782, -1.6064, -0.2740, -0.6694, -1.4231,  0.5448],
       device='cuda:0'), range: [-3.3878, 3.4320]
2025-04-13 12:50:57,965 - INFO -   Noise shape: tensor([-1.2657, -0.3794, -0.5131, -0.2279, -2.2311,  1.8567,  0.9097],
       device='cuda:0'), range: [-3.0953, 3.6492]
2025-04-13 12:50:57,966 - INFO -   Noisy actions shape: tensor([-1.3217, -0.6989, -0.9916, -0.3025, -2.3284,  1.3158,  1.0348],
       device='cuda:0'), range: [-2.9360, 3.6166]
2025-04-13 12:50:58,009 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:58,009 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0113, 3.4188]
2025-04-13 12:50:58,009 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.4930, 2.7779]
2025-04-13 12:50:58,010 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,010 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,010 - INFO -   True actions shape: tensor([-0.1288,  0.8598, -1.7398, -2.0237,  1.4132, -0.1740, -0.1988],
       device='cuda:0'), range: [-4.0113, 3.4188]
2025-04-13 12:50:58,011 - INFO -   Noise shape: tensor([-0.3052,  3.1758, -0.0829, -0.6060,  0.7958,  0.8653, -2.1232],
       device='cuda:0'), range: [-3.1324, 3.4536]
2025-04-13 12:50:58,012 - INFO -   Noisy actions shape: tensor([-0.2189,  1.8216, -1.6764, -2.1114,  1.5925,  0.1091, -0.8612],
       device='cuda:0'), range: [-3.5457, 3.4982]
2025-04-13 12:50:58,056 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:58,056 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9071, 3.2449]
2025-04-13 12:50:58,056 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9259, 3.4867]
2025-04-13 12:50:58,056 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,056 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,057 - INFO -   True actions shape: tensor([ 1.1882,  1.5470, -0.2332, -0.1198,  0.1255,  0.3035,  1.1760],
       device='cuda:0'), range: [-3.9071, 3.2449]
2025-04-13 12:50:58,058 - INFO -   Noise shape: tensor([-3.0192,  0.3396, -0.2673,  0.1577,  2.3991, -0.1676,  0.7603],
       device='cuda:0'), range: [-3.6593, 3.0402]
2025-04-13 12:50:58,058 - INFO -   Noisy actions shape: tensor([-2.9499,  0.4234, -0.2796,  0.1510,  2.4024, -0.1508,  0.8233],
       device='cuda:0'), range: [-3.0374, 3.8110]
2025-04-13 12:50:58,102 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:58,102 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4451, 3.7618]
2025-04-13 12:50:58,102 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4849, 2.9303]
2025-04-13 12:50:58,102 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,102 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,103 - INFO -   True actions shape: tensor([ 1.0015, -1.0624, -0.5695, -0.0475,  0.1042,  0.8207, -0.2525],
       device='cuda:0'), range: [-3.4451, 3.7618]
2025-04-13 12:50:58,103 - INFO -   Noise shape: tensor([ 0.2312, -0.2458,  0.4722,  1.0257,  1.7895, -0.7656,  0.6298],
       device='cuda:0'), range: [-3.8392, 3.2604]
2025-04-13 12:50:58,104 - INFO -   Noisy actions shape: tensor([ 0.6265, -0.6651,  0.1929,  0.9132,  1.6710, -0.3553,  0.4679],
       device='cuda:0'), range: [-3.8391, 3.4161]
2025-04-13 12:50:58,148 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:58,148 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6509, 3.5377]
2025-04-13 12:50:58,148 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8345, 3.6068]
2025-04-13 12:50:58,148 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,148 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,149 - INFO -   True actions shape: tensor([ 0.0722, -0.8439,  0.2187, -0.8920, -0.0863, -1.3753, -1.0983],
       device='cuda:0'), range: [-3.6509, 3.5377]
2025-04-13 12:50:58,150 - INFO -   Noise shape: tensor([-1.7245,  0.7994, -0.5413, -0.5785, -0.6892,  1.1029,  0.9780],
       device='cuda:0'), range: [-4.1790, 4.1937]
2025-04-13 12:50:58,150 - INFO -   Noisy actions shape: tensor([-1.5885,  0.4509, -0.4296, -0.8556, -0.6755,  0.5477,  0.5284],
       device='cuda:0'), range: [-3.6387, 3.7352]
2025-04-13 12:50:58,193 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:58,194 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4535, 3.4766]
2025-04-13 12:50:58,194 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5673, 3.2592]
2025-04-13 12:50:58,194 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,194 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,195 - INFO -   True actions shape: tensor([ 0.4599, -1.3034, -0.5308,  1.4467,  1.7833, -0.7345, -1.5830],
       device='cuda:0'), range: [-3.4535, 3.4766]
2025-04-13 12:50:58,195 - INFO -   Noise shape: tensor([ 1.0339, -0.1057,  1.0996,  3.0212, -1.8575,  0.1226, -0.6969],
       device='cuda:0'), range: [-3.3652, 3.5075]
2025-04-13 12:50:58,196 - INFO -   Noisy actions shape: tensor([ 1.0690, -0.9682,  0.4397,  3.1940, -0.1365, -0.4127, -1.5908],
       device='cuda:0'), range: [-3.4579, 3.6121]
2025-04-13 12:50:58,239 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:58,239 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4486, 3.8209]
2025-04-13 12:50:58,239 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4263, 3.3066]
2025-04-13 12:50:58,239 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,239 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,240 - INFO -   True actions shape: tensor([-0.2461, -0.3725,  1.0575, -1.1252, -0.2700,  0.0607,  0.0108],
       device='cuda:0'), range: [-3.4486, 3.8209]
2025-04-13 12:50:58,241 - INFO -   Noise shape: tensor([-0.1074,  0.2385,  0.3227,  0.1065,  2.1105,  0.5947, -1.1366],
       device='cuda:0'), range: [-3.3736, 2.9988]
2025-04-13 12:50:58,241 - INFO -   Noisy actions shape: tensor([-0.2598, -0.3307,  1.0950, -1.0947,  0.0631,  0.1529, -0.1669],
       device='cuda:0'), range: [-3.5454, 3.6768]
2025-04-13 12:50:58,281 - INFO -   Loss components:
2025-04-13 12:50:58,281 - INFO -     Diffusion loss: 1.773071 (coef: 1.0)
2025-04-13 12:50:58,281 - INFO -     Grasp quality loss: 0.693325 (coef: 0.5)
2025-04-13 12:50:58,281 - INFO -     Grasp rotation loss: 0.577252 (coef: 0.5)
2025-04-13 12:50:58,281 - INFO -     Grasp width loss: 24.312626 (coef: 0.005)
2025-04-13 12:50:58,281 - INFO -     TOTAL loss: 2.529923
2025-04-13 12:50:58,289 - INFO -   Gradients: avg norm: 0.543212, max norm: 3.543608, non-zero params: 250
2025-04-13 12:50:58,289 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:50:58,292 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:58,292 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1050, 3.5150]
2025-04-13 12:50:58,292 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9863, 3.4625]
2025-04-13 12:50:58,292 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,292 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,293 - INFO -   True actions shape: tensor([-0.3692, -0.0790, -0.3670, -1.2176, -1.0609, -0.8355, -1.1581],
       device='cuda:0'), range: [-4.1050, 3.5150]
2025-04-13 12:50:58,293 - INFO -   Noise shape: tensor([ 3.5218, -0.7129, -0.4334, -0.0978,  0.1374, -0.8981,  1.6961],
       device='cuda:0'), range: [-3.0087, 3.6454]
2025-04-13 12:50:58,294 - INFO -   Noisy actions shape: tensor([ 1.3647, -0.4111, -0.5299, -1.1154, -0.8651, -1.1638, -0.2030],
       device='cuda:0'), range: [-4.0251, 3.6565]
2025-04-13 12:50:58,339 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:58,340 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0926, 3.5436]
2025-04-13 12:50:58,340 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6972, 3.1014]
2025-04-13 12:50:58,340 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,340 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,341 - INFO -   True actions shape: tensor([ 0.4596, -0.0189, -0.0293, -0.1610, -0.7213,  0.9779, -0.2131],
       device='cuda:0'), range: [-3.0926, 3.5436]
2025-04-13 12:50:58,341 - INFO -   Noise shape: tensor([-0.9087,  0.2503,  0.5291, -0.0671, -1.1060,  0.6684, -0.5343],
       device='cuda:0'), range: [-3.3143, 3.1615]
2025-04-13 12:50:58,342 - INFO -   Noisy actions shape: tensor([ 0.2075,  0.0469,  0.1093, -0.1729, -0.9841,  1.1181, -0.3447],
       device='cuda:0'), range: [-3.4275, 3.6528]
2025-04-13 12:50:58,384 - INFO - 
=== Epoch 9 Summary ===
2025-04-13 12:50:58,384 - INFO -   Avg total loss: 2.613826
2025-04-13 12:50:58,384 - INFO -   Avg diffusion loss: 1.849120
2025-04-13 12:50:58,384 - INFO -   Avg grasp loss: 1.529412
2025-04-13 12:50:58,384 - INFO - 
=== EPOCH 10/20 ===
2025-04-13 12:50:58,385 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:58,388 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:58,388 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7022, 3.6489]
2025-04-13 12:50:58,388 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2650, 3.3263]
2025-04-13 12:50:58,389 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,389 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,389 - INFO -   True actions shape: tensor([ 1.7837,  0.8838, -0.1922,  0.5252, -0.3015,  0.0507,  0.3637],
       device='cuda:0'), range: [-3.7022, 3.6489]
2025-04-13 12:50:58,390 - INFO -   Noise shape: tensor([-0.0281,  1.6914, -0.6046, -1.7591, -1.0397,  0.4013, -1.2148],
       device='cuda:0'), range: [-3.8396, 3.1230]
2025-04-13 12:50:58,391 - INFO -   Noisy actions shape: tensor([ 1.4548,  1.6858, -0.5006, -0.5622, -0.8368,  0.2688, -0.3874],
       device='cuda:0'), range: [-3.4209, 3.7264]
2025-04-13 12:50:58,391 - INFO -   Diffusion: timestep range [229, 925], noise range [-3.8396, 3.1230]
2025-04-13 12:50:58,391 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4209, 3.7264]
2025-04-13 12:50:58,410 - INFO -   Model output shapes:
2025-04-13 12:50:58,410 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:58,410 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4304, 0.5807]
2025-04-13 12:50:58,410 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3063
2025-04-13 12:50:58,410 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1836, 0.4357]
2025-04-13 12:50:58,432 - INFO -   Loss components:
2025-04-13 12:50:58,432 - INFO -     Diffusion loss: 1.742363 (coef: 1.0)
2025-04-13 12:50:58,432 - INFO -     Grasp quality loss: 0.693233 (coef: 0.5)
2025-04-13 12:50:58,432 - INFO -     Grasp rotation loss: 0.592236 (coef: 0.5)
2025-04-13 12:50:58,432 - INFO -     Grasp width loss: 23.469677 (coef: 0.005)
2025-04-13 12:50:58,432 - INFO -     TOTAL loss: 2.502445
2025-04-13 12:50:58,440 - INFO -   Gradients: avg norm: 0.544221, max norm: 3.511752, non-zero params: 250
2025-04-13 12:50:58,440 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:50:58,440 - INFO - --- Gradient Check @ Epoch 10, Batch 0 ---
2025-04-13 12:50:58,457 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:58,457 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:58,457 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.9449e-01, MaxNorm=2.8253e+00
2025-04-13 12:50:58,457 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.2790e-02, MaxNorm=6.8934e-02
2025-04-13 12:50:58,457 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.6866e-02, MaxNorm=4.2591e-02
2025-04-13 12:50:58,457 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=8.8347e-01, MaxNorm=2.5026e+00
2025-04-13 12:50:58,457 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3305e+00, MaxNorm=2.4619e+00
2025-04-13 12:50:58,457 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.2548e+00, MaxNorm=2.2907e+00
2025-04-13 12:50:58,457 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.0275e-01, MaxNorm=4.6779e-01
2025-04-13 12:50:58,457 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.8475e+00, MaxNorm=2.0216e+00
2025-04-13 12:50:58,457 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0017e+00, MaxNorm=1.1188e+00
2025-04-13 12:50:58,457 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9262e+00, MaxNorm=3.5118e+00
2025-04-13 12:50:58,457 - INFO - --- End Gradient Check ---
2025-04-13 12:50:58,460 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:58,460 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4224, 3.5199]
2025-04-13 12:50:58,460 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4549, 3.2999]
2025-04-13 12:50:58,460 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,460 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,461 - INFO -   True actions shape: tensor([ 0.1817,  1.5898,  0.4610, -0.7895, -0.1800,  1.0125,  0.8327],
       device='cuda:0'), range: [-3.4224, 3.5199]
2025-04-13 12:50:58,461 - INFO -   Noise shape: tensor([-0.5781,  2.6285, -0.6194, -0.6106, -0.6476,  0.0382,  0.2894],
       device='cuda:0'), range: [-3.4903, 3.5707]
2025-04-13 12:50:58,462 - INFO -   Noisy actions shape: tensor([-0.2548,  2.9451, -0.0761, -0.9948, -0.5691,  0.7743,  0.8106],
       device='cuda:0'), range: [-2.9410, 3.7909]
2025-04-13 12:50:58,504 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:58,504 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8701, 3.1613]
2025-04-13 12:50:58,504 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1279, 2.5961]
2025-04-13 12:50:58,504 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,504 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,505 - INFO -   True actions shape: tensor([ 2.0400,  2.5352,  1.0367,  1.3386,  0.5582, -1.9997,  0.2255],
       device='cuda:0'), range: [-3.8701, 3.1613]
2025-04-13 12:50:58,506 - INFO -   Noise shape: tensor([-0.9480, -0.5791,  0.2173, -2.0588,  0.8184, -0.2772, -0.6863],
       device='cuda:0'), range: [-3.9119, 3.0711]
2025-04-13 12:50:58,506 - INFO -   Noisy actions shape: tensor([ 1.0384,  1.6559,  0.9541, -0.1949,  0.9415, -1.7538, -0.2399],
       device='cuda:0'), range: [-3.8933, 3.4390]
2025-04-13 12:50:58,548 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:58,548 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5743, 3.2206]
2025-04-13 12:50:58,548 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8926, 2.8022]
2025-04-13 12:50:58,549 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,549 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,549 - INFO -   True actions shape: tensor([ 0.2670, -0.1204, -0.2072,  1.4192,  1.2426,  1.0770, -2.6863],
       device='cuda:0'), range: [-3.5743, 3.2206]
2025-04-13 12:50:58,550 - INFO -   Noise shape: tensor([ 1.2130,  1.4202, -1.1958,  0.7775, -0.1925,  1.2710, -0.5426],
       device='cuda:0'), range: [-3.7745, 3.3974]
2025-04-13 12:50:58,550 - INFO -   Noisy actions shape: tensor([ 0.6883,  0.4022, -0.6264,  1.6045,  1.0884,  1.4643, -2.7004],
       device='cuda:0'), range: [-3.7602, 3.7028]
2025-04-13 12:50:58,592 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:58,592 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3954, 3.4367]
2025-04-13 12:50:58,592 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3238, 3.1871]
2025-04-13 12:50:58,592 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,592 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,593 - INFO -   True actions shape: tensor([ 0.3997,  0.3084, -0.9743,  0.4673, -0.8538, -0.4111, -2.9003],
       device='cuda:0'), range: [-3.3954, 3.4367]
2025-04-13 12:50:58,594 - INFO -   Noise shape: tensor([-0.1050, -0.0147,  1.6015,  1.8491,  0.4390, -1.4530, -2.5520],
       device='cuda:0'), range: [-3.6436, 3.6257]
2025-04-13 12:50:58,594 - INFO -   Noisy actions shape: tensor([ 0.3338,  0.2818, -0.3223,  1.1103, -0.6345, -0.9132, -3.6319],
       device='cuda:0'), range: [-3.6319, 3.9508]
2025-04-13 12:50:58,636 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:58,636 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6861, 3.5021]
2025-04-13 12:50:58,636 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7293, 2.9893]
2025-04-13 12:50:58,636 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,636 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,637 - INFO -   True actions shape: tensor([-0.0895,  1.1021,  0.3244, -1.6165, -0.0634,  1.1675,  0.6556],
       device='cuda:0'), range: [-3.6861, 3.5021]
2025-04-13 12:50:58,637 - INFO -   Noise shape: tensor([-0.8967, -1.7515, -1.3918,  0.9556, -0.9609, -0.9206,  0.7105],
       device='cuda:0'), range: [-3.2345, 3.0130]
2025-04-13 12:50:58,638 - INFO -   Noisy actions shape: tensor([-0.8195, -0.9571, -1.0385,  0.0105, -0.8618, -0.2065,  0.9441],
       device='cuda:0'), range: [-3.3203, 3.9467]
2025-04-13 12:50:58,680 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:58,680 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2706, 3.6658]
2025-04-13 12:50:58,680 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1821, 2.8542]
2025-04-13 12:50:58,680 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,680 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,681 - INFO -   True actions shape: tensor([-1.3977, -0.8238, -0.9836,  0.5272,  1.2758, -1.0916, -1.4761],
       device='cuda:0'), range: [-3.2706, 3.6658]
2025-04-13 12:50:58,682 - INFO -   Noise shape: tensor([ 0.2409, -1.4658, -1.3176,  0.7161,  0.4161,  0.1666, -0.5854],
       device='cuda:0'), range: [-3.4011, 3.5011]
2025-04-13 12:50:58,682 - INFO -   Noisy actions shape: tensor([-0.8485, -1.6063, -1.6204,  0.8753,  1.2121, -0.6774, -1.4739],
       device='cuda:0'), range: [-3.2722, 3.5881]
2025-04-13 12:50:58,724 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:58,725 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6962, 3.1258]
2025-04-13 12:50:58,725 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9707, 3.2547]
2025-04-13 12:50:58,725 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,725 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,726 - INFO -   True actions shape: tensor([ 1.0865, -0.7406,  0.5545,  0.5350,  0.3958, -0.9818,  0.6468],
       device='cuda:0'), range: [-3.6962, 3.1258]
2025-04-13 12:50:58,726 - INFO -   Noise shape: tensor([ 0.5950,  0.6522,  0.5982, -0.7955, -1.3812,  0.0741,  0.8045],
       device='cuda:0'), range: [-3.2697, 3.6400]
2025-04-13 12:50:58,727 - INFO -   Noisy actions shape: tensor([ 1.1445, -0.6657,  0.6159,  0.4459,  0.2440, -0.9680,  0.7301],
       device='cuda:0'), range: [-3.8710, 3.5332]
2025-04-13 12:50:58,772 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:58,772 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4025, 4.0402]
2025-04-13 12:50:58,772 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8309, 3.0062]
2025-04-13 12:50:58,772 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,772 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,773 - INFO -   True actions shape: tensor([-0.2583, -0.5718,  1.0492, -1.0320,  0.1172,  1.2792,  0.1509],
       device='cuda:0'), range: [-3.4025, 4.0402]
2025-04-13 12:50:58,774 - INFO -   Noise shape: tensor([ 0.5963,  1.1579, -1.3186, -0.8007, -0.7334,  0.2341, -1.3293],
       device='cuda:0'), range: [-3.9413, 3.8067]
2025-04-13 12:50:58,774 - INFO -   Noisy actions shape: tensor([ 0.4571,  0.8614, -0.8327, -1.1276, -0.6369,  0.6938, -1.1773],
       device='cuda:0'), range: [-3.8112, 3.3850]
2025-04-13 12:50:58,817 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:58,817 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1427, 3.8222]
2025-04-13 12:50:58,817 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8779, 3.3307]
2025-04-13 12:50:58,817 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,818 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,818 - INFO -   True actions shape: tensor([-1.1065, -0.1955, -0.8521,  0.3076, -0.4539, -1.3408, -2.4788],
       device='cuda:0'), range: [-3.1427, 3.8222]
2025-04-13 12:50:58,819 - INFO -   Noise shape: tensor([-0.5375,  0.1451, -1.0275, -0.4762,  1.3099,  1.6587, -0.2041],
       device='cuda:0'), range: [-3.6545, 3.5341]
2025-04-13 12:50:58,819 - INFO -   Noisy actions shape: tensor([-0.8171,  0.0868, -1.2199, -0.3751,  1.1380,  1.2335, -0.8679],
       device='cuda:0'), range: [-3.1578, 3.7889]
2025-04-13 12:50:58,868 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:58,868 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9500, 3.2148]
2025-04-13 12:50:58,868 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2642, 3.2126]
2025-04-13 12:50:58,868 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,868 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,869 - INFO -   True actions shape: tensor([ 0.7022, -0.5969, -0.8033, -0.3658, -1.1300, -1.0441, -1.2823],
       device='cuda:0'), range: [-2.9500, 3.2148]
2025-04-13 12:50:58,870 - INFO -   Noise shape: tensor([ 0.1875, -0.2342,  1.9138,  0.1506, -0.3901, -0.8102,  0.0619],
       device='cuda:0'), range: [-3.9176, 3.5284]
2025-04-13 12:50:58,870 - INFO -   Noisy actions shape: tensor([ 0.6516, -0.6032,  0.6578, -0.1758, -1.1068, -1.3192, -0.9234],
       device='cuda:0'), range: [-3.4330, 3.5956]
2025-04-13 12:50:58,909 - INFO -   Loss components:
2025-04-13 12:50:58,910 - INFO -     Diffusion loss: 1.693458 (coef: 1.0)
2025-04-13 12:50:58,910 - INFO -     Grasp quality loss: 0.694667 (coef: 0.5)
2025-04-13 12:50:58,910 - INFO -     Grasp rotation loss: 0.571732 (coef: 0.5)
2025-04-13 12:50:58,910 - INFO -     Grasp width loss: 21.023748 (coef: 0.005)
2025-04-13 12:50:58,910 - INFO -     TOTAL loss: 2.431777
2025-04-13 12:50:58,917 - INFO -   Gradients: avg norm: 0.492458, max norm: 3.326008, non-zero params: 250
2025-04-13 12:50:58,917 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-13 12:50:58,920 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:58,920 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1736, 3.4380]
2025-04-13 12:50:58,920 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4341, 3.0310]
2025-04-13 12:50:58,920 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,920 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,921 - INFO -   True actions shape: tensor([ 1.4696,  0.8086, -1.2684, -0.4543, -0.9120,  2.2303,  0.6843],
       device='cuda:0'), range: [-3.1736, 3.4380]
2025-04-13 12:50:58,922 - INFO -   Noise shape: tensor([-0.4750,  0.8564,  0.3804, -0.2647, -0.2477, -1.5644, -0.1559],
       device='cuda:0'), range: [-3.3870, 3.4228]
2025-04-13 12:50:58,922 - INFO -   Noisy actions shape: tensor([-0.1768,  0.9987,  0.1236, -0.3489, -0.4222, -1.0953, -0.0183],
       device='cuda:0'), range: [-3.1292, 3.6326]
2025-04-13 12:50:58,964 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:58,964 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0053, 3.4102]
2025-04-13 12:50:58,964 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0975, 2.9855]
2025-04-13 12:50:58,964 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:58,964 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:58,965 - INFO -   True actions shape: tensor([ 0.9717,  0.2960, -0.6249,  0.6003,  0.2176, -1.1738,  0.2358],
       device='cuda:0'), range: [-3.0053, 3.4102]
2025-04-13 12:50:58,965 - INFO -   Noise shape: tensor([-1.6492, -0.0665,  0.3033,  0.1273, -0.6955,  0.1332,  0.0272],
       device='cuda:0'), range: [-3.6774, 3.2129]
2025-04-13 12:50:58,966 - INFO -   Noisy actions shape: tensor([-0.8979,  0.0981, -0.0682,  0.4224, -0.4791, -0.5001,  0.1465],
       device='cuda:0'), range: [-3.3432, 3.3533]
2025-04-13 12:50:59,006 - INFO - 
=== Epoch 10 Summary ===
2025-04-13 12:50:59,006 - INFO -   Avg total loss: 2.564931
2025-04-13 12:50:59,006 - INFO -   Avg diffusion loss: 1.820571
2025-04-13 12:50:59,006 - INFO -   Avg grasp loss: 1.488720
2025-04-13 12:50:59,175 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125051/ckpt_epoch_10.pth
2025-04-13 12:50:59,175 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:50:59,175 - INFO - 
=== EPOCH 11/20 ===
2025-04-13 12:50:59,176 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:59,179 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:59,179 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0611, 3.4801]
2025-04-13 12:50:59,179 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4999, 2.9082]
2025-04-13 12:50:59,179 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,180 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,180 - INFO -   True actions shape: tensor([ 0.1446,  1.3828, -0.2268, -0.3320,  2.6302,  1.0903, -1.5233],
       device='cuda:0'), range: [-3.0611, 3.4801]
2025-04-13 12:50:59,181 - INFO -   Noise shape: tensor([-0.3698, -0.3303,  1.9393, -1.8284,  0.1945, -0.8163, -0.8750],
       device='cuda:0'), range: [-3.2966, 4.1560]
2025-04-13 12:50:59,182 - INFO -   Noisy actions shape: tensor([-0.2654,  0.3262,  1.6306, -1.7826,  1.3555, -0.2394, -1.4661],
       device='cuda:0'), range: [-3.3171, 3.5543]
2025-04-13 12:50:59,182 - INFO -   Diffusion: timestep range [146, 755], noise range [-3.2966, 4.1560]
2025-04-13 12:50:59,182 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3171, 3.5543]
2025-04-13 12:50:59,200 - INFO -   Model output shapes:
2025-04-13 12:50:59,200 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:59,201 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4138, 0.5685]
2025-04-13 12:50:59,201 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3136
2025-04-13 12:50:59,201 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2255, 0.3909]
2025-04-13 12:50:59,222 - INFO -   Loss components:
2025-04-13 12:50:59,222 - INFO -     Diffusion loss: 1.757713 (coef: 1.0)
2025-04-13 12:50:59,222 - INFO -     Grasp quality loss: 0.695207 (coef: 0.5)
2025-04-13 12:50:59,222 - INFO -     Grasp rotation loss: 0.572965 (coef: 0.5)
2025-04-13 12:50:59,222 - INFO -     Grasp width loss: 18.992411 (coef: 0.005)
2025-04-13 12:50:59,222 - INFO -     TOTAL loss: 2.486761
2025-04-13 12:50:59,230 - INFO -   Gradients: avg norm: 0.526441, max norm: 3.582146, non-zero params: 250
2025-04-13 12:50:59,230 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:50:59,230 - INFO - --- Gradient Check @ Epoch 11, Batch 0 ---
2025-04-13 12:50:59,246 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:59,246 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:59,246 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.4245e-01, MaxNorm=2.9781e+00
2025-04-13 12:50:59,246 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=5.1125e-02, MaxNorm=1.5749e-01
2025-04-13 12:50:59,246 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=6.9048e-03, MaxNorm=1.5817e-02
2025-04-13 12:50:59,247 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.7476e-01, MaxNorm=1.6536e+00
2025-04-13 12:50:59,247 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.4340e+00, MaxNorm=2.7060e+00
2025-04-13 12:50:59,247 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3438e+00, MaxNorm=2.4409e+00
2025-04-13 12:50:59,247 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.0850e-01, MaxNorm=4.8375e-01
2025-04-13 12:50:59,247 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.1838e+00, MaxNorm=1.2605e+00
2025-04-13 12:50:59,247 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0256e+00, MaxNorm=1.0563e+00
2025-04-13 12:50:59,247 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9758e+00, MaxNorm=3.5821e+00
2025-04-13 12:50:59,247 - INFO - --- End Gradient Check ---
2025-04-13 12:50:59,249 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:59,249 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3310, 3.6391]
2025-04-13 12:50:59,249 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2385, 3.5236]
2025-04-13 12:50:59,250 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,250 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,250 - INFO -   True actions shape: tensor([ 1.2751, -0.1008, -0.1879,  0.1638, -1.0017,  0.2895,  0.1607],
       device='cuda:0'), range: [-3.3310, 3.6391]
2025-04-13 12:50:59,251 - INFO -   Noise shape: tensor([-0.9435,  0.1886,  0.2727, -0.5675,  0.3313, -0.0442, -0.1522],
       device='cuda:0'), range: [-3.3633, 3.2426]
2025-04-13 12:50:59,251 - INFO -   Noisy actions shape: tensor([-0.9135,  0.1862,  0.2683, -0.5635,  0.3078, -0.0374, -0.1484],
       device='cuda:0'), range: [-3.4462, 3.1291]
2025-04-13 12:50:59,293 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:59,293 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1801, 3.5819]
2025-04-13 12:50:59,293 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4426, 3.1415]
2025-04-13 12:50:59,293 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,293 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,294 - INFO -   True actions shape: tensor([-0.7323, -0.4982, -0.5902,  0.0924,  0.2946,  0.5203, -0.3156],
       device='cuda:0'), range: [-3.1801, 3.5819]
2025-04-13 12:50:59,295 - INFO -   Noise shape: tensor([-0.6771,  0.3676,  0.3280, -0.4690, -0.8637, -0.9545, -0.4903],
       device='cuda:0'), range: [-3.9351, 4.4643]
2025-04-13 12:50:59,295 - INFO -   Noisy actions shape: tensor([-0.9283,  0.1141,  0.0384, -0.3820, -0.6493, -0.6328, -0.5787],
       device='cuda:0'), range: [-3.8708, 3.5760]
2025-04-13 12:50:59,337 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:59,337 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1673, 3.8041]
2025-04-13 12:50:59,337 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2660, 3.0873]
2025-04-13 12:50:59,337 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,337 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,338 - INFO -   True actions shape: tensor([-1.0956, -2.3111,  0.2923, -0.4690,  0.6259,  1.1053, -0.2167],
       device='cuda:0'), range: [-4.1673, 3.8041]
2025-04-13 12:50:59,338 - INFO -   Noise shape: tensor([ 0.0353, -0.6872, -1.2295, -1.1687, -0.4362, -1.9721,  0.7457],
       device='cuda:0'), range: [-3.2950, 3.4619]
2025-04-13 12:50:59,339 - INFO -   Noisy actions shape: tensor([-0.8086, -2.2017, -0.5786, -1.1169,  0.1911, -0.4450,  0.3210],
       device='cuda:0'), range: [-4.1946, 3.2087]
2025-04-13 12:50:59,382 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:59,382 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3412, 3.7247]
2025-04-13 12:50:59,382 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9996, 3.1144]
2025-04-13 12:50:59,382 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,382 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,383 - INFO -   True actions shape: tensor([ 0.8545,  1.1563, -0.8582,  0.3945, -1.0952,  0.7024, -0.8288],
       device='cuda:0'), range: [-4.3412, 3.7247]
2025-04-13 12:50:59,383 - INFO -   Noise shape: tensor([ 1.2957, -0.9129, -0.6492, -1.4680,  0.0216, -2.2858,  0.6913],
       device='cuda:0'), range: [-3.6335, 3.8800]
2025-04-13 12:50:59,384 - INFO -   Noisy actions shape: tensor([ 1.5463,  0.0028, -1.0418, -0.9055, -0.6633, -1.3552,  0.0270],
       device='cuda:0'), range: [-3.4799, 3.2019]
2025-04-13 12:50:59,426 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:50:59,426 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2825, 3.2898]
2025-04-13 12:50:59,426 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9692, 3.2739]
2025-04-13 12:50:59,426 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,426 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,427 - INFO -   True actions shape: tensor([ 1.5128, -1.4106, -1.2203, -0.8119,  1.7130,  0.0799,  0.2575],
       device='cuda:0'), range: [-3.2825, 3.2898]
2025-04-13 12:50:59,427 - INFO -   Noise shape: tensor([-0.2989, -0.3057,  0.7964, -0.5158, -0.9989, -0.3375, -0.0632],
       device='cuda:0'), range: [-3.4128, 3.9258]
2025-04-13 12:50:59,428 - INFO -   Noisy actions shape: tensor([ 0.8901, -1.2328, -0.3353, -0.9438,  0.5527, -0.1747,  0.1431],
       device='cuda:0'), range: [-3.6205, 4.0388]
2025-04-13 12:50:59,469 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:50:59,469 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6946, 3.4022]
2025-04-13 12:50:59,470 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6345, 3.4516]
2025-04-13 12:50:59,470 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,470 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,470 - INFO -   True actions shape: tensor([ 2.0119,  0.6020,  1.3227, -1.4505,  0.5151,  0.4215,  0.3898],
       device='cuda:0'), range: [-3.6946, 3.4022]
2025-04-13 12:50:59,471 - INFO -   Noise shape: tensor([ 0.8605,  0.8087, -1.1345,  1.3484, -1.0545, -1.7140,  0.7874],
       device='cuda:0'), range: [-3.1817, 3.6125]
2025-04-13 12:50:59,472 - INFO -   Noisy actions shape: tensor([ 2.1477,  0.7584,  1.0550, -1.1350,  0.2821,  0.0522,  0.5465],
       device='cuda:0'), range: [-3.5881, 3.7023]
2025-04-13 12:50:59,513 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:50:59,513 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0390, 4.5346]
2025-04-13 12:50:59,513 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1209, 3.1613]
2025-04-13 12:50:59,513 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,513 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,514 - INFO -   True actions shape: tensor([-0.5627,  1.4217,  2.2060, -0.0988, -0.5085, -1.6914,  0.7226],
       device='cuda:0'), range: [-3.0390, 4.5346]
2025-04-13 12:50:59,515 - INFO -   Noise shape: tensor([-0.1470,  0.3749, -0.8560,  1.9388,  1.1928, -0.0209,  0.6945],
       device='cuda:0'), range: [-3.7292, 4.2530]
2025-04-13 12:50:59,515 - INFO -   Noisy actions shape: tensor([-0.4294,  1.0879,  0.4816,  1.5732,  0.7243, -0.9375,  0.9758],
       device='cuda:0'), range: [-3.5114, 4.5384]
2025-04-13 12:50:59,557 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:50:59,557 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4924, 2.9928]
2025-04-13 12:50:59,557 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8174, 3.2921]
2025-04-13 12:50:59,557 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,557 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,558 - INFO -   True actions shape: tensor([ 0.0973,  1.3758,  0.1099, -0.2804,  0.4511,  0.2827,  0.7407],
       device='cuda:0'), range: [-3.4924, 2.9928]
2025-04-13 12:50:59,558 - INFO -   Noise shape: tensor([ 0.1654,  0.3192, -1.4313, -0.1534, -1.1327, -0.1473,  1.1929],
       device='cuda:0'), range: [-3.4391, 3.2218]
2025-04-13 12:50:59,559 - INFO -   Noisy actions shape: tensor([ 0.1896,  0.8034, -1.2903, -0.2458, -0.8869, -0.0329,  1.3819],
       device='cuda:0'), range: [-3.6860, 3.4100]
2025-04-13 12:50:59,601 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:50:59,601 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0557, 3.6675]
2025-04-13 12:50:59,601 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8769, 3.1739]
2025-04-13 12:50:59,601 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,601 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,602 - INFO -   True actions shape: tensor([-0.3034, -1.1959, -0.8383,  0.2464, -0.5977,  0.2449, -0.7933],
       device='cuda:0'), range: [-3.0557, 3.6675]
2025-04-13 12:50:59,602 - INFO -   Noise shape: tensor([ 0.4370,  0.0991,  1.0468, -1.2165,  0.1854, -0.6228,  1.0161],
       device='cuda:0'), range: [-3.4744, 3.7311]
2025-04-13 12:50:59,603 - INFO -   Noisy actions shape: tensor([ 0.4073, -0.0111,  0.9654, -1.1887,  0.1298, -0.5977,  0.9389],
       device='cuda:0'), range: [-3.3723, 3.8462]
2025-04-13 12:50:59,644 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:50:59,645 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2856, 3.7512]
2025-04-13 12:50:59,645 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6234, 3.0666]
2025-04-13 12:50:59,645 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,645 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,646 - INFO -   True actions shape: tensor([ 0.1886,  0.5428,  0.0246, -0.2328, -0.1724, -0.3019,  2.6397],
       device='cuda:0'), range: [-3.2856, 3.7512]
2025-04-13 12:50:59,646 - INFO -   Noise shape: tensor([-1.5607, -0.4779, -0.8316,  1.0273, -1.5849,  0.4360, -0.3937],
       device='cuda:0'), range: [-3.7168, 3.8968]
2025-04-13 12:50:59,647 - INFO -   Noisy actions shape: tensor([-0.3967,  0.3298, -0.2820,  0.1600, -0.7414, -0.1211,  2.3116],
       device='cuda:0'), range: [-3.2374, 3.8934]
2025-04-13 12:50:59,686 - INFO -   Loss components:
2025-04-13 12:50:59,686 - INFO -     Diffusion loss: 1.725531 (coef: 1.0)
2025-04-13 12:50:59,686 - INFO -     Grasp quality loss: 0.691241 (coef: 0.5)
2025-04-13 12:50:59,686 - INFO -     Grasp rotation loss: 0.568290 (coef: 0.5)
2025-04-13 12:50:59,686 - INFO -     Grasp width loss: 17.162498 (coef: 0.005)
2025-04-13 12:50:59,686 - INFO -     TOTAL loss: 2.441109
2025-04-13 12:50:59,694 - INFO -   Gradients: avg norm: 0.439312, max norm: 3.448288, non-zero params: 250
2025-04-13 12:50:59,694 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-13 12:50:59,696 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:50:59,696 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2735, 3.4430]
2025-04-13 12:50:59,696 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5307, 3.4429]
2025-04-13 12:50:59,697 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,697 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,697 - INFO -   True actions shape: tensor([ 1.4106,  0.2109,  1.1149, -2.3294, -0.6610,  0.6790, -1.7187],
       device='cuda:0'), range: [-3.2735, 3.4430]
2025-04-13 12:50:59,698 - INFO -   Noise shape: tensor([-0.5437,  0.7929, -1.3600,  1.4280,  0.6245,  1.0765,  0.0390],
       device='cuda:0'), range: [-3.8561, 3.5919]
2025-04-13 12:50:59,698 - INFO -   Noisy actions shape: tensor([ 0.1481,  0.8031, -0.7141,  0.2292,  0.2610,  1.2668, -0.7374],
       device='cuda:0'), range: [-3.2428, 3.8423]
2025-04-13 12:50:59,740 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:50:59,740 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2408, 3.1964]
2025-04-13 12:50:59,740 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5951, 2.8131]
2025-04-13 12:50:59,740 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,740 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,741 - INFO -   True actions shape: tensor([ 1.0479, -2.6613,  0.4015,  1.3177, -0.6302,  0.2448, -1.2968],
       device='cuda:0'), range: [-3.2408, 3.1964]
2025-04-13 12:50:59,741 - INFO -   Noise shape: tensor([ 0.7248, -0.7796,  1.0866, -1.8337, -0.7159, -0.3896, -0.2927],
       device='cuda:0'), range: [-4.0130, 3.4701]
2025-04-13 12:50:59,742 - INFO -   Noisy actions shape: tensor([ 1.1996, -2.7724,  0.6688,  0.7988, -0.7938,  0.1358, -1.3284],
       device='cuda:0'), range: [-3.5828, 3.1971]
2025-04-13 12:50:59,781 - INFO - 
=== Epoch 11 Summary ===
2025-04-13 12:50:59,781 - INFO -   Avg total loss: 2.461479
2025-04-13 12:50:59,781 - INFO -   Avg diffusion loss: 1.727640
2025-04-13 12:50:59,781 - INFO -   Avg grasp loss: 1.467679
2025-04-13 12:50:59,781 - INFO - 
=== EPOCH 12/20 ===
2025-04-13 12:50:59,782 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:50:59,785 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:50:59,785 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9167, 3.5344]
2025-04-13 12:50:59,785 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2374, 2.9020]
2025-04-13 12:50:59,785 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,785 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,786 - INFO -   True actions shape: tensor([-0.6161, -0.7024, -0.4673,  0.9404, -0.1986,  0.4391,  0.5205],
       device='cuda:0'), range: [-3.9167, 3.5344]
2025-04-13 12:50:59,787 - INFO -   Noise shape: tensor([ 0.1091, -1.9039, -0.9999, -0.4131,  0.1323, -1.3078,  0.0646],
       device='cuda:0'), range: [-3.1761, 3.0810]
2025-04-13 12:50:59,787 - INFO -   Noisy actions shape: tensor([-0.5632, -1.1939, -0.7217,  0.7925, -0.1551,  0.0667,  0.5185],
       device='cuda:0'), range: [-3.7462, 3.2450]
2025-04-13 12:50:59,787 - INFO -   Diffusion: timestep range [168, 985], noise range [-3.1761, 3.0810]
2025-04-13 12:50:59,787 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.7462, 3.2450]
2025-04-13 12:50:59,806 - INFO -   Model output shapes:
2025-04-13 12:50:59,806 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:50:59,806 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4177, 0.5831]
2025-04-13 12:50:59,806 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3152
2025-04-13 12:50:59,806 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2643, 0.3692]
2025-04-13 12:50:59,826 - INFO -   Loss components:
2025-04-13 12:50:59,827 - INFO -     Diffusion loss: 1.663922 (coef: 1.0)
2025-04-13 12:50:59,827 - INFO -     Grasp quality loss: 0.692108 (coef: 0.5)
2025-04-13 12:50:59,827 - INFO -     Grasp rotation loss: 0.577238 (coef: 0.5)
2025-04-13 12:50:59,827 - INFO -     Grasp width loss: 17.386906 (coef: 0.005)
2025-04-13 12:50:59,827 - INFO -     TOTAL loss: 2.385529
2025-04-13 12:50:59,834 - INFO -   Gradients: avg norm: 0.422913, max norm: 3.147364, non-zero params: 250
2025-04-13 12:50:59,834 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:50:59,834 - INFO - --- Gradient Check @ Epoch 12, Batch 0 ---
2025-04-13 12:50:59,851 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:50:59,851 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:50:59,851 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.5095e-01, MaxNorm=2.6937e+00
2025-04-13 12:50:59,851 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=4.1121e-02, MaxNorm=1.2609e-01
2025-04-13 12:50:59,851 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.0461e-02, MaxNorm=3.2576e-02
2025-04-13 12:50:59,851 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.4371e-01, MaxNorm=4.6937e-01
2025-04-13 12:50:59,851 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3010e+00, MaxNorm=2.4943e+00
2025-04-13 12:50:59,851 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1658e+00, MaxNorm=2.0961e+00
2025-04-13 12:50:59,851 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=8.9513e-02, MaxNorm=4.1369e-01
2025-04-13 12:50:59,851 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=6.2331e-01, MaxNorm=6.5395e-01
2025-04-13 12:50:59,851 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.8270e-01, MaxNorm=9.1453e-01
2025-04-13 12:50:59,851 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7208e+00, MaxNorm=3.1474e+00
2025-04-13 12:50:59,852 - INFO - --- End Gradient Check ---
2025-04-13 12:50:59,854 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:50:59,854 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3439, 3.1981]
2025-04-13 12:50:59,854 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9973, 3.4684]
2025-04-13 12:50:59,854 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,854 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,855 - INFO -   True actions shape: tensor([ 0.0300, -0.6958, -1.2005, -0.4513,  1.0353, -1.4205, -1.2720],
       device='cuda:0'), range: [-3.3439, 3.1981]
2025-04-13 12:50:59,856 - INFO -   Noise shape: tensor([ 1.2072,  2.6782,  0.8932, -0.0413, -1.7051,  0.7053,  0.0490],
       device='cuda:0'), range: [-3.7334, 3.4438]
2025-04-13 12:50:59,856 - INFO -   Noisy actions shape: tensor([ 1.0952e+00,  2.0914e+00,  2.6777e-01, -2.3728e-01, -1.0687e+00,
         1.7915e-03, -5.2053e-01], device='cuda:0'), range: [-3.6636, 3.2414]
2025-04-13 12:50:59,898 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:50:59,898 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8355, 3.2567]
2025-04-13 12:50:59,898 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4187, 2.9128]
2025-04-13 12:50:59,899 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,899 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,899 - INFO -   True actions shape: tensor([ 0.9538,  1.0867, -0.6916, -1.8889,  0.3521, -1.6705,  0.1139],
       device='cuda:0'), range: [-3.8355, 3.2567]
2025-04-13 12:50:59,900 - INFO -   Noise shape: tensor([ 2.5382, -0.2190, -1.5944, -0.6982, -0.5672,  0.1416,  1.6018],
       device='cuda:0'), range: [-3.5885, 3.5030]
2025-04-13 12:50:59,900 - INFO -   Noisy actions shape: tensor([ 2.6469,  0.4105, -1.7132, -1.6170, -0.2826, -0.7944,  1.4037],
       device='cuda:0'), range: [-3.8341, 3.4101]
2025-04-13 12:50:59,943 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:50:59,943 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7246, 3.5614]
2025-04-13 12:50:59,943 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1579, 3.3108]
2025-04-13 12:50:59,944 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,944 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,944 - INFO -   True actions shape: tensor([ 1.9203,  0.1449, -1.5380, -0.4518, -0.4556, -0.8345, -0.6572],
       device='cuda:0'), range: [-3.7246, 3.5614]
2025-04-13 12:50:59,945 - INFO -   Noise shape: tensor([-1.3309, -0.6265, -0.5142,  0.1887,  1.4449, -1.4131, -1.4782],
       device='cuda:0'), range: [-2.8400, 3.1856]
2025-04-13 12:50:59,946 - INFO -   Noisy actions shape: tensor([ 1.6296,  0.0222, -1.6081, -0.4072, -0.1703, -1.0898, -0.9283],
       device='cuda:0'), range: [-3.7447, 3.4137]
2025-04-13 12:50:59,989 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:50:59,989 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2624, 3.6200]
2025-04-13 12:50:59,989 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2625, 3.1748]
2025-04-13 12:50:59,989 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:50:59,989 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:50:59,990 - INFO -   True actions shape: tensor([-0.8026, -0.0751,  0.5485,  0.8406, -0.3718, -0.3273,  0.6933],
       device='cuda:0'), range: [-3.2624, 3.6200]
2025-04-13 12:50:59,990 - INFO -   Noise shape: tensor([ 0.2914,  0.3278, -0.9858,  2.1542, -0.0702,  0.0658, -0.2521],
       device='cuda:0'), range: [-3.7371, 3.7745]
2025-04-13 12:50:59,991 - INFO -   Noisy actions shape: tensor([-0.6192,  0.0622,  0.1087,  1.6316, -0.3689, -0.2737,  0.5348],
       device='cuda:0'), range: [-4.1485, 3.5228]
2025-04-13 12:51:00,038 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:00,038 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0153, 3.1588]
2025-04-13 12:51:00,039 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9988, 2.8995]
2025-04-13 12:51:00,039 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,039 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,040 - INFO -   True actions shape: tensor([ 1.5950, -2.0657,  2.2297, -1.5931,  0.7587,  0.5625,  0.7018],
       device='cuda:0'), range: [-4.0153, 3.1588]
2025-04-13 12:51:00,040 - INFO -   Noise shape: tensor([ 1.4292,  0.1614,  0.8762,  0.3324, -0.6423,  0.5082, -1.9440],
       device='cuda:0'), range: [-3.3144, 3.1311]
2025-04-13 12:51:00,041 - INFO -   Noisy actions shape: tensor([ 1.8529, -1.9894,  2.3615, -1.4919,  0.6118,  0.6543,  0.2907],
       device='cuda:0'), range: [-3.1684, 3.2074]
2025-04-13 12:51:00,085 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:00,085 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5439, 3.5410]
2025-04-13 12:51:00,085 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3000, 2.8681]
2025-04-13 12:51:00,086 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,086 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,086 - INFO -   True actions shape: tensor([ 1.3699, -1.7093,  0.9585,  0.2984,  0.1119, -1.8833,  0.2520],
       device='cuda:0'), range: [-3.5439, 3.5410]
2025-04-13 12:51:00,087 - INFO -   Noise shape: tensor([-0.0732, -0.6712,  0.1921,  0.5473, -1.0333,  0.7138, -0.0246],
       device='cuda:0'), range: [-3.3864, 3.4471]
2025-04-13 12:51:00,088 - INFO -   Noisy actions shape: tensor([ 1.2785, -1.8334,  0.9705,  0.4544, -0.2165, -1.5661,  0.2317],
       device='cuda:0'), range: [-3.6654, 3.2927]
2025-04-13 12:51:00,130 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:00,131 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7585, 3.8620]
2025-04-13 12:51:00,131 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9668, 3.0760]
2025-04-13 12:51:00,131 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,131 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,132 - INFO -   True actions shape: tensor([ 0.1538, -1.0520,  0.9547, -1.4274, -1.5479, -0.8405,  1.2837],
       device='cuda:0'), range: [-3.7585, 3.8620]
2025-04-13 12:51:00,132 - INFO -   Noise shape: tensor([ 0.8094, -1.2939,  0.7029,  0.1069, -0.0904,  0.8061, -1.5763],
       device='cuda:0'), range: [-3.2515, 3.0707]
2025-04-13 12:51:00,133 - INFO -   Noisy actions shape: tensor([ 0.3785, -1.3776,  1.1157, -1.3374, -1.5093, -0.5753,  0.7801],
       device='cuda:0'), range: [-3.5787, 3.5131]
2025-04-13 12:51:00,175 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:00,175 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3961, 3.7203]
2025-04-13 12:51:00,175 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5873, 3.0220]
2025-04-13 12:51:00,175 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,175 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,176 - INFO -   True actions shape: tensor([-0.4626, -1.2547, -1.0138, -0.9879,  0.4309, -0.9423, -0.9025],
       device='cuda:0'), range: [-3.3961, 3.7203]
2025-04-13 12:51:00,176 - INFO -   Noise shape: tensor([ 1.4064,  1.2671, -1.1005, -2.0639, -0.3715,  0.1987, -0.4097],
       device='cuda:0'), range: [-3.3799, 3.3242]
2025-04-13 12:51:00,177 - INFO -   Noisy actions shape: tensor([ 1.1147,  0.6776, -1.4087, -2.2857, -0.1741, -0.1845, -0.7292],
       device='cuda:0'), range: [-3.0231, 3.4474]
2025-04-13 12:51:00,218 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:00,218 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2287, 3.1708]
2025-04-13 12:51:00,218 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0866, 3.2546]
2025-04-13 12:51:00,218 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,218 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,219 - INFO -   True actions shape: tensor([ 1.5650,  1.5096,  1.0753,  1.5165, -0.3593,  1.8175, -0.6170],
       device='cuda:0'), range: [-3.2287, 3.1708]
2025-04-13 12:51:00,220 - INFO -   Noise shape: tensor([ 0.1906,  1.4747,  1.0149,  1.8055, -1.1942, -1.6005, -0.7908],
       device='cuda:0'), range: [-3.9438, 3.0988]
2025-04-13 12:51:00,220 - INFO -   Noisy actions shape: tensor([ 1.0666,  2.0780,  1.4513,  2.3510, -1.1799, -0.2422, -1.0022],
       device='cuda:0'), range: [-3.5040, 3.0035]
2025-04-13 12:51:00,262 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:00,262 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9453, 3.4765]
2025-04-13 12:51:00,262 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0179, 2.7954]
2025-04-13 12:51:00,262 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,262 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,263 - INFO -   True actions shape: tensor([-0.5497, -0.3673, -0.7387, -1.1500, -0.6176,  0.3212,  0.8462],
       device='cuda:0'), range: [-3.9453, 3.4765]
2025-04-13 12:51:00,263 - INFO -   Noise shape: tensor([-0.1977, -0.6509,  0.5573, -0.9729,  0.1462, -0.0438,  0.7445],
       device='cuda:0'), range: [-3.9960, 3.8256]
2025-04-13 12:51:00,264 - INFO -   Noisy actions shape: tensor([-0.4983, -0.7375, -0.0278, -1.4786, -0.2726,  0.1669,  1.1103],
       device='cuda:0'), range: [-3.6379, 3.8471]
2025-04-13 12:51:00,303 - INFO -   Loss components:
2025-04-13 12:51:00,303 - INFO -     Diffusion loss: 1.449894 (coef: 1.0)
2025-04-13 12:51:00,303 - INFO -     Grasp quality loss: 0.693325 (coef: 0.5)
2025-04-13 12:51:00,303 - INFO -     Grasp rotation loss: 0.574780 (coef: 0.5)
2025-04-13 12:51:00,303 - INFO -     Grasp width loss: 13.397070 (coef: 0.005)
2025-04-13 12:51:00,303 - INFO -     TOTAL loss: 2.150931
2025-04-13 12:51:00,311 - INFO -   Gradients: avg norm: 0.358965, max norm: 2.812045, non-zero params: 250
2025-04-13 12:51:00,311 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-13 12:51:00,313 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:00,314 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6877, 3.1353]
2025-04-13 12:51:00,314 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9441, 2.9014]
2025-04-13 12:51:00,314 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,314 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,315 - INFO -   True actions shape: tensor([ 0.2517, -0.2243, -0.4449,  0.4146,  0.7387, -1.8209,  1.0476],
       device='cuda:0'), range: [-3.6877, 3.1353]
2025-04-13 12:51:00,315 - INFO -   Noise shape: tensor([-1.0230, -0.7368,  1.4353,  0.7633,  0.0550,  1.4918,  1.6868],
       device='cuda:0'), range: [-3.8247, 3.6650]
2025-04-13 12:51:00,316 - INFO -   Noisy actions shape: tensor([-0.7155, -0.7386,  0.9534,  0.8654,  0.4525,  0.2432,  1.9850],
       device='cuda:0'), range: [-3.4019, 3.4915]
2025-04-13 12:51:00,357 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:00,357 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6204, 3.8166]
2025-04-13 12:51:00,357 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1056, 2.9832]
2025-04-13 12:51:00,357 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,357 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,358 - INFO -   True actions shape: tensor([ 1.2249,  0.1729,  1.3327, -1.0874, -0.2986,  0.5573,  0.7500],
       device='cuda:0'), range: [-3.6204, 3.8166]
2025-04-13 12:51:00,359 - INFO -   Noise shape: tensor([ 0.4869, -0.6283, -0.3301, -0.2825, -0.2428,  0.4662,  0.0689],
       device='cuda:0'), range: [-4.2857, 3.1304]
2025-04-13 12:51:00,359 - INFO -   Noisy actions shape: tensor([ 1.1082, -0.4108,  0.5060, -0.8619, -0.3712,  0.7033,  0.4920],
       device='cuda:0'), range: [-3.7801, 3.3296]
2025-04-13 12:51:00,398 - INFO - 
=== Epoch 12 Summary ===
2025-04-13 12:51:00,398 - INFO -   Avg total loss: 2.349202
2025-04-13 12:51:00,398 - INFO -   Avg diffusion loss: 1.634021
2025-04-13 12:51:00,398 - INFO -   Avg grasp loss: 1.430363
2025-04-13 12:51:00,398 - INFO - 
=== EPOCH 13/20 ===
2025-04-13 12:51:00,399 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:00,402 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:00,402 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9609, 3.6253]
2025-04-13 12:51:00,402 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6108, 3.2398]
2025-04-13 12:51:00,403 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,403 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,403 - INFO -   True actions shape: tensor([-0.4573,  2.0364, -1.3142, -0.5650, -0.8918,  0.2081,  1.6772],
       device='cuda:0'), range: [-3.9609, 3.6253]
2025-04-13 12:51:00,404 - INFO -   Noise shape: tensor([-1.7356,  0.8115,  0.7386,  0.7130,  0.3197, -0.4695,  0.6556],
       device='cuda:0'), range: [-3.3510, 3.6219]
2025-04-13 12:51:00,404 - INFO -   Noisy actions shape: tensor([-0.7280,  2.1397, -1.1797, -0.4442, -0.8295,  0.1306,  1.7602],
       device='cuda:0'), range: [-4.0561, 3.6031]
2025-04-13 12:51:00,405 - INFO -   Diffusion: timestep range [37, 989], noise range [-3.3510, 3.6219]
2025-04-13 12:51:00,405 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.0561, 3.6031]
2025-04-13 12:51:00,423 - INFO -   Model output shapes:
2025-04-13 12:51:00,423 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:00,423 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4334, 0.5909]
2025-04-13 12:51:00,423 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3256
2025-04-13 12:51:00,423 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1593, 0.3199]
2025-04-13 12:51:00,444 - INFO -   Loss components:
2025-04-13 12:51:00,444 - INFO -     Diffusion loss: 1.878813 (coef: 1.0)
2025-04-13 12:51:00,444 - INFO -     Grasp quality loss: 0.696117 (coef: 0.5)
2025-04-13 12:51:00,444 - INFO -     Grasp rotation loss: 0.567288 (coef: 0.5)
2025-04-13 12:51:00,444 - INFO -     Grasp width loss: 13.292472 (coef: 0.005)
2025-04-13 12:51:00,444 - INFO -     TOTAL loss: 2.576978
2025-04-13 12:51:00,452 - INFO -   Gradients: avg norm: 0.458243, max norm: 3.345212, non-zero params: 250
2025-04-13 12:51:00,452 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:51:00,452 - INFO - --- Gradient Check @ Epoch 13, Batch 0 ---
2025-04-13 12:51:00,469 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:00,469 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:00,469 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.2128e-01, MaxNorm=2.9957e+00
2025-04-13 12:51:00,469 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.6140e-02, MaxNorm=8.2546e-02
2025-04-13 12:51:00,469 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.4825e-03, MaxNorm=2.0139e-02
2025-04-13 12:51:00,469 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.3100e-01, MaxNorm=5.1202e-01
2025-04-13 12:51:00,469 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5494e+00, MaxNorm=2.8403e+00
2025-04-13 12:51:00,469 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1684e+00, MaxNorm=2.1866e+00
2025-04-13 12:51:00,469 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.0142e-01, MaxNorm=4.6687e-01
2025-04-13 12:51:00,469 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.5022e-01, MaxNorm=5.8201e-01
2025-04-13 12:51:00,469 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=9.5497e-01, MaxNorm=9.7692e-01
2025-04-13 12:51:00,469 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.8374e+00, MaxNorm=3.3452e+00
2025-04-13 12:51:00,469 - INFO - --- End Gradient Check ---
2025-04-13 12:51:00,471 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:00,472 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3099, 3.3222]
2025-04-13 12:51:00,472 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3527, 3.2080]
2025-04-13 12:51:00,472 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,472 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,473 - INFO -   True actions shape: tensor([-0.3705,  0.6396, -1.3730, -0.6026,  0.0230, -2.5692, -0.0248],
       device='cuda:0'), range: [-4.3099, 3.3222]
2025-04-13 12:51:00,473 - INFO -   Noise shape: tensor([-0.2644,  0.1387,  0.6516,  0.1857, -0.5165, -1.3856,  1.0948],
       device='cuda:0'), range: [-3.2772, 3.5750]
2025-04-13 12:51:00,474 - INFO -   Noisy actions shape: tensor([-0.4197,  0.6545, -1.1953, -0.5468, -0.0915, -2.8116,  0.2174],
       device='cuda:0'), range: [-3.3018, 3.0230]
2025-04-13 12:51:00,515 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:00,515 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0697, 3.3977]
2025-04-13 12:51:00,515 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1040, 3.2174]
2025-04-13 12:51:00,515 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,515 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,516 - INFO -   True actions shape: tensor([-0.3326, -1.2187, -1.1092,  1.9476,  1.5665, -0.2369, -0.7573],
       device='cuda:0'), range: [-3.0697, 3.3977]
2025-04-13 12:51:00,517 - INFO -   Noise shape: tensor([ 0.1738,  0.5448, -2.0930,  0.0492, -0.7689,  0.7705, -0.5085],
       device='cuda:0'), range: [-3.2996, 3.2700]
2025-04-13 12:51:00,517 - INFO -   Noisy actions shape: tensor([ 0.0030, -0.0712, -2.3685,  0.9323,  0.0305,  0.5776, -0.7980],
       device='cuda:0'), range: [-3.2910, 3.3802]
2025-04-13 12:51:00,559 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:00,560 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9217, 3.5273]
2025-04-13 12:51:00,560 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1246, 2.8092]
2025-04-13 12:51:00,560 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,560 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,561 - INFO -   True actions shape: tensor([-0.4620, -0.5817,  1.4837,  0.2764,  1.1104, -0.7121,  1.3033],
       device='cuda:0'), range: [-3.9217, 3.5273]
2025-04-13 12:51:00,561 - INFO -   Noise shape: tensor([-0.2185, -0.1322,  0.3795, -0.5677, -0.0648, -2.0626, -0.1137],
       device='cuda:0'), range: [-3.4391, 2.9153]
2025-04-13 12:51:00,562 - INFO -   Noisy actions shape: tensor([-0.5012, -0.5458,  1.4174, -0.1166,  0.8528, -1.8015,  0.9785],
       device='cuda:0'), range: [-3.6841, 3.1144]
2025-04-13 12:51:00,604 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:00,605 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3153, 3.4556]
2025-04-13 12:51:00,605 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7341, 3.2057]
2025-04-13 12:51:00,605 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,605 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,606 - INFO -   True actions shape: tensor([-1.1725, -0.6940, -0.0710, -0.0203,  0.9886, -0.0942,  2.8436],
       device='cuda:0'), range: [-3.3153, 3.4556]
2025-04-13 12:51:00,606 - INFO -   Noise shape: tensor([-0.4540,  1.7989, -0.2649, -0.2214,  1.2309,  0.0141, -0.4048],
       device='cuda:0'), range: [-3.4853, 3.2711]
2025-04-13 12:51:00,607 - INFO -   Noisy actions shape: tensor([-0.5403,  1.7420, -0.2695, -0.2223,  1.3013,  0.0070, -0.1911],
       device='cuda:0'), range: [-3.2805, 3.5976]
2025-04-13 12:51:00,648 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:00,648 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1834, 4.6164]
2025-04-13 12:51:00,648 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4829, 3.7115]
2025-04-13 12:51:00,649 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,649 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,649 - INFO -   True actions shape: tensor([-1.8512, -0.3000, -0.5327,  0.2431, -0.5892,  0.5635, -0.9872],
       device='cuda:0'), range: [-3.1834, 4.6164]
2025-04-13 12:51:00,650 - INFO -   Noise shape: tensor([-0.7515,  0.2674, -1.2888,  1.7881,  1.5408,  2.2350, -0.7923],
       device='cuda:0'), range: [-3.4309, 3.7058]
2025-04-13 12:51:00,650 - INFO -   Noisy actions shape: tensor([-1.9385, -0.2594, -0.7088,  0.4924, -0.3664,  0.8726, -1.0889],
       device='cuda:0'), range: [-3.5163, 3.7927]
2025-04-13 12:51:00,692 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:00,692 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2237, 3.2869]
2025-04-13 12:51:00,692 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7292, 2.9545]
2025-04-13 12:51:00,692 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,692 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,693 - INFO -   True actions shape: tensor([-0.6003, -0.1163,  0.0677,  2.3586,  0.4662, -0.4499,  0.2246],
       device='cuda:0'), range: [-3.2237, 3.2869]
2025-04-13 12:51:00,693 - INFO -   Noise shape: tensor([-1.4025,  0.5889, -1.2321, -0.6269, -2.6304, -0.9455, -0.4830],
       device='cuda:0'), range: [-3.4820, 3.7946]
2025-04-13 12:51:00,694 - INFO -   Noisy actions shape: tensor([-1.5204,  0.4663, -1.0576,  0.5479, -2.1077, -1.0461, -0.3221],
       device='cuda:0'), range: [-3.2087, 3.7407]
2025-04-13 12:51:00,735 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:00,735 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6071, 3.4469]
2025-04-13 12:51:00,736 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1901, 3.0555]
2025-04-13 12:51:00,736 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,736 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,736 - INFO -   True actions shape: tensor([-0.0831, -0.6364,  0.2084,  1.6368,  0.1859,  0.5668, -0.8778],
       device='cuda:0'), range: [-3.6071, 3.4469]
2025-04-13 12:51:00,737 - INFO -   Noise shape: tensor([-0.9230,  1.0889,  1.3594, -1.1935,  0.8687, -0.0260, -0.8273],
       device='cuda:0'), range: [-3.7658, 4.3465]
2025-04-13 12:51:00,737 - INFO -   Noisy actions shape: tensor([-0.4591, -0.1266,  0.7543,  0.9932,  0.5300,  0.5048, -1.1421],
       device='cuda:0'), range: [-3.4829, 3.8304]
2025-04-13 12:51:00,779 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:00,779 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4318, 3.3189]
2025-04-13 12:51:00,779 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3229, 3.1445]
2025-04-13 12:51:00,779 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,779 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,780 - INFO -   True actions shape: tensor([ 1.3651,  0.6130, -0.6253,  1.2069, -1.7808,  0.7468,  0.6562],
       device='cuda:0'), range: [-3.4318, 3.3189]
2025-04-13 12:51:00,781 - INFO -   Noise shape: tensor([ 0.6597, -0.2494,  0.9667, -1.1694, -1.8668,  1.1389,  0.0527],
       device='cuda:0'), range: [-3.2906, 3.4474]
2025-04-13 12:51:00,781 - INFO -   Noisy actions shape: tensor([ 1.4704,  0.3102,  0.1405,  0.1756, -2.5637,  1.3034,  0.5372],
       device='cuda:0'), range: [-3.4266, 3.5819]
2025-04-13 12:51:00,823 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:00,823 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2235, 3.4405]
2025-04-13 12:51:00,823 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3851, 3.7139]
2025-04-13 12:51:00,823 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,823 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,824 - INFO -   True actions shape: tensor([-0.4343,  0.2565,  0.9547,  1.6073,  0.0760, -1.0385, -0.7666],
       device='cuda:0'), range: [-3.2235, 3.4405]
2025-04-13 12:51:00,824 - INFO -   Noise shape: tensor([ 0.5524, -0.0955, -0.5307,  1.1553, -0.0479,  0.8224,  1.5693],
       device='cuda:0'), range: [-3.8278, 3.4832]
2025-04-13 12:51:00,825 - INFO -   Noisy actions shape: tensor([-0.2452,  0.2152,  0.7474,  1.8830,  0.0578, -0.7382, -0.2515],
       device='cuda:0'), range: [-3.5358, 3.0158]
2025-04-13 12:51:00,873 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:00,873 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3979, 2.9520]
2025-04-13 12:51:00,873 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6215, 3.2450]
2025-04-13 12:51:00,873 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,873 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,874 - INFO -   True actions shape: tensor([-0.5431,  0.8563, -0.3652,  0.3015, -0.3382, -1.2472,  1.8773],
       device='cuda:0'), range: [-3.3979, 2.9520]
2025-04-13 12:51:00,874 - INFO -   Noise shape: tensor([ 0.3542, -0.2209,  1.3835,  0.5603,  0.0589,  0.5891,  1.3130],
       device='cuda:0'), range: [-3.1185, 4.0329]
2025-04-13 12:51:00,875 - INFO -   Noisy actions shape: tensor([-0.3147,  0.6539,  0.3234,  0.5283, -0.2715, -0.8276,  2.2732],
       device='cuda:0'), range: [-3.3109, 4.1980]
2025-04-13 12:51:00,915 - INFO -   Loss components:
2025-04-13 12:51:00,915 - INFO -     Diffusion loss: 1.720239 (coef: 1.0)
2025-04-13 12:51:00,915 - INFO -     Grasp quality loss: 0.693230 (coef: 0.5)
2025-04-13 12:51:00,915 - INFO -     Grasp rotation loss: 0.589457 (coef: 0.5)
2025-04-13 12:51:00,915 - INFO -     Grasp width loss: 14.392185 (coef: 0.005)
2025-04-13 12:51:00,915 - INFO -     TOTAL loss: 2.433543
2025-04-13 12:51:00,923 - INFO -   Gradients: avg norm: 0.438118, max norm: 3.375299, non-zero params: 250
2025-04-13 12:51:00,923 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-13 12:51:00,926 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:00,926 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4137, 3.3100]
2025-04-13 12:51:00,926 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8897, 3.4506]
2025-04-13 12:51:00,926 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,926 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,927 - INFO -   True actions shape: tensor([-0.1782, -1.4175, -0.8106, -1.4319,  0.2354, -1.9136, -1.6840],
       device='cuda:0'), range: [-3.4137, 3.3100]
2025-04-13 12:51:00,927 - INFO -   Noise shape: tensor([-0.3535,  0.1381, -1.0951,  1.2609,  0.8208, -1.0379, -0.7784],
       device='cuda:0'), range: [-3.3666, 3.6690]
2025-04-13 12:51:00,928 - INFO -   Noisy actions shape: tensor([-0.3726, -0.9336, -1.3417, -0.1715,  0.7356, -2.1027, -1.7576],
       device='cuda:0'), range: [-3.5392, 4.2372]
2025-04-13 12:51:00,970 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:00,970 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7651, 4.2182]
2025-04-13 12:51:00,970 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9749, 3.3119]
2025-04-13 12:51:00,970 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:00,970 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:00,971 - INFO -   True actions shape: tensor([ 1.0215,  0.8828,  0.0677,  0.4118,  2.1186, -0.0393, -2.1977],
       device='cuda:0'), range: [-3.7651, 4.2182]
2025-04-13 12:51:00,971 - INFO -   Noise shape: tensor([-2.0460,  0.9404, -0.5226,  0.0946,  1.2156, -0.1548, -2.0033],
       device='cuda:0'), range: [-3.2965, 3.2455]
2025-04-13 12:51:00,972 - INFO -   Noisy actions shape: tensor([ 0.0116,  1.2076, -0.1704,  0.4112,  2.4378, -0.1037, -2.8569],
       device='cuda:0'), range: [-3.2326, 3.6654]
2025-04-13 12:51:01,011 - INFO - 
=== Epoch 13 Summary ===
2025-04-13 12:51:01,011 - INFO -   Avg total loss: 2.352206
2025-04-13 12:51:01,011 - INFO -   Avg diffusion loss: 1.644450
2025-04-13 12:51:01,011 - INFO -   Avg grasp loss: 1.415512
2025-04-13 12:51:01,011 - INFO - 
=== EPOCH 14/20 ===
2025-04-13 12:51:01,012 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:01,015 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:01,015 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2139, 3.5240]
2025-04-13 12:51:01,015 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8774, 3.1732]
2025-04-13 12:51:01,015 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,015 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,016 - INFO -   True actions shape: tensor([ 0.9033,  2.1048, -1.3283, -2.1607, -0.3690,  1.5901, -0.7891],
       device='cuda:0'), range: [-3.2139, 3.5240]
2025-04-13 12:51:01,017 - INFO -   Noise shape: tensor([-1.1136, -0.9286,  0.0762,  0.1943,  0.0316,  2.4633, -1.2909],
       device='cuda:0'), range: [-3.5861, 2.9789]
2025-04-13 12:51:01,017 - INFO -   Noisy actions shape: tensor([-1.0627, -0.8124,  0.0036,  0.0762,  0.0114,  2.5463, -1.3320],
       device='cuda:0'), range: [-3.6163, 2.9554]
2025-04-13 12:51:01,017 - INFO -   Diffusion: timestep range [67, 964], noise range [-3.5861, 2.9789]
2025-04-13 12:51:01,017 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6163, 2.9554]
2025-04-13 12:51:01,036 - INFO -   Model output shapes:
2025-04-13 12:51:01,036 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:01,036 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4301, 0.5935]
2025-04-13 12:51:01,036 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3127
2025-04-13 12:51:01,036 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2842, 0.3268]
2025-04-13 12:51:01,057 - INFO -   Loss components:
2025-04-13 12:51:01,057 - INFO -     Diffusion loss: 1.378886 (coef: 1.0)
2025-04-13 12:51:01,057 - INFO -     Grasp quality loss: 0.698216 (coef: 0.5)
2025-04-13 12:51:01,057 - INFO -     Grasp rotation loss: 0.597421 (coef: 0.5)
2025-04-13 12:51:01,057 - INFO -     Grasp width loss: 15.708271 (coef: 0.005)
2025-04-13 12:51:01,057 - INFO -     TOTAL loss: 2.105246
2025-04-13 12:51:01,065 - INFO -   Gradients: avg norm: 0.355359, max norm: 2.688115, non-zero params: 250
2025-04-13 12:51:01,065 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:51:01,065 - INFO - --- Gradient Check @ Epoch 14, Batch 0 ---
2025-04-13 12:51:01,081 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:01,081 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:01,081 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=5.2577e-01, MaxNorm=2.0296e+00
2025-04-13 12:51:01,082 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.7515e-02, MaxNorm=4.7806e-02
2025-04-13 12:51:01,082 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.4926e-02, MaxNorm=6.5733e-02
2025-04-13 12:51:01,082 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.5831e-01, MaxNorm=6.5315e-01
2025-04-13 12:51:01,082 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.0793e+00, MaxNorm=1.9323e+00
2025-04-13 12:51:01,082 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.0298e+00, MaxNorm=1.8239e+00
2025-04-13 12:51:01,082 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=7.5422e-02, MaxNorm=3.4973e-01
2025-04-13 12:51:01,082 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=7.2671e-01, MaxNorm=7.3930e-01
2025-04-13 12:51:01,082 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=7.9421e-01, MaxNorm=8.0064e-01
2025-04-13 12:51:01,082 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4938e+00, MaxNorm=2.6881e+00
2025-04-13 12:51:01,082 - INFO - --- End Gradient Check ---
2025-04-13 12:51:01,084 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:01,084 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4670, 3.5604]
2025-04-13 12:51:01,084 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8207, 3.9726]
2025-04-13 12:51:01,085 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,085 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,085 - INFO -   True actions shape: tensor([-0.7375,  1.7615,  0.6347, -0.7198, -0.0863,  0.6358, -0.9337],
       device='cuda:0'), range: [-3.4670, 3.5604]
2025-04-13 12:51:01,086 - INFO -   Noise shape: tensor([-1.8939,  0.5043,  0.0198, -0.2353, -0.3223, -0.6330, -0.5755],
       device='cuda:0'), range: [-4.1602, 3.5237]
2025-04-13 12:51:01,086 - INFO -   Noisy actions shape: tensor([-2.0274,  1.0035,  0.2070, -0.4380, -0.3334, -0.4162, -0.8263],
       device='cuda:0'), range: [-4.0803, 3.7934]
2025-04-13 12:51:01,128 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:01,128 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2820, 4.3386]
2025-04-13 12:51:01,128 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9467, 3.2034]
2025-04-13 12:51:01,128 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,128 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,129 - INFO -   True actions shape: tensor([-0.6344,  0.0257, -0.3007, -0.7296, -0.4119,  0.3063,  0.7327],
       device='cuda:0'), range: [-4.2820, 4.3386]
2025-04-13 12:51:01,129 - INFO -   Noise shape: tensor([-1.8889,  1.7643, -1.9285, -0.5840,  0.0855, -1.2252, -0.8208],
       device='cuda:0'), range: [-3.6819, 3.4210]
2025-04-13 12:51:01,130 - INFO -   Noisy actions shape: tensor([-1.6886,  1.1390, -1.4558, -0.9345, -0.2642, -0.5404,  0.0458],
       device='cuda:0'), range: [-4.2748, 4.3019]
2025-04-13 12:51:01,172 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:01,173 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5919, 2.9881]
2025-04-13 12:51:01,173 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9070, 3.0172]
2025-04-13 12:51:01,173 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,173 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,174 - INFO -   True actions shape: tensor([ 1.1434,  0.4843,  1.4763,  0.8680,  0.6247, -0.4449, -0.2742],
       device='cuda:0'), range: [-3.5919, 2.9881]
2025-04-13 12:51:01,174 - INFO -   Noise shape: tensor([ 1.8888, -0.1387, -0.0732, -1.4447, -0.0470,  0.9029,  0.3216],
       device='cuda:0'), range: [-3.6332, 3.4866]
2025-04-13 12:51:01,175 - INFO -   Noisy actions shape: tensor([ 2.0544,  0.3010,  1.1297, -0.1855,  0.4683,  0.1935, -0.0231],
       device='cuda:0'), range: [-3.6270, 3.2774]
2025-04-13 12:51:01,217 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:01,218 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2784, 3.6569]
2025-04-13 12:51:01,218 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1331, 2.7601]
2025-04-13 12:51:01,218 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,218 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,219 - INFO -   True actions shape: tensor([ 0.3543,  0.8754, -2.7033, -0.0610, -0.9977, -0.1974, -0.1194],
       device='cuda:0'), range: [-3.2784, 3.6569]
2025-04-13 12:51:01,219 - INFO -   Noise shape: tensor([ 0.4941,  0.9235,  0.9544, -1.0608, -1.2992, -0.3654, -0.3077],
       device='cuda:0'), range: [-3.5738, 3.3086]
2025-04-13 12:51:01,220 - INFO -   Noisy actions shape: tensor([ 0.5511,  1.2158, -1.8879, -0.5734, -1.5066, -0.3513, -0.2549],
       device='cuda:0'), range: [-3.4955, 3.7871]
2025-04-13 12:51:01,261 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:01,262 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2768, 4.0460]
2025-04-13 12:51:01,262 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7854, 3.0927]
2025-04-13 12:51:01,262 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,262 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,263 - INFO -   True actions shape: tensor([-0.1903,  0.8949,  0.4211, -1.4087,  1.0834,  0.9363, -1.0467],
       device='cuda:0'), range: [-3.2768, 4.0460]
2025-04-13 12:51:01,263 - INFO -   Noise shape: tensor([-0.6541, -0.3104,  1.6039, -0.4674,  0.5278, -0.8260, -0.6614],
       device='cuda:0'), range: [-3.3665, 4.0404]
2025-04-13 12:51:01,264 - INFO -   Noisy actions shape: tensor([-0.5161,  0.5811,  1.2272, -1.4358,  1.1960,  0.3348, -1.2381],
       device='cuda:0'), range: [-2.9760, 3.3584]
2025-04-13 12:51:01,305 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:01,305 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7144, 3.1573]
2025-04-13 12:51:01,305 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6375, 3.2377]
2025-04-13 12:51:01,305 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,305 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,306 - INFO -   True actions shape: tensor([ 2.5329, -0.3474,  0.9372,  0.9393, -0.8327,  1.1039,  0.1723],
       device='cuda:0'), range: [-3.7144, 3.1573]
2025-04-13 12:51:01,307 - INFO -   Noise shape: tensor([ 1.6456,  0.5441, -1.2960,  0.9193, -0.5388,  0.1990,  0.4810],
       device='cuda:0'), range: [-3.3937, 3.3662]
2025-04-13 12:51:01,307 - INFO -   Noisy actions shape: tensor([ 3.0124,  0.0525, -0.0378,  1.3041, -0.9890,  0.9994,  0.4282],
       device='cuda:0'), range: [-3.4719, 3.4756]
2025-04-13 12:51:01,348 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:01,349 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2782, 3.5578]
2025-04-13 12:51:01,349 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3486, 2.8114]
2025-04-13 12:51:01,349 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,349 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,350 - INFO -   True actions shape: tensor([ 1.8059, -0.7839,  1.0613,  0.5228,  1.4039, -1.0412,  0.4918],
       device='cuda:0'), range: [-3.2782, 3.5578]
2025-04-13 12:51:01,350 - INFO -   Noise shape: tensor([-1.5187,  0.9947,  0.6168, -1.2317, -0.5770,  1.0551,  0.0164],
       device='cuda:0'), range: [-3.9350, 3.4429]
2025-04-13 12:51:01,351 - INFO -   Noisy actions shape: tensor([ 0.8394, -0.2012,  1.2273, -0.1422,  0.9461, -0.3966,  0.4377],
       device='cuda:0'), range: [-3.5242, 3.5925]
2025-04-13 12:51:01,392 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:01,392 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4067, 3.6822]
2025-04-13 12:51:01,392 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6772, 3.3685]
2025-04-13 12:51:01,392 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,392 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,393 - INFO -   True actions shape: tensor([ 0.5615,  0.8187, -1.4468,  0.4625, -0.3932, -1.7048, -0.8849],
       device='cuda:0'), range: [-3.4067, 3.6822]
2025-04-13 12:51:01,394 - INFO -   Noise shape: tensor([-0.5335, -0.2378,  1.1730, -0.3682,  0.3807,  0.6276, -0.4974],
       device='cuda:0'), range: [-3.5528, 3.3437]
2025-04-13 12:51:01,394 - INFO -   Noisy actions shape: tensor([-0.5167, -0.2134,  1.1296, -0.3544,  0.3689,  0.5768, -0.5234],
       device='cuda:0'), range: [-3.2052, 3.8801]
2025-04-13 12:51:01,436 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:01,436 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2291, 4.3171]
2025-04-13 12:51:01,436 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6175, 3.0598]
2025-04-13 12:51:01,436 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,436 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,437 - INFO -   True actions shape: tensor([ 1.3960,  0.2428, -0.7353, -1.2293, -1.6582, -1.1832, -0.5426],
       device='cuda:0'), range: [-3.2291, 4.3171]
2025-04-13 12:51:01,437 - INFO -   Noise shape: tensor([-0.6325, -1.0070,  0.8658,  1.8175,  2.8798, -0.2047, -0.5535],
       device='cuda:0'), range: [-3.0109, 3.7893]
2025-04-13 12:51:01,438 - INFO -   Noisy actions shape: tensor([-0.4790, -0.9751,  0.7819,  1.6750,  2.6852, -0.3305, -0.6085],
       device='cuda:0'), range: [-3.4902, 3.7796]
2025-04-13 12:51:01,479 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:01,479 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3012, 3.2561]
2025-04-13 12:51:01,479 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1204, 2.6447]
2025-04-13 12:51:01,480 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,480 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,480 - INFO -   True actions shape: tensor([-0.2542, -2.3329,  0.2504,  3.0734, -0.1842,  0.5992,  0.8254],
       device='cuda:0'), range: [-3.3012, 3.2561]
2025-04-13 12:51:01,481 - INFO -   Noise shape: tensor([-0.7520,  0.9593,  1.1836, -1.5940,  0.3432, -0.0098, -0.1725],
       device='cuda:0'), range: [-3.3747, 2.9876]
2025-04-13 12:51:01,481 - INFO -   Noisy actions shape: tensor([-0.7901,  0.4045,  1.2095, -0.8544,  0.2924,  0.1265,  0.0195],
       device='cuda:0'), range: [-3.3391, 4.0655]
2025-04-13 12:51:01,520 - INFO -   Loss components:
2025-04-13 12:51:01,520 - INFO -     Diffusion loss: 1.536606 (coef: 1.0)
2025-04-13 12:51:01,520 - INFO -     Grasp quality loss: 0.695471 (coef: 0.5)
2025-04-13 12:51:01,520 - INFO -     Grasp rotation loss: 0.582336 (coef: 0.5)
2025-04-13 12:51:01,520 - INFO -     Grasp width loss: 13.141642 (coef: 0.005)
2025-04-13 12:51:01,520 - INFO -     TOTAL loss: 2.241217
2025-04-13 12:51:01,528 - INFO -   Gradients: avg norm: 0.393570, max norm: 3.134604, non-zero params: 250
2025-04-13 12:51:01,528 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-13 12:51:01,531 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:01,531 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2490, 3.4988]
2025-04-13 12:51:01,531 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5926, 2.9158]
2025-04-13 12:51:01,531 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,531 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,532 - INFO -   True actions shape: tensor([ 1.0483, -0.7420, -0.5251, -0.7598, -0.0153,  0.1154, -0.6672],
       device='cuda:0'), range: [-3.2490, 3.4988]
2025-04-13 12:51:01,532 - INFO -   Noise shape: tensor([ 0.4801, -1.0888,  0.4188, -0.5354, -1.3510,  0.4120,  0.8874],
       device='cuda:0'), range: [-3.1739, 3.7870]
2025-04-13 12:51:01,533 - INFO -   Noisy actions shape: tensor([ 0.4964, -1.1002,  0.4106, -0.5472, -1.3511,  0.4138,  0.8769],
       device='cuda:0'), range: [-3.0989, 3.8031]
2025-04-13 12:51:01,574 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:01,574 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3174, 4.3874]
2025-04-13 12:51:01,574 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9486, 3.3348]
2025-04-13 12:51:01,575 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,575 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,575 - INFO -   True actions shape: tensor([-2.0249, -0.7356, -1.5053,  0.8195, -0.7008,  2.3588, -0.5327],
       device='cuda:0'), range: [-3.3174, 4.3874]
2025-04-13 12:51:01,576 - INFO -   Noise shape: tensor([-0.8266, -0.6177, -1.2188, -0.0964,  0.4114, -0.0947, -0.2656],
       device='cuda:0'), range: [-3.3136, 2.9540]
2025-04-13 12:51:01,576 - INFO -   Noisy actions shape: tensor([-1.5191, -0.8466, -1.6905,  0.2147,  0.1219,  0.7876, -0.4444],
       device='cuda:0'), range: [-3.2766, 3.8143]
2025-04-13 12:51:01,616 - INFO - 
=== Epoch 14 Summary ===
2025-04-13 12:51:01,616 - INFO -   Avg total loss: 2.313497
2025-04-13 12:51:01,616 - INFO -   Avg diffusion loss: 1.604681
2025-04-13 12:51:01,616 - INFO -   Avg grasp loss: 1.417633
2025-04-13 12:51:01,616 - INFO - 
=== EPOCH 15/20 ===
2025-04-13 12:51:01,617 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:01,620 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:01,620 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6709, 3.9421]
2025-04-13 12:51:01,620 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1540, 3.1355]
2025-04-13 12:51:01,620 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,620 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,621 - INFO -   True actions shape: tensor([ 1.2417, -0.6750, -2.4234, -0.7976,  0.8602, -1.5214,  0.3811],
       device='cuda:0'), range: [-3.6709, 3.9421]
2025-04-13 12:51:01,622 - INFO -   Noise shape: tensor([ 1.4520,  0.8812, -0.6734, -1.0653,  1.2961,  2.3300,  0.2919],
       device='cuda:0'), range: [-3.4391, 3.6051]
2025-04-13 12:51:01,622 - INFO -   Noisy actions shape: tensor([ 1.7135,  0.6874, -1.2506, -1.2292,  1.4683,  1.8825,  0.3769],
       device='cuda:0'), range: [-3.5074, 3.7861]
2025-04-13 12:51:01,622 - INFO -   Diffusion: timestep range [195, 915], noise range [-3.4391, 3.6051]
2025-04-13 12:51:01,622 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5074, 3.7861]
2025-04-13 12:51:01,641 - INFO -   Model output shapes:
2025-04-13 12:51:01,641 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:01,641 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4416, 0.5644]
2025-04-13 12:51:01,641 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3357
2025-04-13 12:51:01,641 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1885, 0.2923]
2025-04-13 12:51:01,662 - INFO -   Loss components:
2025-04-13 12:51:01,662 - INFO -     Diffusion loss: 1.432269 (coef: 1.0)
2025-04-13 12:51:01,662 - INFO -     Grasp quality loss: 0.694391 (coef: 0.5)
2025-04-13 12:51:01,662 - INFO -     Grasp rotation loss: 0.564993 (coef: 0.5)
2025-04-13 12:51:01,662 - INFO -     Grasp width loss: 13.256557 (coef: 0.005)
2025-04-13 12:51:01,663 - INFO -     TOTAL loss: 2.128244
2025-04-13 12:51:01,670 - INFO -   Gradients: avg norm: 0.304077, max norm: 2.269753, non-zero params: 250
2025-04-13 12:51:01,670 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:51:01,670 - INFO - --- Gradient Check @ Epoch 15, Batch 0 ---
2025-04-13 12:51:01,687 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:01,687 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:01,687 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.5240e-01, MaxNorm=1.7450e+00
2025-04-13 12:51:01,687 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=9.2928e-03, MaxNorm=2.6978e-02
2025-04-13 12:51:01,687 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.7993e-02, MaxNorm=5.6859e-02
2025-04-13 12:51:01,687 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.3148e-01, MaxNorm=5.5059e-01
2025-04-13 12:51:01,687 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=9.4663e-01, MaxNorm=1.7726e+00
2025-04-13 12:51:01,687 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.8105e-01, MaxNorm=1.5974e+00
2025-04-13 12:51:01,687 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.8301e-02, MaxNorm=2.6564e-01
2025-04-13 12:51:01,687 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.1598e-01, MaxNorm=5.5899e-01
2025-04-13 12:51:01,687 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.3607e-01, MaxNorm=6.9610e-01
2025-04-13 12:51:01,687 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2512e+00, MaxNorm=2.2698e+00
2025-04-13 12:51:01,687 - INFO - --- End Gradient Check ---
2025-04-13 12:51:01,690 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:01,690 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6641, 3.7588]
2025-04-13 12:51:01,690 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2708, 3.4517]
2025-04-13 12:51:01,690 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,690 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,691 - INFO -   True actions shape: tensor([ 0.5656,  1.0470,  0.2900, -0.7823, -1.6162,  1.0496, -0.4512],
       device='cuda:0'), range: [-3.6641, 3.7588]
2025-04-13 12:51:01,692 - INFO -   Noise shape: tensor([-1.5760,  0.1442,  0.5880,  1.6248,  0.2787, -0.9406, -0.0524],
       device='cuda:0'), range: [-3.1331, 3.3942]
2025-04-13 12:51:01,692 - INFO -   Noisy actions shape: tensor([ 0.3918,  1.0565,  0.3519, -0.6019, -1.5766,  0.9417, -0.4542],
       device='cuda:0'), range: [-3.7335, 3.6878]
2025-04-13 12:51:01,736 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:01,737 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5794, 3.3125]
2025-04-13 12:51:01,737 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8844, 2.7315]
2025-04-13 12:51:01,737 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,737 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,738 - INFO -   True actions shape: tensor([-0.3906,  0.6438, -1.5557,  0.2866,  1.1771,  0.0065, -1.7481],
       device='cuda:0'), range: [-3.5794, 3.3125]
2025-04-13 12:51:01,739 - INFO -   Noise shape: tensor([ 1.4070, -0.1724,  0.5736, -0.2007,  0.8827, -0.4923,  0.0735],
       device='cuda:0'), range: [-3.7194, 3.6665]
2025-04-13 12:51:01,739 - INFO -   Noisy actions shape: tensor([ 1.1348,  0.0984, -0.0938, -0.0699,  1.2786, -0.4489, -0.6292],
       device='cuda:0'), range: [-3.3379, 3.5963]
2025-04-13 12:51:01,784 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:01,784 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4318, 3.9937]
2025-04-13 12:51:01,785 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8157, 3.1879]
2025-04-13 12:51:01,785 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,785 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,786 - INFO -   True actions shape: tensor([ 1.5616,  0.7854,  1.1673,  1.7918, -2.1135, -0.0057, -1.3506],
       device='cuda:0'), range: [-3.4318, 3.9937]
2025-04-13 12:51:01,786 - INFO -   Noise shape: tensor([-0.0160,  1.6492,  0.1078, -0.6308,  0.7979,  0.1069, -0.1005],
       device='cuda:0'), range: [-4.1151, 3.4766]
2025-04-13 12:51:01,787 - INFO -   Noisy actions shape: tensor([ 0.6455,  1.8266,  0.5910,  0.1856, -0.1702,  0.0944, -0.6619],
       device='cuda:0'), range: [-4.2083, 3.3686]
2025-04-13 12:51:01,830 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:01,830 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0603, 3.9234]
2025-04-13 12:51:01,830 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3848, 3.6524]
2025-04-13 12:51:01,830 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,830 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,831 - INFO -   True actions shape: tensor([-0.2657, -0.3447, -0.7046, -0.6742, -0.4388, -0.2066, -1.0756],
       device='cuda:0'), range: [-3.0603, 3.9234]
2025-04-13 12:51:01,832 - INFO -   Noise shape: tensor([ 1.4835, -0.5246,  0.6874,  1.0912, -1.7921,  1.0166,  0.2419],
       device='cuda:0'), range: [-3.6165, 3.4600]
2025-04-13 12:51:01,832 - INFO -   Noisy actions shape: tensor([ 0.8416, -0.6127, -0.0276,  0.2752, -1.5623,  0.5591, -0.6040],
       device='cuda:0'), range: [-3.6387, 3.1117]
2025-04-13 12:51:01,875 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:01,875 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3505, 3.6510]
2025-04-13 12:51:01,875 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8343, 3.6653]
2025-04-13 12:51:01,875 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,875 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,876 - INFO -   True actions shape: tensor([ 0.9817,  1.6917,  0.4300, -1.2760,  0.5165, -0.4796, -0.0990],
       device='cuda:0'), range: [-3.3505, 3.6510]
2025-04-13 12:51:01,876 - INFO -   Noise shape: tensor([ 0.5675, -1.7731,  0.5023, -0.5380,  1.0563,  0.0731,  0.9585],
       device='cuda:0'), range: [-4.1346, 3.3381]
2025-04-13 12:51:01,877 - INFO -   Noisy actions shape: tensor([ 1.1339,  0.6011,  0.6214, -1.3756,  0.9692, -0.3817,  0.3851],
       device='cuda:0'), range: [-4.0427, 3.8526]
2025-04-13 12:51:01,919 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:01,919 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2028, 3.2702]
2025-04-13 12:51:01,919 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8031, 2.8880]
2025-04-13 12:51:01,919 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,919 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,920 - INFO -   True actions shape: tensor([-6.0960e-03, -5.6388e-01,  2.2456e+00, -1.4281e-04, -1.4182e+00,
         3.6379e-01,  7.6219e-01], device='cuda:0'), range: [-3.2028, 3.2702]
2025-04-13 12:51:01,921 - INFO -   Noise shape: tensor([ 0.6637, -0.5270, -0.9653, -1.7312,  0.6282,  0.9358, -0.0206],
       device='cuda:0'), range: [-3.8900, 3.4113]
2025-04-13 12:51:01,921 - INFO -   Noisy actions shape: tensor([ 0.4530, -0.7718,  0.9618, -1.1932, -0.5947,  0.9085,  0.5380],
       device='cuda:0'), range: [-3.8863, 3.3125]
2025-04-13 12:51:01,963 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:01,963 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1508, 3.4235]
2025-04-13 12:51:01,963 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6826, 3.8083]
2025-04-13 12:51:01,963 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:01,963 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:01,964 - INFO -   True actions shape: tensor([ 1.8887,  0.4733,  0.2242, -0.7186, -1.7502,  0.5583, -1.3852],
       device='cuda:0'), range: [-3.1508, 3.4235]
2025-04-13 12:51:01,965 - INFO -   Noise shape: tensor([-1.9692, -0.4508,  0.8172, -1.1593,  0.0897, -0.7421,  0.3041],
       device='cuda:0'), range: [-3.7747, 3.0166]
2025-04-13 12:51:01,965 - INFO -   Noisy actions shape: tensor([-1.8003, -0.4087,  0.8334, -1.2165, -0.0605, -0.6916,  0.1844],
       device='cuda:0'), range: [-3.2516, 3.1060]
2025-04-13 12:51:02,007 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:02,007 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1673, 3.3529]
2025-04-13 12:51:02,007 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5953, 2.9238]
2025-04-13 12:51:02,007 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,007 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,008 - INFO -   True actions shape: tensor([ 0.2355,  0.7871,  0.3881, -0.5220, -0.5219,  0.4328,  0.5274],
       device='cuda:0'), range: [-3.1673, 3.3529]
2025-04-13 12:51:02,008 - INFO -   Noise shape: tensor([-0.5253,  0.5589,  0.5143, -0.3817,  0.0718,  0.0660, -1.2931],
       device='cuda:0'), range: [-3.0944, 3.7006]
2025-04-13 12:51:02,009 - INFO -   Noisy actions shape: tensor([-0.0773,  0.9635,  0.6011, -0.6448, -0.4053,  0.4024, -0.2348],
       device='cuda:0'), range: [-3.5830, 3.4687]
2025-04-13 12:51:02,050 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:02,051 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8175, 3.5115]
2025-04-13 12:51:02,051 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9399, 2.9362]
2025-04-13 12:51:02,051 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,051 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,052 - INFO -   True actions shape: tensor([ 0.7266, -0.6702, -3.0573,  0.3207,  1.0232, -0.6683, -0.2386],
       device='cuda:0'), range: [-3.8175, 3.5115]
2025-04-13 12:51:02,052 - INFO -   Noise shape: tensor([ 0.9870, -1.4618,  0.0664,  0.7913, -0.6742,  0.5063,  2.3541],
       device='cuda:0'), range: [-3.3109, 3.1562]
2025-04-13 12:51:02,053 - INFO -   Noisy actions shape: tensor([ 1.2252, -1.5823, -1.6954,  0.8324,  0.0328,  0.0327,  1.7938],
       device='cuda:0'), range: [-3.9363, 3.3778]
2025-04-13 12:51:02,094 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:02,094 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1972, 3.0184]
2025-04-13 12:51:02,094 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8207, 3.0694]
2025-04-13 12:51:02,094 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,094 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,095 - INFO -   True actions shape: tensor([-0.0034,  0.7296,  0.3449,  0.3857, -0.9287,  1.1882, -0.0416],
       device='cuda:0'), range: [-3.1972, 3.0184]
2025-04-13 12:51:02,096 - INFO -   Noise shape: tensor([-0.5385, -0.3181,  0.4806,  1.0678, -1.4452,  2.5710,  0.6341],
       device='cuda:0'), range: [-3.1863, 3.0989]
2025-04-13 12:51:02,096 - INFO -   Noisy actions shape: tensor([-0.4973, -0.0085,  0.5770,  1.1337, -1.6929,  2.8308,  0.5677],
       device='cuda:0'), range: [-3.3014, 3.1437]
2025-04-13 12:51:02,135 - INFO -   Loss components:
2025-04-13 12:51:02,135 - INFO -     Diffusion loss: 1.409220 (coef: 1.0)
2025-04-13 12:51:02,135 - INFO -     Grasp quality loss: 0.694201 (coef: 0.5)
2025-04-13 12:51:02,135 - INFO -     Grasp rotation loss: 0.582250 (coef: 0.5)
2025-04-13 12:51:02,135 - INFO -     Grasp width loss: 11.072403 (coef: 0.005)
2025-04-13 12:51:02,135 - INFO -     TOTAL loss: 2.102808
2025-04-13 12:51:02,143 - INFO -   Gradients: avg norm: 0.350871, max norm: 2.746689, non-zero params: 250
2025-04-13 12:51:02,143 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-13 12:51:02,146 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:02,146 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6762, 3.3766]
2025-04-13 12:51:02,146 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2489, 3.2935]
2025-04-13 12:51:02,146 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,146 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,147 - INFO -   True actions shape: tensor([ 0.1743,  0.8654,  1.1005, -1.0894, -0.9105, -0.3960,  0.4756],
       device='cuda:0'), range: [-3.6762, 3.3766]
2025-04-13 12:51:02,147 - INFO -   Noise shape: tensor([ 0.3394, -0.7657, -0.5775, -1.5110,  1.2605,  1.4408,  0.1973],
       device='cuda:0'), range: [-3.4515, 3.7420]
2025-04-13 12:51:02,148 - INFO -   Noisy actions shape: tensor([ 0.2267,  0.7309,  0.9933, -1.3183, -0.6959, -0.1591,  0.5011],
       device='cuda:0'), range: [-3.2538, 3.5400]
2025-04-13 12:51:02,189 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:02,189 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1287, 3.2845]
2025-04-13 12:51:02,189 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7782, 2.9815]
2025-04-13 12:51:02,189 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,189 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,190 - INFO -   True actions shape: tensor([-0.0461,  0.9959, -0.0892, -0.0893, -0.3445, -0.8413, -1.6481],
       device='cuda:0'), range: [-3.1287, 3.2845]
2025-04-13 12:51:02,191 - INFO -   Noise shape: tensor([-0.3227,  0.9917, -1.2865,  0.0545, -0.4997, -0.4940, -1.5813],
       device='cuda:0'), range: [-3.8986, 3.6049]
2025-04-13 12:51:02,191 - INFO -   Noisy actions shape: tensor([-0.1482,  1.2636, -0.5014, -0.0668, -0.4879, -0.9560, -2.0717],
       device='cuda:0'), range: [-4.3096, 3.2771]
2025-04-13 12:51:02,231 - INFO - 
=== Epoch 15 Summary ===
2025-04-13 12:51:02,231 - INFO -   Avg total loss: 2.230218
2025-04-13 12:51:02,231 - INFO -   Avg diffusion loss: 1.531111
2025-04-13 12:51:02,231 - INFO -   Avg grasp loss: 1.398214
2025-04-13 12:51:02,399 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125051/ckpt_epoch_15.pth
2025-04-13 12:51:02,400 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:51:02,400 - INFO - 
=== EPOCH 16/20 ===
2025-04-13 12:51:02,401 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:02,404 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:02,404 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6197, 3.6496]
2025-04-13 12:51:02,404 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0687, 2.9378]
2025-04-13 12:51:02,404 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,404 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,405 - INFO -   True actions shape: tensor([ 0.0971,  1.2753, -0.8033, -0.2178, -0.3747, -1.4189, -0.9100],
       device='cuda:0'), range: [-3.6197, 3.6496]
2025-04-13 12:51:02,406 - INFO -   Noise shape: tensor([ 0.6554,  0.2501,  1.4727,  0.2264,  0.1939,  0.0417, -1.1578],
       device='cuda:0'), range: [-3.6917, 3.3517]
2025-04-13 12:51:02,406 - INFO -   Noisy actions shape: tensor([ 0.6119,  0.8710,  0.8490,  0.0820, -0.0267, -0.6947, -1.4610],
       device='cuda:0'), range: [-3.6168, 3.9082]
2025-04-13 12:51:02,406 - INFO -   Diffusion: timestep range [248, 859], noise range [-3.6917, 3.3517]
2025-04-13 12:51:02,406 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6168, 3.9082]
2025-04-13 12:51:02,425 - INFO -   Model output shapes:
2025-04-13 12:51:02,425 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:02,425 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4236, 0.5724]
2025-04-13 12:51:02,425 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3792
2025-04-13 12:51:02,425 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1965, 0.2880]
2025-04-13 12:51:02,446 - INFO -   Loss components:
2025-04-13 12:51:02,446 - INFO -     Diffusion loss: 1.321198 (coef: 1.0)
2025-04-13 12:51:02,446 - INFO -     Grasp quality loss: 0.696068 (coef: 0.5)
2025-04-13 12:51:02,446 - INFO -     Grasp rotation loss: 0.561952 (coef: 0.5)
2025-04-13 12:51:02,446 - INFO -     Grasp width loss: 11.063611 (coef: 0.005)
2025-04-13 12:51:02,446 - INFO -     TOTAL loss: 2.005526
2025-04-13 12:51:02,454 - INFO -   Gradients: avg norm: 0.315578, max norm: 2.520478, non-zero params: 250
2025-04-13 12:51:02,454 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:51:02,454 - INFO - --- Gradient Check @ Epoch 16, Batch 0 ---
2025-04-13 12:51:02,471 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:02,471 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:02,471 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.9116e-01, MaxNorm=1.8389e+00
2025-04-13 12:51:02,471 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.5380e-02, MaxNorm=4.0602e-02
2025-04-13 12:51:02,471 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.6563e-03, MaxNorm=2.1095e-02
2025-04-13 12:51:02,471 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.5590e-01, MaxNorm=3.1283e-01
2025-04-13 12:51:02,471 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.0850e+00, MaxNorm=2.0418e+00
2025-04-13 12:51:02,471 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.2542e-01, MaxNorm=1.7035e+00
2025-04-13 12:51:02,471 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=6.2623e-02, MaxNorm=2.8197e-01
2025-04-13 12:51:02,471 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.2300e-01, MaxNorm=4.8887e-01
2025-04-13 12:51:02,471 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.3819e-01, MaxNorm=6.7790e-01
2025-04-13 12:51:02,471 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3814e+00, MaxNorm=2.5205e+00
2025-04-13 12:51:02,471 - INFO - --- End Gradient Check ---
2025-04-13 12:51:02,474 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:02,474 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3398, 3.5043]
2025-04-13 12:51:02,474 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8181, 3.7191]
2025-04-13 12:51:02,474 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,474 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,475 - INFO -   True actions shape: tensor([ 1.9735, -0.9922, -1.2964,  0.2494, -0.5759, -1.2658, -0.0830],
       device='cuda:0'), range: [-3.3398, 3.5043]
2025-04-13 12:51:02,476 - INFO -   Noise shape: tensor([-0.6169, -1.3940,  0.9345, -2.3660, -1.4955,  0.1880, -0.8985],
       device='cuda:0'), range: [-4.1454, 3.9079]
2025-04-13 12:51:02,476 - INFO -   Noisy actions shape: tensor([ 0.4306, -1.7015,  0.1784, -1.9394, -1.5857, -0.4571, -0.8237],
       device='cuda:0'), range: [-3.3607, 3.3360]
2025-04-13 12:51:02,518 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:02,518 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0491, 3.9383]
2025-04-13 12:51:02,518 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4668, 3.1973]
2025-04-13 12:51:02,518 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,518 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,519 - INFO -   True actions shape: tensor([1.6726, 0.6409, 1.9206, 0.5999, 0.9644, 1.8303, 2.8193],
       device='cuda:0'), range: [-4.0491, 3.9383]
2025-04-13 12:51:02,519 - INFO -   Noise shape: tensor([ 0.9070,  1.9256, -0.0569,  0.5080,  0.4046,  0.2099, -1.8338],
       device='cuda:0'), range: [-3.5980, 3.0077]
2025-04-13 12:51:02,520 - INFO -   Noisy actions shape: tensor([ 1.6722e+00,  1.9637e+00,  9.9937e-01,  7.5289e-01,  8.6498e-01,
         1.1738e+00, -1.6654e-04], device='cuda:0'), range: [-4.0823, 3.2499]
2025-04-13 12:51:02,562 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:02,562 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1588, 3.3639]
2025-04-13 12:51:02,562 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2006, 3.2926]
2025-04-13 12:51:02,562 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,562 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,563 - INFO -   True actions shape: tensor([-1.9204,  0.3270,  1.7403, -0.0954,  1.3389,  0.1836, -0.6125],
       device='cuda:0'), range: [-3.1588, 3.3639]
2025-04-13 12:51:02,563 - INFO -   Noise shape: tensor([-0.6184,  1.7897,  2.0261,  0.1666,  0.5207, -0.4115,  2.4439],
       device='cuda:0'), range: [-4.0255, 3.7172]
2025-04-13 12:51:02,564 - INFO -   Noisy actions shape: tensor([-1.8066,  1.4836,  2.6605,  0.0481,  1.3221, -0.1558,  1.2678],
       device='cuda:0'), range: [-3.5610, 3.2035]
2025-04-13 12:51:02,605 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:02,605 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2321, 3.5441]
2025-04-13 12:51:02,605 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5121, 3.9004]
2025-04-13 12:51:02,606 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,606 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,606 - INFO -   True actions shape: tensor([ 1.3038,  0.7641, -0.8321,  0.7367,  0.8622, -0.3418, -1.7188],
       device='cuda:0'), range: [-3.2321, 3.5441]
2025-04-13 12:51:02,607 - INFO -   Noise shape: tensor([-0.8745,  1.9287,  0.9028, -0.4186,  0.9609,  0.1479,  0.7534],
       device='cuda:0'), range: [-3.2754, 3.2489]
2025-04-13 12:51:02,607 - INFO -   Noisy actions shape: tensor([-0.8643,  1.9346,  0.8963, -0.4128,  0.9676,  0.1452,  0.7399],
       device='cuda:0'), range: [-3.3815, 3.1698]
2025-04-13 12:51:02,649 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:02,649 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0759, 3.5547]
2025-04-13 12:51:02,649 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5862, 4.0297]
2025-04-13 12:51:02,649 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,649 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,650 - INFO -   True actions shape: tensor([ 8.4664e-01, -1.7329e-01,  4.6519e-01,  7.5287e-01,  2.3216e-03,
         8.5587e-01, -2.7280e+00], device='cuda:0'), range: [-4.0759, 3.5547]
2025-04-13 12:51:02,650 - INFO -   Noise shape: tensor([-0.5614,  0.2768,  0.4286, -0.9391, -0.7683,  0.8372, -2.4548],
       device='cuda:0'), range: [-3.0878, 3.5795]
2025-04-13 12:51:02,651 - INFO -   Noisy actions shape: tensor([ 0.7167, -0.1142,  0.5418,  0.5489, -0.1520,  1.0066, -3.1654],
       device='cuda:0'), range: [-3.9212, 3.5770]
2025-04-13 12:51:02,692 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:02,692 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1612, 4.0265]
2025-04-13 12:51:02,692 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9593, 3.2559]
2025-04-13 12:51:02,692 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,693 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,693 - INFO -   True actions shape: tensor([-0.1191,  1.3276,  0.6776, -2.0274, -0.5424,  1.1765, -1.6188],
       device='cuda:0'), range: [-4.1612, 4.0265]
2025-04-13 12:51:02,694 - INFO -   Noise shape: tensor([ 0.5422, -0.4496,  1.0932,  1.3641,  0.9042,  1.3384, -1.6904],
       device='cuda:0'), range: [-3.9735, 3.5183]
2025-04-13 12:51:02,694 - INFO -   Noisy actions shape: tensor([ 0.1997,  0.8594,  1.1682, -0.9387,  0.0463,  1.7196, -2.2827],
       device='cuda:0'), range: [-4.2798, 3.5598]
2025-04-13 12:51:02,736 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:02,736 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2355, 3.2138]
2025-04-13 12:51:02,736 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8887, 2.8510]
2025-04-13 12:51:02,736 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,736 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,737 - INFO -   True actions shape: tensor([-0.4914, -0.8509, -0.4613, -1.0868, -0.3787, -0.0044, -0.5932],
       device='cuda:0'), range: [-3.2355, 3.2138]
2025-04-13 12:51:02,737 - INFO -   Noise shape: tensor([ 0.5730, -1.5496,  0.3422,  0.1069, -1.1398,  1.9317, -0.5377],
       device='cuda:0'), range: [-3.5997, 3.1369]
2025-04-13 12:51:02,738 - INFO -   Noisy actions shape: tensor([-0.0105, -1.6458, -0.1352, -0.7663, -1.0207,  1.2335, -0.8000],
       device='cuda:0'), range: [-3.8808, 3.4105]
2025-04-13 12:51:02,780 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:02,780 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2418, 3.5089]
2025-04-13 12:51:02,780 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8594, 2.9258]
2025-04-13 12:51:02,780 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,780 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,781 - INFO -   True actions shape: tensor([-3.1299,  2.5638, -0.8367,  1.5526, -0.4163, -0.6553,  0.8002],
       device='cuda:0'), range: [-3.2418, 3.5089]
2025-04-13 12:51:02,782 - INFO -   Noise shape: tensor([-0.4343, -0.2943, -0.0388, -1.1025,  0.2742, -1.2982, -1.9365],
       device='cuda:0'), range: [-3.6454, 3.6275]
2025-04-13 12:51:02,782 - INFO -   Noisy actions shape: tensor([-1.6749,  0.7786, -0.3771, -0.3722,  0.0802, -1.4527, -1.4407],
       device='cuda:0'), range: [-3.1930, 3.6177]
2025-04-13 12:51:02,825 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:02,825 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4184, 4.0048]
2025-04-13 12:51:02,825 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3026, 2.7724]
2025-04-13 12:51:02,826 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,826 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,826 - INFO -   True actions shape: tensor([ 0.3045, -1.0916,  1.2268,  0.4110, -0.5270,  1.1959, -1.4445],
       device='cuda:0'), range: [-3.4184, 4.0048]
2025-04-13 12:51:02,827 - INFO -   Noise shape: tensor([-0.5690,  0.1776,  0.4108,  1.5982, -0.1230, -0.0755,  1.3606],
       device='cuda:0'), range: [-3.4096, 3.1824]
2025-04-13 12:51:02,827 - INFO -   Noisy actions shape: tensor([-5.4844e-01,  1.0749e-01,  4.8830e-01,  1.6212e+00, -1.5637e-01,
         1.0375e-03,  1.2656e+00], device='cuda:0'), range: [-3.4352, 3.9275]
2025-04-13 12:51:02,870 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:02,870 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6665, 3.3854]
2025-04-13 12:51:02,870 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2392, 3.5084]
2025-04-13 12:51:02,870 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,870 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,871 - INFO -   True actions shape: tensor([ 3.3083, -3.2875, -0.2647, -0.3261,  0.3710,  1.0853,  1.1032],
       device='cuda:0'), range: [-3.6665, 3.3854]
2025-04-13 12:51:02,871 - INFO -   Noise shape: tensor([-0.4822,  1.9493,  0.9477, -0.5228, -1.1295,  0.5435,  0.5677],
       device='cuda:0'), range: [-3.9131, 3.4416]
2025-04-13 12:51:02,872 - INFO -   Noisy actions shape: tensor([ 1.0556,  0.2644,  0.7277, -0.6135, -0.8424,  0.9731,  1.0029],
       device='cuda:0'), range: [-3.3618, 3.2730]
2025-04-13 12:51:02,911 - INFO -   Loss components:
2025-04-13 12:51:02,911 - INFO -     Diffusion loss: 1.203223 (coef: 1.0)
2025-04-13 12:51:02,911 - INFO -     Grasp quality loss: 0.697723 (coef: 0.5)
2025-04-13 12:51:02,911 - INFO -     Grasp rotation loss: 0.573488 (coef: 0.5)
2025-04-13 12:51:02,911 - INFO -     Grasp width loss: 11.176140 (coef: 0.005)
2025-04-13 12:51:02,911 - INFO -     TOTAL loss: 1.894709
2025-04-13 12:51:02,919 - INFO -   Gradients: avg norm: 0.295068, max norm: 2.195315, non-zero params: 250
2025-04-13 12:51:02,919 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-13 12:51:02,922 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:02,922 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5609, 3.6584]
2025-04-13 12:51:02,922 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8064, 2.9179]
2025-04-13 12:51:02,922 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,922 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,923 - INFO -   True actions shape: tensor([-0.3709, -0.6816,  0.0160, -1.1067,  1.0665,  0.3438, -0.2043],
       device='cuda:0'), range: [-3.5609, 3.6584]
2025-04-13 12:51:02,924 - INFO -   Noise shape: tensor([-0.0969,  2.0443, -1.5369, -0.3567,  0.6252, -1.1516, -0.1353],
       device='cuda:0'), range: [-3.5429, 3.8538]
2025-04-13 12:51:02,924 - INFO -   Noisy actions shape: tensor([-0.3831, -0.0661, -0.4258, -1.1625,  1.2010, -0.0012, -0.2346],
       device='cuda:0'), range: [-2.9625, 3.7072]
2025-04-13 12:51:02,967 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:02,967 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7702, 3.3972]
2025-04-13 12:51:02,967 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4210, 3.0938]
2025-04-13 12:51:02,967 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:02,967 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:02,968 - INFO -   True actions shape: tensor([ 0.9717, -0.2926,  1.5078,  1.6813, -0.9431, -0.0990, -0.3813],
       device='cuda:0'), range: [-3.7702, 3.3972]
2025-04-13 12:51:02,969 - INFO -   Noise shape: tensor([-1.9025, -1.9037, -1.2250,  1.2708, -1.1876,  0.2068, -0.5223],
       device='cuda:0'), range: [-3.4748, 3.1738]
2025-04-13 12:51:02,969 - INFO -   Noisy actions shape: tensor([-1.7306, -1.9260, -0.9788,  1.5141, -1.3185,  0.1891, -0.5747],
       device='cuda:0'), range: [-3.5915, 3.3477]
2025-04-13 12:51:03,009 - INFO - 
=== Epoch 16 Summary ===
2025-04-13 12:51:03,009 - INFO -   Avg total loss: 2.094676
2025-04-13 12:51:03,009 - INFO -   Avg diffusion loss: 1.401621
2025-04-13 12:51:03,009 - INFO -   Avg grasp loss: 1.386110
2025-04-13 12:51:03,009 - INFO - 
=== EPOCH 17/20 ===
2025-04-13 12:51:03,010 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:03,013 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:03,013 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7780, 3.1940]
2025-04-13 12:51:03,013 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6963, 3.2244]
2025-04-13 12:51:03,013 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,013 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,014 - INFO -   True actions shape: tensor([-0.0988, -0.9196, -0.0215,  1.5434,  0.1847, -0.1169, -0.7892],
       device='cuda:0'), range: [-3.7780, 3.1940]
2025-04-13 12:51:03,014 - INFO -   Noise shape: tensor([ 0.7573, -0.3225, -1.3263,  1.5314,  1.3560,  0.4049,  1.4736],
       device='cuda:0'), range: [-3.1881, 3.7379]
2025-04-13 12:51:03,015 - INFO -   Noisy actions shape: tensor([ 0.6021, -0.7450, -1.1533,  2.1032,  1.2617,  0.2893,  0.8681],
       device='cuda:0'), range: [-3.1372, 3.7445]
2025-04-13 12:51:03,015 - INFO -   Diffusion: timestep range [8, 966], noise range [-3.1881, 3.7379]
2025-04-13 12:51:03,015 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.1372, 3.7445]
2025-04-13 12:51:03,034 - INFO -   Model output shapes:
2025-04-13 12:51:03,034 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:03,034 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4341, 0.5608]
2025-04-13 12:51:03,034 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3794
2025-04-13 12:51:03,034 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1408, 0.3289]
2025-04-13 12:51:03,054 - INFO -   Loss components:
2025-04-13 12:51:03,055 - INFO -     Diffusion loss: 1.687075 (coef: 1.0)
2025-04-13 12:51:03,055 - INFO -     Grasp quality loss: 0.694206 (coef: 0.5)
2025-04-13 12:51:03,055 - INFO -     Grasp rotation loss: 0.599191 (coef: 0.5)
2025-04-13 12:51:03,055 - INFO -     Grasp width loss: 11.863916 (coef: 0.005)
2025-04-13 12:51:03,055 - INFO -     TOTAL loss: 2.393093
2025-04-13 12:51:03,062 - INFO -   Gradients: avg norm: 0.405209, max norm: 3.076515, non-zero params: 250
2025-04-13 12:51:03,062 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:51:03,062 - INFO - --- Gradient Check @ Epoch 17, Batch 0 ---
2025-04-13 12:51:03,079 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:03,079 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:03,079 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.0684e-01, MaxNorm=2.4932e+00
2025-04-13 12:51:03,079 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=8.5403e-03, MaxNorm=1.6684e-02
2025-04-13 12:51:03,079 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.0339e-02, MaxNorm=4.1658e-02
2025-04-13 12:51:03,079 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.9548e-01, MaxNorm=7.2179e-01
2025-04-13 12:51:03,079 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3156e+00, MaxNorm=2.4510e+00
2025-04-13 12:51:03,079 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1412e+00, MaxNorm=2.0789e+00
2025-04-13 12:51:03,079 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=8.4039e-02, MaxNorm=3.8402e-01
2025-04-13 12:51:03,079 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=6.4992e-01, MaxNorm=6.5578e-01
2025-04-13 12:51:03,079 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.8002e-01, MaxNorm=9.0203e-01
2025-04-13 12:51:03,080 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6944e+00, MaxNorm=3.0765e+00
2025-04-13 12:51:03,080 - INFO - --- End Gradient Check ---
2025-04-13 12:51:03,082 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:03,082 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7535, 3.2855]
2025-04-13 12:51:03,082 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8629, 3.3495]
2025-04-13 12:51:03,082 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,082 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,083 - INFO -   True actions shape: tensor([-0.4926, -0.8492,  0.2745,  1.1252, -1.0802,  0.0921,  0.2821],
       device='cuda:0'), range: [-3.7535, 3.2855]
2025-04-13 12:51:03,084 - INFO -   Noise shape: tensor([-1.5910,  1.9339, -1.0334, -1.7398,  0.5143,  1.3602, -0.4136],
       device='cuda:0'), range: [-3.4394, 3.1688]
2025-04-13 12:51:03,084 - INFO -   Noisy actions shape: tensor([-1.0456, -0.0746, -0.1268,  0.4027, -0.8137,  0.5882,  0.1093],
       device='cuda:0'), range: [-3.6732, 3.3732]
2025-04-13 12:51:03,126 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:03,126 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9519, 3.1495]
2025-04-13 12:51:03,126 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0392, 2.7824]
2025-04-13 12:51:03,126 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,126 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,127 - INFO -   True actions shape: tensor([ 0.5516, -1.4112,  1.0281,  1.0401, -0.3094,  0.8570, -0.5379],
       device='cuda:0'), range: [-3.9519, 3.1495]
2025-04-13 12:51:03,127 - INFO -   Noise shape: tensor([ 1.4268,  0.2025, -0.1438,  0.8747,  0.6037,  0.7539, -0.0761],
       device='cuda:0'), range: [-3.4945, 3.6255]
2025-04-13 12:51:03,128 - INFO -   Noisy actions shape: tensor([ 1.0571, -1.2253,  0.8941,  1.2963, -0.0539,  1.0807, -0.5259],
       device='cuda:0'), range: [-3.5299, 3.8466]
2025-04-13 12:51:03,169 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:03,169 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2850, 3.4506]
2025-04-13 12:51:03,169 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2939, 3.3004]
2025-04-13 12:51:03,170 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,170 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,170 - INFO -   True actions shape: tensor([ 0.4092, -0.4420,  0.2543, -0.2566, -0.8937, -0.8157, -1.7260],
       device='cuda:0'), range: [-3.2850, 3.4506]
2025-04-13 12:51:03,171 - INFO -   Noise shape: tensor([ 1.0151, -1.7549,  1.9612,  0.2556, -0.3490, -1.8321,  0.8713],
       device='cuda:0'), range: [-3.4025, 3.3098]
2025-04-13 12:51:03,171 - INFO -   Noisy actions shape: tensor([ 1.0117, -1.5634,  1.5795,  0.0032, -0.8745, -1.8799, -0.5845],
       device='cuda:0'), range: [-3.3366, 3.3906]
2025-04-13 12:51:03,213 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:03,213 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0574, 3.5655]
2025-04-13 12:51:03,213 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3256, 3.6643]
2025-04-13 12:51:03,213 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,213 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,214 - INFO -   True actions shape: tensor([-0.0211,  0.3042,  0.2359, -0.9994, -0.2583,  1.3434,  0.8810],
       device='cuda:0'), range: [-4.0574, 3.5655]
2025-04-13 12:51:03,215 - INFO -   Noise shape: tensor([-0.0178, -1.0360,  1.0216,  2.0996, -2.0422, -0.3196,  0.0971],
       device='cuda:0'), range: [-3.8625, 3.4186]
2025-04-13 12:51:03,215 - INFO -   Noisy actions shape: tensor([-0.0214, -0.9614,  1.0476,  1.8772, -2.0546, -0.0642,  0.2592],
       device='cuda:0'), range: [-3.7699, 4.0164]
2025-04-13 12:51:03,257 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:03,257 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5574, 3.2616]
2025-04-13 12:51:03,257 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6010, 2.8559]
2025-04-13 12:51:03,257 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,257 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,258 - INFO -   True actions shape: tensor([-1.6941, -0.2419, -0.3331, -1.5326, -0.9881, -2.2291, -0.0265],
       device='cuda:0'), range: [-3.5574, 3.2616]
2025-04-13 12:51:03,258 - INFO -   Noise shape: tensor([ 1.1219, -0.2636, -0.2455,  0.9122, -0.5637,  0.1756, -0.0201],
       device='cuda:0'), range: [-2.9396, 3.7037]
2025-04-13 12:51:03,259 - INFO -   Noisy actions shape: tensor([ 0.1213, -0.3493, -0.3795,  0.0209, -0.9831, -0.9658, -0.0307],
       device='cuda:0'), range: [-3.0908, 3.3460]
2025-04-13 12:51:03,300 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:03,300 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4623, 3.9608]
2025-04-13 12:51:03,301 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2206, 3.0252]
2025-04-13 12:51:03,301 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,301 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,301 - INFO -   True actions shape: tensor([-1.8001, -0.0336,  0.0389,  1.1694,  0.2804, -0.0313,  1.2265],
       device='cuda:0'), range: [-3.4623, 3.9608]
2025-04-13 12:51:03,302 - INFO -   Noise shape: tensor([-0.6080, -2.0359, -0.2270,  0.6991,  1.7682, -0.5191,  3.7204],
       device='cuda:0'), range: [-4.0015, 3.7204]
2025-04-13 12:51:03,303 - INFO -   Noisy actions shape: tensor([-1.6673, -1.5194, -0.1405,  1.3066,  1.4899, -0.4028,  3.5664],
       device='cuda:0'), range: [-3.7613, 3.5664]
2025-04-13 12:51:03,344 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:03,344 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3822, 3.2033]
2025-04-13 12:51:03,344 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9979, 3.0777]
2025-04-13 12:51:03,344 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,344 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,345 - INFO -   True actions shape: tensor([-1.4743,  1.9931, -2.1117,  0.6668, -0.9727,  1.6818,  0.4809],
       device='cuda:0'), range: [-3.3822, 3.2033]
2025-04-13 12:51:03,346 - INFO -   Noise shape: tensor([ 0.9141, -0.1475,  0.2318, -0.2302, -2.2108, -0.0782,  1.7601],
       device='cuda:0'), range: [-4.0424, 3.3481]
2025-04-13 12:51:03,346 - INFO -   Noisy actions shape: tensor([ 0.4728,  0.4070, -0.3586, -0.0377, -2.3932,  0.3879,  1.8245],
       device='cuda:0'), range: [-4.0921, 3.3789]
2025-04-13 12:51:03,388 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:03,388 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4288, 3.7078]
2025-04-13 12:51:03,388 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9609, 3.3304]
2025-04-13 12:51:03,388 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,388 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,389 - INFO -   True actions shape: tensor([ 0.3365,  2.6768, -0.5933,  0.4776,  0.6592,  1.1386, -0.2203],
       device='cuda:0'), range: [-3.4288, 3.7078]
2025-04-13 12:51:03,389 - INFO -   Noise shape: tensor([ 0.6836,  0.7649,  0.4111, -0.2107,  0.1094, -0.7302, -0.1051],
       device='cuda:0'), range: [-2.9810, 3.8943]
2025-04-13 12:51:03,390 - INFO -   Noisy actions shape: tensor([ 0.7033,  0.9302,  0.3733, -0.1806,  0.1502, -0.6579, -0.1187],
       device='cuda:0'), range: [-3.0949, 3.5748]
2025-04-13 12:51:03,431 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:03,431 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2094, 4.1875]
2025-04-13 12:51:03,432 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5171, 2.7917]
2025-04-13 12:51:03,432 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,432 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,432 - INFO -   True actions shape: tensor([-0.9377, -0.3080, -2.6937, -0.8494,  0.2534,  0.7714,  0.5248],
       device='cuda:0'), range: [-3.2094, 4.1875]
2025-04-13 12:51:03,433 - INFO -   Noise shape: tensor([ 1.3756,  0.3858,  0.4222, -0.1445,  0.6824, -0.5482,  0.9003],
       device='cuda:0'), range: [-3.7519, 3.5837]
2025-04-13 12:51:03,434 - INFO -   Noisy actions shape: tensor([ 0.5841,  0.1378, -1.2069, -0.6075,  0.7037, -0.0036,  1.0382],
       device='cuda:0'), range: [-3.2419, 4.4367]
2025-04-13 12:51:03,475 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:03,475 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6372, 3.8585]
2025-04-13 12:51:03,475 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0342, 3.1311]
2025-04-13 12:51:03,475 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,475 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,476 - INFO -   True actions shape: tensor([ 0.8336, -0.7662, -0.1936,  0.3368,  2.1021,  0.4379,  0.4350],
       device='cuda:0'), range: [-3.6372, 3.8585]
2025-04-13 12:51:03,477 - INFO -   Noise shape: tensor([-1.5149, -0.3630, -0.8622, -0.0826, -0.6216,  0.9871, -0.4705],
       device='cuda:0'), range: [-3.3659, 3.0618]
2025-04-13 12:51:03,477 - INFO -   Noisy actions shape: tensor([-1.5110, -0.3666, -0.8631, -0.0810, -0.6118,  0.9891, -0.4684],
       device='cuda:0'), range: [-3.5445, 3.0659]
2025-04-13 12:51:03,517 - INFO -   Loss components:
2025-04-13 12:51:03,517 - INFO -     Diffusion loss: 1.353743 (coef: 1.0)
2025-04-13 12:51:03,517 - INFO -     Grasp quality loss: 0.692467 (coef: 0.5)
2025-04-13 12:51:03,517 - INFO -     Grasp rotation loss: 0.569297 (coef: 0.5)
2025-04-13 12:51:03,517 - INFO -     Grasp width loss: 11.372148 (coef: 0.005)
2025-04-13 12:51:03,517 - INFO -     TOTAL loss: 2.041486
2025-04-13 12:51:03,524 - INFO -   Gradients: avg norm: 0.311814, max norm: 2.413876, non-zero params: 250
2025-04-13 12:51:03,525 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-13 12:51:03,527 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:03,527 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9686, 3.5845]
2025-04-13 12:51:03,527 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7971, 3.1695]
2025-04-13 12:51:03,528 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,528 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,528 - INFO -   True actions shape: tensor([-0.9567, -1.3544, -0.2786, -0.9328, -0.1425,  0.8412, -0.1422],
       device='cuda:0'), range: [-2.9686, 3.5845]
2025-04-13 12:51:03,529 - INFO -   Noise shape: tensor([ 0.9088,  0.1140,  2.0323, -0.5490, -0.1102,  0.2867, -1.1570],
       device='cuda:0'), range: [-3.9904, 3.4681]
2025-04-13 12:51:03,529 - INFO -   Noisy actions shape: tensor([-0.7343, -1.2965,  0.1736, -1.0305, -0.1632,  0.8836, -0.3923],
       device='cuda:0'), range: [-3.1087, 3.7997]
2025-04-13 12:51:03,575 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:03,576 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2307, 4.6137]
2025-04-13 12:51:03,576 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9333, 3.7155]
2025-04-13 12:51:03,576 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,576 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,577 - INFO -   True actions shape: tensor([ 2.5440, -0.2239, -0.1927,  0.6470,  1.3892,  0.2376, -0.7035],
       device='cuda:0'), range: [-3.2307, 4.6137]
2025-04-13 12:51:03,577 - INFO -   Noise shape: tensor([-0.9273,  0.0976,  0.4120,  0.3944,  0.9029, -0.0191,  1.8466],
       device='cuda:0'), range: [-3.5115, 3.0723]
2025-04-13 12:51:03,578 - INFO -   Noisy actions shape: tensor([-0.2288,  0.0356,  0.3472,  0.5501,  1.2352,  0.0438,  1.5980],
       device='cuda:0'), range: [-3.6085, 3.0168]
2025-04-13 12:51:03,619 - INFO - 
=== Epoch 17 Summary ===
2025-04-13 12:51:03,619 - INFO -   Avg total loss: 2.123693
2025-04-13 12:51:03,619 - INFO -   Avg diffusion loss: 1.428823
2025-04-13 12:51:03,619 - INFO -   Avg grasp loss: 1.389740
2025-04-13 12:51:03,619 - INFO - 
=== EPOCH 18/20 ===
2025-04-13 12:51:03,620 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:03,623 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:03,623 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1065, 3.5617]
2025-04-13 12:51:03,623 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8659, 3.6388]
2025-04-13 12:51:03,623 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,623 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,624 - INFO -   True actions shape: tensor([-0.0493, -0.2181,  1.2030, -0.0557, -1.0312, -0.4230,  1.0989],
       device='cuda:0'), range: [-4.1065, 3.5617]
2025-04-13 12:51:03,625 - INFO -   Noise shape: tensor([ 0.3303, -1.0528,  0.4374,  0.8894,  0.6637,  0.4464,  0.6963],
       device='cuda:0'), range: [-3.4736, 3.6407]
2025-04-13 12:51:03,625 - INFO -   Noisy actions shape: tensor([ 0.2672, -1.0299,  0.9568,  0.7559,  0.0934,  0.1916,  1.1351],
       device='cuda:0'), range: [-3.5145, 3.2785]
2025-04-13 12:51:03,626 - INFO -   Diffusion: timestep range [122, 963], noise range [-3.4736, 3.6407]
2025-04-13 12:51:03,626 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5145, 3.2785]
2025-04-13 12:51:03,644 - INFO -   Model output shapes:
2025-04-13 12:51:03,645 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:03,645 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4329, 0.5787]
2025-04-13 12:51:03,645 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.4575
2025-04-13 12:51:03,645 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1643, 0.2456]
2025-04-13 12:51:03,666 - INFO -   Loss components:
2025-04-13 12:51:03,666 - INFO -     Diffusion loss: 1.045031 (coef: 1.0)
2025-04-13 12:51:03,666 - INFO -     Grasp quality loss: 0.694611 (coef: 0.5)
2025-04-13 12:51:03,667 - INFO -     Grasp rotation loss: 0.597172 (coef: 0.5)
2025-04-13 12:51:03,667 - INFO -     Grasp width loss: 10.867197 (coef: 0.005)
2025-04-13 12:51:03,667 - INFO -     TOTAL loss: 1.745259
2025-04-13 12:51:03,674 - INFO -   Gradients: avg norm: 0.265609, max norm: 2.000401, non-zero params: 250
2025-04-13 12:51:03,674 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-13 12:51:03,674 - INFO - --- Gradient Check @ Epoch 18, Batch 0 ---
2025-04-13 12:51:03,691 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:03,691 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:03,691 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.0655e-01, MaxNorm=1.6094e+00
2025-04-13 12:51:03,692 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=7.7956e-03, MaxNorm=1.7065e-02
2025-04-13 12:51:03,692 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=7.3557e-03, MaxNorm=1.8900e-02
2025-04-13 12:51:03,692 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.5418e-01, MaxNorm=3.7473e-01
2025-04-13 12:51:03,692 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=9.2381e-01, MaxNorm=1.7079e+00
2025-04-13 12:51:03,692 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=7.9086e-01, MaxNorm=1.4689e+00
2025-04-13 12:51:03,692 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.4665e-02, MaxNorm=2.4480e-01
2025-04-13 12:51:03,692 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.1833e-01, MaxNorm=4.3557e-01
2025-04-13 12:51:03,692 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.9249e-01, MaxNorm=6.1832e-01
2025-04-13 12:51:03,692 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1067e+00, MaxNorm=2.0004e+00
2025-04-13 12:51:03,692 - INFO - --- End Gradient Check ---
2025-04-13 12:51:03,694 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:03,694 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3018, 3.4247]
2025-04-13 12:51:03,695 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3193, 3.2830]
2025-04-13 12:51:03,695 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,695 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,696 - INFO -   True actions shape: tensor([ 0.6231,  0.3123, -1.0631, -0.3535, -1.6115, -0.8618,  1.2455],
       device='cuda:0'), range: [-3.3018, 3.4247]
2025-04-13 12:51:03,696 - INFO -   Noise shape: tensor([-0.0381,  1.9176,  1.1365,  0.7885,  0.1719, -2.4778,  2.0339],
       device='cuda:0'), range: [-3.8670, 3.7307]
2025-04-13 12:51:03,697 - INFO -   Noisy actions shape: tensor([ 0.5662,  0.9910, -0.5747, -0.0412, -1.4375, -1.7071,  1.9021],
       device='cuda:0'), range: [-4.0586, 3.4008]
2025-04-13 12:51:03,739 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:03,739 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3970, 4.1891]
2025-04-13 12:51:03,739 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1740, 2.7228]
2025-04-13 12:51:03,739 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,739 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,740 - INFO -   True actions shape: tensor([-0.8557,  0.0315,  1.2287,  0.6594, -0.1016, -0.3499,  0.2514],
       device='cuda:0'), range: [-3.3970, 4.1891]
2025-04-13 12:51:03,741 - INFO -   Noise shape: tensor([-0.7328,  0.5832, -2.4562,  0.0972, -0.2926,  2.1431,  0.1525],
       device='cuda:0'), range: [-3.4706, 3.2873]
2025-04-13 12:51:03,741 - INFO -   Noisy actions shape: tensor([-0.9581,  0.5652, -1.9670,  0.2928, -0.3097,  1.9356,  0.2216],
       device='cuda:0'), range: [-3.1328, 3.6965]
2025-04-13 12:51:03,785 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:03,785 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3163, 4.0717]
2025-04-13 12:51:03,785 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0823, 2.8629]
2025-04-13 12:51:03,785 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,785 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,786 - INFO -   True actions shape: tensor([ 1.4170,  0.2749,  0.1311,  0.1097, -0.3104, -0.9796, -1.6185],
       device='cuda:0'), range: [-3.3163, 4.0717]
2025-04-13 12:51:03,787 - INFO -   Noise shape: tensor([ 2.6382,  0.3759, -0.0131,  0.6812,  0.2983, -0.0509, -0.7530],
       device='cuda:0'), range: [-3.0086, 4.4729]
2025-04-13 12:51:03,787 - INFO -   Noisy actions shape: tensor([ 2.9941,  0.4624,  0.0529,  0.6474,  0.1076, -0.5249, -1.4501],
       device='cuda:0'), range: [-3.0582, 4.2814]
2025-04-13 12:51:03,830 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:03,830 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4614, 3.4374]
2025-04-13 12:51:03,830 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8976, 3.5559]
2025-04-13 12:51:03,830 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,830 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,831 - INFO -   True actions shape: tensor([-0.2653, -0.5723,  0.3182, -0.3667, -0.5978,  0.6334, -0.1393],
       device='cuda:0'), range: [-3.4614, 3.4374]
2025-04-13 12:51:03,832 - INFO -   Noise shape: tensor([-0.4215,  0.2645, -1.3529, -0.4254, -0.8812,  0.0053, -2.5094],
       device='cuda:0'), range: [-3.7385, 3.1522]
2025-04-13 12:51:03,832 - INFO -   Noisy actions shape: tensor([-0.4871, -0.2094, -0.7480, -0.5606, -1.0485,  0.4454, -1.8961],
       device='cuda:0'), range: [-3.8559, 3.1416]
2025-04-13 12:51:03,875 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:03,875 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3087, 3.5220]
2025-04-13 12:51:03,876 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7932, 3.2099]
2025-04-13 12:51:03,876 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,876 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,876 - INFO -   True actions shape: tensor([ 0.2403,  0.5432,  0.4225,  0.5561,  0.5097, -0.2889, -0.9442],
       device='cuda:0'), range: [-3.3087, 3.5220]
2025-04-13 12:51:03,877 - INFO -   Noise shape: tensor([-0.0267, -0.3252, -0.0564, -0.4251,  1.8303,  1.7208, -0.0288],
       device='cuda:0'), range: [-3.6245, 2.9880]
2025-04-13 12:51:03,878 - INFO -   Noisy actions shape: tensor([-0.0173, -0.3038, -0.0399, -0.4031,  1.8487,  1.7083, -0.0656],
       device='cuda:0'), range: [-3.5765, 3.4875]
2025-04-13 12:51:03,919 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:03,919 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8154, 3.3793]
2025-04-13 12:51:03,919 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2504, 3.0998]
2025-04-13 12:51:03,920 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,920 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,920 - INFO -   True actions shape: tensor([-0.8582, -0.3816, -0.4341, -1.1977, -0.7903,  0.1899,  1.7301],
       device='cuda:0'), range: [-3.8154, 3.3793]
2025-04-13 12:51:03,921 - INFO -   Noise shape: tensor([ 1.2892,  1.5939, -1.0479, -1.2795,  0.6096, -0.0893,  0.3939],
       device='cuda:0'), range: [-3.6593, 3.7999]
2025-04-13 12:51:03,921 - INFO -   Noisy actions shape: tensor([ 0.7703,  1.2558, -1.1315, -1.6797,  0.1926,  0.0049,  1.1250],
       device='cuda:0'), range: [-3.2730, 3.7591]
2025-04-13 12:51:03,963 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:03,963 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3415, 3.5380]
2025-04-13 12:51:03,963 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0535, 2.8619]
2025-04-13 12:51:03,963 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:03,963 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:03,964 - INFO -   True actions shape: tensor([ 0.4430, -0.5017, -0.1753, -0.6172, -0.6840, -0.7919,  1.6344],
       device='cuda:0'), range: [-3.3415, 3.5380]
2025-04-13 12:51:03,965 - INFO -   Noise shape: tensor([-0.8183, -1.1664,  0.4392,  0.3262,  1.2538,  0.5501, -0.0100],
       device='cuda:0'), range: [-3.2156, 3.2718]
2025-04-13 12:51:03,965 - INFO -   Noisy actions shape: tensor([-0.4227, -1.2452,  0.2623, -0.0814,  0.6446,  0.0039,  0.9188],
       device='cuda:0'), range: [-3.5048, 3.7136]
2025-04-13 12:51:04,007 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:04,007 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3317, 3.4108]
2025-04-13 12:51:04,007 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1141, 3.2404]
2025-04-13 12:51:04,007 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,007 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,008 - INFO -   True actions shape: tensor([-1.7870,  0.9370,  0.9781,  0.5572,  0.4373,  1.3450, -2.1909],
       device='cuda:0'), range: [-4.3317, 3.4108]
2025-04-13 12:51:04,008 - INFO -   Noise shape: tensor([-0.3462, -0.8971,  1.4717, -1.6335,  0.2374,  1.7119, -0.5330],
       device='cuda:0'), range: [-3.9821, 3.2190]
2025-04-13 12:51:04,009 - INFO -   Noisy actions shape: tensor([-1.8202,  0.7543,  1.2341,  0.2445,  0.4737,  1.6392, -2.2518],
       device='cuda:0'), range: [-4.2255, 3.6286]
2025-04-13 12:51:04,050 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:04,050 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5238, 3.7644]
2025-04-13 12:51:04,051 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9853, 3.1604]
2025-04-13 12:51:04,051 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,051 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,051 - INFO -   True actions shape: tensor([-0.2147,  0.3190,  0.5575, -0.1803, -0.3414,  0.5052,  0.9966],
       device='cuda:0'), range: [-3.5238, 3.7644]
2025-04-13 12:51:04,052 - INFO -   Noise shape: tensor([-0.1525, -1.3722, -0.7487,  1.8206,  0.8778,  1.3584, -2.1230],
       device='cuda:0'), range: [-3.6188, 3.4397]
2025-04-13 12:51:04,053 - INFO -   Noisy actions shape: tensor([-0.2624, -0.6454, -0.0598,  1.0414,  0.3082,  1.2646, -0.6151],
       device='cuda:0'), range: [-3.5692, 3.7504]
2025-04-13 12:51:04,094 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:04,094 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7713, 3.7484]
2025-04-13 12:51:04,094 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3742, 3.5602]
2025-04-13 12:51:04,094 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,094 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,095 - INFO -   True actions shape: tensor([-0.3943,  1.2205,  0.3561, -0.3017, -0.9872,  0.3033, -0.7961],
       device='cuda:0'), range: [-3.7713, 3.7484]
2025-04-13 12:51:04,096 - INFO -   Noise shape: tensor([-1.5180,  1.5188,  0.8884,  0.5381,  2.1270, -0.0851,  0.6554],
       device='cuda:0'), range: [-3.5911, 4.3715]
2025-04-13 12:51:04,096 - INFO -   Noisy actions shape: tensor([-1.5636,  1.7092,  0.9370,  0.4769,  1.9211, -0.0306,  0.5058],
       device='cuda:0'), range: [-3.2682, 4.0639]
2025-04-13 12:51:04,135 - INFO -   Loss components:
2025-04-13 12:51:04,135 - INFO -     Diffusion loss: 1.255614 (coef: 1.0)
2025-04-13 12:51:04,135 - INFO -     Grasp quality loss: 0.695310 (coef: 0.5)
2025-04-13 12:51:04,135 - INFO -     Grasp rotation loss: 0.557854 (coef: 0.5)
2025-04-13 12:51:04,136 - INFO -     Grasp width loss: 10.716295 (coef: 0.005)
2025-04-13 12:51:04,136 - INFO -     TOTAL loss: 1.935777
2025-04-13 12:51:04,143 - INFO -   Gradients: avg norm: 0.301010, max norm: 2.441167, non-zero params: 250
2025-04-13 12:51:04,143 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-13 12:51:04,146 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:04,146 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6103, 3.6241]
2025-04-13 12:51:04,146 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8302, 2.9422]
2025-04-13 12:51:04,146 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,146 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,147 - INFO -   True actions shape: tensor([-1.1330, -1.7664,  0.8900,  0.2599, -1.1782,  0.1637,  0.9241],
       device='cuda:0'), range: [-3.6103, 3.6241]
2025-04-13 12:51:04,148 - INFO -   Noise shape: tensor([ 0.4869,  1.4057, -0.3052,  0.8308,  0.5825, -1.7495, -0.3132],
       device='cuda:0'), range: [-3.4662, 3.0931]
2025-04-13 12:51:04,148 - INFO -   Noisy actions shape: tensor([-0.8112, -0.9850,  0.6705,  0.5935, -0.8106, -0.6088,  0.6979],
       device='cuda:0'), range: [-3.4013, 3.2855]
2025-04-13 12:51:04,191 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:04,191 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9910, 3.7626]
2025-04-13 12:51:04,191 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1140, 3.3501]
2025-04-13 12:51:04,191 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,191 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,192 - INFO -   True actions shape: tensor([-0.4625,  0.4243,  0.6535,  1.2659,  0.4653, -0.1587, -0.3130],
       device='cuda:0'), range: [-2.9910, 3.7626]
2025-04-13 12:51:04,193 - INFO -   Noise shape: tensor([-1.9462, -0.3992,  1.6051,  0.0253, -0.0300,  0.3293, -0.0489],
       device='cuda:0'), range: [-3.8511, 3.6267]
2025-04-13 12:51:04,193 - INFO -   Noisy actions shape: tensor([-1.9909, -0.3381,  1.6787,  0.1962,  0.0332,  0.3048, -0.0908],
       device='cuda:0'), range: [-4.1449, 3.2009]
2025-04-13 12:51:04,233 - INFO - 
=== Epoch 18 Summary ===
2025-04-13 12:51:04,233 - INFO -   Avg total loss: 1.967698
2025-04-13 12:51:04,233 - INFO -   Avg diffusion loss: 1.282019
2025-04-13 12:51:04,233 - INFO -   Avg grasp loss: 1.371358
2025-04-13 12:51:04,233 - INFO - 
=== EPOCH 19/20 ===
2025-04-13 12:51:04,234 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:04,237 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:04,237 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3498, 4.2578]
2025-04-13 12:51:04,237 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5356, 2.9863]
2025-04-13 12:51:04,237 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,237 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,238 - INFO -   True actions shape: tensor([-0.8110, -0.3645,  0.1016,  1.1838, -0.2196,  0.6080, -0.1856],
       device='cuda:0'), range: [-3.3498, 4.2578]
2025-04-13 12:51:04,238 - INFO -   Noise shape: tensor([-0.1084, -0.4933,  1.4782, -0.0553,  1.1993,  0.4010,  0.1675],
       device='cuda:0'), range: [-3.0253, 3.3666]
2025-04-13 12:51:04,239 - INFO -   Noisy actions shape: tensor([-0.8018, -0.5058,  0.5796,  1.1006,  0.1848,  0.7057, -0.1205],
       device='cuda:0'), range: [-3.4298, 3.8990]
2025-04-13 12:51:04,239 - INFO -   Diffusion: timestep range [133, 958], noise range [-3.0253, 3.3666]
2025-04-13 12:51:04,239 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4298, 3.8990]
2025-04-13 12:51:04,257 - INFO -   Model output shapes:
2025-04-13 12:51:04,258 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:04,258 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4339, 0.5831]
2025-04-13 12:51:04,258 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5004
2025-04-13 12:51:04,258 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2035, 0.3030]
2025-04-13 12:51:04,278 - INFO -   Loss components:
2025-04-13 12:51:04,278 - INFO -     Diffusion loss: 1.328219 (coef: 1.0)
2025-04-13 12:51:04,279 - INFO -     Grasp quality loss: 0.692467 (coef: 0.5)
2025-04-13 12:51:04,279 - INFO -     Grasp rotation loss: 0.582697 (coef: 0.5)
2025-04-13 12:51:04,279 - INFO -     Grasp width loss: 10.080812 (coef: 0.005)
2025-04-13 12:51:04,279 - INFO -     TOTAL loss: 2.016205
2025-04-13 12:51:04,286 - INFO -   Gradients: avg norm: 0.293399, max norm: 2.119069, non-zero params: 250
2025-04-13 12:51:04,286 - INFO -   Optimizer step complete, current LR: 7.596123e-07
2025-04-13 12:51:04,286 - INFO - --- Gradient Check @ Epoch 19, Batch 0 ---
2025-04-13 12:51:04,303 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:04,303 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:04,303 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.2834e-01, MaxNorm=1.6841e+00
2025-04-13 12:51:04,303 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=5.4312e-03, MaxNorm=1.0662e-02
2025-04-13 12:51:04,303 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.1074e-02, MaxNorm=2.3844e-02
2025-04-13 12:51:04,303 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.4847e-01, MaxNorm=7.3409e-01
2025-04-13 12:51:04,303 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=9.9883e-01, MaxNorm=1.9269e+00
2025-04-13 12:51:04,303 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.6517e-01, MaxNorm=1.5401e+00
2025-04-13 12:51:04,303 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.4638e-02, MaxNorm=2.4574e-01
2025-04-13 12:51:04,303 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=6.2862e-01, MaxNorm=6.5255e-01
2025-04-13 12:51:04,303 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.5544e-01, MaxNorm=5.9725e-01
2025-04-13 12:51:04,303 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1755e+00, MaxNorm=2.1191e+00
2025-04-13 12:51:04,303 - INFO - --- End Gradient Check ---
2025-04-13 12:51:04,306 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:04,306 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1770, 3.3697]
2025-04-13 12:51:04,306 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3964, 3.3321]
2025-04-13 12:51:04,306 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,306 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,307 - INFO -   True actions shape: tensor([-1.0295,  0.3074, -0.8565,  1.1897, -0.3946,  0.1936, -0.9635],
       device='cuda:0'), range: [-3.1770, 3.3697]
2025-04-13 12:51:04,308 - INFO -   Noise shape: tensor([-1.1990, -1.1133,  2.4537, -0.7939,  0.8470, -0.1032,  1.2247],
       device='cuda:0'), range: [-3.0364, 3.4677]
2025-04-13 12:51:04,308 - INFO -   Noisy actions shape: tensor([-1.2508,  0.0758, -0.3422,  1.0045, -0.2150,  0.1687, -0.6957],
       device='cuda:0'), range: [-3.6757, 3.6111]
2025-04-13 12:51:04,350 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:04,350 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3983, 3.4959]
2025-04-13 12:51:04,350 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1852, 3.4803]
2025-04-13 12:51:04,350 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,350 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,351 - INFO -   True actions shape: tensor([-0.9339,  1.1365, -1.1040,  1.1130,  1.6652, -0.5057, -0.6623],
       device='cuda:0'), range: [-3.3983, 3.4959]
2025-04-13 12:51:04,351 - INFO -   Noise shape: tensor([-0.3106, -1.4678, -0.4897,  0.4251, -0.2108,  0.1310, -1.3537],
       device='cuda:0'), range: [-3.0363, 3.2103]
2025-04-13 12:51:04,352 - INFO -   Noisy actions shape: tensor([-0.9660,  0.9386, -1.1578,  1.1584,  1.6243, -0.4847, -0.8306],
       device='cuda:0'), range: [-3.2383, 3.6311]
2025-04-13 12:51:04,393 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:04,393 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0857, 3.5202]
2025-04-13 12:51:04,393 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2248, 2.8878]
2025-04-13 12:51:04,394 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,394 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,394 - INFO -   True actions shape: tensor([-1.9001,  1.0999, -0.6896,  0.4339, -1.2074,  1.2367, -0.6585],
       device='cuda:0'), range: [-3.0857, 3.5202]
2025-04-13 12:51:04,395 - INFO -   Noise shape: tensor([ 1.6170, -1.0194,  0.4327, -0.2281, -0.0842,  0.5886,  0.6556],
       device='cuda:0'), range: [-3.5241, 3.3862]
2025-04-13 12:51:04,395 - INFO -   Noisy actions shape: tensor([ 0.8950, -0.5967,  0.1794, -0.0712, -0.4800,  0.9656,  0.4000],
       device='cuda:0'), range: [-3.5028, 3.3933]
2025-04-13 12:51:04,437 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:04,437 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8160, 3.6049]
2025-04-13 12:51:04,437 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9262, 2.7387]
2025-04-13 12:51:04,437 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,437 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,438 - INFO -   True actions shape: tensor([ 0.3327,  0.2653,  0.0408,  1.1044, -1.0370,  0.8346,  0.5732],
       device='cuda:0'), range: [-3.8160, 3.6049]
2025-04-13 12:51:04,439 - INFO -   Noise shape: tensor([ 1.8312, -0.3655,  0.6765, -0.1720,  0.3624, -0.4594, -1.3356],
       device='cuda:0'), range: [-3.1781, 3.4178]
2025-04-13 12:51:04,439 - INFO -   Noisy actions shape: tensor([ 0.5872,  0.2112,  0.1356,  1.0692, -0.9757,  0.7616,  0.3795],
       device='cuda:0'), range: [-3.2525, 3.6611]
2025-04-13 12:51:04,481 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:04,481 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4529, 3.1942]
2025-04-13 12:51:04,481 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2811, 2.8138]
2025-04-13 12:51:04,481 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,481 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,482 - INFO -   True actions shape: tensor([ 0.0880,  1.3815,  1.1384,  2.2810, -1.0283,  0.7467,  1.1480],
       device='cuda:0'), range: [-3.4529, 3.1942]
2025-04-13 12:51:04,482 - INFO -   Noise shape: tensor([ 0.0589, -1.6675,  1.3411,  2.6297,  0.6512,  0.0355,  0.6367],
       device='cuda:0'), range: [-3.5603, 3.8240]
2025-04-13 12:51:04,483 - INFO -   Noisy actions shape: tensor([ 0.1034,  0.6804,  1.5482,  3.0812, -0.7210,  0.7085,  1.3009],
       device='cuda:0'), range: [-3.4559, 3.8848]
2025-04-13 12:51:04,524 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:04,524 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5949, 3.5645]
2025-04-13 12:51:04,524 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2548, 3.0125]
2025-04-13 12:51:04,525 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,525 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,525 - INFO -   True actions shape: tensor([ 0.1391,  0.0830, -0.8740, -0.5754,  0.3335, -0.9811, -0.0481],
       device='cuda:0'), range: [-3.5949, 3.5645]
2025-04-13 12:51:04,526 - INFO -   Noise shape: tensor([ 0.7209, -0.5847,  0.5835, -0.1992, -1.5804, -0.5156,  1.4034],
       device='cuda:0'), range: [-3.2112, 3.6093]
2025-04-13 12:51:04,526 - INFO -   Noisy actions shape: tensor([ 0.7289, -0.5774,  0.5209, -0.2390, -1.5531, -0.5831,  1.3966],
       device='cuda:0'), range: [-3.4290, 3.6159]
2025-04-13 12:51:04,568 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:04,568 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5457, 3.7243]
2025-04-13 12:51:04,568 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9017, 2.9821]
2025-04-13 12:51:04,568 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,568 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,569 - INFO -   True actions shape: tensor([0.1774, 0.1893, 0.6854, 0.3409, 2.0224, 1.4509, 0.6133],
       device='cuda:0'), range: [-3.5457, 3.7243]
2025-04-13 12:51:04,570 - INFO -   Noise shape: tensor([ 0.1920,  0.0416, -1.0956, -0.8512,  1.1628,  0.5084,  0.1795],
       device='cuda:0'), range: [-3.4175, 3.5451]
2025-04-13 12:51:04,570 - INFO -   Noisy actions shape: tensor([ 0.2513,  0.1222, -0.6709, -0.6073,  1.9475,  1.1060,  0.4359],
       device='cuda:0'), range: [-3.3662, 3.2140]
2025-04-13 12:51:04,612 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:04,612 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6497, 3.0853]
2025-04-13 12:51:04,612 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5839, 4.0211]
2025-04-13 12:51:04,612 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,612 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,613 - INFO -   True actions shape: tensor([ 0.0491, -0.6123,  0.6831,  1.1898, -0.2048,  2.8386, -0.4866],
       device='cuda:0'), range: [-3.6497, 3.0853]
2025-04-13 12:51:04,613 - INFO -   Noise shape: tensor([-0.6333,  1.3551, -1.6060,  1.8132, -0.2759,  2.2114, -1.4380],
       device='cuda:0'), range: [-3.5169, 3.2618]
2025-04-13 12:51:04,614 - INFO -   Noisy actions shape: tensor([-0.5589,  0.9902, -1.1909,  2.1400, -0.3352,  3.1727, -1.5118],
       device='cuda:0'), range: [-3.6136, 3.1727]
2025-04-13 12:51:04,655 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:04,655 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2395, 3.5557]
2025-04-13 12:51:04,655 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0128, 3.2787]
2025-04-13 12:51:04,655 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,655 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,656 - INFO -   True actions shape: tensor([-0.3834, -0.0583,  0.4009, -0.4782, -2.0373,  1.3167, -0.3330],
       device='cuda:0'), range: [-3.2395, 3.5557]
2025-04-13 12:51:04,657 - INFO -   Noise shape: tensor([ 0.3061, -0.8799,  0.0924, -0.1797,  1.1969,  0.6839,  0.3759],
       device='cuda:0'), range: [-3.9465, 3.6450]
2025-04-13 12:51:04,657 - INFO -   Noisy actions shape: tensor([-0.1988, -0.4579,  0.3983, -0.5072, -1.2547,  1.4837, -0.1219],
       device='cuda:0'), range: [-3.5848, 3.6710]
2025-04-13 12:51:04,699 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:04,699 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1403, 3.2020]
2025-04-13 12:51:04,699 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3733, 2.9383]
2025-04-13 12:51:04,699 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,699 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,700 - INFO -   True actions shape: tensor([-1.0433,  0.1357,  0.4759,  0.8948, -0.9097,  1.2983, -1.7533],
       device='cuda:0'), range: [-3.1403, 3.2020]
2025-04-13 12:51:04,700 - INFO -   Noise shape: tensor([-1.6332, -0.3121, -0.7578,  0.2437,  2.1473, -0.7045, -0.0197],
       device='cuda:0'), range: [-3.4279, 3.5508]
2025-04-13 12:51:04,701 - INFO -   Noisy actions shape: tensor([-1.9037, -0.2395, -0.5270,  0.5585,  1.6562, -0.1723, -0.6691],
       device='cuda:0'), range: [-3.4623, 3.5848]
2025-04-13 12:51:04,739 - INFO -   Loss components:
2025-04-13 12:51:04,739 - INFO -     Diffusion loss: 1.216613 (coef: 1.0)
2025-04-13 12:51:04,740 - INFO -     Grasp quality loss: 0.695667 (coef: 0.5)
2025-04-13 12:51:04,740 - INFO -     Grasp rotation loss: 0.581022 (coef: 0.5)
2025-04-13 12:51:04,740 - INFO -     Grasp width loss: 9.704388 (coef: 0.005)
2025-04-13 12:51:04,740 - INFO -     TOTAL loss: 1.903479
2025-04-13 12:51:04,747 - INFO -   Gradients: avg norm: 0.268529, max norm: 2.214209, non-zero params: 250
2025-04-13 12:51:04,747 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-13 12:51:04,750 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:04,750 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6731, 3.2897]
2025-04-13 12:51:04,751 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8518, 2.8902]
2025-04-13 12:51:04,751 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,751 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,751 - INFO -   True actions shape: tensor([-0.3766,  0.1460,  0.4165,  2.1082,  1.2458,  1.3581,  1.9736],
       device='cuda:0'), range: [-3.6731, 3.2897]
2025-04-13 12:51:04,752 - INFO -   Noise shape: tensor([-0.5683, -0.2396, -0.9877, -2.2259, -0.8351, -0.0196, -0.0125],
       device='cuda:0'), range: [-3.1602, 3.3179]
2025-04-13 12:51:04,753 - INFO -   Noisy actions shape: tensor([-0.5980, -0.2264, -0.9492, -2.0408, -0.7275,  0.0946,  0.1534],
       device='cuda:0'), range: [-3.4951, 3.6715]
2025-04-13 12:51:04,795 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:04,795 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4911, 3.4033]
2025-04-13 12:51:04,795 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9115, 3.1263]
2025-04-13 12:51:04,795 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,795 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,796 - INFO -   True actions shape: tensor([-0.4688, -0.8419, -0.8581,  0.4410, -1.3134, -1.3695, -0.6594],
       device='cuda:0'), range: [-3.4911, 3.4033]
2025-04-13 12:51:04,797 - INFO -   Noise shape: tensor([-0.4194, -0.0548,  0.9161, -0.9955,  0.6397, -0.7360, -0.1168],
       device='cuda:0'), range: [-3.4964, 3.3247]
2025-04-13 12:51:04,797 - INFO -   Noisy actions shape: tensor([-0.6052, -0.7808, -0.3703, -0.0396, -0.9006, -1.5535, -0.6440],
       device='cuda:0'), range: [-3.5278, 3.7306]
2025-04-13 12:51:04,837 - INFO - 
=== Epoch 19 Summary ===
2025-04-13 12:51:04,837 - INFO -   Avg total loss: 1.963387
2025-04-13 12:51:04,837 - INFO -   Avg diffusion loss: 1.277200
2025-04-13 12:51:04,837 - INFO -   Avg grasp loss: 1.372374
2025-04-13 12:51:04,837 - INFO - 
=== EPOCH 20/20 ===
2025-04-13 12:51:04,838 - INFO - GPU Memory: 0.26GB allocated, 0.46GB reserved
2025-04-13 12:51:04,840 - INFO - Batch 1/13: Generated dummy data
2025-04-13 12:51:04,841 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5303, 3.2775]
2025-04-13 12:51:04,841 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7587, 3.7017]
2025-04-13 12:51:04,841 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,841 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,842 - INFO -   True actions shape: tensor([-2.4138, -0.7042,  0.5554,  0.0886,  0.3744,  1.7524, -0.6259],
       device='cuda:0'), range: [-3.5303, 3.2775]
2025-04-13 12:51:04,842 - INFO -   Noise shape: tensor([ 0.3397,  0.5797,  0.6228,  0.7349,  1.5111, -1.1974, -1.2792],
       device='cuda:0'), range: [-3.6946, 3.8786]
2025-04-13 12:51:04,843 - INFO -   Noisy actions shape: tensor([-0.3343,  0.3647,  0.7511,  0.7311,  1.5559, -0.6717, -1.4017],
       device='cuda:0'), range: [-3.8164, 3.1961]
2025-04-13 12:51:04,843 - INFO -   Diffusion: timestep range [159, 900], noise range [-3.6946, 3.8786]
2025-04-13 12:51:04,843 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8164, 3.1961]
2025-04-13 12:51:04,862 - INFO -   Model output shapes:
2025-04-13 12:51:04,862 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-13 12:51:04,862 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4420, 0.5815]
2025-04-13 12:51:04,862 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5286
2025-04-13 12:51:04,862 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1585, 0.3066]
2025-04-13 12:51:04,883 - INFO -   Loss components:
2025-04-13 12:51:04,883 - INFO -     Diffusion loss: 1.191088 (coef: 1.0)
2025-04-13 12:51:04,883 - INFO -     Grasp quality loss: 0.690415 (coef: 0.5)
2025-04-13 12:51:04,883 - INFO -     Grasp rotation loss: 0.565652 (coef: 0.5)
2025-04-13 12:51:04,883 - INFO -     Grasp width loss: 10.177059 (coef: 0.005)
2025-04-13 12:51:04,883 - INFO -     TOTAL loss: 1.870007
2025-04-13 12:51:04,890 - INFO -   Gradients: avg norm: 0.266700, max norm: 2.025188, non-zero params: 250
2025-04-13 12:51:04,891 - INFO -   Optimizer step complete, current LR: 7.500000e-05
2025-04-13 12:51:04,891 - INFO - --- Gradient Check @ Epoch 20, Batch 0 ---
2025-04-13 12:51:04,907 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-13 12:51:04,907 - INFO -   --- Gradient Stats by Component ---
2025-04-13 12:51:04,907 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.0598e-01, MaxNorm=1.4751e+00
2025-04-13 12:51:04,907 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=7.2109e-03, MaxNorm=1.4922e-02
2025-04-13 12:51:04,908 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.1748e-03, MaxNorm=2.0435e-02
2025-04-13 12:51:04,908 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.5528e-01, MaxNorm=3.6922e-01
2025-04-13 12:51:04,908 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.0413e+00, MaxNorm=2.0252e+00
2025-04-13 12:51:04,908 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.4224e-01, MaxNorm=1.5263e+00
2025-04-13 12:51:04,908 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=4.5441e-02, MaxNorm=2.1067e-01
2025-04-13 12:51:04,908 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.2410e-01, MaxNorm=4.5595e-01
2025-04-13 12:51:04,908 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=4.6534e-01, MaxNorm=4.8464e-01
2025-04-13 12:51:04,908 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1025e+00, MaxNorm=1.9927e+00
2025-04-13 12:51:04,908 - INFO - --- End Gradient Check ---
2025-04-13 12:51:04,910 - INFO - Batch 2/13: Generated dummy data
2025-04-13 12:51:04,910 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4746, 3.8787]
2025-04-13 12:51:04,910 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8442, 3.0439]
2025-04-13 12:51:04,911 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,911 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,911 - INFO -   True actions shape: tensor([ 0.8174, -1.6221,  0.1420, -0.4237, -0.8279, -0.1901, -0.4478],
       device='cuda:0'), range: [-3.4746, 3.8787]
2025-04-13 12:51:04,912 - INFO -   Noise shape: tensor([ 1.2843, -2.0519,  0.2784, -0.1869, -0.8263, -1.4593, -0.0622],
       device='cuda:0'), range: [-3.2991, 3.1343]
2025-04-13 12:51:04,912 - INFO -   Noisy actions shape: tensor([ 1.3957, -2.2788,  0.2971, -0.2504, -0.9448, -1.4712, -0.1310],
       device='cuda:0'), range: [-3.2690, 3.8510]
2025-04-13 12:51:04,954 - INFO - Batch 3/13: Generated dummy data
2025-04-13 12:51:04,954 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0573, 4.8284]
2025-04-13 12:51:04,954 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9819, 3.0385]
2025-04-13 12:51:04,954 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,954 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,955 - INFO -   True actions shape: tensor([-1.4640,  1.2433, -2.6198,  2.4386, -0.7814, -0.3263, -0.7085],
       device='cuda:0'), range: [-3.0573, 4.8284]
2025-04-13 12:51:04,956 - INFO -   Noise shape: tensor([-1.0897,  0.9801,  0.1741,  2.9792, -0.8759,  0.9972, -0.0335],
       device='cuda:0'), range: [-3.4567, 3.7106]
2025-04-13 12:51:04,956 - INFO -   Noisy actions shape: tensor([-1.6614,  1.4225, -2.5237,  3.0136, -0.9490, -0.1080, -0.6995],
       device='cuda:0'), range: [-3.9554, 4.4784]
2025-04-13 12:51:04,997 - INFO - Batch 4/13: Generated dummy data
2025-04-13 12:51:04,998 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5031, 3.4989]
2025-04-13 12:51:04,998 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7549, 3.1531]
2025-04-13 12:51:04,998 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:04,998 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:04,999 - INFO -   True actions shape: tensor([ 0.1524,  0.5274, -2.1345, -1.0238,  0.3091,  0.3241, -0.5199],
       device='cuda:0'), range: [-3.5031, 3.4989]
2025-04-13 12:51:04,999 - INFO -   Noise shape: tensor([ 0.0427, -0.3077, -0.6007,  0.9602,  1.0002,  1.7298,  0.7380],
       device='cuda:0'), range: [-4.7357, 4.2309]
2025-04-13 12:51:05,000 - INFO -   Noisy actions shape: tensor([ 0.1556,  0.4984, -2.1791, -0.9355,  0.3958,  0.4748, -0.4530],
       device='cuda:0'), range: [-3.4224, 3.4536]
2025-04-13 12:51:05,041 - INFO - Batch 5/13: Generated dummy data
2025-04-13 12:51:05,042 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6261, 3.9590]
2025-04-13 12:51:05,042 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7856, 2.9944]
2025-04-13 12:51:05,042 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,042 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,043 - INFO -   True actions shape: tensor([-1.1310, -1.3322,  1.1836, -0.3303,  0.7217,  0.4260,  0.5188],
       device='cuda:0'), range: [-3.6261, 3.9590]
2025-04-13 12:51:05,043 - INFO -   Noise shape: tensor([ 2.3436, -0.4084, -0.9350,  1.6748,  0.6028, -1.1194, -0.1565],
       device='cuda:0'), range: [-3.9489, 3.3643]
2025-04-13 12:51:05,044 - INFO -   Noisy actions shape: tensor([-0.6136, -1.3883,  0.9608,  0.0287,  0.8322,  0.1814,  0.4744],
       device='cuda:0'), range: [-3.6592, 4.2339]
2025-04-13 12:51:05,086 - INFO - Batch 6/13: Generated dummy data
2025-04-13 12:51:05,086 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4080, 3.8713]
2025-04-13 12:51:05,086 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6809, 3.9193]
2025-04-13 12:51:05,086 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,086 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,087 - INFO -   True actions shape: tensor([-2.3257, -0.5414, -0.1741, -0.5336, -0.2704, -0.6808, -0.1651],
       device='cuda:0'), range: [-3.4080, 3.8713]
2025-04-13 12:51:05,088 - INFO -   Noise shape: tensor([ 0.8639,  0.0204,  0.6034, -0.1711, -0.3763,  1.0124,  0.8662],
       device='cuda:0'), range: [-3.9816, 3.3638]
2025-04-13 12:51:05,089 - INFO -   Noisy actions shape: tensor([ 0.6541, -0.0277,  0.5856, -0.2177, -0.3988,  0.9480,  0.8481],
       device='cuda:0'), range: [-3.2268, 3.7738]
2025-04-13 12:51:05,135 - INFO - Batch 7/13: Generated dummy data
2025-04-13 12:51:05,135 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2502, 2.8573]
2025-04-13 12:51:05,135 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0617, 2.7072]
2025-04-13 12:51:05,135 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,135 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,136 - INFO -   True actions shape: tensor([ 0.3665,  0.1990, -1.3163,  0.8794, -0.8196,  1.1634, -0.1750],
       device='cuda:0'), range: [-3.2502, 2.8573]
2025-04-13 12:51:05,137 - INFO -   Noise shape: tensor([-0.9911, -0.1929,  1.9968, -0.3543,  0.8401, -0.5871,  0.8342],
       device='cuda:0'), range: [-3.3294, 3.8057]
2025-04-13 12:51:05,137 - INFO -   Noisy actions shape: tensor([-0.3531,  0.0293,  0.2676,  0.4486, -0.0915,  0.5176,  0.3997],
       device='cuda:0'), range: [-3.0588, 2.9999]
2025-04-13 12:51:05,181 - INFO - Batch 8/13: Generated dummy data
2025-04-13 12:51:05,181 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3182, 2.9342]
2025-04-13 12:51:05,181 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5409, 2.9013]
2025-04-13 12:51:05,182 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,182 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,182 - INFO -   True actions shape: tensor([ 0.9043, -0.0016,  0.4403,  1.4260,  0.9158,  0.4251, -0.4131],
       device='cuda:0'), range: [-3.3182, 2.9342]
2025-04-13 12:51:05,183 - INFO -   Noise shape: tensor([ 0.2401,  0.5437, -1.2903,  1.6877,  0.9482, -1.5600, -0.7756],
       device='cuda:0'), range: [-3.9555, 3.6701]
2025-04-13 12:51:05,184 - INFO -   Noisy actions shape: tensor([ 0.6054,  0.4902, -0.9759,  2.1367,  1.2497, -1.2260, -0.8778],
       device='cuda:0'), range: [-3.1973, 3.4634]
2025-04-13 12:51:05,226 - INFO - Batch 9/13: Generated dummy data
2025-04-13 12:51:05,226 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5754, 3.6620]
2025-04-13 12:51:05,227 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6856, 3.0473]
2025-04-13 12:51:05,227 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,227 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,227 - INFO -   True actions shape: tensor([ 1.4337, -0.3785,  1.4224, -1.2621, -1.4678,  0.9883,  1.4081],
       device='cuda:0'), range: [-3.5754, 3.6620]
2025-04-13 12:51:05,228 - INFO -   Noise shape: tensor([-0.2767,  0.2720, -1.2041,  0.3633,  0.4856,  0.9793, -1.0000],
       device='cuda:0'), range: [-3.3019, 3.5066]
2025-04-13 12:51:05,229 - INFO -   Noisy actions shape: tensor([ 1.4106, -0.3583,  1.3339, -1.2333, -1.4299,  1.0549,  1.3340],
       device='cuda:0'), range: [-4.0528, 3.6297]
2025-04-13 12:51:05,271 - INFO - Batch 10/13: Generated dummy data
2025-04-13 12:51:05,271 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3156, 4.8126]
2025-04-13 12:51:05,271 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9589, 2.8603]
2025-04-13 12:51:05,271 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,271 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,272 - INFO -   True actions shape: tensor([ 1.3255,  0.3294,  0.9520,  0.5688,  0.6736, -0.0089,  0.0766],
       device='cuda:0'), range: [-3.3156, 4.8126]
2025-04-13 12:51:05,272 - INFO -   Noise shape: tensor([-0.3014, -1.8485, -0.0402, -0.0933,  0.3330,  1.1584, -1.0616],
       device='cuda:0'), range: [-3.4934, 4.5796]
2025-04-13 12:51:05,273 - INFO -   Noisy actions shape: tensor([ 0.9099, -0.7955,  0.7551,  0.4112,  0.7424,  0.6600, -0.5490],
       device='cuda:0'), range: [-2.8868, 4.5055]
2025-04-13 12:51:05,315 - INFO - Batch 11/13: Generated dummy data
2025-04-13 12:51:05,315 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9661, 3.3486]
2025-04-13 12:51:05,315 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9312, 3.0324]
2025-04-13 12:51:05,315 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,315 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,316 - INFO -   True actions shape: tensor([ 0.7596,  0.0909,  0.3246, -0.1558,  1.0825,  1.1007,  0.2059],
       device='cuda:0'), range: [-3.9661, 3.3486]
2025-04-13 12:51:05,317 - INFO -   Noise shape: tensor([-2.7721,  0.2415,  1.2136,  0.1341, -1.7072,  0.6030,  1.4184],
       device='cuda:0'), range: [-3.5584, 3.4329]
2025-04-13 12:51:05,317 - INFO -   Noisy actions shape: tensor([-2.2921,  0.2580,  1.2474,  0.0667, -1.1835,  0.9685,  1.3935],
       device='cuda:0'), range: [-3.6870, 3.2653]
2025-04-13 12:51:05,357 - INFO -   Loss components:
2025-04-13 12:51:05,357 - INFO -     Diffusion loss: 1.151051 (coef: 1.0)
2025-04-13 12:51:05,357 - INFO -     Grasp quality loss: 0.697004 (coef: 0.5)
2025-04-13 12:51:05,357 - INFO -     Grasp rotation loss: 0.574635 (coef: 0.5)
2025-04-13 12:51:05,357 - INFO -     Grasp width loss: 9.245952 (coef: 0.005)
2025-04-13 12:51:05,357 - INFO -     TOTAL loss: 1.833100
2025-04-13 12:51:05,366 - INFO -   Gradients: avg norm: 0.239334, max norm: 2.020705, non-zero params: 250
2025-04-13 12:51:05,366 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-13 12:51:05,369 - INFO - Batch 12/13: Generated dummy data
2025-04-13 12:51:05,369 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4278, 3.7674]
2025-04-13 12:51:05,369 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1239, 3.3145]
2025-04-13 12:51:05,369 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,369 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,370 - INFO -   True actions shape: tensor([ 0.5863, -0.1547,  0.0850,  2.0409,  0.7599,  0.4527, -0.4408],
       device='cuda:0'), range: [-3.4278, 3.7674]
2025-04-13 12:51:05,370 - INFO -   Noise shape: tensor([-0.9784,  0.2574,  0.5758,  0.3562, -1.2996, -0.7982, -0.7226],
       device='cuda:0'), range: [-3.2833, 3.4301]
2025-04-13 12:51:05,371 - INFO -   Noisy actions shape: tensor([ 0.2514, -0.0666,  0.2606,  2.0501,  0.3159,  0.1807, -0.6445],
       device='cuda:0'), range: [-3.7670, 3.7261]
2025-04-13 12:51:05,413 - INFO - Batch 13/13: Generated dummy data
2025-04-13 12:51:05,413 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4816, 3.9910]
2025-04-13 12:51:05,413 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9628, 3.1624]
2025-04-13 12:51:05,413 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-13 12:51:05,413 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-13 12:51:05,414 - INFO -   True actions shape: tensor([-0.0386, -0.7816,  0.2928,  0.2759,  0.8863, -0.7763, -1.0521],
       device='cuda:0'), range: [-3.4816, 3.9910]
2025-04-13 12:51:05,415 - INFO -   Noise shape: tensor([-0.4527, -1.4996, -0.3201, -1.2474, -1.4570, -1.6339, -0.2727],
       device='cuda:0'), range: [-3.3088, 3.6125]
2025-04-13 12:51:05,415 - INFO -   Noisy actions shape: tensor([-0.3968, -1.6802, -0.1015, -0.8795, -0.7118, -1.7886, -0.8147],
       device='cuda:0'), range: [-3.3099, 3.2470]
2025-04-13 12:51:05,455 - INFO - 
=== Epoch 20 Summary ===
2025-04-13 12:51:05,455 - INFO -   Avg total loss: 1.998541
2025-04-13 12:51:05,455 - INFO -   Avg diffusion loss: 1.317825
2025-04-13 12:51:05,455 - INFO -   Avg grasp loss: 1.361432
2025-04-13 12:51:05,623 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250413_125051/ckpt_epoch_20.pth
2025-04-13 12:51:05,624 - INFO - Saved model state with 16022452 parameters
2025-04-13 12:51:05,651 - INFO - 
=== Training Complete ===
2025-04-13 12:51:05,651 - INFO - Total training time: 0.23 minutes
2025-04-13 12:51:05,651 - INFO - Final global step: 260
2025-04-13 12:51:05,651 - INFO - ----------------------

2025-04-13 12:51:05,652 - INFO - 
=== Model Configuration ===
2025-04-13 12:51:05,652 - INFO - Model: PrestoGIGA with depth=12, heads=4, hidden=256
2025-04-13 12:51:05,652 - INFO - Sequence length: 50, patch size: 1
2025-04-13 12:51:05,652 - INFO - GIGA encoder: voxel_simple_local, decoder: simple_local, c_dim: 32
2025-04-13 12:51:05,652 - INFO - Diffusion: beta_schedule=squaredcos_cap_v2, steps=1000, type=epsilon
2025-04-13 12:51:05,652 - INFO - x0_type: step, x0_iter: 1
2025-04-13 12:51:05,652 - INFO - Optimizer: AdamW with lr=0.0001, weight_decay=0.01
