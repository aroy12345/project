2025-04-15 07:31:56,857 - INFO - --- Logging Initialized ---

2025-04-15 07:31:59,358 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,360 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,361 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,549 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,552 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,555 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,556 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,687 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,688 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,698 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,698 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,699 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,700 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,701 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,703 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,704 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,746 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,748 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,749 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,984 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:31:59,986 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,100 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-15 07:32:00,100 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-15 07:32:00,206 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,207 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,207 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,208 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,209 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,209 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,213 - INFO - Environment variable for CUROBO_USE_LRU_CACHE is not set, Enabling as default.
2025-04-15 07:32:00,213 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,214 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,216 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,218 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,219 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,220 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,221 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,222 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,223 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,224 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,231 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,348 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,355 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,356 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,358 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,477 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,487 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,488 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,491 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,499 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,500 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,506 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,507 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,508 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,509 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,509 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,511 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,512 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,513 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,514 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,515 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,516 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,517 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,522 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,527 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,528 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,530 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,531 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,532 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,533 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,534 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,534 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,539 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,540 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,541 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,542 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,542 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,543 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,544 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,546 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,547 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,551 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,552 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,556 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,558 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,754 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,755 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:00,755 - INFO - Environment variable for CUROBO_TORCH_COMPILE is not set, Disabling.
2025-04-15 07:32:01,314 - INFO - Starting training loop with: epochs=20, batch_size=8
2025-04-15 07:32:01,314 - INFO - Loss coefficients: diffusion=1.0, grasp=0.5, tsdf=0.0, collision=0.0, distance=0.0, euclidean=0.0
2025-04-15 07:32:01,314 - INFO - Model settings: seq_len=50, obs_dim=7, cond_dim=104, tsdf_dim=32, num_grasp_points=64, num_tsdf_points=32
2025-04-15 07:32:01,341 - INFO - 
=== EPOCH 1/20 ===
2025-04-15 07:32:01,342 - INFO - GPU Memory: 0.06GB allocated, 0.08GB reserved
2025-04-15 07:32:01,346 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:01,352 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4520, 3.9970]
2025-04-15 07:32:01,352 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1730, 2.8677]
2025-04-15 07:32:01,361 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:01,362 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:01,411 - INFO -   True actions shape: tensor([ 0.5798, -0.8163,  1.6338, -0.1402,  0.3170,  0.5221,  0.7379],
       device='cuda:0'), range: [-3.4520, 3.9970]
2025-04-15 07:32:01,412 - INFO -   Noise shape: tensor([-2.3798, -0.1698,  0.4788, -0.9827, -1.2117,  0.6177, -0.6394],
       device='cuda:0'), range: [-3.5704, 3.2765]
2025-04-15 07:32:01,413 - INFO -   Noisy actions shape: tensor([-2.3310, -0.2291,  0.5971, -0.9903, -1.1853,  0.6543, -0.5837],
       device='cuda:0'), range: [-3.3259, 3.7986]
2025-04-15 07:32:01,413 - INFO -   Diffusion: timestep range [414, 952], noise range [-3.5704, 3.2765]
2025-04-15 07:32:01,413 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3259, 3.7986]
2025-04-15 07:32:01,862 - INFO -   Model output shapes:
2025-04-15 07:32:01,862 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:01,865 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.2502, 0.3988]
2025-04-15 07:32:01,865 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5165
2025-04-15 07:32:01,865 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.5128, 0.4100]
2025-04-15 07:32:01,986 - INFO -   Loss components:
2025-04-15 07:32:01,986 - INFO -     Diffusion loss: 3.600897 (coef: 1.0)
2025-04-15 07:32:01,986 - INFO -     Grasp quality loss: 0.779990 (coef: 0.5)
2025-04-15 07:32:01,986 - INFO -     Grasp rotation loss: 0.567065 (coef: 0.5)
2025-04-15 07:32:01,986 - INFO -     Grasp width loss: 67.289642 (coef: 0.005)
2025-04-15 07:32:01,986 - INFO -     TOTAL loss: 4.610873
2025-04-15 07:32:01,994 - INFO -   Gradients: avg norm: 1.466918, max norm: 13.022533, non-zero params: 250
2025-04-15 07:32:01,994 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-15 07:32:01,994 - INFO - --- Gradient Check @ Epoch 1, Batch 0 ---
2025-04-15 07:32:02,017 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:02,017 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:02,017 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.3837e+00, MaxNorm=6.2734e+00
2025-04-15 07:32:02,017 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.6450e-01, MaxNorm=4.0249e-01
2025-04-15 07:32:02,017 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.6601e-02, MaxNorm=3.4926e-02
2025-04-15 07:32:02,017 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.0082e+00, MaxNorm=7.3772e+00
2025-04-15 07:32:02,017 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.2786e+00, MaxNorm=4.2174e+00
2025-04-15 07:32:02,017 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.4478e+00, MaxNorm=4.4249e+00
2025-04-15 07:32:02,017 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.9826e-01, MaxNorm=1.3168e+00
2025-04-15 07:32:02,017 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.1703e+01, MaxNorm=1.3023e+01
2025-04-15 07:32:02,017 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=2.1130e+00, MaxNorm=2.2709e+00
2025-04-15 07:32:02,017 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.7659e+00, MaxNorm=6.8503e+00
2025-04-15 07:32:02,017 - INFO - --- End Gradient Check ---
2025-04-15 07:32:02,021 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:02,021 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8414, 3.8056]
2025-04-15 07:32:02,021 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3787, 2.8990]
2025-04-15 07:32:02,021 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,021 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,022 - INFO -   True actions shape: tensor([ 0.5678,  0.7016, -0.1548, -0.8977,  0.9126, -2.0831,  0.2304],
       device='cuda:0'), range: [-3.8414, 3.8056]
2025-04-15 07:32:02,023 - INFO -   Noise shape: tensor([-0.5012, -0.2817,  0.8088, -0.2706, -0.4443, -0.4309, -0.2454],
       device='cuda:0'), range: [-3.6985, 3.8025]
2025-04-15 07:32:02,023 - INFO -   Noisy actions shape: tensor([-0.4545, -0.2251,  0.7940, -0.3410, -0.3705, -0.5949, -0.2264],
       device='cuda:0'), range: [-3.8552, 3.9914]
2025-04-15 07:32:02,070 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:02,070 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6015, 3.4678]
2025-04-15 07:32:02,071 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2464, 2.9333]
2025-04-15 07:32:02,071 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,071 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,071 - INFO -   True actions shape: tensor([ 1.3275,  0.7394,  1.1402, -0.1969, -0.6061,  0.4728, -0.5881],
       device='cuda:0'), range: [-3.6015, 3.4678]
2025-04-15 07:32:02,072 - INFO -   Noise shape: tensor([ 0.0249, -1.3818, -0.5634, -0.3323, -0.3677,  1.5947, -0.9795],
       device='cuda:0'), range: [-3.7494, 3.0830]
2025-04-15 07:32:02,073 - INFO -   Noisy actions shape: tensor([ 0.1364, -1.3148, -0.4655, -0.3477, -0.4174,  1.6288, -1.0255],
       device='cuda:0'), range: [-3.8037, 3.4287]
2025-04-15 07:32:02,119 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:02,119 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8202, 3.3143]
2025-04-15 07:32:02,119 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7083, 3.3006]
2025-04-15 07:32:02,119 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,119 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,120 - INFO -   True actions shape: tensor([-0.4947, -0.6165, -0.1742, -2.5371, -0.0619, -0.1981, -0.1780],
       device='cuda:0'), range: [-3.8202, 3.3143]
2025-04-15 07:32:02,121 - INFO -   Noise shape: tensor([-0.0907,  0.9850, -0.3643, -0.8061, -1.9244,  0.1941, -0.3933],
       device='cuda:0'), range: [-3.0937, 2.9995]
2025-04-15 07:32:02,121 - INFO -   Noisy actions shape: tensor([-0.4205,  0.2339, -0.3775, -2.3921, -1.3733, -0.0093, -0.4003],
       device='cuda:0'), range: [-3.7946, 3.9876]
2025-04-15 07:32:02,168 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:02,168 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7615, 3.6018]
2025-04-15 07:32:02,168 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9439, 2.8573]
2025-04-15 07:32:02,168 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,168 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,169 - INFO -   True actions shape: tensor([-1.3805, -0.3742,  1.6343,  0.0137, -0.6675,  1.2961,  0.2437],
       device='cuda:0'), range: [-3.7615, 3.6018]
2025-04-15 07:32:02,170 - INFO -   Noise shape: tensor([-0.0927, -1.7477, -1.9112,  0.2544, -0.4909,  1.0898,  0.8388],
       device='cuda:0'), range: [-3.7414, 3.0475]
2025-04-15 07:32:02,170 - INFO -   Noisy actions shape: tensor([-1.3272, -0.9561,  0.8716,  0.1010, -0.7961,  1.5933,  0.5190],
       device='cuda:0'), range: [-3.4350, 3.2049]
2025-04-15 07:32:02,216 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:02,216 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8654, 3.5578]
2025-04-15 07:32:02,216 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7806, 2.9088]
2025-04-15 07:32:02,217 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,217 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,217 - INFO -   True actions shape: tensor([-1.0927,  0.3493, -0.5042, -0.6677, -0.2436, -0.3592,  2.1740],
       device='cuda:0'), range: [-3.8654, 3.5578]
2025-04-15 07:32:02,218 - INFO -   Noise shape: tensor([ 0.8771,  0.7341, -0.4786, -0.6587,  0.7058,  0.1734, -0.4486],
       device='cuda:0'), range: [-3.5732, 3.9819]
2025-04-15 07:32:02,218 - INFO -   Noisy actions shape: tensor([-0.0502,  0.7839, -0.6918, -0.9349,  0.3750, -0.1036,  1.0812],
       device='cuda:0'), range: [-3.6872, 3.3059]
2025-04-15 07:32:02,264 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:02,264 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9793, 3.4071]
2025-04-15 07:32:02,265 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2245, 2.6734]
2025-04-15 07:32:02,265 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,265 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,266 - INFO -   True actions shape: tensor([ 0.8865, -0.8504, -0.4678, -0.0174, -0.3960,  0.6339, -0.0477],
       device='cuda:0'), range: [-3.9793, 3.4071]
2025-04-15 07:32:02,266 - INFO -   Noise shape: tensor([ 1.0075,  1.0657, -0.0641,  0.3573, -0.7189, -0.8942, -0.0763],
       device='cuda:0'), range: [-3.3972, 3.5840]
2025-04-15 07:32:02,267 - INFO -   Noisy actions shape: tensor([ 1.1027, -0.5692, -0.4695,  0.0690, -0.5572,  0.4003, -0.0646],
       device='cuda:0'), range: [-3.6786, 3.4114]
2025-04-15 07:32:02,313 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:02,313 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4416, 3.6585]
2025-04-15 07:32:02,313 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6584, 3.2675]
2025-04-15 07:32:02,313 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,313 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,314 - INFO -   True actions shape: tensor([ 0.2115,  0.9689,  0.0014, -0.9114,  0.9603, -0.2252,  1.0088],
       device='cuda:0'), range: [-3.4416, 3.6585]
2025-04-15 07:32:02,315 - INFO -   Noise shape: tensor([ 1.7080, -1.3366,  0.4683,  0.7121,  0.2199, -0.3847, -0.9536],
       device='cuda:0'), range: [-3.3035, 3.8916]
2025-04-15 07:32:02,315 - INFO -   Noisy actions shape: tensor([ 1.4310, -0.3785,  0.3554, -0.0567,  0.7940, -0.4384, -0.0625],
       device='cuda:0'), range: [-3.3485, 3.8808]
2025-04-15 07:32:02,362 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:02,362 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4573, 3.2382]
2025-04-15 07:32:02,362 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0801, 3.0966]
2025-04-15 07:32:02,362 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,362 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,363 - INFO -   True actions shape: tensor([ 0.0662, -0.8361,  0.7177,  1.5844, -0.8507,  0.9024,  1.2973],
       device='cuda:0'), range: [-3.4573, 3.2382]
2025-04-15 07:32:02,364 - INFO -   Noise shape: tensor([-0.6669,  0.5829, -0.6160, -0.8356,  1.3974, -0.2482, -0.0208],
       device='cuda:0'), range: [-3.7608, 3.3209]
2025-04-15 07:32:02,364 - INFO -   Noisy actions shape: tensor([-0.2703, -0.4413,  0.3220,  0.9686, -0.0536,  0.6637,  1.1194],
       device='cuda:0'), range: [-3.4607, 3.3144]
2025-04-15 07:32:02,410 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:02,410 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0595, 3.4215]
2025-04-15 07:32:02,411 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0743, 3.2633]
2025-04-15 07:32:02,411 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,411 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,412 - INFO -   True actions shape: tensor([ 2.2205,  0.5847, -0.1444,  1.5780, -1.0167, -1.1829, -0.3454],
       device='cuda:0'), range: [-3.0595, 3.4215]
2025-04-15 07:32:02,412 - INFO -   Noise shape: tensor([ 2.1425,  0.8864, -0.7288, -0.5403, -0.1704,  0.7529,  1.1141],
       device='cuda:0'), range: [-3.8257, 3.0237]
2025-04-15 07:32:02,413 - INFO -   Noisy actions shape: tensor([ 2.9318,  1.0569, -0.7118,  0.2598, -0.6258,  0.1129,  0.8236],
       device='cuda:0'), range: [-3.8221, 3.5092]
2025-04-15 07:32:02,459 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:02,460 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1560, 3.4290]
2025-04-15 07:32:02,460 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4560, 3.2367]
2025-04-15 07:32:02,460 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,460 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,461 - INFO -   True actions shape: tensor([ 0.2772, -0.8518,  1.1334,  0.9242,  0.5049,  0.7610, -0.1481],
       device='cuda:0'), range: [-4.1560, 3.4290]
2025-04-15 07:32:02,461 - INFO -   Noise shape: tensor([-1.9451,  0.7401,  1.1094,  0.2414, -1.2840,  0.1306,  1.2889],
       device='cuda:0'), range: [-3.8337, 3.6806]
2025-04-15 07:32:02,462 - INFO -   Noisy actions shape: tensor([-1.1744, -0.0826,  1.5860,  0.8257, -0.5469,  0.6319,  0.8034],
       device='cuda:0'), range: [-4.0329, 3.4326]
2025-04-15 07:32:02,506 - INFO -   Loss components:
2025-04-15 07:32:02,506 - INFO -     Diffusion loss: 3.026973 (coef: 1.0)
2025-04-15 07:32:02,506 - INFO -     Grasp quality loss: 0.709976 (coef: 0.5)
2025-04-15 07:32:02,506 - INFO -     Grasp rotation loss: 0.574323 (coef: 0.5)
2025-04-15 07:32:02,506 - INFO -     Grasp width loss: 32.132629 (coef: 0.005)
2025-04-15 07:32:02,506 - INFO -     TOTAL loss: 3.829785
2025-04-15 07:32:02,514 - INFO -   Gradients: avg norm: 0.953510, max norm: 6.360289, non-zero params: 250
2025-04-15 07:32:02,514 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-15 07:32:02,517 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:02,517 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2221, 3.3028]
2025-04-15 07:32:02,517 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7017, 3.6662]
2025-04-15 07:32:02,517 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,517 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,518 - INFO -   True actions shape: tensor([-0.0937,  0.3379, -1.0386, -0.5132,  1.0508,  0.1362,  1.2172],
       device='cuda:0'), range: [-3.2221, 3.3028]
2025-04-15 07:32:02,519 - INFO -   Noise shape: tensor([-0.3484,  0.0877, -1.8011,  0.8171, -0.9168, -0.8442, -0.8376],
       device='cuda:0'), range: [-3.3606, 3.6718]
2025-04-15 07:32:02,519 - INFO -   Noisy actions shape: tensor([-0.3602,  0.1889, -2.0356,  0.6157, -0.5424, -0.7593, -0.4151],
       device='cuda:0'), range: [-3.1711, 3.2175]
2025-04-15 07:32:02,565 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:02,565 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1655, 3.7775]
2025-04-15 07:32:02,565 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7354, 3.1831]
2025-04-15 07:32:02,566 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,566 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,566 - INFO -   True actions shape: tensor([-1.3953, -0.6673,  0.4632, -1.9080, -2.7045,  0.0273,  1.5009],
       device='cuda:0'), range: [-3.1655, 3.7775]
2025-04-15 07:32:02,567 - INFO -   Noise shape: tensor([-0.0183, -1.8634,  0.1629,  0.0180,  2.1462,  1.3743,  1.1533],
       device='cuda:0'), range: [-3.1780, 3.4281]
2025-04-15 07:32:02,568 - INFO -   Noisy actions shape: tensor([-0.6219, -1.9684,  0.3477, -0.8117,  0.7601,  1.2500,  1.6903],
       device='cuda:0'), range: [-3.6728, 3.4785]
2025-04-15 07:32:02,639 - INFO - 
=== Epoch 1 Summary ===
2025-04-15 07:32:02,639 - INFO -   Avg total loss: 4.005744
2025-04-15 07:32:02,639 - INFO -   Avg diffusion loss: 3.131471
2025-04-15 07:32:02,639 - INFO -   Avg grasp loss: 1.748546
2025-04-15 07:32:02,639 - INFO - 
=== EPOCH 2/20 ===
2025-04-15 07:32:02,640 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:02,643 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:02,643 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7796, 3.5551]
2025-04-15 07:32:02,643 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8579, 3.4630]
2025-04-15 07:32:02,643 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,643 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,644 - INFO -   True actions shape: tensor([ 1.2008, -1.2590, -0.4527,  1.1152,  2.2020,  0.9761,  0.7696],
       device='cuda:0'), range: [-3.7796, 3.5551]
2025-04-15 07:32:02,645 - INFO -   Noise shape: tensor([ 1.4497,  1.3592,  0.4191,  0.0867, -2.2247,  2.2386, -1.1026],
       device='cuda:0'), range: [-3.4073, 3.3617]
2025-04-15 07:32:02,645 - INFO -   Noisy actions shape: tensor([ 1.6472, -0.6757, -0.2684,  1.0699,  1.2376,  1.7262,  0.3139],
       device='cuda:0'), range: [-3.6998, 3.3357]
2025-04-15 07:32:02,645 - INFO -   Diffusion: timestep range [132, 865], noise range [-3.4073, 3.3617]
2025-04-15 07:32:02,645 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6998, 3.3357]
2025-04-15 07:32:02,668 - INFO -   Model output shapes:
2025-04-15 07:32:02,668 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:02,668 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.3692, 0.5147]
2025-04-15 07:32:02,668 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5357
2025-04-15 07:32:02,668 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3845, 0.3528]
2025-04-15 07:32:02,689 - INFO -   Loss components:
2025-04-15 07:32:02,689 - INFO -     Diffusion loss: 2.880401 (coef: 1.0)
2025-04-15 07:32:02,689 - INFO -     Grasp quality loss: 0.702767 (coef: 0.5)
2025-04-15 07:32:02,690 - INFO -     Grasp rotation loss: 0.584678 (coef: 0.5)
2025-04-15 07:32:02,690 - INFO -     Grasp width loss: 26.214577 (coef: 0.005)
2025-04-15 07:32:02,690 - INFO -     TOTAL loss: 3.655196
2025-04-15 07:32:02,698 - INFO -   Gradients: avg norm: 0.741928, max norm: 5.556481, non-zero params: 250
2025-04-15 07:32:02,698 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-15 07:32:02,698 - INFO - --- Gradient Check @ Epoch 2, Batch 0 ---
2025-04-15 07:32:02,715 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:02,715 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:02,715 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1550e+00, MaxNorm=4.8941e+00
2025-04-15 07:32:02,715 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=5.4542e-02, MaxNorm=1.4802e-01
2025-04-15 07:32:02,715 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.2302e-02, MaxNorm=3.2124e-02
2025-04-15 07:32:02,715 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.1931e-01, MaxNorm=8.6106e-01
2025-04-15 07:32:02,715 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.8360e+00, MaxNorm=3.3719e+00
2025-04-15 07:32:02,715 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.9410e+00, MaxNorm=3.5091e+00
2025-04-15 07:32:02,715 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.2262e-01, MaxNorm=1.0130e+00
2025-04-15 07:32:02,715 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.2122e+00, MaxNorm=1.2417e+00
2025-04-15 07:32:02,715 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.8102e+00, MaxNorm=1.8300e+00
2025-04-15 07:32:02,715 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.0389e+00, MaxNorm=5.5565e+00
2025-04-15 07:32:02,715 - INFO - --- End Gradient Check ---
2025-04-15 07:32:02,718 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:02,718 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2886, 3.6968]
2025-04-15 07:32:02,718 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9921, 3.6289]
2025-04-15 07:32:02,718 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,718 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,719 - INFO -   True actions shape: tensor([ 0.2438, -0.2371,  1.9226,  1.7260,  0.0587, -0.8389,  1.6702],
       device='cuda:0'), range: [-3.2886, 3.6968]
2025-04-15 07:32:02,720 - INFO -   Noise shape: tensor([ 0.4052,  0.6733, -1.5821, -0.5263,  0.3290, -1.0327, -3.1356],
       device='cuda:0'), range: [-3.1356, 3.2593]
2025-04-15 07:32:02,720 - INFO -   Noisy actions shape: tensor([ 0.4364,  0.2079,  0.6115,  1.0786,  0.2423, -1.2876, -0.5123],
       device='cuda:0'), range: [-3.7915, 3.4829]
2025-04-15 07:32:02,766 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:02,766 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1750, 3.6200]
2025-04-15 07:32:02,766 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8320, 3.3405]
2025-04-15 07:32:02,767 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,767 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,767 - INFO -   True actions shape: tensor([-0.9775,  0.2543, -0.5497, -0.3611, -1.1068, -0.5829, -1.9774],
       device='cuda:0'), range: [-3.1750, 3.6200]
2025-04-15 07:32:02,768 - INFO -   Noise shape: tensor([-0.4678, -0.0414, -0.5676,  0.1569,  0.7709,  0.3475,  0.4527],
       device='cuda:0'), range: [-3.4673, 2.9103]
2025-04-15 07:32:02,768 - INFO -   Noisy actions shape: tensor([-1.0511,  0.2409, -0.6518, -0.3226, -0.9309, -0.5019, -1.8475],
       device='cuda:0'), range: [-3.4528, 3.2904]
2025-04-15 07:32:02,814 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:02,814 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8520, 3.5429]
2025-04-15 07:32:02,814 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8826, 3.1078]
2025-04-15 07:32:02,814 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,814 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,815 - INFO -   True actions shape: tensor([-0.2741,  0.7984, -0.7921,  0.7749, -0.3875,  1.4441,  0.9274],
       device='cuda:0'), range: [-3.8520, 3.5429]
2025-04-15 07:32:02,816 - INFO -   Noise shape: tensor([0.9677, 0.8828, 0.2941, 0.4063, 0.7131, 1.8025, 1.0686],
       device='cuda:0'), range: [-3.6377, 3.5150]
2025-04-15 07:32:02,816 - INFO -   Noisy actions shape: tensor([ 0.4348,  1.1828, -0.3994,  0.8498,  0.1812,  2.2754,  1.4024],
       device='cuda:0'), range: [-3.8206, 4.2191]
2025-04-15 07:32:02,862 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:02,863 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7967, 3.7235]
2025-04-15 07:32:02,863 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9366, 3.3434]
2025-04-15 07:32:02,863 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,863 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,864 - INFO -   True actions shape: tensor([-0.1463, -0.0728,  1.4202,  0.6073, -1.1460,  1.1409,  1.5997],
       device='cuda:0'), range: [-3.7967, 3.7235]
2025-04-15 07:32:02,864 - INFO -   Noise shape: tensor([-0.0809,  0.1979,  0.4598,  1.6337,  0.3824,  0.0395,  1.4521],
       device='cuda:0'), range: [-3.6827, 3.7142]
2025-04-15 07:32:02,865 - INFO -   Noisy actions shape: tensor([-0.1667,  0.0153,  1.4834,  1.2272, -0.8862,  1.0555,  2.0563],
       device='cuda:0'), range: [-3.9718, 3.6054]
2025-04-15 07:32:02,911 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:02,911 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7500, 3.2801]
2025-04-15 07:32:02,911 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9305, 3.8505]
2025-04-15 07:32:02,911 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,911 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,912 - INFO -   True actions shape: tensor([ 0.2144, -0.9040, -0.6226, -1.4324,  0.8017, -2.2080, -0.7597],
       device='cuda:0'), range: [-3.7500, 3.2801]
2025-04-15 07:32:02,913 - INFO -   Noise shape: tensor([ 1.7819, -0.2386, -0.4927, -0.8075,  0.8042, -0.6053, -0.7740],
       device='cuda:0'), range: [-3.6106, 3.0260]
2025-04-15 07:32:02,913 - INFO -   Noisy actions shape: tensor([ 0.8895, -0.9258, -0.7650, -1.6335,  1.0511, -2.2698, -1.0007],
       device='cuda:0'), range: [-4.0263, 3.0735]
2025-04-15 07:32:02,960 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:02,960 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5870, 3.7560]
2025-04-15 07:32:02,960 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0877, 3.6069]
2025-04-15 07:32:02,960 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:02,960 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:02,961 - INFO -   True actions shape: tensor([-1.8486,  1.8159,  0.9436,  0.8995, -0.4547,  1.4072,  1.8832],
       device='cuda:0'), range: [-3.5870, 3.7560]
2025-04-15 07:32:02,962 - INFO -   Noise shape: tensor([-1.5515,  0.5173,  0.8182,  0.2528,  0.7701,  1.7913,  2.0334],
       device='cuda:0'), range: [-3.4609, 3.9196]
2025-04-15 07:32:02,962 - INFO -   Noisy actions shape: tensor([-2.0406,  1.8690,  1.0452,  0.9253, -0.3469,  1.6355,  2.1397],
       device='cuda:0'), range: [-3.5463, 3.5704]
2025-04-15 07:32:03,009 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:03,009 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8655, 3.3218]
2025-04-15 07:32:03,009 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5022, 2.8155]
2025-04-15 07:32:03,009 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,009 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,010 - INFO -   True actions shape: tensor([ 1.3619,  0.4318,  1.3861,  0.2542,  0.7307,  0.4630, -1.3254],
       device='cuda:0'), range: [-3.8655, 3.3218]
2025-04-15 07:32:03,011 - INFO -   Noise shape: tensor([ 1.3725, -1.6335,  0.4724, -0.0662, -0.6682, -0.6034, -0.5197],
       device='cuda:0'), range: [-3.5808, 3.4852]
2025-04-15 07:32:03,011 - INFO -   Noisy actions shape: tensor([ 1.9079, -0.6077,  1.3999,  0.1671,  0.2003,  0.0214, -1.3784],
       device='cuda:0'), range: [-3.6197, 3.1956]
2025-04-15 07:32:03,059 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:03,060 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1053, 3.9141]
2025-04-15 07:32:03,060 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4465, 3.1984]
2025-04-15 07:32:03,060 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,060 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,061 - INFO -   True actions shape: tensor([-0.2930,  0.4435,  0.3221, -0.2559,  0.3322,  1.2584, -0.7907],
       device='cuda:0'), range: [-3.1053, 3.9141]
2025-04-15 07:32:03,061 - INFO -   Noise shape: tensor([-0.0058, -2.4888,  0.1749, -0.4649, -0.2927,  0.3666,  0.4228],
       device='cuda:0'), range: [-3.1497, 3.8122]
2025-04-15 07:32:03,062 - INFO -   Noisy actions shape: tensor([-0.2815, -0.3170,  0.3596, -0.3826,  0.2301,  1.3105, -0.6291],
       device='cuda:0'), range: [-3.5552, 3.1370]
2025-04-15 07:32:03,108 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:03,108 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6742, 3.2673]
2025-04-15 07:32:03,108 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8231, 3.2943]
2025-04-15 07:32:03,108 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,108 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,109 - INFO -   True actions shape: tensor([-0.3418, -0.9500, -0.4419,  0.3970, -0.1811,  0.1178,  1.3331],
       device='cuda:0'), range: [-3.6742, 3.2673]
2025-04-15 07:32:03,109 - INFO -   Noise shape: tensor([-1.8292, -0.2446, -0.6781, -1.0354, -0.0204, -0.8521, -1.5636],
       device='cuda:0'), range: [-3.5804, 2.9954]
2025-04-15 07:32:03,110 - INFO -   Noisy actions shape: tensor([-1.5084, -0.8570, -0.7875, -0.4259, -0.1453, -0.5019, -0.1117],
       device='cuda:0'), range: [-3.7937, 2.9871]
2025-04-15 07:32:03,156 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:03,156 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4297, 3.3356]
2025-04-15 07:32:03,156 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2819, 2.7141]
2025-04-15 07:32:03,156 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,156 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,157 - INFO -   True actions shape: tensor([-0.2064,  0.3117,  1.4217, -1.4295,  0.2990,  0.3104,  0.3582],
       device='cuda:0'), range: [-3.4297, 3.3356]
2025-04-15 07:32:03,157 - INFO -   Noise shape: tensor([-0.9160, -1.2281, -1.8483, -0.4558, -0.8366,  1.2275, -0.1907],
       device='cuda:0'), range: [-3.0263, 3.9272]
2025-04-15 07:32:03,158 - INFO -   Noisy actions shape: tensor([-0.6148, -0.3058,  0.3794, -1.4752, -0.1320,  0.8538,  0.2255],
       device='cuda:0'), range: [-3.3800, 3.2523]
2025-04-15 07:32:03,201 - INFO -   Loss components:
2025-04-15 07:32:03,201 - INFO -     Diffusion loss: 3.290874 (coef: 1.0)
2025-04-15 07:32:03,201 - INFO -     Grasp quality loss: 0.700980 (coef: 0.5)
2025-04-15 07:32:03,201 - INFO -     Grasp rotation loss: 0.583638 (coef: 0.5)
2025-04-15 07:32:03,201 - INFO -     Grasp width loss: 21.868460 (coef: 0.005)
2025-04-15 07:32:03,201 - INFO -     TOTAL loss: 4.042526
2025-04-15 07:32:03,209 - INFO -   Gradients: avg norm: 0.850978, max norm: 6.154281, non-zero params: 250
2025-04-15 07:32:03,209 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-15 07:32:03,212 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:03,212 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2613, 3.6978]
2025-04-15 07:32:03,212 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7725, 2.8579]
2025-04-15 07:32:03,213 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,213 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,213 - INFO -   True actions shape: tensor([ 0.0551,  1.1293,  1.5377, -1.5490, -2.2490,  1.4342,  0.9159],
       device='cuda:0'), range: [-3.2613, 3.6978]
2025-04-15 07:32:03,214 - INFO -   Noise shape: tensor([ 0.9189,  0.3881,  1.3919, -0.6110, -0.8031, -0.6940, -1.3636],
       device='cuda:0'), range: [-3.5066, 3.1183]
2025-04-15 07:32:03,215 - INFO -   Noisy actions shape: tensor([ 0.0610,  1.1317,  1.5466, -1.5529, -2.2541,  1.4297,  0.9072],
       device='cuda:0'), range: [-3.5034, 3.9799]
2025-04-15 07:32:03,261 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:03,261 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5979, 3.4363]
2025-04-15 07:32:03,261 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8903, 2.7943]
2025-04-15 07:32:03,261 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,261 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,262 - INFO -   True actions shape: tensor([-1.0737,  0.2093, -0.9540, -0.3510, -0.0135, -0.1572,  1.3581],
       device='cuda:0'), range: [-3.5979, 3.4363]
2025-04-15 07:32:03,263 - INFO -   Noise shape: tensor([-0.9962,  0.3971,  1.0163,  0.1316, -0.3681, -0.7784, -1.6335],
       device='cuda:0'), range: [-3.5265, 2.9825]
2025-04-15 07:32:03,263 - INFO -   Noisy actions shape: tensor([-1.4369,  0.3867, -0.2779, -0.2296, -0.2048, -0.5426,  0.2976],
       device='cuda:0'), range: [-3.2429, 3.5398]
2025-04-15 07:32:03,307 - INFO - 
=== Epoch 2 Summary ===
2025-04-15 07:32:03,307 - INFO -   Avg total loss: 3.670229
2025-04-15 07:32:03,307 - INFO -   Avg diffusion loss: 2.911043
2025-04-15 07:32:03,307 - INFO -   Avg grasp loss: 1.518373
2025-04-15 07:32:03,307 - INFO - 
=== EPOCH 3/20 ===
2025-04-15 07:32:03,308 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:03,311 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:03,311 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9790, 3.6855]
2025-04-15 07:32:03,311 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2343, 2.7658]
2025-04-15 07:32:03,311 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,312 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,312 - INFO -   True actions shape: tensor([-0.7148,  1.4175,  0.4053, -1.2012,  0.4120, -0.9617, -0.0972],
       device='cuda:0'), range: [-3.9790, 3.6855]
2025-04-15 07:32:03,313 - INFO -   Noise shape: tensor([ 0.2374, -0.3149,  0.2592,  1.4852,  1.1901,  0.4050,  0.3643],
       device='cuda:0'), range: [-3.3944, 3.5128]
2025-04-15 07:32:03,313 - INFO -   Noisy actions shape: tensor([-5.8890e-02,  2.6048e-01,  3.9629e-01,  9.0195e-01,  1.2567e+00,
        -3.9682e-04,  2.9795e-01], device='cuda:0'), range: [-3.8308, 3.5363]
2025-04-15 07:32:03,314 - INFO -   Diffusion: timestep range [94, 743], noise range [-3.3944, 3.5128]
2025-04-15 07:32:03,314 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.8308, 3.5363]
2025-04-15 07:32:03,336 - INFO -   Model output shapes:
2025-04-15 07:32:03,336 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:03,337 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.3686, 0.5339]
2025-04-15 07:32:03,337 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5585
2025-04-15 07:32:03,337 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.3193, 0.3941]
2025-04-15 07:32:03,358 - INFO -   Loss components:
2025-04-15 07:32:03,358 - INFO -     Diffusion loss: 2.946294 (coef: 1.0)
2025-04-15 07:32:03,358 - INFO -     Grasp quality loss: 0.702484 (coef: 0.5)
2025-04-15 07:32:03,358 - INFO -     Grasp rotation loss: 0.556031 (coef: 0.5)
2025-04-15 07:32:03,358 - INFO -     Grasp width loss: 23.481134 (coef: 0.005)
2025-04-15 07:32:03,358 - INFO -     TOTAL loss: 3.692957
2025-04-15 07:32:03,366 - INFO -   Gradients: avg norm: 0.800353, max norm: 5.973824, non-zero params: 250
2025-04-15 07:32:03,366 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-15 07:32:03,366 - INFO - --- Gradient Check @ Epoch 3, Batch 0 ---
2025-04-15 07:32:03,384 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:03,384 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:03,384 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.2544e+00, MaxNorm=5.6589e+00
2025-04-15 07:32:03,384 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=3.8175e-02, MaxNorm=9.3941e-02
2025-04-15 07:32:03,384 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.1288e-03, MaxNorm=2.7347e-02
2025-04-15 07:32:03,384 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.5269e-01, MaxNorm=8.7546e-01
2025-04-15 07:32:03,384 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.0044e+00, MaxNorm=3.7175e+00
2025-04-15 07:32:03,384 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=2.0526e+00, MaxNorm=3.7130e+00
2025-04-15 07:32:03,384 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.4574e-01, MaxNorm=1.0869e+00
2025-04-15 07:32:03,384 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.3856e+00, MaxNorm=1.3890e+00
2025-04-15 07:32:03,384 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.8096e+00, MaxNorm=1.8632e+00
2025-04-15 07:32:03,384 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.2673e+00, MaxNorm=5.9738e+00
2025-04-15 07:32:03,384 - INFO - --- End Gradient Check ---
2025-04-15 07:32:03,387 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:03,387 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0336, 3.1520]
2025-04-15 07:32:03,387 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5752, 2.9666]
2025-04-15 07:32:03,387 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,387 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,388 - INFO -   True actions shape: tensor([ 0.5867, -0.7810,  1.0454,  0.2293, -1.6889, -0.9975, -1.4155],
       device='cuda:0'), range: [-4.0336, 3.1520]
2025-04-15 07:32:03,388 - INFO -   Noise shape: tensor([ 0.3213,  0.3307,  0.8368, -0.9630,  0.2749, -1.0663, -0.3538],
       device='cuda:0'), range: [-3.8342, 2.6851]
2025-04-15 07:32:03,389 - INFO -   Noisy actions shape: tensor([ 0.6610, -0.4183,  1.3388, -0.4043, -1.1727, -1.4405, -1.3384],
       device='cuda:0'), range: [-4.1426, 3.0520]
2025-04-15 07:32:03,435 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:03,435 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9946, 3.2348]
2025-04-15 07:32:03,435 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4522, 2.8209]
2025-04-15 07:32:03,436 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,436 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,436 - INFO -   True actions shape: tensor([ 0.8814,  0.6136, -1.5060, -0.4361,  0.4916,  0.9949, -0.0879],
       device='cuda:0'), range: [-3.9946, 3.2348]
2025-04-15 07:32:03,437 - INFO -   Noise shape: tensor([ 0.4095, -1.1870, -0.4952, -1.2572,  0.5139,  0.5685,  0.7474],
       device='cuda:0'), range: [-3.2758, 3.4559]
2025-04-15 07:32:03,438 - INFO -   Noisy actions shape: tensor([ 0.9503,  0.3345, -1.5784, -0.7046,  0.5935,  1.0964,  0.0803],
       device='cuda:0'), range: [-3.1829, 3.6223]
2025-04-15 07:32:03,484 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:03,484 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9542, 3.8577]
2025-04-15 07:32:03,484 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5980, 2.9763]
2025-04-15 07:32:03,484 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,484 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,485 - INFO -   True actions shape: tensor([ 0.1920, -0.0538,  0.6608, -1.2038, -0.9785, -0.9553,  0.3767],
       device='cuda:0'), range: [-2.9542, 3.8577]
2025-04-15 07:32:03,486 - INFO -   Noise shape: tensor([-0.1231, -1.9900, -0.8616,  1.8326,  0.3094, -0.1868,  0.9837],
       device='cuda:0'), range: [-3.9269, 3.2832]
2025-04-15 07:32:03,486 - INFO -   Noisy actions shape: tensor([ 0.1884, -0.1106,  0.6359, -1.1510, -0.9693, -0.9602,  0.4046],
       device='cuda:0'), range: [-3.7500, 3.9082]
2025-04-15 07:32:03,533 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:03,533 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2797, 3.2136]
2025-04-15 07:32:03,533 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8823, 3.3037]
2025-04-15 07:32:03,533 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,533 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,534 - INFO -   True actions shape: tensor([ 0.1706, -0.9970,  1.7143,  0.0618, -0.3564,  0.9994,  1.1362],
       device='cuda:0'), range: [-3.2797, 3.2136]
2025-04-15 07:32:03,534 - INFO -   Noise shape: tensor([-0.6337,  0.6917, -1.5574,  1.1465,  2.1864,  0.2809, -0.3484],
       device='cuda:0'), range: [-3.6147, 2.9169]
2025-04-15 07:32:03,535 - INFO -   Noisy actions shape: tensor([-0.3167, -0.2382,  0.1544,  0.8399,  1.2600,  0.9147,  0.5767],
       device='cuda:0'), range: [-3.8570, 3.4702]
2025-04-15 07:32:03,581 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:03,581 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7004, 4.1759]
2025-04-15 07:32:03,581 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2540, 3.0854]
2025-04-15 07:32:03,581 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,581 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,582 - INFO -   True actions shape: tensor([-0.1567,  0.1085,  1.4367,  3.1043, -1.2802,  0.5156, -0.4294],
       device='cuda:0'), range: [-3.7004, 4.1759]
2025-04-15 07:32:03,583 - INFO -   Noise shape: tensor([-0.5352,  0.3260,  0.4591, -0.3607,  0.2252, -0.1354, -0.1290],
       device='cuda:0'), range: [-3.2195, 3.4340]
2025-04-15 07:32:03,583 - INFO -   Noisy actions shape: tensor([-0.5571,  0.3436,  0.8947,  0.6516, -0.1962,  0.0368, -0.2596],
       device='cuda:0'), range: [-3.4196, 3.4477]
2025-04-15 07:32:03,629 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:03,629 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3373, 3.0704]
2025-04-15 07:32:03,629 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.4529, 3.8955]
2025-04-15 07:32:03,630 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,630 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,630 - INFO -   True actions shape: tensor([ 0.8780,  0.6089,  1.7524, -0.2518, -1.2321,  0.1722, -0.2758],
       device='cuda:0'), range: [-3.3373, 3.0704]
2025-04-15 07:32:03,631 - INFO -   Noise shape: tensor([-0.4444, -1.4145, -0.2330,  0.6319, -0.5900, -1.0060,  1.2760],
       device='cuda:0'), range: [-3.2843, 2.8606]
2025-04-15 07:32:03,632 - INFO -   Noisy actions shape: tensor([ 0.3515, -0.4998,  1.1410,  0.2382, -1.3089, -0.5486,  0.6533],
       device='cuda:0'), range: [-3.6149, 3.0565]
2025-04-15 07:32:03,678 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:03,678 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5579, 3.8161]
2025-04-15 07:32:03,678 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6329, 3.4659]
2025-04-15 07:32:03,678 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,678 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,679 - INFO -   True actions shape: tensor([-1.3852, -1.5036,  1.6151,  1.2054,  0.8282,  0.5059,  1.3142],
       device='cuda:0'), range: [-3.5579, 3.8161]
2025-04-15 07:32:03,680 - INFO -   Noise shape: tensor([-1.4465, -0.3461,  0.4479, -1.2914,  1.6083,  0.4465,  3.2888],
       device='cuda:0'), range: [-3.5063, 3.6779]
2025-04-15 07:32:03,680 - INFO -   Noisy actions shape: tensor([-1.9760, -1.1346,  1.2816, -0.3852,  1.7951,  0.6542,  3.4564],
       device='cuda:0'), range: [-3.5134, 3.4564]
2025-04-15 07:32:03,727 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:03,727 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2770, 3.7624]
2025-04-15 07:32:03,727 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4085, 3.0268]
2025-04-15 07:32:03,727 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,727 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,728 - INFO -   True actions shape: tensor([ 0.8939,  0.9609, -0.8961, -0.0314,  0.6881, -1.6431, -0.4894],
       device='cuda:0'), range: [-3.2770, 3.7624]
2025-04-15 07:32:03,729 - INFO -   Noise shape: tensor([-1.0589,  0.7433, -0.8084, -0.8607,  0.8989, -1.1234, -0.8488],
       device='cuda:0'), range: [-3.3074, 3.1538]
2025-04-15 07:32:03,729 - INFO -   Noisy actions shape: tensor([ 0.1401,  1.2128, -1.1961, -0.5118,  1.0754, -1.9904, -0.8831],
       device='cuda:0'), range: [-3.1141, 3.6890]
2025-04-15 07:32:03,775 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:03,775 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8219, 4.1198]
2025-04-15 07:32:03,776 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8540, 4.3400]
2025-04-15 07:32:03,776 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,776 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,777 - INFO -   True actions shape: tensor([-0.1661, -2.1933,  0.6228,  1.2063,  0.6478,  0.8153,  1.4638],
       device='cuda:0'), range: [-3.8219, 4.1198]
2025-04-15 07:32:03,777 - INFO -   Noise shape: tensor([ 0.6113,  1.8190,  0.2821,  1.2906, -0.0464,  0.0546, -0.4663],
       device='cuda:0'), range: [-3.5953, 3.5816]
2025-04-15 07:32:03,778 - INFO -   Noisy actions shape: tensor([0.4728, 0.6483, 0.5305, 1.6935, 0.2477, 0.4129, 0.2364],
       device='cuda:0'), range: [-3.9387, 3.2999]
2025-04-15 07:32:03,824 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:03,824 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5443, 4.2180]
2025-04-15 07:32:03,824 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9556, 3.3067]
2025-04-15 07:32:03,824 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,824 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,825 - INFO -   True actions shape: tensor([ 0.2863, -0.1191, -1.3738, -0.6877, -1.2450,  0.6280, -0.9033],
       device='cuda:0'), range: [-3.5443, 4.2180]
2025-04-15 07:32:03,826 - INFO -   Noise shape: tensor([ 1.0972,  1.6216,  2.1932, -1.1521, -0.0356, -0.1723, -1.6583],
       device='cuda:0'), range: [-3.8384, 3.2894]
2025-04-15 07:32:03,826 - INFO -   Noisy actions shape: tensor([ 1.1138,  1.4131,  1.3901, -1.3358, -0.5671,  0.1143, -1.8855],
       device='cuda:0'), range: [-3.8165, 3.8863]
2025-04-15 07:32:03,869 - INFO -   Loss components:
2025-04-15 07:32:03,869 - INFO -     Diffusion loss: 2.790733 (coef: 1.0)
2025-04-15 07:32:03,869 - INFO -     Grasp quality loss: 0.689949 (coef: 0.5)
2025-04-15 07:32:03,869 - INFO -     Grasp rotation loss: 0.574509 (coef: 0.5)
2025-04-15 07:32:03,870 - INFO -     Grasp width loss: 17.509125 (coef: 0.005)
2025-04-15 07:32:03,870 - INFO -     TOTAL loss: 3.510508
2025-04-15 07:32:03,878 - INFO -   Gradients: avg norm: 0.786285, max norm: 5.716772, non-zero params: 250
2025-04-15 07:32:03,878 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-15 07:32:03,880 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:03,880 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1627, 3.8901]
2025-04-15 07:32:03,881 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5455, 2.9230]
2025-04-15 07:32:03,881 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,881 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,881 - INFO -   True actions shape: tensor([ 0.7566, -0.3878,  0.9816,  0.2378,  1.6236,  1.0229,  2.8233],
       device='cuda:0'), range: [-3.1627, 3.8901]
2025-04-15 07:32:03,882 - INFO -   Noise shape: tensor([ 0.3606, -1.5230,  1.4768,  0.2995,  0.6426,  0.5174,  1.2663],
       device='cuda:0'), range: [-3.6018, 3.4851]
2025-04-15 07:32:03,883 - INFO -   Noisy actions shape: tensor([ 0.7877, -0.5317,  1.1183,  0.2654,  1.6777,  1.0678,  2.9315],
       device='cuda:0'), range: [-3.7538, 3.8907]
2025-04-15 07:32:03,929 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:03,929 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0661, 3.5042]
2025-04-15 07:32:03,929 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4244, 3.1736]
2025-04-15 07:32:03,929 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,929 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,930 - INFO -   True actions shape: tensor([ 0.4471, -0.5936, -0.2274, -0.6616,  0.5902, -0.8708, -0.4831],
       device='cuda:0'), range: [-3.0661, 3.5042]
2025-04-15 07:32:03,930 - INFO -   Noise shape: tensor([ 0.9032, -1.0378, -1.5110,  0.5449, -0.2913,  0.1019, -0.4424],
       device='cuda:0'), range: [-3.7634, 3.8596]
2025-04-15 07:32:03,931 - INFO -   Noisy actions shape: tensor([ 0.8812, -1.0783, -1.0459, -0.2347,  0.3200, -0.6586, -0.6489],
       device='cuda:0'), range: [-3.1766, 3.6162]
2025-04-15 07:32:03,975 - INFO - 
=== Epoch 3 Summary ===
2025-04-15 07:32:03,975 - INFO -   Avg total loss: 3.519864
2025-04-15 07:32:03,975 - INFO -   Avg diffusion loss: 2.783346
2025-04-15 07:32:03,975 - INFO -   Avg grasp loss: 1.473038
2025-04-15 07:32:03,975 - INFO - 
=== EPOCH 4/20 ===
2025-04-15 07:32:03,976 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:03,979 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:03,979 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5278, 3.3894]
2025-04-15 07:32:03,979 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7977, 2.9327]
2025-04-15 07:32:03,979 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:03,979 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:03,980 - INFO -   True actions shape: tensor([ 1.0462,  2.2106, -0.2289,  2.1431,  0.3704,  0.0958,  0.9483],
       device='cuda:0'), range: [-3.5278, 3.3894]
2025-04-15 07:32:03,980 - INFO -   Noise shape: tensor([-1.7615,  0.7458, -0.0848,  0.4366, -1.0205, -1.7805, -0.7975],
       device='cuda:0'), range: [-3.5655, 3.3001]
2025-04-15 07:32:03,981 - INFO -   Noisy actions shape: tensor([ 0.4281,  2.3331, -0.2440,  2.1702,  0.0247, -0.4786,  0.6435],
       device='cuda:0'), range: [-3.5289, 3.4010]
2025-04-15 07:32:03,981 - INFO -   Diffusion: timestep range [5, 917], noise range [-3.5655, 3.3001]
2025-04-15 07:32:03,981 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5289, 3.4010]
2025-04-15 07:32:04,003 - INFO -   Model output shapes:
2025-04-15 07:32:04,003 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:04,003 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4216, 0.6076]
2025-04-15 07:32:04,004 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5835
2025-04-15 07:32:04,004 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2344, 0.3072]
2025-04-15 07:32:04,025 - INFO -   Loss components:
2025-04-15 07:32:04,025 - INFO -     Diffusion loss: 2.834831 (coef: 1.0)
2025-04-15 07:32:04,025 - INFO -     Grasp quality loss: 0.696138 (coef: 0.5)
2025-04-15 07:32:04,026 - INFO -     Grasp rotation loss: 0.579363 (coef: 0.5)
2025-04-15 07:32:04,026 - INFO -     Grasp width loss: 13.561319 (coef: 0.005)
2025-04-15 07:32:04,026 - INFO -     TOTAL loss: 3.540387
2025-04-15 07:32:04,034 - INFO -   Gradients: avg norm: 0.687742, max norm: 5.287816, non-zero params: 250
2025-04-15 07:32:04,034 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-15 07:32:04,034 - INFO - --- Gradient Check @ Epoch 4, Batch 0 ---
2025-04-15 07:32:04,051 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:04,051 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:04,051 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1119e+00, MaxNorm=4.8035e+00
2025-04-15 07:32:04,051 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.6395e-02, MaxNorm=6.3712e-02
2025-04-15 07:32:04,051 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=6.1771e-03, MaxNorm=1.4210e-02
2025-04-15 07:32:04,051 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.6749e-01, MaxNorm=5.4965e-01
2025-04-15 07:32:04,051 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.8614e+00, MaxNorm=3.4893e+00
2025-04-15 07:32:04,051 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.9157e+00, MaxNorm=3.5086e+00
2025-04-15 07:32:04,051 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.9609e-01, MaxNorm=8.6799e-01
2025-04-15 07:32:04,051 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=7.7633e-01, MaxNorm=8.6274e-01
2025-04-15 07:32:04,051 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.5428e+00, MaxNorm=1.5537e+00
2025-04-15 07:32:04,051 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.9040e+00, MaxNorm=5.2878e+00
2025-04-15 07:32:04,051 - INFO - --- End Gradient Check ---
2025-04-15 07:32:04,054 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:04,054 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7831, 3.4799]
2025-04-15 07:32:04,054 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7532, 3.4187]
2025-04-15 07:32:04,054 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,054 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,055 - INFO -   True actions shape: tensor([-0.0729,  1.5748, -0.5052, -1.1193, -0.4113,  0.3718, -0.4015],
       device='cuda:0'), range: [-3.7831, 3.4799]
2025-04-15 07:32:04,056 - INFO -   Noise shape: tensor([ 0.9385, -0.5136, -0.2073, -1.1283,  0.7450,  0.0401, -1.1662],
       device='cuda:0'), range: [-3.5998, 3.4250]
2025-04-15 07:32:04,056 - INFO -   Noisy actions shape: tensor([ 0.4192,  1.0879, -0.5399, -1.5398,  0.0295,  0.3397, -0.9432],
       device='cuda:0'), range: [-3.5949, 3.1260]
2025-04-15 07:32:04,102 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:04,103 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6848, 3.4180]
2025-04-15 07:32:04,103 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0439, 2.9330]
2025-04-15 07:32:04,103 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,103 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,104 - INFO -   True actions shape: tensor([-1.1860, -0.8055,  0.9595,  0.6633,  1.3179, -0.5919, -1.3238],
       device='cuda:0'), range: [-3.6848, 3.4180]
2025-04-15 07:32:04,104 - INFO -   Noise shape: tensor([-0.5210,  0.5491, -0.6440, -0.7563, -0.1663, -1.9467,  0.0048],
       device='cuda:0'), range: [-3.4990, 3.3685]
2025-04-15 07:32:04,105 - INFO -   Noisy actions shape: tensor([-0.6488,  0.4568, -0.5341, -0.6784, -0.0197, -2.0001, -0.1414],
       device='cuda:0'), range: [-3.6550, 3.3233]
2025-04-15 07:32:04,151 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:04,151 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2207, 3.2802]
2025-04-15 07:32:04,151 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1793, 3.1456]
2025-04-15 07:32:04,151 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,151 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,152 - INFO -   True actions shape: tensor([ 0.3973, -0.2283,  0.0257,  0.9211, -0.7614, -0.8454,  0.5531],
       device='cuda:0'), range: [-3.2207, 3.2802]
2025-04-15 07:32:04,152 - INFO -   Noise shape: tensor([ 0.1138,  0.5964,  2.4408,  0.4503, -0.8817,  2.5864,  0.6770],
       device='cuda:0'), range: [-3.2474, 3.4539]
2025-04-15 07:32:04,153 - INFO -   Noisy actions shape: tensor([ 0.3447,  0.3049,  1.8716,  0.9409, -1.1649,  1.4160,  0.8740],
       device='cuda:0'), range: [-3.6038, 3.2567]
2025-04-15 07:32:04,199 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:04,199 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7168, 3.8005]
2025-04-15 07:32:04,199 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1653, 3.7372]
2025-04-15 07:32:04,199 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,199 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,200 - INFO -   True actions shape: tensor([-0.9541, -0.4264,  0.1396,  0.4199, -0.1291,  0.0583,  0.0291],
       device='cuda:0'), range: [-3.7168, 3.8005]
2025-04-15 07:32:04,200 - INFO -   Noise shape: tensor([-0.5925,  1.1036, -1.1375,  1.1895, -0.9692,  2.0750,  0.0500],
       device='cuda:0'), range: [-4.4650, 3.4072]
2025-04-15 07:32:04,201 - INFO -   Noisy actions shape: tensor([-1.1231,  0.2223, -0.4836,  0.9858, -0.6225,  1.1477,  0.0511],
       device='cuda:0'), range: [-4.6745, 3.7257]
2025-04-15 07:32:04,247 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:04,247 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7198, 3.3317]
2025-04-15 07:32:04,247 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0640, 2.8185]
2025-04-15 07:32:04,247 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,247 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,248 - INFO -   True actions shape: tensor([-0.5464,  0.8363, -0.3571, -0.0533,  0.8631,  0.6434,  1.1445],
       device='cuda:0'), range: [-3.7198, 3.3317]
2025-04-15 07:32:04,248 - INFO -   Noise shape: tensor([ 1.5871,  2.3193, -2.1366, -0.4075,  0.3354,  0.5087,  0.1035],
       device='cuda:0'), range: [-3.7516, 3.2295]
2025-04-15 07:32:04,249 - INFO -   Noisy actions shape: tensor([ 1.0077,  2.3893, -1.9693, -0.3673,  0.7617,  0.7820,  0.7275],
       device='cuda:0'), range: [-4.1127, 3.9685]
2025-04-15 07:32:04,294 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:04,295 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7337, 3.0719]
2025-04-15 07:32:04,295 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2484, 3.0945]
2025-04-15 07:32:04,295 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,295 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,296 - INFO -   True actions shape: tensor([ 1.1175, -1.4544,  0.1736, -0.2054, -0.4516, -0.8611, -0.0017],
       device='cuda:0'), range: [-3.7337, 3.0719]
2025-04-15 07:32:04,296 - INFO -   Noise shape: tensor([-0.2046,  0.4501,  0.0420, -0.1253, -0.0209, -0.8982, -0.9330],
       device='cuda:0'), range: [-3.1189, 3.6771]
2025-04-15 07:32:04,297 - INFO -   Noisy actions shape: tensor([ 0.7395, -0.8468,  0.1613, -0.2385, -0.3641, -1.2345, -0.5887],
       device='cuda:0'), range: [-4.1773, 3.0503]
2025-04-15 07:32:04,342 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:04,342 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6470, 3.4048]
2025-04-15 07:32:04,343 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0929, 3.0475]
2025-04-15 07:32:04,343 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,343 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,343 - INFO -   True actions shape: tensor([ 0.6054,  1.3297,  1.3275, -0.0887,  0.1923,  2.0422,  0.8659],
       device='cuda:0'), range: [-3.6470, 3.4048]
2025-04-15 07:32:04,344 - INFO -   Noise shape: tensor([ 0.6046, -0.5550, -1.1627, -0.6637, -0.0325,  0.2056, -1.7859],
       device='cuda:0'), range: [-3.8347, 3.9875]
2025-04-15 07:32:04,345 - INFO -   Noisy actions shape: tensor([ 0.8445,  0.3278, -0.1663, -0.5901,  0.0861,  1.3615, -0.9418],
       device='cuda:0'), range: [-3.0983, 3.9788]
2025-04-15 07:32:04,390 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:04,390 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8530, 2.9811]
2025-04-15 07:32:04,390 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7117, 3.1115]
2025-04-15 07:32:04,391 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,391 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,391 - INFO -   True actions shape: tensor([-0.1086, -0.2956,  0.4738, -0.2218,  0.4678, -0.7868,  1.1674],
       device='cuda:0'), range: [-3.8530, 2.9811]
2025-04-15 07:32:04,392 - INFO -   Noise shape: tensor([ 0.6816,  0.0902, -0.3434, -1.2730,  0.6855, -0.2212,  1.4377],
       device='cuda:0'), range: [-3.8446, 3.5768]
2025-04-15 07:32:04,392 - INFO -   Noisy actions shape: tensor([ 0.5626, -0.0503, -0.0975, -1.2393,  0.8219, -0.5473,  1.8064],
       device='cuda:0'), range: [-3.9351, 3.8310]
2025-04-15 07:32:04,438 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:04,438 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7469, 3.5434]
2025-04-15 07:32:04,438 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7435, 3.3414]
2025-04-15 07:32:04,439 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,439 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,439 - INFO -   True actions shape: tensor([-0.8599, -1.7073,  0.5525,  1.1319,  1.6595,  0.5294,  0.9059],
       device='cuda:0'), range: [-3.7469, 3.5434]
2025-04-15 07:32:04,440 - INFO -   Noise shape: tensor([ 0.5728, -1.0245,  2.2332,  1.8231, -1.3575, -1.0953, -0.4836],
       device='cuda:0'), range: [-3.5121, 3.1870]
2025-04-15 07:32:04,441 - INFO -   Noisy actions shape: tensor([-0.7285, -1.8772,  0.9865,  1.4726,  1.3557,  0.3005,  0.7914],
       device='cuda:0'), range: [-3.6696, 3.0217]
2025-04-15 07:32:04,486 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:04,487 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6209, 3.3030]
2025-04-15 07:32:04,487 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9125, 2.9977]
2025-04-15 07:32:04,487 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,487 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,488 - INFO -   True actions shape: tensor([-0.7403, -0.9625, -0.1132, -0.6865,  0.2550,  1.0024,  0.0101],
       device='cuda:0'), range: [-3.6209, 3.3030]
2025-04-15 07:32:04,488 - INFO -   Noise shape: tensor([-0.6281,  0.2208, -1.3839, -1.8767,  0.8760,  1.1797, -0.9384],
       device='cuda:0'), range: [-3.9634, 3.3481]
2025-04-15 07:32:04,489 - INFO -   Noisy actions shape: tensor([-0.7567,  0.0350, -1.3804, -1.9727,  0.9084,  1.3479, -0.9196],
       device='cuda:0'), range: [-3.2174, 3.2915]
2025-04-15 07:32:04,534 - INFO -   Loss components:
2025-04-15 07:32:04,534 - INFO -     Diffusion loss: 2.280117 (coef: 1.0)
2025-04-15 07:32:04,534 - INFO -     Grasp quality loss: 0.695734 (coef: 0.5)
2025-04-15 07:32:04,534 - INFO -     Grasp rotation loss: 0.587649 (coef: 0.5)
2025-04-15 07:32:04,534 - INFO -     Grasp width loss: 8.601219 (coef: 0.005)
2025-04-15 07:32:04,534 - INFO -     TOTAL loss: 2.964814
2025-04-15 07:32:04,542 - INFO -   Gradients: avg norm: 0.573801, max norm: 4.572788, non-zero params: 250
2025-04-15 07:32:04,542 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-15 07:32:04,545 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:04,545 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1318, 3.1575]
2025-04-15 07:32:04,545 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5077, 2.6629]
2025-04-15 07:32:04,545 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,545 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,546 - INFO -   True actions shape: tensor([ 1.4136, -1.0341,  0.0331, -0.1308,  0.5595, -0.4585, -0.4926],
       device='cuda:0'), range: [-3.1318, 3.1575]
2025-04-15 07:32:04,547 - INFO -   Noise shape: tensor([-0.3667,  0.4962,  1.4980,  0.9951,  0.8392, -0.2026,  0.7517],
       device='cuda:0'), range: [-3.4447, 3.9205]
2025-04-15 07:32:04,547 - INFO -   Noisy actions shape: tensor([ 1.2947, -0.8958,  0.3697,  0.0967,  0.7341, -0.4923, -0.3106],
       device='cuda:0'), range: [-3.4696, 3.9002]
2025-04-15 07:32:04,593 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:04,593 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2206, 3.0534]
2025-04-15 07:32:04,593 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2955, 3.2650]
2025-04-15 07:32:04,593 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,593 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,594 - INFO -   True actions shape: tensor([-0.3894,  1.8075,  0.0188,  0.7418,  0.2030,  0.6154,  1.5747],
       device='cuda:0'), range: [-3.2206, 3.0534]
2025-04-15 07:32:04,595 - INFO -   Noise shape: tensor([-1.4973, -0.2194, -1.3471, -0.1957,  0.2577, -0.8602,  0.3861],
       device='cuda:0'), range: [-3.8505, 3.3665]
2025-04-15 07:32:04,595 - INFO -   Noisy actions shape: tensor([-1.5449,  0.3371, -1.2785,  0.0376,  0.3070, -0.6340,  0.8439],
       device='cuda:0'), range: [-4.3076, 3.3590]
2025-04-15 07:32:04,639 - INFO - 
=== Epoch 4 Summary ===
2025-04-15 07:32:04,639 - INFO -   Avg total loss: 3.174669
2025-04-15 07:32:04,639 - INFO -   Avg diffusion loss: 2.485804
2025-04-15 07:32:04,639 - INFO -   Avg grasp loss: 1.377730
2025-04-15 07:32:04,639 - INFO - 
=== EPOCH 5/20 ===
2025-04-15 07:32:04,640 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:04,643 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:04,643 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9763, 3.6827]
2025-04-15 07:32:04,643 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2303, 3.3178]
2025-04-15 07:32:04,643 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,643 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,644 - INFO -   True actions shape: tensor([-1.5192, -0.5380,  1.1677, -0.1515,  0.6006,  0.3342, -0.4471],
       device='cuda:0'), range: [-3.9763, 3.6827]
2025-04-15 07:32:04,644 - INFO -   Noise shape: tensor([-0.9323,  3.8268,  0.5034, -1.1162, -0.3642, -1.6529,  1.7230],
       device='cuda:0'), range: [-3.0949, 3.9372]
2025-04-15 07:32:04,645 - INFO -   Noisy actions shape: tensor([-1.4111,  3.3862,  0.8853, -1.0972, -0.1271, -1.4264,  1.4518],
       device='cuda:0'), range: [-3.6657, 3.7943]
2025-04-15 07:32:04,645 - INFO -   Diffusion: timestep range [214, 766], noise range [-3.0949, 3.9372]
2025-04-15 07:32:04,645 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6657, 3.7943]
2025-04-15 07:32:04,667 - INFO -   Model output shapes:
2025-04-15 07:32:04,667 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:04,667 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4297, 0.6108]
2025-04-15 07:32:04,667 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6049
2025-04-15 07:32:04,667 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1682, 0.3151]
2025-04-15 07:32:04,689 - INFO -   Loss components:
2025-04-15 07:32:04,689 - INFO -     Diffusion loss: 2.778620 (coef: 1.0)
2025-04-15 07:32:04,689 - INFO -     Grasp quality loss: 0.694034 (coef: 0.5)
2025-04-15 07:32:04,689 - INFO -     Grasp rotation loss: 0.575299 (coef: 0.5)
2025-04-15 07:32:04,689 - INFO -     Grasp width loss: 9.887634 (coef: 0.005)
2025-04-15 07:32:04,689 - INFO -     TOTAL loss: 3.462724
2025-04-15 07:32:04,697 - INFO -   Gradients: avg norm: 0.679555, max norm: 5.505526, non-zero params: 250
2025-04-15 07:32:04,697 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-15 07:32:04,697 - INFO - --- Gradient Check @ Epoch 5, Batch 0 ---
2025-04-15 07:32:04,714 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:04,714 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:04,714 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=1.1186e+00, MaxNorm=4.8557e+00
2025-04-15 07:32:04,714 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.3186e-02, MaxNorm=2.6990e-02
2025-04-15 07:32:04,714 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.6973e-02, MaxNorm=3.7954e-02
2025-04-15 07:32:04,714 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.6323e-01, MaxNorm=3.0971e-01
2025-04-15 07:32:04,714 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=2.0282e+00, MaxNorm=3.8153e+00
2025-04-15 07:32:04,714 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.9034e+00, MaxNorm=3.4716e+00
2025-04-15 07:32:04,714 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=2.1243e-01, MaxNorm=9.6503e-01
2025-04-15 07:32:04,714 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.4304e-01, MaxNorm=7.0765e-01
2025-04-15 07:32:04,714 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6246e+00, MaxNorm=1.7013e+00
2025-04-15 07:32:04,714 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=3.0227e+00, MaxNorm=5.5055e+00
2025-04-15 07:32:04,714 - INFO - --- End Gradient Check ---
2025-04-15 07:32:04,717 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:04,717 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4723, 3.8495]
2025-04-15 07:32:04,717 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5412, 2.9974]
2025-04-15 07:32:04,717 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,717 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,718 - INFO -   True actions shape: tensor([-2.3974, -1.0450, -0.3941,  0.7486, -0.6709, -1.2850, -0.6391],
       device='cuda:0'), range: [-3.4723, 3.8495]
2025-04-15 07:32:04,719 - INFO -   Noise shape: tensor([ 0.2141, -0.6348, -0.0995, -2.6814, -0.7002, -1.6324,  0.3555],
       device='cuda:0'), range: [-3.2310, 3.9834]
2025-04-15 07:32:04,719 - INFO -   Noisy actions shape: tensor([-0.0932, -0.7628, -0.1489, -2.5641, -0.7800, -1.7828,  0.2711],
       device='cuda:0'), range: [-3.3643, 4.1710]
2025-04-15 07:32:04,765 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:04,765 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2740, 3.8257]
2025-04-15 07:32:04,765 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2477, 3.3989]
2025-04-15 07:32:04,765 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,765 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,766 - INFO -   True actions shape: tensor([-0.0319,  1.6485,  1.0294,  0.9240,  0.2238,  1.3457,  0.3548],
       device='cuda:0'), range: [-3.2740, 3.8257]
2025-04-15 07:32:04,767 - INFO -   Noise shape: tensor([ 0.6794, -0.8987, -0.3301,  0.7236, -1.1142, -0.7277, -0.0072],
       device='cuda:0'), range: [-3.6272, 3.2638]
2025-04-15 07:32:04,767 - INFO -   Noisy actions shape: tensor([0.0407, 1.5433, 0.9883, 0.9959, 0.1038, 1.2604, 0.3520],
       device='cuda:0'), range: [-3.3610, 3.6850]
2025-04-15 07:32:04,813 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:04,813 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2500, 3.5899]
2025-04-15 07:32:04,813 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0836, 2.8771]
2025-04-15 07:32:04,813 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,813 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,814 - INFO -   True actions shape: tensor([ 1.3319,  1.6722,  0.4659,  0.8797, -2.1775,  0.1913,  0.6177],
       device='cuda:0'), range: [-3.2500, 3.5899]
2025-04-15 07:32:04,815 - INFO -   Noise shape: tensor([-0.3812, -0.8667, -0.2194, -2.3309, -0.8683, -0.2848,  0.0229],
       device='cuda:0'), range: [-3.7129, 2.8921]
2025-04-15 07:32:04,815 - INFO -   Noisy actions shape: tensor([ 1.2745,  1.5521,  0.4352,  0.5846, -2.2682,  0.1546,  0.6158],
       device='cuda:0'), range: [-3.3852, 3.6290]
2025-04-15 07:32:04,861 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:04,861 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0486, 4.1673]
2025-04-15 07:32:04,861 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2897, 2.8559]
2025-04-15 07:32:04,861 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,861 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,862 - INFO -   True actions shape: tensor([-0.4256,  0.2638,  1.4942,  0.0350,  0.2425, -0.9679, -0.4197],
       device='cuda:0'), range: [-3.0486, 4.1673]
2025-04-15 07:32:04,862 - INFO -   Noise shape: tensor([-1.0350, -1.8733, -1.0622,  0.1901, -0.5708,  0.6609, -0.1137],
       device='cuda:0'), range: [-3.0439, 3.1443]
2025-04-15 07:32:04,863 - INFO -   Noisy actions shape: tensor([-0.8828, -0.6998,  0.7709,  0.1246, -0.0725, -0.5129, -0.4209],
       device='cuda:0'), range: [-3.0017, 3.1599]
2025-04-15 07:32:04,908 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:04,909 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5965, 3.7448]
2025-04-15 07:32:04,909 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8054, 3.6271]
2025-04-15 07:32:04,909 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,909 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,910 - INFO -   True actions shape: tensor([-0.5547,  1.4020,  1.9013, -0.7230,  0.5162,  1.0010, -1.3163],
       device='cuda:0'), range: [-3.5965, 3.7448]
2025-04-15 07:32:04,910 - INFO -   Noise shape: tensor([ 2.5095,  0.4710, -1.2594,  0.3287,  0.9692,  1.1350, -0.9252],
       device='cuda:0'), range: [-3.7270, 3.0488]
2025-04-15 07:32:04,911 - INFO -   Noisy actions shape: tensor([ 1.6987,  1.2076,  0.1051, -0.1612,  1.0871,  1.5070, -1.5237],
       device='cuda:0'), range: [-3.8954, 2.9937]
2025-04-15 07:32:04,956 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:04,957 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5110, 3.5232]
2025-04-15 07:32:04,957 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7717, 3.0476]
2025-04-15 07:32:04,957 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:04,957 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:04,958 - INFO -   True actions shape: tensor([ 1.4484, -0.4913,  0.7837,  1.3758,  0.2134,  0.9280, -0.6319],
       device='cuda:0'), range: [-3.5110, 3.5232]
2025-04-15 07:32:04,958 - INFO -   Noise shape: tensor([-0.1783, -0.5086,  1.6197, -0.9868, -0.6273, -0.5918, -0.1913],
       device='cuda:0'), range: [-3.8840, 3.7984]
2025-04-15 07:32:04,959 - INFO -   Noisy actions shape: tensor([ 1.3859, -0.5809,  1.0840,  1.1573,  0.0872,  0.7950, -0.6570],
       device='cuda:0'), range: [-3.7503, 3.8039]
2025-04-15 07:32:05,005 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:05,005 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6322, 3.2703]
2025-04-15 07:32:05,005 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7921, 3.0249]
2025-04-15 07:32:05,005 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,005 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,006 - INFO -   True actions shape: tensor([ 0.6589,  0.6894,  2.1053, -0.4023, -1.0450, -0.0809, -0.6038],
       device='cuda:0'), range: [-3.6322, 3.2703]
2025-04-15 07:32:05,006 - INFO -   Noise shape: tensor([ 0.6162, -1.5442,  2.2167, -0.8721,  0.3633, -1.8999, -0.3579],
       device='cuda:0'), range: [-3.6802, 3.5729]
2025-04-15 07:32:05,007 - INFO -   Noisy actions shape: tensor([ 0.8966, -0.3725,  3.0135, -0.8444, -0.6195, -1.2023, -0.6979],
       device='cuda:0'), range: [-3.5075, 3.5464]
2025-04-15 07:32:05,053 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:05,053 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6167, 3.0886]
2025-04-15 07:32:05,053 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3704, 3.1380]
2025-04-15 07:32:05,053 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,053 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,054 - INFO -   True actions shape: tensor([ 0.4595, -1.4482,  0.3258,  0.0398, -0.5083,  0.7643, -0.9783],
       device='cuda:0'), range: [-3.6167, 3.0886]
2025-04-15 07:32:05,054 - INFO -   Noise shape: tensor([ 0.4064, -0.2969,  0.4695,  0.9863, -0.3179,  0.0587,  0.5771],
       device='cuda:0'), range: [-3.3911, 3.5648]
2025-04-15 07:32:05,055 - INFO -   Noisy actions shape: tensor([ 0.6070, -1.3743,  0.5298,  0.5734, -0.5994,  0.6716, -0.5025],
       device='cuda:0'), range: [-3.2833, 3.6871]
2025-04-15 07:32:05,100 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:05,101 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5916, 3.2801]
2025-04-15 07:32:05,101 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9415, 2.9951]
2025-04-15 07:32:05,101 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,101 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,102 - INFO -   True actions shape: tensor([ 0.0950, -1.2510, -0.8165,  1.4507, -0.1949,  0.6677,  0.5901],
       device='cuda:0'), range: [-3.5916, 3.2801]
2025-04-15 07:32:05,102 - INFO -   Noise shape: tensor([ 1.3484, -0.1824, -0.5325, -1.1754, -0.1574, -0.3168, -0.3411],
       device='cuda:0'), range: [-2.8147, 3.2769]
2025-04-15 07:32:05,103 - INFO -   Noisy actions shape: tensor([ 0.8738, -1.1168, -0.9733,  0.4751, -0.2502,  0.3512,  0.2743],
       device='cuda:0'), range: [-3.2123, 3.0473]
2025-04-15 07:32:05,148 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:05,149 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3354, 4.1089]
2025-04-15 07:32:05,149 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2247, 2.9902]
2025-04-15 07:32:05,149 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,149 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,150 - INFO -   True actions shape: tensor([-0.6876, -1.9873, -0.0460, -2.2932,  0.2851, -1.3725,  1.0450],
       device='cuda:0'), range: [-3.3354, 4.1089]
2025-04-15 07:32:05,150 - INFO -   Noise shape: tensor([ 0.9226,  0.8661,  2.4806,  2.8360, -0.2399,  0.5561, -0.6832],
       device='cuda:0'), range: [-3.6750, 3.3682]
2025-04-15 07:32:05,151 - INFO -   Noisy actions shape: tensor([ 0.2995, -0.5490,  1.9205,  0.8094, -0.0121, -0.4122,  0.1097],
       device='cuda:0'), range: [-3.7971, 3.4392]
2025-04-15 07:32:05,194 - INFO -   Loss components:
2025-04-15 07:32:05,194 - INFO -     Diffusion loss: 1.905578 (coef: 1.0)
2025-04-15 07:32:05,194 - INFO -     Grasp quality loss: 0.703457 (coef: 0.5)
2025-04-15 07:32:05,194 - INFO -     Grasp rotation loss: 0.579911 (coef: 0.5)
2025-04-15 07:32:05,194 - INFO -     Grasp width loss: 9.176487 (coef: 0.005)
2025-04-15 07:32:05,194 - INFO -     TOTAL loss: 2.593144
2025-04-15 07:32:05,202 - INFO -   Gradients: avg norm: 0.536144, max norm: 4.004243, non-zero params: 250
2025-04-15 07:32:05,202 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-15 07:32:05,205 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:05,205 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4439, 3.2529]
2025-04-15 07:32:05,205 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0076, 2.6239]
2025-04-15 07:32:05,205 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,205 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,206 - INFO -   True actions shape: tensor([0.5084, 0.4224, 0.3130, 0.1215, 1.0957, 0.8927, 1.3156],
       device='cuda:0'), range: [-3.4439, 3.2529]
2025-04-15 07:32:05,206 - INFO -   Noise shape: tensor([ 0.0189,  0.6049, -1.4204, -0.5410,  0.0282,  0.2447, -0.9333],
       device='cuda:0'), range: [-3.5604, 4.1698]
2025-04-15 07:32:05,207 - INFO -   Noisy actions shape: tensor([ 0.4730,  0.6302, -0.2854, -0.1066,  1.0144,  0.9157,  0.8286],
       device='cuda:0'), range: [-3.4524, 3.9855]
2025-04-15 07:32:05,253 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:05,253 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4751, 3.1626]
2025-04-15 07:32:05,253 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8399, 3.0714]
2025-04-15 07:32:05,253 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,253 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,254 - INFO -   True actions shape: tensor([ 0.1602, -1.2273, -0.5275,  0.0205, -1.4240,  0.8861,  0.0837],
       device='cuda:0'), range: [-3.4751, 3.1626]
2025-04-15 07:32:05,254 - INFO -   Noise shape: tensor([ 0.7437, -0.8395, -0.1424,  0.2591,  0.2646, -0.9394, -0.9925],
       device='cuda:0'), range: [-3.7456, 3.7039]
2025-04-15 07:32:05,255 - INFO -   Noisy actions shape: tensor([ 0.7607, -1.0884, -0.2547,  0.2573, -0.0545, -0.7219, -0.9499],
       device='cuda:0'), range: [-3.4909, 3.5699]
2025-04-15 07:32:05,299 - INFO - 
=== Epoch 5 Summary ===
2025-04-15 07:32:05,299 - INFO -   Avg total loss: 2.997712
2025-04-15 07:32:05,299 - INFO -   Avg diffusion loss: 2.318504
2025-04-15 07:32:05,299 - INFO -   Avg grasp loss: 1.358417
2025-04-15 07:32:05,504 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250415_073200/ckpt_epoch_5.pth
2025-04-15 07:32:05,504 - INFO - Saved model state with 16022452 parameters
2025-04-15 07:32:05,504 - INFO - 
=== EPOCH 6/20 ===
2025-04-15 07:32:05,505 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:05,508 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:05,509 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0202, 3.2304]
2025-04-15 07:32:05,509 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9347, 3.4329]
2025-04-15 07:32:05,509 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,509 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,510 - INFO -   True actions shape: tensor([ 2.1445, -0.3895,  1.2056, -0.0755,  0.7457, -1.1826, -0.3458],
       device='cuda:0'), range: [-4.0202, 3.2304]
2025-04-15 07:32:05,510 - INFO -   Noise shape: tensor([-1.3261, -0.6269, -1.1621, -1.9966,  1.5291, -0.3930,  1.4517],
       device='cuda:0'), range: [-3.1333, 3.6474]
2025-04-15 07:32:05,511 - INFO -   Noisy actions shape: tensor([ 1.6109, -0.5688,  0.7731, -0.7070,  1.1936, -1.2462,  0.1343],
       device='cuda:0'), range: [-3.3840, 3.2625]
2025-04-15 07:32:05,511 - INFO -   Diffusion: timestep range [9, 811], noise range [-3.1333, 3.6474]
2025-04-15 07:32:05,511 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.3840, 3.2625]
2025-04-15 07:32:05,533 - INFO -   Model output shapes:
2025-04-15 07:32:05,534 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:05,534 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4220, 0.5968]
2025-04-15 07:32:05,534 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6022
2025-04-15 07:32:05,534 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.2376, 0.2735]
2025-04-15 07:32:05,555 - INFO -   Loss components:
2025-04-15 07:32:05,555 - INFO -     Diffusion loss: 2.164587 (coef: 1.0)
2025-04-15 07:32:05,555 - INFO -     Grasp quality loss: 0.697191 (coef: 0.5)
2025-04-15 07:32:05,555 - INFO -     Grasp rotation loss: 0.586505 (coef: 0.5)
2025-04-15 07:32:05,555 - INFO -     Grasp width loss: 9.058024 (coef: 0.005)
2025-04-15 07:32:05,555 - INFO -     TOTAL loss: 2.851725
2025-04-15 07:32:05,563 - INFO -   Gradients: avg norm: 0.529442, max norm: 4.294299, non-zero params: 250
2025-04-15 07:32:05,563 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-15 07:32:05,563 - INFO - --- Gradient Check @ Epoch 6, Batch 0 ---
2025-04-15 07:32:05,581 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:05,581 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:05,581 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.6984e-01, MaxNorm=3.7871e+00
2025-04-15 07:32:05,581 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.5792e-02, MaxNorm=4.5952e-02
2025-04-15 07:32:05,581 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.4705e-02, MaxNorm=4.6025e-02
2025-04-15 07:32:05,581 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.2935e-01, MaxNorm=2.8095e-01
2025-04-15 07:32:05,581 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.4936e+00, MaxNorm=2.7628e+00
2025-04-15 07:32:05,581 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.5145e+00, MaxNorm=2.7376e+00
2025-04-15 07:32:05,581 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.5360e-01, MaxNorm=6.7847e-01
2025-04-15 07:32:05,581 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=5.2149e-01, MaxNorm=6.0870e-01
2025-04-15 07:32:05,581 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2997e+00, MaxNorm=1.3934e+00
2025-04-15 07:32:05,581 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.3601e+00, MaxNorm=4.2943e+00
2025-04-15 07:32:05,581 - INFO - --- End Gradient Check ---
2025-04-15 07:32:05,584 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:05,584 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.8194, 3.3082]
2025-04-15 07:32:05,584 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2917, 2.9556]
2025-04-15 07:32:05,584 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,584 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,585 - INFO -   True actions shape: tensor([-0.3061,  1.9819, -2.7372, -0.6318,  0.2379,  0.7762,  1.5060],
       device='cuda:0'), range: [-2.8194, 3.3082]
2025-04-15 07:32:05,585 - INFO -   Noise shape: tensor([-1.9837, -1.0616, -0.5356,  1.1793,  3.2225, -1.7913,  0.0966],
       device='cuda:0'), range: [-3.4966, 3.8581]
2025-04-15 07:32:05,586 - INFO -   Noisy actions shape: tensor([-1.9971, -0.9552, -0.6798,  1.1441,  3.2306, -1.7477,  0.1763],
       device='cuda:0'), range: [-3.3995, 3.9105]
2025-04-15 07:32:05,632 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:05,632 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2313, 3.8435]
2025-04-15 07:32:05,632 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0385, 4.0513]
2025-04-15 07:32:05,632 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,632 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,633 - INFO -   True actions shape: tensor([-1.0133,  0.2950,  0.6529,  0.0806,  0.3323,  0.2397, -1.8343],
       device='cuda:0'), range: [-4.2313, 3.8435]
2025-04-15 07:32:05,634 - INFO -   Noise shape: tensor([ 0.8620,  2.0727,  1.9469, -1.4624, -0.3994, -0.3817, -0.6037],
       device='cuda:0'), range: [-3.5061, 3.7140]
2025-04-15 07:32:05,634 - INFO -   Noisy actions shape: tensor([ 0.2459,  1.9461,  2.0144, -1.2299, -0.1820, -0.2126, -1.4340],
       device='cuda:0'), range: [-3.6261, 3.3504]
2025-04-15 07:32:05,680 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:05,680 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6151, 3.4438]
2025-04-15 07:32:05,680 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6616, 3.9501]
2025-04-15 07:32:05,680 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,680 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,681 - INFO -   True actions shape: tensor([-2.0563, -1.4052, -1.2099,  2.3477,  0.7379, -2.0281, -0.7651],
       device='cuda:0'), range: [-3.6151, 3.4438]
2025-04-15 07:32:05,682 - INFO -   Noise shape: tensor([-0.9397,  1.1310, -0.8868,  1.0677,  0.0215, -0.5862, -0.7574],
       device='cuda:0'), range: [-4.2201, 3.6332]
2025-04-15 07:32:05,682 - INFO -   Noisy actions shape: tensor([-1.4126,  0.7543, -1.1549,  1.6078,  0.2008, -1.0629, -0.9211],
       device='cuda:0'), range: [-3.6593, 3.3049]
2025-04-15 07:32:05,728 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:05,728 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5195, 3.1877]
2025-04-15 07:32:05,728 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8472, 2.8186]
2025-04-15 07:32:05,728 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,728 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,729 - INFO -   True actions shape: tensor([-0.1092,  0.9047,  0.1680, -1.4566,  1.2030, -0.1069, -1.1713],
       device='cuda:0'), range: [-3.5195, 3.1877]
2025-04-15 07:32:05,730 - INFO -   Noise shape: tensor([-1.7396,  1.0303,  2.1769,  0.9724,  1.6415, -0.2608,  1.2982],
       device='cuda:0'), range: [-3.8637, 3.9813]
2025-04-15 07:32:05,730 - INFO -   Noisy actions shape: tensor([-1.5232,  1.3557,  1.9230,  0.0319,  2.0312, -0.2772,  0.4602],
       device='cuda:0'), range: [-3.4064, 3.1100]
2025-04-15 07:32:05,776 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:05,776 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5384, 3.2505]
2025-04-15 07:32:05,776 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6819, 2.6823]
2025-04-15 07:32:05,776 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,776 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,777 - INFO -   True actions shape: tensor([-0.7335,  0.2291, -1.4479,  1.7458, -0.8245, -0.3705, -0.3869],
       device='cuda:0'), range: [-3.5384, 3.2505]
2025-04-15 07:32:05,778 - INFO -   Noise shape: tensor([ 0.1232, -1.1815,  0.1881, -0.2858, -1.5100,  0.2047,  1.1527],
       device='cuda:0'), range: [-3.6160, 3.4369]
2025-04-15 07:32:05,778 - INFO -   Noisy actions shape: tensor([-0.1386, -1.0289, -0.3252,  0.3367, -1.7022,  0.0637,  0.9473],
       device='cuda:0'), range: [-3.4955, 3.4538]
2025-04-15 07:32:05,824 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:05,824 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3623, 3.5096]
2025-04-15 07:32:05,824 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9464, 4.1615]
2025-04-15 07:32:05,824 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,824 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,825 - INFO -   True actions shape: tensor([-0.2807,  2.0061, -0.9437,  1.1865, -0.1733, -0.8579, -0.1259],
       device='cuda:0'), range: [-3.3623, 3.5096]
2025-04-15 07:32:05,826 - INFO -   Noise shape: tensor([ 0.7620,  1.0111, -1.3043,  0.9252, -2.1220,  0.1840,  0.6746],
       device='cuda:0'), range: [-3.3390, 3.2041]
2025-04-15 07:32:05,826 - INFO -   Noisy actions shape: tensor([ 0.1391,  2.2427, -1.4704,  1.4905, -1.2136, -0.6502,  0.2291],
       device='cuda:0'), range: [-3.3669, 3.5140]
2025-04-15 07:32:05,875 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:05,875 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3600, 3.5601]
2025-04-15 07:32:05,875 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2994, 2.6123]
2025-04-15 07:32:05,875 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,875 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,876 - INFO -   True actions shape: tensor([ 0.8810,  1.3292,  1.5170, -0.2123, -0.7382, -0.3542, -0.3315],
       device='cuda:0'), range: [-3.3600, 3.5601]
2025-04-15 07:32:05,877 - INFO -   Noise shape: tensor([ 0.4740, -1.4045,  0.6837,  1.4162, -0.8755, -0.5996, -0.2073],
       device='cuda:0'), range: [-3.2968, 3.8805]
2025-04-15 07:32:05,877 - INFO -   Noisy actions shape: tensor([ 0.9861,  0.8131,  1.6557,  0.2495, -0.9785, -0.5266, -0.3802],
       device='cuda:0'), range: [-3.2951, 3.1864]
2025-04-15 07:32:05,922 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:05,922 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5638, 3.9806]
2025-04-15 07:32:05,922 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8887, 2.9927]
2025-04-15 07:32:05,923 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,923 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,923 - INFO -   True actions shape: tensor([-0.1124,  1.8747,  0.3730, -1.0994,  0.1836,  0.6913,  0.4802],
       device='cuda:0'), range: [-3.5638, 3.9806]
2025-04-15 07:32:05,924 - INFO -   Noise shape: tensor([-0.4100, -0.9443, -1.8736, -2.0476,  0.8757, -0.3345, -0.0537],
       device='cuda:0'), range: [-3.3857, 3.0333]
2025-04-15 07:32:05,924 - INFO -   Noisy actions shape: tensor([-0.3901,  0.4371, -1.2276, -2.2850,  0.7978,  0.1719,  0.2588],
       device='cuda:0'), range: [-3.0338, 3.6756]
2025-04-15 07:32:05,969 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:05,969 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4929, 3.1128]
2025-04-15 07:32:05,969 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7077, 3.3102]
2025-04-15 07:32:05,969 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:05,969 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:05,970 - INFO -   True actions shape: tensor([-0.0518, -0.0915,  0.5944,  0.2334,  0.4471, -1.0451,  1.0577],
       device='cuda:0'), range: [-3.4929, 3.1128]
2025-04-15 07:32:05,971 - INFO -   Noise shape: tensor([-0.1914,  1.2418,  0.8963, -0.7348,  0.9477,  0.1238,  0.7710],
       device='cuda:0'), range: [-3.6079, 3.8888]
2025-04-15 07:32:05,971 - INFO -   Noisy actions shape: tensor([-0.1827,  0.9216,  1.0722, -0.4349,  1.0219, -0.5465,  1.2590],
       device='cuda:0'), range: [-3.2075, 3.0914]
2025-04-15 07:32:06,016 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:06,016 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4329, 3.5834]
2025-04-15 07:32:06,016 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0079, 3.3033]
2025-04-15 07:32:06,016 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,016 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,017 - INFO -   True actions shape: tensor([-0.3680, -0.5327,  0.3799, -0.9149,  1.9866, -0.6702,  0.6278],
       device='cuda:0'), range: [-3.4329, 3.5834]
2025-04-15 07:32:06,017 - INFO -   Noise shape: tensor([ 0.3809, -0.3073, -0.6639,  0.2795, -0.4815,  1.7812,  0.4779],
       device='cuda:0'), range: [-3.7433, 3.0103]
2025-04-15 07:32:06,018 - INFO -   Noisy actions shape: tensor([-0.2425, -0.5987,  0.1722, -0.7954,  1.7632, -0.1278,  0.7390],
       device='cuda:0'), range: [-3.4607, 2.9512]
2025-04-15 07:32:06,060 - INFO -   Loss components:
2025-04-15 07:32:06,060 - INFO -     Diffusion loss: 2.136597 (coef: 1.0)
2025-04-15 07:32:06,060 - INFO -     Grasp quality loss: 0.694722 (coef: 0.5)
2025-04-15 07:32:06,060 - INFO -     Grasp rotation loss: 0.575837 (coef: 0.5)
2025-04-15 07:32:06,060 - INFO -     Grasp width loss: 7.683069 (coef: 0.005)
2025-04-15 07:32:06,060 - INFO -     TOTAL loss: 2.810292
2025-04-15 07:32:06,067 - INFO -   Gradients: avg norm: 0.572198, max norm: 4.657936, non-zero params: 250
2025-04-15 07:32:06,067 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-15 07:32:06,070 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:06,070 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2879, 3.7306]
2025-04-15 07:32:06,070 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3424, 3.3856]
2025-04-15 07:32:06,070 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,070 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,071 - INFO -   True actions shape: tensor([ 1.8487,  1.0222, -0.0731,  1.5619,  1.7574, -2.5951, -1.2458],
       device='cuda:0'), range: [-3.2879, 3.7306]
2025-04-15 07:32:06,072 - INFO -   Noise shape: tensor([-1.3809, -0.0970, -1.1766, -0.4874, -0.1263,  0.3173,  0.1881],
       device='cuda:0'), range: [-3.3431, 4.2257]
2025-04-15 07:32:06,072 - INFO -   Noisy actions shape: tensor([ 1.3861,  0.9538, -0.4008,  1.3619,  1.6511, -2.4013, -1.1427],
       device='cuda:0'), range: [-3.3781, 4.2883]
2025-04-15 07:32:06,117 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:06,117 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3101, 3.8813]
2025-04-15 07:32:06,117 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4552, 2.6881]
2025-04-15 07:32:06,117 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,117 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,118 - INFO -   True actions shape: tensor([ 0.6505,  0.5520,  0.4073,  0.4108,  1.1276, -1.4042,  0.0248],
       device='cuda:0'), range: [-3.3101, 3.8813]
2025-04-15 07:32:06,118 - INFO -   Noise shape: tensor([-1.8005, -0.2114,  0.0069,  0.2256,  0.1982, -1.1316,  1.2220],
       device='cuda:0'), range: [-3.1111, 3.2763]
2025-04-15 07:32:06,119 - INFO -   Noisy actions shape: tensor([-1.6249, -0.0915,  0.0918,  0.3065,  0.4293, -1.3999,  1.2002],
       device='cuda:0'), range: [-3.3844, 3.8866]
2025-04-15 07:32:06,161 - INFO - 
=== Epoch 6 Summary ===
2025-04-15 07:32:06,162 - INFO -   Avg total loss: 2.885050
2025-04-15 07:32:06,162 - INFO -   Avg diffusion loss: 2.211852
2025-04-15 07:32:06,162 - INFO -   Avg grasp loss: 1.346397
2025-04-15 07:32:06,162 - INFO - 
=== EPOCH 7/20 ===
2025-04-15 07:32:06,163 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:06,165 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:06,165 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1283, 3.2087]
2025-04-15 07:32:06,165 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0146, 3.1225]
2025-04-15 07:32:06,166 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,166 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,166 - INFO -   True actions shape: tensor([ 0.4223, -0.1145,  0.1352,  0.3773, -0.9176, -1.2640, -1.1943],
       device='cuda:0'), range: [-3.1283, 3.2087]
2025-04-15 07:32:06,167 - INFO -   Noise shape: tensor([ 0.3194, -0.9401,  1.2698,  0.0246,  0.8030, -2.1287, -1.9387],
       device='cuda:0'), range: [-3.6101, 3.7615]
2025-04-15 07:32:06,167 - INFO -   Noisy actions shape: tensor([ 0.4558, -0.9132,  1.2260,  0.1661,  0.3943, -2.4492, -2.2471],
       device='cuda:0'), range: [-3.1930, 3.5736]
2025-04-15 07:32:06,168 - INFO -   Diffusion: timestep range [402, 903], noise range [-3.6101, 3.7615]
2025-04-15 07:32:06,168 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.1930, 3.5736]
2025-04-15 07:32:06,189 - INFO -   Model output shapes:
2025-04-15 07:32:06,189 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:06,189 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4049, 0.5529]
2025-04-15 07:32:06,189 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5413
2025-04-15 07:32:06,189 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0944, 0.2323]
2025-04-15 07:32:06,210 - INFO -   Loss components:
2025-04-15 07:32:06,210 - INFO -     Diffusion loss: 1.940351 (coef: 1.0)
2025-04-15 07:32:06,210 - INFO -     Grasp quality loss: 0.694287 (coef: 0.5)
2025-04-15 07:32:06,210 - INFO -     Grasp rotation loss: 0.575441 (coef: 0.5)
2025-04-15 07:32:06,210 - INFO -     Grasp width loss: 6.984345 (coef: 0.005)
2025-04-15 07:32:06,211 - INFO -     TOTAL loss: 2.610136
2025-04-15 07:32:06,218 - INFO -   Gradients: avg norm: 0.539972, max norm: 4.245793, non-zero params: 250
2025-04-15 07:32:06,218 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-15 07:32:06,218 - INFO - --- Gradient Check @ Epoch 7, Batch 0 ---
2025-04-15 07:32:06,235 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:06,235 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:06,235 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.5960e-01, MaxNorm=3.7077e+00
2025-04-15 07:32:06,235 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.8504e-02, MaxNorm=4.1955e-02
2025-04-15 07:32:06,235 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.1410e-02, MaxNorm=2.4200e-02
2025-04-15 07:32:06,235 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.3298e-01, MaxNorm=4.4504e-01
2025-04-15 07:32:06,235 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5076e+00, MaxNorm=2.7484e+00
2025-04-15 07:32:06,235 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.5691e+00, MaxNorm=2.8165e+00
2025-04-15 07:32:06,235 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.4996e-01, MaxNorm=6.7225e-01
2025-04-15 07:32:06,235 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=6.4835e-01, MaxNorm=6.8450e-01
2025-04-15 07:32:06,235 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2666e+00, MaxNorm=1.3204e+00
2025-04-15 07:32:06,235 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.3329e+00, MaxNorm=4.2458e+00
2025-04-15 07:32:06,235 - INFO - --- End Gradient Check ---
2025-04-15 07:32:06,238 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:06,238 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3457, 3.8231]
2025-04-15 07:32:06,238 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7858, 3.1562]
2025-04-15 07:32:06,238 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,238 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,239 - INFO -   True actions shape: tensor([ 0.8098, -0.3200, -0.3450, -1.4345, -2.5237,  0.0670,  1.3153],
       device='cuda:0'), range: [-3.3457, 3.8231]
2025-04-15 07:32:06,239 - INFO -   Noise shape: tensor([-1.6741,  0.2523,  1.1009, -0.5148, -0.9368, -0.5887, -0.3820],
       device='cuda:0'), range: [-3.3342, 3.3415]
2025-04-15 07:32:06,240 - INFO -   Noisy actions shape: tensor([-0.9017,  0.0218,  0.7010, -1.2472, -2.2197, -0.4426,  0.4456],
       device='cuda:0'), range: [-3.3090, 3.9441]
2025-04-15 07:32:06,284 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:06,285 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1317, 3.8737]
2025-04-15 07:32:06,285 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2194, 3.4404]
2025-04-15 07:32:06,285 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,285 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,286 - INFO -   True actions shape: tensor([0.8580, 0.4582, 0.0188, 0.4105, 1.4092, 1.5843, 1.2841],
       device='cuda:0'), range: [-4.1317, 3.8737]
2025-04-15 07:32:06,286 - INFO -   Noise shape: tensor([-0.0869,  1.3620, -1.0186, -2.4459, -2.5979,  0.2065, -0.1492],
       device='cuda:0'), range: [-3.7753, 3.3560]
2025-04-15 07:32:06,287 - INFO -   Noisy actions shape: tensor([-0.0722,  1.3696, -1.0181, -2.4385, -2.5734,  0.2336, -0.1272],
       device='cuda:0'), range: [-4.1224, 3.9248]
2025-04-15 07:32:06,331 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:06,331 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6381, 3.6768]
2025-04-15 07:32:06,331 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7724, 3.2781]
2025-04-15 07:32:06,332 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,332 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,332 - INFO -   True actions shape: tensor([ 0.1317,  0.6077, -1.9408,  1.5157, -0.7297,  0.9151,  0.0060],
       device='cuda:0'), range: [-3.6381, 3.6768]
2025-04-15 07:32:06,333 - INFO -   Noise shape: tensor([ 5.4705e-01, -2.8831e-01, -7.1326e-04,  1.3321e+00, -7.4954e-01,
         2.8392e-01,  6.9028e-01], device='cuda:0'), range: [-3.4370, 3.4515]
2025-04-15 07:32:06,333 - INFO -   Noisy actions shape: tensor([ 0.5547, -0.0254, -0.7657,  1.8217, -0.9765,  0.6217,  0.6368],
       device='cuda:0'), range: [-3.6178, 3.7316]
2025-04-15 07:32:06,378 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:06,378 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3949, 3.6639]
2025-04-15 07:32:06,378 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3798, 3.7702]
2025-04-15 07:32:06,378 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,378 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,379 - INFO -   True actions shape: tensor([ 0.2402, -1.3884,  0.1509, -0.4937, -1.1276,  0.0135, -1.1300],
       device='cuda:0'), range: [-3.3949, 3.6639]
2025-04-15 07:32:06,380 - INFO -   Noise shape: tensor([ 0.7555,  1.6977, -0.1789, -0.5273,  0.4662, -0.4265, -0.2173],
       device='cuda:0'), range: [-3.2484, 3.6624]
2025-04-15 07:32:06,380 - INFO -   Noisy actions shape: tensor([ 0.7505,  0.5414, -0.0543, -0.7174, -0.2946, -0.3351, -0.8459],
       device='cuda:0'), range: [-2.9792, 4.0124]
2025-04-15 07:32:06,425 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:06,425 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0112, 3.8429]
2025-04-15 07:32:06,425 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1141, 2.9416]
2025-04-15 07:32:06,425 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,425 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,426 - INFO -   True actions shape: tensor([ 0.6226,  0.8029,  0.3911, -0.7424,  2.7056,  0.1841,  1.1284],
       device='cuda:0'), range: [-4.0112, 3.8429]
2025-04-15 07:32:06,427 - INFO -   Noise shape: tensor([ 0.1230, -0.0054, -0.1411, -0.7243, -0.2485,  0.1681,  1.1456],
       device='cuda:0'), range: [-3.5660, 3.2572]
2025-04-15 07:32:06,427 - INFO -   Noisy actions shape: tensor([ 0.6244,  0.7450,  0.3121, -0.9563,  2.4261,  0.2329,  1.4698],
       device='cuda:0'), range: [-3.5612, 2.9066]
2025-04-15 07:32:06,472 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:06,472 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8878, 4.0588]
2025-04-15 07:32:06,472 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9356, 2.8052]
2025-04-15 07:32:06,472 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,472 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,473 - INFO -   True actions shape: tensor([ 0.4844, -2.2759, -0.9968,  2.8385,  1.6895, -0.6354,  1.9668],
       device='cuda:0'), range: [-3.8878, 4.0588]
2025-04-15 07:32:06,474 - INFO -   Noise shape: tensor([ 0.1384, -0.1741,  0.5614, -1.9029,  0.2396, -0.4206,  0.3528],
       device='cuda:0'), range: [-4.0541, 3.6954]
2025-04-15 07:32:06,474 - INFO -   Noisy actions shape: tensor([ 0.5016, -2.1844, -0.7257,  1.9564,  1.6615, -0.7446,  1.9610],
       device='cuda:0'), range: [-3.5842, 3.9014]
2025-04-15 07:32:06,519 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:06,519 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.4091, 3.3633]
2025-04-15 07:32:06,519 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8799, 2.8569]
2025-04-15 07:32:06,519 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,519 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,520 - INFO -   True actions shape: tensor([ 0.5521,  0.6369, -0.9506,  0.1377,  1.3845,  0.2218,  1.6456],
       device='cuda:0'), range: [-4.4091, 3.3633]
2025-04-15 07:32:06,521 - INFO -   Noise shape: tensor([-0.3022, -0.8706,  0.4949,  0.3119, -0.9546, -1.4542,  0.6456],
       device='cuda:0'), range: [-4.2955, 3.0574]
2025-04-15 07:32:06,521 - INFO -   Noisy actions shape: tensor([ 0.1388, -0.2313, -0.2580,  0.3250,  0.2005, -0.9435,  1.5730],
       device='cuda:0'), range: [-4.8167, 3.3766]
2025-04-15 07:32:06,566 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:06,566 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.8247, 4.1095]
2025-04-15 07:32:06,566 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9239, 3.3808]
2025-04-15 07:32:06,566 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,566 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,567 - INFO -   True actions shape: tensor([ 0.9670, -0.6899,  1.0354, -2.1069,  0.8202,  0.5165,  0.0411],
       device='cuda:0'), range: [-2.8247, 4.1095]
2025-04-15 07:32:06,568 - INFO -   Noise shape: tensor([ 1.9314, -0.9414, -0.6334, -0.3644, -1.3403, -0.6740,  0.9304],
       device='cuda:0'), range: [-3.4581, 3.3295]
2025-04-15 07:32:06,568 - INFO -   Noisy actions shape: tensor([ 1.8048, -1.0689,  0.5785, -2.0058,  0.0379,  0.1091,  0.5019],
       device='cuda:0'), range: [-3.1922, 3.4956]
2025-04-15 07:32:06,613 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:06,613 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8991, 3.8896]
2025-04-15 07:32:06,613 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9082, 3.5529]
2025-04-15 07:32:06,613 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,613 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,614 - INFO -   True actions shape: tensor([-2.1579,  0.7898,  0.1126,  1.0724, -0.7026,  2.5560, -1.7975],
       device='cuda:0'), range: [-3.8991, 3.8896]
2025-04-15 07:32:06,614 - INFO -   Noise shape: tensor([ 0.9168, -0.4531,  0.0914, -0.5595, -1.3229, -1.5134, -1.5144],
       device='cuda:0'), range: [-4.1165, 3.4486]
2025-04-15 07:32:06,615 - INFO -   Noisy actions shape: tensor([ 0.1197, -0.1542,  0.1245, -0.1571, -1.4837, -0.5433, -2.0398],
       device='cuda:0'), range: [-4.4805, 3.7846]
2025-04-15 07:32:06,659 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:06,659 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0909, 3.5887]
2025-04-15 07:32:06,660 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9078, 2.8831]
2025-04-15 07:32:06,660 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,660 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,660 - INFO -   True actions shape: tensor([ 0.5252, -0.2137, -0.5413,  0.5524, -1.0942, -0.7392, -0.1181],
       device='cuda:0'), range: [-4.0909, 3.5887]
2025-04-15 07:32:06,661 - INFO -   Noise shape: tensor([ 0.1790,  1.5427,  0.9928,  3.0604,  0.4624, -0.3671, -0.2951],
       device='cuda:0'), range: [-4.0782, 3.4810]
2025-04-15 07:32:06,662 - INFO -   Noisy actions shape: tensor([ 0.5540,  0.3808, -0.1292,  1.6605, -0.8407, -0.8229, -0.2202],
       device='cuda:0'), range: [-3.6247, 3.3200]
2025-04-15 07:32:06,703 - INFO -   Loss components:
2025-04-15 07:32:06,704 - INFO -     Diffusion loss: 2.028365 (coef: 1.0)
2025-04-15 07:32:06,704 - INFO -     Grasp quality loss: 0.697414 (coef: 0.5)
2025-04-15 07:32:06,704 - INFO -     Grasp rotation loss: 0.555113 (coef: 0.5)
2025-04-15 07:32:06,704 - INFO -     Grasp width loss: 6.658161 (coef: 0.005)
2025-04-15 07:32:06,704 - INFO -     TOTAL loss: 2.687919
2025-04-15 07:32:06,711 - INFO -   Gradients: avg norm: 0.498893, max norm: 4.029586, non-zero params: 250
2025-04-15 07:32:06,711 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-15 07:32:06,714 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:06,714 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9364, 3.5146]
2025-04-15 07:32:06,714 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1998, 3.0706]
2025-04-15 07:32:06,714 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,714 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,715 - INFO -   True actions shape: tensor([-0.5249,  0.0145,  0.1772, -0.2449,  0.6331, -0.9551,  1.2978],
       device='cuda:0'), range: [-3.9364, 3.5146]
2025-04-15 07:32:06,716 - INFO -   Noise shape: tensor([ 0.8613,  0.1547, -2.0893,  1.8482, -0.7851, -0.6135, -1.3487],
       device='cuda:0'), range: [-3.7424, 3.6108]
2025-04-15 07:32:06,716 - INFO -   Noisy actions shape: tensor([ 0.0812,  0.1026, -1.0839,  0.8876,  0.0511, -1.1333,  0.2580],
       device='cuda:0'), range: [-3.6389, 3.2259]
2025-04-15 07:32:06,761 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:06,761 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3512, 3.4722]
2025-04-15 07:32:06,761 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1068, 3.0860]
2025-04-15 07:32:06,761 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,761 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,762 - INFO -   True actions shape: tensor([ 0.9521, -0.6851, -1.1902,  0.0685, -1.5395, -2.2927,  1.3531],
       device='cuda:0'), range: [-3.3512, 3.4722]
2025-04-15 07:32:06,762 - INFO -   Noise shape: tensor([ 0.3920,  0.3358, -0.1871,  0.6473,  0.2459,  0.1548,  0.3114],
       device='cuda:0'), range: [-3.0604, 3.4067]
2025-04-15 07:32:06,763 - INFO -   Noisy actions shape: tensor([ 1.0068, -0.3749, -1.0872,  0.4228, -1.1302, -1.8028,  1.2919],
       device='cuda:0'), range: [-3.0264, 3.6198]
2025-04-15 07:32:06,805 - INFO - 
=== Epoch 7 Summary ===
2025-04-15 07:32:06,805 - INFO -   Avg total loss: 2.736628
2025-04-15 07:32:06,805 - INFO -   Avg diffusion loss: 2.069605
2025-04-15 07:32:06,805 - INFO -   Avg grasp loss: 1.334045
2025-04-15 07:32:06,805 - INFO - 
=== EPOCH 8/20 ===
2025-04-15 07:32:06,806 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:06,809 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:06,809 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6643, 3.3711]
2025-04-15 07:32:06,809 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4972, 3.2551]
2025-04-15 07:32:06,810 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,810 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,810 - INFO -   True actions shape: tensor([-0.1632,  1.4078,  1.5549, -1.5338, -0.6433,  1.8931, -2.8200],
       device='cuda:0'), range: [-3.6643, 3.3711]
2025-04-15 07:32:06,811 - INFO -   Noise shape: tensor([-0.1360,  0.1118,  2.0739, -0.2587,  1.0592,  1.3308,  0.9486],
       device='cuda:0'), range: [-3.2729, 3.3490]
2025-04-15 07:32:06,812 - INFO -   Noisy actions shape: tensor([-0.1365,  0.1162,  2.0787, -0.2634,  1.0572,  1.3367,  0.9398],
       device='cuda:0'), range: [-3.2441, 3.3707]
2025-04-15 07:32:06,812 - INFO -   Diffusion: timestep range [2, 997], noise range [-3.2729, 3.3490]
2025-04-15 07:32:06,812 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.2441, 3.3707]
2025-04-15 07:32:06,834 - INFO -   Model output shapes:
2025-04-15 07:32:06,834 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:06,834 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.3884, 0.5518]
2025-04-15 07:32:06,834 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6004
2025-04-15 07:32:06,834 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1943, 0.2092]
2025-04-15 07:32:06,855 - INFO -   Loss components:
2025-04-15 07:32:06,855 - INFO -     Diffusion loss: 1.995959 (coef: 1.0)
2025-04-15 07:32:06,855 - INFO -     Grasp quality loss: 0.699268 (coef: 0.5)
2025-04-15 07:32:06,855 - INFO -     Grasp rotation loss: 0.574799 (coef: 0.5)
2025-04-15 07:32:06,855 - INFO -     Grasp width loss: 6.718362 (coef: 0.005)
2025-04-15 07:32:06,855 - INFO -     TOTAL loss: 2.666585
2025-04-15 07:32:06,863 - INFO -   Gradients: avg norm: 0.500635, max norm: 4.039245, non-zero params: 250
2025-04-15 07:32:06,863 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-15 07:32:06,863 - INFO - --- Gradient Check @ Epoch 8, Batch 0 ---
2025-04-15 07:32:06,879 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:06,879 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:06,879 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.3131e-01, MaxNorm=3.5254e+00
2025-04-15 07:32:06,879 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.2962e-02, MaxNorm=5.5784e-02
2025-04-15 07:32:06,879 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.5515e-02, MaxNorm=3.7574e-02
2025-04-15 07:32:06,879 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=6.4668e-02, MaxNorm=1.1959e-01
2025-04-15 07:32:06,879 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.5395e+00, MaxNorm=2.8396e+00
2025-04-15 07:32:06,879 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.6045e+00, MaxNorm=2.9477e+00
2025-04-15 07:32:06,879 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.3237e-01, MaxNorm=5.9103e-01
2025-04-15 07:32:06,879 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.3925e-01, MaxNorm=4.6690e-01
2025-04-15 07:32:06,879 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1560e+00, MaxNorm=1.2193e+00
2025-04-15 07:32:06,879 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.2377e+00, MaxNorm=4.0392e+00
2025-04-15 07:32:06,879 - INFO - --- End Gradient Check ---
2025-04-15 07:32:06,882 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:06,882 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6565, 3.0673]
2025-04-15 07:32:06,882 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9073, 3.1053]
2025-04-15 07:32:06,882 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,882 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,883 - INFO -   True actions shape: tensor([ 0.0576,  0.9870,  0.0656,  0.6793,  1.7310, -1.5140, -0.0571],
       device='cuda:0'), range: [-3.6565, 3.0673]
2025-04-15 07:32:06,884 - INFO -   Noise shape: tensor([-1.3662, -0.4605, -0.4553,  0.3759,  0.5588, -1.5211, -2.1671],
       device='cuda:0'), range: [-3.3963, 3.3755]
2025-04-15 07:32:06,884 - INFO -   Noisy actions shape: tensor([-1.1543,  0.0948, -0.3615,  0.6652,  1.3495, -2.0743, -1.9053],
       device='cuda:0'), range: [-3.7428, 3.7950]
2025-04-15 07:32:06,929 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:06,929 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1581, 3.7206]
2025-04-15 07:32:06,929 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4014, 3.1487]
2025-04-15 07:32:06,929 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,929 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,930 - INFO -   True actions shape: tensor([ 2.3773, -1.8494,  0.0413,  0.0813, -1.4068, -0.5466,  0.2201],
       device='cuda:0'), range: [-3.1581, 3.7206]
2025-04-15 07:32:06,930 - INFO -   Noise shape: tensor([-0.2828, -0.9409, -0.4102,  0.1382,  0.1910, -0.7750,  0.1485],
       device='cuda:0'), range: [-3.2014, 4.3179]
2025-04-15 07:32:06,931 - INFO -   Noisy actions shape: tensor([ 2.1010, -2.0667, -0.1145,  0.1269, -1.2345, -0.7958,  0.2596],
       device='cuda:0'), range: [-3.2944, 3.3578]
2025-04-15 07:32:06,976 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:06,976 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3793, 3.5975]
2025-04-15 07:32:06,976 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1848, 3.6005]
2025-04-15 07:32:06,976 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:06,976 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:06,977 - INFO -   True actions shape: tensor([ 1.1225,  0.2949, -1.5499, -0.5099, -0.2339, -0.3878, -1.1115],
       device='cuda:0'), range: [-3.3793, 3.5975]
2025-04-15 07:32:06,978 - INFO -   Noise shape: tensor([ 0.9538,  1.4518,  0.4197,  1.5191, -1.3770, -0.3962,  0.3550],
       device='cuda:0'), range: [-3.5702, 3.1723]
2025-04-15 07:32:06,978 - INFO -   Noisy actions shape: tensor([ 1.1372,  1.4811,  0.1392,  1.4051, -1.3966, -0.4585,  0.1530],
       device='cuda:0'), range: [-3.5613, 3.7037]
2025-04-15 07:32:07,023 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:07,023 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4852, 3.2449]
2025-04-15 07:32:07,023 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7394, 2.9186]
2025-04-15 07:32:07,023 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,023 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,024 - INFO -   True actions shape: tensor([-1.0756, -0.1711,  0.5071,  0.2407,  1.2625, -0.0623,  0.3154],
       device='cuda:0'), range: [-3.4852, 3.2449]
2025-04-15 07:32:07,025 - INFO -   Noise shape: tensor([ 0.4154,  0.6636, -0.9531, -1.0865,  0.3980, -0.2731,  1.1491],
       device='cuda:0'), range: [-3.4283, 3.2467]
2025-04-15 07:32:07,025 - INFO -   Noisy actions shape: tensor([-1.0452, -0.1260,  0.4417,  0.1670,  1.2864, -0.0805,  0.3921],
       device='cuda:0'), range: [-3.5353, 3.4862]
2025-04-15 07:32:07,070 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:07,070 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2554, 3.5286]
2025-04-15 07:32:07,070 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2032, 3.4817]
2025-04-15 07:32:07,071 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,071 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,071 - INFO -   True actions shape: tensor([-0.4416, -1.1311, -0.2964,  1.3279,  0.3477,  1.0178, -0.7616],
       device='cuda:0'), range: [-3.2554, 3.5286]
2025-04-15 07:32:07,072 - INFO -   Noise shape: tensor([-0.1669, -0.4860,  0.4253,  0.0930,  1.3457,  2.0264, -0.5880],
       device='cuda:0'), range: [-3.2953, 3.3867]
2025-04-15 07:32:07,072 - INFO -   Noisy actions shape: tensor([-0.4502, -1.1893,  0.0302,  1.1009,  1.1055,  2.0532, -0.9621],
       device='cuda:0'), range: [-3.6764, 3.3769]
2025-04-15 07:32:07,117 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:07,117 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9144, 2.8074]
2025-04-15 07:32:07,117 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1058, 3.3733]
2025-04-15 07:32:07,117 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,117 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,118 - INFO -   True actions shape: tensor([ 0.9971,  1.1359, -1.0811,  1.3019, -1.5940,  1.2717,  0.4127],
       device='cuda:0'), range: [-3.9144, 2.8074]
2025-04-15 07:32:07,118 - INFO -   Noise shape: tensor([ 1.2038, -0.2522, -0.9791, -0.5324, -0.4282, -0.1248, -0.4851],
       device='cuda:0'), range: [-2.8692, 3.9861]
2025-04-15 07:32:07,119 - INFO -   Noisy actions shape: tensor([ 1.3885,  0.9467, -1.3780,  0.9899, -1.6345,  1.1215,  0.1901],
       device='cuda:0'), range: [-4.2354, 3.3538]
2025-04-15 07:32:07,164 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:07,164 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1268, 3.4761]
2025-04-15 07:32:07,164 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0464, 2.9604]
2025-04-15 07:32:07,164 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,164 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,165 - INFO -   True actions shape: tensor([ 0.3644,  0.3922, -2.1742,  0.5602,  0.4123, -1.5558,  1.1830],
       device='cuda:0'), range: [-3.1268, 3.4761]
2025-04-15 07:32:07,165 - INFO -   Noise shape: tensor([ 0.4147,  0.6821, -0.6344, -1.2075, -1.4506, -0.4804, -0.6741],
       device='cuda:0'), range: [-3.8463, 3.4966]
2025-04-15 07:32:07,166 - INFO -   Noisy actions shape: tensor([ 0.4147,  0.4765, -2.2376,  0.4006,  0.2226, -1.6047,  1.0867],
       device='cuda:0'), range: [-3.3342, 2.9081]
2025-04-15 07:32:07,210 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:07,210 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0624, 3.3350]
2025-04-15 07:32:07,211 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0834, 3.1071]
2025-04-15 07:32:07,211 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,211 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,211 - INFO -   True actions shape: tensor([-0.7172,  0.1360,  2.0464,  0.6706,  1.0405, -1.0663,  0.4020],
       device='cuda:0'), range: [-3.0624, 3.3350]
2025-04-15 07:32:07,212 - INFO -   Noise shape: tensor([ 1.2695, -1.2327, -0.0895, -0.5455, -1.3030, -0.9525,  0.0203],
       device='cuda:0'), range: [-3.3259, 4.1280]
2025-04-15 07:32:07,213 - INFO -   Noisy actions shape: tensor([ 0.0044, -0.4914,  1.7345,  0.3131,  0.2601, -1.3978,  0.3594],
       device='cuda:0'), range: [-3.0455, 3.3486]
2025-04-15 07:32:07,257 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:07,257 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3025, 3.3559]
2025-04-15 07:32:07,257 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3349, 3.1161]
2025-04-15 07:32:07,257 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,257 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,258 - INFO -   True actions shape: tensor([ 0.0043,  0.6979,  0.2311,  0.5373,  0.5894,  0.0822, -0.9568],
       device='cuda:0'), range: [-3.3025, 3.3559]
2025-04-15 07:32:07,259 - INFO -   Noise shape: tensor([-0.0589, -1.0340, -2.1570, -1.3538,  0.9174, -0.3615,  0.7317],
       device='cuda:0'), range: [-3.7795, 3.2639]
2025-04-15 07:32:07,259 - INFO -   Noisy actions shape: tensor([-0.0579, -0.9366, -2.1099, -1.2743,  0.9850, -0.3480,  0.6038],
       device='cuda:0'), range: [-3.8060, 3.3604]
2025-04-15 07:32:07,304 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:07,304 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5267, 3.2342]
2025-04-15 07:32:07,304 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2566, 3.1820]
2025-04-15 07:32:07,304 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,304 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,305 - INFO -   True actions shape: tensor([-0.0836, -0.4723, -1.4519, -2.6538,  0.0375,  1.8386, -2.7919],
       device='cuda:0'), range: [-3.5267, 3.2342]
2025-04-15 07:32:07,305 - INFO -   Noise shape: tensor([ 1.4654, -1.3478,  0.1543, -0.6861,  0.9642, -1.0367,  0.5445],
       device='cuda:0'), range: [-3.4088, 3.6267]
2025-04-15 07:32:07,306 - INFO -   Noisy actions shape: tensor([ 0.3739, -0.8661, -1.3330, -2.7358,  0.3340,  1.4277, -2.4864],
       device='cuda:0'), range: [-3.3621, 3.6156]
2025-04-15 07:32:07,348 - INFO -   Loss components:
2025-04-15 07:32:07,348 - INFO -     Diffusion loss: 1.981913 (coef: 1.0)
2025-04-15 07:32:07,348 - INFO -     Grasp quality loss: 0.692230 (coef: 0.5)
2025-04-15 07:32:07,348 - INFO -     Grasp rotation loss: 0.565003 (coef: 0.5)
2025-04-15 07:32:07,348 - INFO -     Grasp width loss: 6.525036 (coef: 0.005)
2025-04-15 07:32:07,348 - INFO -     TOTAL loss: 2.643155
2025-04-15 07:32:07,356 - INFO -   Gradients: avg norm: 0.486951, max norm: 3.990290, non-zero params: 250
2025-04-15 07:32:07,356 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-15 07:32:07,358 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:07,358 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1254, 3.4711]
2025-04-15 07:32:07,358 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0174, 2.4462]
2025-04-15 07:32:07,359 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,359 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,359 - INFO -   True actions shape: tensor([-0.1883,  2.1866, -0.2811, -1.4796, -0.7811,  0.7075, -0.9997],
       device='cuda:0'), range: [-3.1254, 3.4711]
2025-04-15 07:32:07,360 - INFO -   Noise shape: tensor([-0.1892, -0.5826, -0.5372, -0.5795, -1.1488, -2.3475, -0.7836],
       device='cuda:0'), range: [-3.6454, 3.9534]
2025-04-15 07:32:07,360 - INFO -   Noisy actions shape: tensor([-0.2669,  1.1496, -0.5772, -1.4610, -1.3625, -1.1426, -1.2622],
       device='cuda:0'), range: [-3.7415, 3.4368]
2025-04-15 07:32:07,405 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:07,405 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6378, 3.7531]
2025-04-15 07:32:07,405 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8271, 3.2245]
2025-04-15 07:32:07,405 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,405 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,406 - INFO -   True actions shape: tensor([-0.0758, -1.0507, -0.9027,  0.6194,  0.3207, -0.9605,  1.2499],
       device='cuda:0'), range: [-3.6378, 3.7531]
2025-04-15 07:32:07,407 - INFO -   Noise shape: tensor([ 1.3473,  0.7019,  1.3919,  0.6776,  1.0861,  0.4195, -1.0034],
       device='cuda:0'), range: [-3.6270, 3.2322]
2025-04-15 07:32:07,407 - INFO -   Noisy actions shape: tensor([ 0.8096, -0.3520,  0.2056,  0.9102,  0.9447, -0.4648,  0.3102],
       device='cuda:0'), range: [-3.0875, 3.1679]
2025-04-15 07:32:07,451 - INFO - 
=== Epoch 8 Summary ===
2025-04-15 07:32:07,451 - INFO -   Avg total loss: 2.678702
2025-04-15 07:32:07,451 - INFO -   Avg diffusion loss: 2.012294
2025-04-15 07:32:07,451 - INFO -   Avg grasp loss: 1.332815
2025-04-15 07:32:07,451 - INFO - 
=== EPOCH 9/20 ===
2025-04-15 07:32:07,452 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:07,454 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:07,455 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3149, 3.2399]
2025-04-15 07:32:07,455 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2875, 3.0551]
2025-04-15 07:32:07,455 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,455 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,456 - INFO -   True actions shape: tensor([ 1.4412, -0.9558, -0.7821, -0.0989, -0.7360,  2.0997, -0.9487],
       device='cuda:0'), range: [-3.3149, 3.2399]
2025-04-15 07:32:07,456 - INFO -   Noise shape: tensor([-0.3293, -0.7741,  1.0338, -2.8748,  0.7349,  0.7244,  1.4213],
       device='cuda:0'), range: [-3.4092, 3.8115]
2025-04-15 07:32:07,457 - INFO -   Noisy actions shape: tensor([ 0.3421, -1.1170,  0.5812, -2.6220,  0.3335,  1.5784,  0.8551],
       device='cuda:0'), range: [-3.4853, 3.6828]
2025-04-15 07:32:07,457 - INFO -   Diffusion: timestep range [366, 824], noise range [-3.4092, 3.8115]
2025-04-15 07:32:07,457 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4853, 3.6828]
2025-04-15 07:32:07,478 - INFO -   Model output shapes:
2025-04-15 07:32:07,478 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:07,479 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4165, 0.5694]
2025-04-15 07:32:07,479 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5961
2025-04-15 07:32:07,479 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1662, 0.2373]
2025-04-15 07:32:07,500 - INFO -   Loss components:
2025-04-15 07:32:07,500 - INFO -     Diffusion loss: 1.686351 (coef: 1.0)
2025-04-15 07:32:07,500 - INFO -     Grasp quality loss: 0.697691 (coef: 0.5)
2025-04-15 07:32:07,501 - INFO -     Grasp rotation loss: 0.560130 (coef: 0.5)
2025-04-15 07:32:07,501 - INFO -     Grasp width loss: 7.205874 (coef: 0.005)
2025-04-15 07:32:07,501 - INFO -     TOTAL loss: 2.351290
2025-04-15 07:32:07,508 - INFO -   Gradients: avg norm: 0.456362, max norm: 3.651513, non-zero params: 250
2025-04-15 07:32:07,508 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-15 07:32:07,508 - INFO - --- Gradient Check @ Epoch 9, Batch 0 ---
2025-04-15 07:32:07,525 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:07,525 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:07,525 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.4995e-01, MaxNorm=3.3023e+00
2025-04-15 07:32:07,525 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.2010e-02, MaxNorm=2.4419e-02
2025-04-15 07:32:07,525 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.5487e-03, MaxNorm=2.3635e-02
2025-04-15 07:32:07,525 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.2111e-01, MaxNorm=2.2147e-01
2025-04-15 07:32:07,525 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3336e+00, MaxNorm=2.5042e+00
2025-04-15 07:32:07,525 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3220e+00, MaxNorm=2.3891e+00
2025-04-15 07:32:07,525 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.1986e-01, MaxNorm=5.4149e-01
2025-04-15 07:32:07,525 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.5383e-01, MaxNorm=5.0295e-01
2025-04-15 07:32:07,525 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0382e+00, MaxNorm=1.0572e+00
2025-04-15 07:32:07,525 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9980e+00, MaxNorm=3.6515e+00
2025-04-15 07:32:07,525 - INFO - --- End Gradient Check ---
2025-04-15 07:32:07,527 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:07,528 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3505, 3.9759]
2025-04-15 07:32:07,528 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2652, 2.6947]
2025-04-15 07:32:07,528 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,528 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,529 - INFO -   True actions shape: tensor([-0.3795, -1.4904,  0.4237, -0.3982,  0.0608,  0.0209,  0.2263],
       device='cuda:0'), range: [-4.3505, 3.9759]
2025-04-15 07:32:07,529 - INFO -   Noise shape: tensor([-0.8716,  0.5268,  0.9678, -0.9897,  0.7604,  1.2170, -0.2013],
       device='cuda:0'), range: [-3.7225, 3.4023]
2025-04-15 07:32:07,530 - INFO -   Noisy actions shape: tensor([-0.8878,  0.4590,  0.9859, -1.0067,  0.7623,  1.2167, -0.1909],
       device='cuda:0'), range: [-3.3955, 3.3664]
2025-04-15 07:32:07,574 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:07,575 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6210, 3.8363]
2025-04-15 07:32:07,575 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7502, 3.3038]
2025-04-15 07:32:07,575 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,575 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,575 - INFO -   True actions shape: tensor([-0.1658,  1.3970,  1.5180, -0.9757,  0.1155, -0.3560,  1.5170],
       device='cuda:0'), range: [-3.6210, 3.8363]
2025-04-15 07:32:07,576 - INFO -   Noise shape: tensor([-0.4342, -0.4874,  0.0241, -1.2064,  2.4363,  0.9263,  0.9830],
       device='cuda:0'), range: [-3.1221, 3.2633]
2025-04-15 07:32:07,577 - INFO -   Noisy actions shape: tensor([-0.4603,  0.2492,  0.7555, -1.5279,  2.1881,  0.6385,  1.5942],
       device='cuda:0'), range: [-3.5766, 4.2609]
2025-04-15 07:32:07,621 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:07,621 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6065, 3.6140]
2025-04-15 07:32:07,621 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9189, 3.2226]
2025-04-15 07:32:07,621 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,621 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,622 - INFO -   True actions shape: tensor([ 1.2490, -0.3913,  1.2764, -2.2266,  1.8119, -0.3454, -0.4944],
       device='cuda:0'), range: [-3.6065, 3.6140]
2025-04-15 07:32:07,623 - INFO -   Noise shape: tensor([ 0.2185,  1.1614,  0.5759, -1.4216, -0.6360,  0.4067,  1.2812],
       device='cuda:0'), range: [-3.5100, 3.9097]
2025-04-15 07:32:07,623 - INFO -   Noisy actions shape: tensor([ 1.1476,  0.3473,  1.3755, -2.6392,  1.1172, -0.0489,  0.3318],
       device='cuda:0'), range: [-3.7827, 3.7528]
2025-04-15 07:32:07,668 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:07,668 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3321, 3.0945]
2025-04-15 07:32:07,668 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6199, 2.7632]
2025-04-15 07:32:07,668 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,668 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,669 - INFO -   True actions shape: tensor([-0.9188,  0.5016,  0.4054, -0.9105,  2.2128, -2.2686,  1.6165],
       device='cuda:0'), range: [-3.3321, 3.0945]
2025-04-15 07:32:07,670 - INFO -   Noise shape: tensor([-0.2517, -0.3317,  1.6602, -0.4973, -0.6809,  0.6605, -1.4131],
       device='cuda:0'), range: [-4.0118, 3.0689]
2025-04-15 07:32:07,670 - INFO -   Noisy actions shape: tensor([-0.4873, -0.1861,  1.7082, -0.7218, -0.0669,  0.0324, -0.9315],
       device='cuda:0'), range: [-3.7632, 2.8473]
2025-04-15 07:32:07,716 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:07,716 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1196, 3.1899]
2025-04-15 07:32:07,717 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7549, 3.0843]
2025-04-15 07:32:07,717 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,717 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,717 - INFO -   True actions shape: tensor([-0.3903,  0.4738, -1.1098, -0.7469,  1.2243,  1.8497,  2.1314],
       device='cuda:0'), range: [-4.1196, 3.1899]
2025-04-15 07:32:07,718 - INFO -   Noise shape: tensor([-0.4625, -0.0758, -0.1992,  1.4179, -0.0537, -1.7062,  0.4197],
       device='cuda:0'), range: [-3.2339, 3.6880]
2025-04-15 07:32:07,719 - INFO -   Noisy actions shape: tensor([-0.5478,  0.0494, -0.4797,  1.1763,  0.2651, -1.1692,  0.9571],
       device='cuda:0'), range: [-3.0810, 3.6451]
2025-04-15 07:32:07,763 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:07,763 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1407, 4.1186]
2025-04-15 07:32:07,764 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8996, 3.5305]
2025-04-15 07:32:07,764 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,764 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,764 - INFO -   True actions shape: tensor([-0.6832, -0.1269,  1.3464, -0.3350,  0.2196, -1.8030,  0.3254],
       device='cuda:0'), range: [-3.1407, 4.1186]
2025-04-15 07:32:07,765 - INFO -   Noise shape: tensor([-0.3515,  0.1237, -1.8605,  0.8379,  0.0744,  0.0668,  0.2732],
       device='cuda:0'), range: [-3.0947, 3.3287]
2025-04-15 07:32:07,765 - INFO -   Noisy actions shape: tensor([-0.7362, -0.1019,  0.9811, -0.1751,  0.2296, -1.7599,  0.3701],
       device='cuda:0'), range: [-3.2784, 4.3814]
2025-04-15 07:32:07,810 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:07,810 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5319, 3.2546]
2025-04-15 07:32:07,810 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0755, 3.0996]
2025-04-15 07:32:07,810 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,810 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,811 - INFO -   True actions shape: tensor([-0.1772, -0.9367,  0.1040, -0.6336, -0.6008, -1.2891,  1.2019],
       device='cuda:0'), range: [-3.5319, 3.2546]
2025-04-15 07:32:07,812 - INFO -   Noise shape: tensor([ 1.5812,  1.0421, -1.5475, -0.3861, -0.0191,  1.1361, -1.6718],
       device='cuda:0'), range: [-4.1328, 3.8532]
2025-04-15 07:32:07,812 - INFO -   Noisy actions shape: tensor([-0.0376, -0.8415, -0.0324, -0.6650, -0.6002, -1.1844,  1.0505],
       device='cuda:0'), range: [-3.4272, 3.8436]
2025-04-15 07:32:07,857 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:07,857 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8919, 3.1641]
2025-04-15 07:32:07,857 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1116, 2.9345]
2025-04-15 07:32:07,857 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,857 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,858 - INFO -   True actions shape: tensor([-1.5670, -1.5258, -0.1023, -0.8506,  0.8992,  0.3588, -0.2766],
       device='cuda:0'), range: [-3.8919, 3.1641]
2025-04-15 07:32:07,859 - INFO -   Noise shape: tensor([-1.2791, -0.0834,  1.3848, -0.0291, -0.4075,  0.0087, -1.1997],
       device='cuda:0'), range: [-3.4192, 3.2996]
2025-04-15 07:32:07,859 - INFO -   Noisy actions shape: tensor([-2.0064, -1.1106,  0.9344, -0.6065,  0.3232,  0.2532, -1.0608],
       device='cuda:0'), range: [-3.0186, 3.3187]
2025-04-15 07:32:07,904 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:07,904 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5017, 3.3008]
2025-04-15 07:32:07,904 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8893, 2.7498]
2025-04-15 07:32:07,904 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,904 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,905 - INFO -   True actions shape: tensor([-0.5266,  1.1710, -0.7853,  0.9464, -1.1345, -0.4650, -0.0102],
       device='cuda:0'), range: [-3.5017, 3.3008]
2025-04-15 07:32:07,905 - INFO -   Noise shape: tensor([-0.0814, -0.2100, -1.9766, -0.7512,  0.9336,  0.6436, -2.5333],
       device='cuda:0'), range: [-3.5869, 4.1707]
2025-04-15 07:32:07,906 - INFO -   Noisy actions shape: tensor([-0.4324,  0.6872, -1.9463,  0.1474, -0.1536,  0.1201, -1.7845],
       device='cuda:0'), range: [-3.5950, 4.1732]
2025-04-15 07:32:07,951 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:07,951 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7044, 3.2848]
2025-04-15 07:32:07,951 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9876, 2.9491]
2025-04-15 07:32:07,951 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:07,951 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:07,952 - INFO -   True actions shape: tensor([ 0.2976, -0.5573, -0.7798, -0.2865, -0.1067, -0.6267,  1.5094],
       device='cuda:0'), range: [-3.7044, 3.2848]
2025-04-15 07:32:07,952 - INFO -   Noise shape: tensor([-0.9691,  0.0540, -0.6197, -1.0092,  0.4825,  1.1687,  0.1292],
       device='cuda:0'), range: [-3.5387, 4.2956]
2025-04-15 07:32:07,953 - INFO -   Noisy actions shape: tensor([-0.3538, -0.4093, -0.9959, -0.8416,  0.2090,  0.2142,  1.2762],
       device='cuda:0'), range: [-3.6095, 3.6992]
2025-04-15 07:32:07,995 - INFO -   Loss components:
2025-04-15 07:32:07,995 - INFO -     Diffusion loss: 1.661080 (coef: 1.0)
2025-04-15 07:32:07,995 - INFO -     Grasp quality loss: 0.695163 (coef: 0.5)
2025-04-15 07:32:07,995 - INFO -     Grasp rotation loss: 0.569081 (coef: 0.5)
2025-04-15 07:32:07,995 - INFO -     Grasp width loss: 7.121264 (coef: 0.005)
2025-04-15 07:32:07,995 - INFO -     TOTAL loss: 2.328809
2025-04-15 07:32:08,003 - INFO -   Gradients: avg norm: 0.444271, max norm: 3.195895, non-zero params: 250
2025-04-15 07:32:08,003 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-15 07:32:08,005 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:08,005 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4947, 3.2376]
2025-04-15 07:32:08,006 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.8457, 3.3466]
2025-04-15 07:32:08,006 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,006 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,006 - INFO -   True actions shape: tensor([-0.4257, -0.1119, -0.0075, -0.2901, -1.2945, -0.9360, -2.1067],
       device='cuda:0'), range: [-3.4947, 3.2376]
2025-04-15 07:32:08,007 - INFO -   Noise shape: tensor([ 0.3801, -2.1081, -0.2443, -0.8569,  0.4726,  1.8952,  0.7029],
       device='cuda:0'), range: [-3.2010, 3.5135]
2025-04-15 07:32:08,008 - INFO -   Noisy actions shape: tensor([-0.1221, -1.3264, -0.1492, -0.7373, -0.7717,  0.3526, -1.2948],
       device='cuda:0'), range: [-3.5979, 3.3923]
2025-04-15 07:32:08,053 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:08,053 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5781, 3.7393]
2025-04-15 07:32:08,053 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5089, 3.4743]
2025-04-15 07:32:08,053 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,053 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,054 - INFO -   True actions shape: tensor([ 0.1827,  0.7393, -0.1569, -0.6643, -1.3280, -0.7171, -0.9373],
       device='cuda:0'), range: [-3.5781, 3.7393]
2025-04-15 07:32:08,054 - INFO -   Noise shape: tensor([-0.7272, -0.9471,  0.0836, -0.4110, -2.2958,  0.9056,  0.5084],
       device='cuda:0'), range: [-3.8228, 3.2045]
2025-04-15 07:32:08,055 - INFO -   Noisy actions shape: tensor([-0.6195, -0.6339,  0.0243, -0.6149, -2.6130,  0.6026,  0.1538],
       device='cuda:0'), range: [-3.8023, 3.3899]
2025-04-15 07:32:08,097 - INFO - 
=== Epoch 9 Summary ===
2025-04-15 07:32:08,097 - INFO -   Avg total loss: 2.463801
2025-04-15 07:32:08,097 - INFO -   Avg diffusion loss: 1.797806
2025-04-15 07:32:08,097 - INFO -   Avg grasp loss: 1.331990
2025-04-15 07:32:08,097 - INFO - 
=== EPOCH 10/20 ===
2025-04-15 07:32:08,098 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:08,101 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:08,101 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7182, 3.2289]
2025-04-15 07:32:08,101 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8141, 3.8266]
2025-04-15 07:32:08,101 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,101 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,102 - INFO -   True actions shape: tensor([-0.5920,  0.7280,  1.5163, -0.4652,  2.3845,  0.1246,  0.6166],
       device='cuda:0'), range: [-3.7182, 3.2289]
2025-04-15 07:32:08,103 - INFO -   Noise shape: tensor([ 1.1536,  0.1736,  0.1418, -0.8831,  0.6563,  0.8461, -0.8907],
       device='cuda:0'), range: [-3.3798, 3.3461]
2025-04-15 07:32:08,103 - INFO -   Noisy actions shape: tensor([-0.2001,  0.7457,  1.4842, -0.7188,  2.4700,  0.3838,  0.3059],
       device='cuda:0'), range: [-3.4624, 3.2416]
2025-04-15 07:32:08,103 - INFO -   Diffusion: timestep range [28, 708], noise range [-3.3798, 3.3461]
2025-04-15 07:32:08,104 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4624, 3.2416]
2025-04-15 07:32:08,124 - INFO -   Model output shapes:
2025-04-15 07:32:08,125 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:08,125 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4191, 0.5655]
2025-04-15 07:32:08,125 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.7141
2025-04-15 07:32:08,125 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1758, 0.2090]
2025-04-15 07:32:08,146 - INFO -   Loss components:
2025-04-15 07:32:08,146 - INFO -     Diffusion loss: 2.119553 (coef: 1.0)
2025-04-15 07:32:08,146 - INFO -     Grasp quality loss: 0.696080 (coef: 0.5)
2025-04-15 07:32:08,146 - INFO -     Grasp rotation loss: 0.582180 (coef: 0.5)
2025-04-15 07:32:08,147 - INFO -     Grasp width loss: 6.727127 (coef: 0.005)
2025-04-15 07:32:08,147 - INFO -     TOTAL loss: 2.792318
2025-04-15 07:32:08,154 - INFO -   Gradients: avg norm: 0.487084, max norm: 3.781092, non-zero params: 250
2025-04-15 07:32:08,154 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-15 07:32:08,154 - INFO - --- Gradient Check @ Epoch 10, Batch 0 ---
2025-04-15 07:32:08,171 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:08,171 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:08,171 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=8.1892e-01, MaxNorm=3.4506e+00
2025-04-15 07:32:08,171 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.0102e-02, MaxNorm=2.1687e-02
2025-04-15 07:32:08,171 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.1903e-02, MaxNorm=3.0386e-02
2025-04-15 07:32:08,171 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.4335e-02, MaxNorm=1.1312e-01
2025-04-15 07:32:08,171 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.6110e+00, MaxNorm=2.9937e+00
2025-04-15 07:32:08,171 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.3992e+00, MaxNorm=2.5094e+00
2025-04-15 07:32:08,171 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.3237e-01, MaxNorm=5.7740e-01
2025-04-15 07:32:08,171 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.1319e-01, MaxNorm=4.3657e-01
2025-04-15 07:32:08,171 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=1.1151e+00, MaxNorm=1.1349e+00
2025-04-15 07:32:08,171 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=2.0772e+00, MaxNorm=3.7811e+00
2025-04-15 07:32:08,171 - INFO - --- End Gradient Check ---
2025-04-15 07:32:08,173 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:08,174 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6506, 3.6484]
2025-04-15 07:32:08,174 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7652, 3.2195]
2025-04-15 07:32:08,174 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,174 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,175 - INFO -   True actions shape: tensor([ 0.6304, -0.3765,  0.8354,  0.0915,  0.1544,  0.5395,  0.4888],
       device='cuda:0'), range: [-3.6506, 3.6484]
2025-04-15 07:32:08,175 - INFO -   Noise shape: tensor([ 0.2222, -0.5062, -1.0479,  0.7991,  0.4391,  0.9644,  1.6762],
       device='cuda:0'), range: [-3.8849, 4.4028]
2025-04-15 07:32:08,176 - INFO -   Noisy actions shape: tensor([ 0.3753, -0.5853, -0.8010,  0.7961,  0.4640,  1.0699,  1.7454],
       device='cuda:0'), range: [-3.5962, 3.2627]
2025-04-15 07:32:08,220 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:08,220 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8214, 3.4815]
2025-04-15 07:32:08,221 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6190, 3.1274]
2025-04-15 07:32:08,221 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,221 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,221 - INFO -   True actions shape: tensor([-0.1876,  0.5388, -0.2085,  1.6202,  1.5552, -1.6164, -0.3342],
       device='cuda:0'), range: [-3.8214, 3.4815]
2025-04-15 07:32:08,222 - INFO -   Noise shape: tensor([ 0.0216,  1.2599,  0.9171, -1.0189,  0.3906, -0.5503, -0.3109],
       device='cuda:0'), range: [-3.3150, 3.6004]
2025-04-15 07:32:08,223 - INFO -   Noisy actions shape: tensor([-0.0530,  1.3703,  0.7641, -0.3095,  0.9640, -1.1349, -0.4163],
       device='cuda:0'), range: [-3.4294, 3.4672]
2025-04-15 07:32:08,267 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:08,267 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0613, 3.5573]
2025-04-15 07:32:08,267 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7056, 3.1603]
2025-04-15 07:32:08,267 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,267 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,268 - INFO -   True actions shape: tensor([-0.6349, -1.8977,  1.9784,  0.1177, -0.7072, -1.0452,  1.0732],
       device='cuda:0'), range: [-3.0613, 3.5573]
2025-04-15 07:32:08,269 - INFO -   Noise shape: tensor([-1.3390,  1.0834,  0.1942,  1.2782, -0.5938,  0.6358,  0.4192],
       device='cuda:0'), range: [-3.9977, 3.7888]
2025-04-15 07:32:08,269 - INFO -   Noisy actions shape: tensor([-1.4643, -0.1705,  1.2727,  1.1234, -0.8886, -0.0617,  0.9500],
       device='cuda:0'), range: [-4.2481, 4.1366]
2025-04-15 07:32:08,314 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:08,314 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2839, 3.4053]
2025-04-15 07:32:08,314 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6201, 2.8803]
2025-04-15 07:32:08,314 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,314 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,315 - INFO -   True actions shape: tensor([ 0.8864,  1.0092,  1.1877, -0.0419,  1.8583,  0.7180, -0.5882],
       device='cuda:0'), range: [-3.2839, 3.4053]
2025-04-15 07:32:08,315 - INFO -   Noise shape: tensor([ 0.4100,  1.2900, -0.5710, -0.1273, -0.4822, -0.5391,  0.0699],
       device='cuda:0'), range: [-4.3529, 3.4335]
2025-04-15 07:32:08,316 - INFO -   Noisy actions shape: tensor([ 0.4347,  1.3178, -0.5374, -0.1284, -0.4299, -0.5188,  0.0534],
       device='cuda:0'), range: [-3.2112, 3.2124]
2025-04-15 07:32:08,361 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:08,361 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7879, 3.1336]
2025-04-15 07:32:08,361 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4110, 2.8394]
2025-04-15 07:32:08,361 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,361 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,362 - INFO -   True actions shape: tensor([-0.2216,  1.0634,  1.7120,  0.3896,  0.2473,  1.0315, -0.1503],
       device='cuda:0'), range: [-3.7879, 3.1336]
2025-04-15 07:32:08,362 - INFO -   Noise shape: tensor([-1.7737,  0.2164, -1.1612, -1.8079, -2.0038, -1.0340,  1.4716],
       device='cuda:0'), range: [-3.5436, 3.4062]
2025-04-15 07:32:08,363 - INFO -   Noisy actions shape: tensor([-1.7644,  0.5068, -0.6327, -1.6253, -1.8533, -0.7021,  1.3699],
       device='cuda:0'), range: [-3.2456, 2.9658]
2025-04-15 07:32:08,407 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:08,407 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7640, 3.2789]
2025-04-15 07:32:08,407 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4056, 2.8729]
2025-04-15 07:32:08,408 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,408 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,408 - INFO -   True actions shape: tensor([-2.1863,  1.1561, -0.1409, -0.1391, -0.4676, -0.1051, -0.0087],
       device='cuda:0'), range: [-3.7640, 3.2789]
2025-04-15 07:32:08,409 - INFO -   Noise shape: tensor([-0.4578,  0.2763,  0.1107, -0.0327, -0.1235, -1.4783,  0.4687],
       device='cuda:0'), range: [-3.6044, 3.2757]
2025-04-15 07:32:08,409 - INFO -   Noisy actions shape: tensor([-1.6124,  0.8809,  0.0119, -0.1056, -0.3660, -1.2794,  0.3819],
       device='cuda:0'), range: [-3.7044, 3.4214]
2025-04-15 07:32:08,455 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:08,455 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9724, 3.8370]
2025-04-15 07:32:08,455 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1259, 3.0881]
2025-04-15 07:32:08,455 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,455 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,456 - INFO -   True actions shape: tensor([ 0.7940,  1.7407, -1.5875,  0.6101,  1.9936, -0.5790,  0.1706],
       device='cuda:0'), range: [-2.9724, 3.8370]
2025-04-15 07:32:08,456 - INFO -   Noise shape: tensor([ 0.9327, -1.2274, -0.5672, -0.0606,  0.8477, -0.1565, -1.8033],
       device='cuda:0'), range: [-3.3807, 3.1677]
2025-04-15 07:32:08,457 - INFO -   Noisy actions shape: tensor([ 1.2217,  0.0396, -1.3962,  0.3119,  1.8625, -0.4687, -1.3533],
       device='cuda:0'), range: [-3.1978, 3.5427]
2025-04-15 07:32:08,502 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:08,502 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4415, 3.5471]
2025-04-15 07:32:08,502 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3318, 2.7982]
2025-04-15 07:32:08,502 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,502 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,503 - INFO -   True actions shape: tensor([ 0.7090,  1.5289,  1.9767, -0.4288,  0.1561, -0.9771,  1.4871],
       device='cuda:0'), range: [-3.4415, 3.5471]
2025-04-15 07:32:08,504 - INFO -   Noise shape: tensor([ 0.7585,  2.0437, -0.0073,  0.5757,  1.3414, -0.4204, -0.7462],
       device='cuda:0'), range: [-3.6317, 3.7211]
2025-04-15 07:32:08,504 - INFO -   Noisy actions shape: tensor([ 1.0378,  2.5443,  1.3002,  0.1489,  1.1102, -0.9611,  0.4222],
       device='cuda:0'), range: [-3.1363, 3.3986]
2025-04-15 07:32:08,549 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:08,549 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3683, 3.2633]
2025-04-15 07:32:08,549 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0060, 2.6586]
2025-04-15 07:32:08,549 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,549 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,550 - INFO -   True actions shape: tensor([ 0.1176, -1.4027, -0.4294,  1.3481, -0.5321,  0.4841,  0.3900],
       device='cuda:0'), range: [-3.3683, 3.2633]
2025-04-15 07:32:08,551 - INFO -   Noise shape: tensor([-2.2243,  0.8390, -1.1391, -0.8409, -0.0398,  0.4761,  1.0088],
       device='cuda:0'), range: [-3.5244, 3.7005]
2025-04-15 07:32:08,551 - INFO -   Noisy actions shape: tensor([-2.0710,  0.3485, -1.2165, -0.3678, -0.2072,  0.6055,  1.0805],
       device='cuda:0'), range: [-3.7391, 3.8334]
2025-04-15 07:32:08,596 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:08,596 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4379, 2.9462]
2025-04-15 07:32:08,596 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9376, 3.9642]
2025-04-15 07:32:08,596 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,596 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,597 - INFO -   True actions shape: tensor([-2.5313, -0.0499,  0.7676,  0.5431, -0.9651,  0.2202, -1.2932],
       device='cuda:0'), range: [-3.4379, 2.9462]
2025-04-15 07:32:08,597 - INFO -   Noise shape: tensor([-1.6065,  1.3911, -0.5614, -1.0517, -0.4779,  1.0025,  1.3405],
       device='cuda:0'), range: [-3.3007, 3.4086]
2025-04-15 07:32:08,598 - INFO -   Noisy actions shape: tensor([-2.0009,  1.3640, -0.4275, -0.9481, -0.6301,  1.0250,  1.1096],
       device='cuda:0'), range: [-3.2853, 3.4157]
2025-04-15 07:32:08,640 - INFO -   Loss components:
2025-04-15 07:32:08,640 - INFO -     Diffusion loss: 1.422919 (coef: 1.0)
2025-04-15 07:32:08,640 - INFO -     Grasp quality loss: 0.692761 (coef: 0.5)
2025-04-15 07:32:08,640 - INFO -     Grasp rotation loss: 0.563496 (coef: 0.5)
2025-04-15 07:32:08,640 - INFO -     Grasp width loss: 6.278711 (coef: 0.005)
2025-04-15 07:32:08,640 - INFO -     TOTAL loss: 2.082441
2025-04-15 07:32:08,648 - INFO -   Gradients: avg norm: 0.426959, max norm: 3.288678, non-zero params: 250
2025-04-15 07:32:08,648 - INFO -   Optimizer step complete, current LR: 0.000000e+00
2025-04-15 07:32:08,651 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:08,651 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5842, 3.3768]
2025-04-15 07:32:08,651 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1299, 2.9950]
2025-04-15 07:32:08,651 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,651 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,652 - INFO -   True actions shape: tensor([ 0.5343,  0.4483, -0.8664,  0.2184, -0.1497,  1.7992,  0.1921],
       device='cuda:0'), range: [-3.5842, 3.3768]
2025-04-15 07:32:08,652 - INFO -   Noise shape: tensor([ 0.1549, -0.5899, -1.2619,  1.5644, -0.9009,  1.7281, -0.4907],
       device='cuda:0'), range: [-3.6696, 3.0813]
2025-04-15 07:32:08,653 - INFO -   Noisy actions shape: tensor([ 0.4978, -0.0703, -1.4924,  1.2210, -0.7207,  2.4942, -0.1914],
       device='cuda:0'), range: [-4.3476, 3.3291]
2025-04-15 07:32:08,698 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:08,698 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2781, 3.5065]
2025-04-15 07:32:08,698 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2020, 2.2704]
2025-04-15 07:32:08,698 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,698 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,699 - INFO -   True actions shape: tensor([-0.8210,  0.3476, -0.3223, -1.3182, -1.0622, -0.6087, -0.4782],
       device='cuda:0'), range: [-3.2781, 3.5065]
2025-04-15 07:32:08,700 - INFO -   Noise shape: tensor([-1.3171, -0.4447,  1.3271, -1.1076, -0.2032,  0.5057, -0.6594],
       device='cuda:0'), range: [-3.6408, 3.1877]
2025-04-15 07:32:08,700 - INFO -   Noisy actions shape: tensor([-1.5051, -0.0582,  0.6885, -1.7178, -0.9060, -0.0876, -0.8018],
       device='cuda:0'), range: [-4.2035, 3.1767]
2025-04-15 07:32:08,743 - INFO - 
=== Epoch 10 Summary ===
2025-04-15 07:32:08,743 - INFO -   Avg total loss: 2.397687
2025-04-15 07:32:08,743 - INFO -   Avg diffusion loss: 1.732577
2025-04-15 07:32:08,743 - INFO -   Avg grasp loss: 1.330219
2025-04-15 07:32:08,912 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250415_073200/ckpt_epoch_10.pth
2025-04-15 07:32:08,912 - INFO - Saved model state with 16022452 parameters
2025-04-15 07:32:08,912 - INFO - 
=== EPOCH 11/20 ===
2025-04-15 07:32:08,913 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:08,916 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:08,916 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9399, 3.6895]
2025-04-15 07:32:08,917 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2706, 3.4507]
2025-04-15 07:32:08,917 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,917 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,917 - INFO -   True actions shape: tensor([-0.4649, -0.5021,  1.5683, -1.3120,  0.0394,  0.9434,  1.5119],
       device='cuda:0'), range: [-3.9399, 3.6895]
2025-04-15 07:32:08,918 - INFO -   Noise shape: tensor([ 0.7790, -0.7712, -1.2060,  0.4258,  1.5806,  1.5792, -0.2124],
       device='cuda:0'), range: [-3.4596, 3.3173]
2025-04-15 07:32:08,919 - INFO -   Noisy actions shape: tensor([ 0.2898, -0.9124,  0.1028, -0.5292,  1.2268,  1.8133,  0.8213],
       device='cuda:0'), range: [-3.7641, 3.3242]
2025-04-15 07:32:08,919 - INFO -   Diffusion: timestep range [83, 819], noise range [-3.4596, 3.3173]
2025-04-15 07:32:08,919 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.7641, 3.3242]
2025-04-15 07:32:08,940 - INFO -   Model output shapes:
2025-04-15 07:32:08,940 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:08,940 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4066, 0.5512]
2025-04-15 07:32:08,940 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6937
2025-04-15 07:32:08,940 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1545, 0.2462]
2025-04-15 07:32:08,962 - INFO -   Loss components:
2025-04-15 07:32:08,962 - INFO -     Diffusion loss: 1.581055 (coef: 1.0)
2025-04-15 07:32:08,962 - INFO -     Grasp quality loss: 0.693923 (coef: 0.5)
2025-04-15 07:32:08,962 - INFO -     Grasp rotation loss: 0.569883 (coef: 0.5)
2025-04-15 07:32:08,962 - INFO -     Grasp width loss: 6.076636 (coef: 0.005)
2025-04-15 07:32:08,962 - INFO -     TOTAL loss: 2.243341
2025-04-15 07:32:08,969 - INFO -   Gradients: avg norm: 0.375455, max norm: 3.036901, non-zero params: 250
2025-04-15 07:32:08,969 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-15 07:32:08,969 - INFO - --- Gradient Check @ Epoch 11, Batch 0 ---
2025-04-15 07:32:08,986 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:08,986 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:08,986 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.1459e-01, MaxNorm=2.3219e+00
2025-04-15 07:32:08,986 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=6.3183e-03, MaxNorm=1.1497e-02
2025-04-15 07:32:08,986 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.7074e-02, MaxNorm=4.1479e-02
2025-04-15 07:32:08,986 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=7.6383e-02, MaxNorm=1.6910e-01
2025-04-15 07:32:08,986 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2787e+00, MaxNorm=2.3523e+00
2025-04-15 07:32:08,986 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1894e+00, MaxNorm=2.1781e+00
2025-04-15 07:32:08,986 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=9.2172e-02, MaxNorm=4.1196e-01
2025-04-15 07:32:08,986 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.9868e-01, MaxNorm=3.6740e-01
2025-04-15 07:32:08,986 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.1262e-01, MaxNorm=8.2116e-01
2025-04-15 07:32:08,986 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6677e+00, MaxNorm=3.0369e+00
2025-04-15 07:32:08,986 - INFO - --- End Gradient Check ---
2025-04-15 07:32:08,989 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:08,989 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6537, 3.8296]
2025-04-15 07:32:08,989 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4850, 3.0117]
2025-04-15 07:32:08,989 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:08,989 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:08,990 - INFO -   True actions shape: tensor([ 0.2621, -0.9196,  1.7075, -0.0901,  2.4122,  0.7185,  0.2292],
       device='cuda:0'), range: [-3.6537, 3.8296]
2025-04-15 07:32:08,990 - INFO -   Noise shape: tensor([ 0.6036,  0.3573, -0.1180,  0.4785, -0.6748,  0.5159, -0.5318],
       device='cuda:0'), range: [-3.5835, 3.2228]
2025-04-15 07:32:08,991 - INFO -   Noisy actions shape: tensor([ 0.6574, -0.0833,  0.6445,  0.3902,  0.4541,  0.7792, -0.3769],
       device='cuda:0'), range: [-3.1023, 3.5398]
2025-04-15 07:32:09,036 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:09,036 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3692, 3.6279]
2025-04-15 07:32:09,036 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3438, 3.2438]
2025-04-15 07:32:09,036 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,036 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,037 - INFO -   True actions shape: tensor([ 0.2051,  0.1424,  0.0422,  1.6733, -1.7245,  0.5276, -0.5424],
       device='cuda:0'), range: [-3.3692, 3.6279]
2025-04-15 07:32:09,037 - INFO -   Noise shape: tensor([ 1.2669, -0.1429, -0.1353,  0.9540, -0.2127,  0.0704, -0.2602],
       device='cuda:0'), range: [-3.5581, 3.5680]
2025-04-15 07:32:09,038 - INFO -   Noisy actions shape: tensor([ 0.5959,  0.0898, -0.0028,  1.8893, -1.7031,  0.5227, -0.5969],
       device='cuda:0'), range: [-3.0627, 3.3681]
2025-04-15 07:32:09,082 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:09,082 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9765, 3.2625]
2025-04-15 07:32:09,082 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7915, 3.0644]
2025-04-15 07:32:09,083 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,083 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,083 - INFO -   True actions shape: tensor([-0.1896,  0.8306,  0.4120, -1.5969,  0.3100,  1.2679,  0.0291],
       device='cuda:0'), range: [-2.9765, 3.2625]
2025-04-15 07:32:09,084 - INFO -   Noise shape: tensor([ 1.0606, -0.7805,  1.8449,  0.6330,  0.6126,  0.3915,  0.3998],
       device='cuda:0'), range: [-2.8780, 3.4325]
2025-04-15 07:32:09,084 - INFO -   Noisy actions shape: tensor([ 0.4711,  0.2120,  1.4191, -0.9182,  0.6113,  1.2554,  0.2589],
       device='cuda:0'), range: [-3.2251, 3.2321]
2025-04-15 07:32:09,129 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:09,129 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4916, 3.3539]
2025-04-15 07:32:09,129 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1939, 2.9257]
2025-04-15 07:32:09,129 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,129 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,130 - INFO -   True actions shape: tensor([-0.7031,  0.0526,  2.3949,  1.2928,  0.6560, -0.3289,  0.7677],
       device='cuda:0'), range: [-3.4916, 3.3539]
2025-04-15 07:32:09,131 - INFO -   Noise shape: tensor([-0.7659,  0.0731, -0.4811, -1.0597, -1.7104,  1.1545,  0.4823],
       device='cuda:0'), range: [-3.2740, 3.2594]
2025-04-15 07:32:09,131 - INFO -   Noisy actions shape: tensor([-0.7979,  0.0755, -0.3686, -0.9982, -1.6779,  1.1378,  0.5177],
       device='cuda:0'), range: [-3.5317, 3.4598]
2025-04-15 07:32:09,176 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:09,176 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9305, 3.1934]
2025-04-15 07:32:09,176 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0989, 2.9377]
2025-04-15 07:32:09,176 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,176 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,177 - INFO -   True actions shape: tensor([ 1.3313, -0.9269,  0.8632,  0.1069,  0.1357,  2.2196, -0.2423],
       device='cuda:0'), range: [-3.9305, 3.1934]
2025-04-15 07:32:09,177 - INFO -   Noise shape: tensor([ 0.5417,  0.8217, -1.5095, -1.5427, -0.4923,  0.6041, -0.7868],
       device='cuda:0'), range: [-3.3468, 4.0174]
2025-04-15 07:32:09,178 - INFO -   Noisy actions shape: tensor([ 0.9544,  0.4658, -1.1355, -1.4189, -0.4190,  1.3093, -0.8226],
       device='cuda:0'), range: [-3.3803, 4.3034]
2025-04-15 07:32:09,222 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:09,223 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2234, 3.5199]
2025-04-15 07:32:09,223 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0266, 3.1876]
2025-04-15 07:32:09,223 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,223 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,224 - INFO -   True actions shape: tensor([-1.2397, -0.4549,  0.2095, -0.5897,  1.0838,  0.3352, -0.2770],
       device='cuda:0'), range: [-3.2234, 3.5199]
2025-04-15 07:32:09,224 - INFO -   Noise shape: tensor([ 0.5627, -0.5423, -0.3939,  1.7318, -1.3773,  1.5570, -0.9598],
       device='cuda:0'), range: [-3.6470, 3.4043]
2025-04-15 07:32:09,225 - INFO -   Noisy actions shape: tensor([-0.5843, -0.6974, -0.0941,  0.6666, -0.0604,  1.2605, -0.8308],
       device='cuda:0'), range: [-3.4663, 3.5912]
2025-04-15 07:32:09,269 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:09,269 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1404, 3.5592]
2025-04-15 07:32:09,269 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4097, 4.1013]
2025-04-15 07:32:09,269 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,269 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,270 - INFO -   True actions shape: tensor([ 0.7344, -0.3682,  1.3505,  0.0842, -1.3057, -0.3171, -0.1827],
       device='cuda:0'), range: [-3.1404, 3.5592]
2025-04-15 07:32:09,271 - INFO -   Noise shape: tensor([ 2.0218, -0.1146, -0.3834, -0.3113, -0.3502,  0.8111,  0.6756],
       device='cuda:0'), range: [-3.3165, 3.8676]
2025-04-15 07:32:09,271 - INFO -   Noisy actions shape: tensor([ 2.0343, -0.3205,  0.5504, -0.1892, -1.0930,  0.4317,  0.4108],
       device='cuda:0'), range: [-3.6187, 3.6563]
2025-04-15 07:32:09,316 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:09,316 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2268, 3.5440]
2025-04-15 07:32:09,316 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8369, 3.1568]
2025-04-15 07:32:09,316 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,316 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,317 - INFO -   True actions shape: tensor([-2.3274, -0.5520, -0.0055, -1.5781,  0.3748, -0.7079, -1.8246],
       device='cuda:0'), range: [-3.2268, 3.5440]
2025-04-15 07:32:09,317 - INFO -   Noise shape: tensor([-0.4206,  0.7507, -0.7801, -0.1285, -1.3027, -1.0556,  1.4258],
       device='cuda:0'), range: [-3.9531, 3.2618]
2025-04-15 07:32:09,318 - INFO -   Noisy actions shape: tensor([-1.9433,  0.1404, -0.5555, -1.2068, -0.6560, -1.2470, -0.2822],
       device='cuda:0'), range: [-4.2035, 3.3926]
2025-04-15 07:32:09,363 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:09,363 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2000, 3.3287]
2025-04-15 07:32:09,363 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.2214, 3.5042]
2025-04-15 07:32:09,363 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,363 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,364 - INFO -   True actions shape: tensor([-1.2840, -0.1301,  0.4805, -0.8560, -1.1673,  0.2662,  0.5459],
       device='cuda:0'), range: [-3.2000, 3.3287]
2025-04-15 07:32:09,364 - INFO -   Noise shape: tensor([ 0.2280,  0.2363, -0.1958, -0.5165, -0.3561,  1.3486, -0.2192],
       device='cuda:0'), range: [-4.0449, 3.4552]
2025-04-15 07:32:09,365 - INFO -   Noisy actions shape: tensor([-0.8199,  0.0567,  0.2344, -0.9849, -1.1148,  1.0853,  0.2684],
       device='cuda:0'), range: [-3.5921, 3.2741]
2025-04-15 07:32:09,409 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:09,409 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3831, 3.4837]
2025-04-15 07:32:09,410 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1809, 3.3521]
2025-04-15 07:32:09,410 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,410 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,410 - INFO -   True actions shape: tensor([-1.2513e-03, -5.7719e-01,  1.2953e+00,  7.6628e-01,  6.4096e-03,
         6.1641e-01, -3.1407e-01], device='cuda:0'), range: [-3.3831, 3.4837]
2025-04-15 07:32:09,411 - INFO -   Noise shape: tensor([-0.5878, -0.4132,  1.0288, -0.8720, -0.1512,  0.0815, -1.8781],
       device='cuda:0'), range: [-3.9146, 3.6707]
2025-04-15 07:32:09,411 - INFO -   Noisy actions shape: tensor([-0.2854, -0.7050,  1.6313,  0.2490, -0.0675,  0.5790, -1.1831],
       device='cuda:0'), range: [-3.3086, 3.3095]
2025-04-15 07:32:09,454 - INFO -   Loss components:
2025-04-15 07:32:09,454 - INFO -     Diffusion loss: 1.824336 (coef: 1.0)
2025-04-15 07:32:09,454 - INFO -     Grasp quality loss: 0.698735 (coef: 0.5)
2025-04-15 07:32:09,454 - INFO -     Grasp rotation loss: 0.559977 (coef: 0.5)
2025-04-15 07:32:09,454 - INFO -     Grasp width loss: 6.139002 (coef: 0.005)
2025-04-15 07:32:09,454 - INFO -     TOTAL loss: 2.484387
2025-04-15 07:32:09,461 - INFO -   Gradients: avg norm: 0.440076, max norm: 3.341656, non-zero params: 250
2025-04-15 07:32:09,461 - INFO -   Optimizer step complete, current LR: 8.213938e-05
2025-04-15 07:32:09,464 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:09,464 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1692, 3.6911]
2025-04-15 07:32:09,464 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8685, 2.5233]
2025-04-15 07:32:09,464 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,464 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,465 - INFO -   True actions shape: tensor([-0.6289, -0.0174,  0.9397,  0.6658, -0.3927, -0.4237,  1.0904],
       device='cuda:0'), range: [-3.1692, 3.6911]
2025-04-15 07:32:09,466 - INFO -   Noise shape: tensor([-0.5493, -1.1561,  0.3285,  1.3905, -0.8434,  0.4627,  0.4528],
       device='cuda:0'), range: [-3.4237, 3.0780]
2025-04-15 07:32:09,467 - INFO -   Noisy actions shape: tensor([-0.8071, -0.9679,  0.7980,  1.5250, -0.9188,  0.1464,  0.9853],
       device='cuda:0'), range: [-3.6946, 3.3277]
2025-04-15 07:32:09,512 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:09,512 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9199, 3.3033]
2025-04-15 07:32:09,512 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1923, 3.5871]
2025-04-15 07:32:09,512 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,512 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,513 - INFO -   True actions shape: tensor([ 1.9855,  0.3941, -1.0742,  1.1654,  1.3497,  1.5850,  2.1578],
       device='cuda:0'), range: [-2.9199, 3.3033]
2025-04-15 07:32:09,514 - INFO -   Noise shape: tensor([ 1.5860,  1.2704,  1.7657, -0.1923,  1.1892,  0.2367,  0.9409],
       device='cuda:0'), range: [-3.6046, 3.8664]
2025-04-15 07:32:09,514 - INFO -   Noisy actions shape: tensor([2.5404, 1.1185, 0.3119, 0.7692, 1.7983, 1.3665, 2.2578],
       device='cuda:0'), range: [-3.5125, 3.9397]
2025-04-15 07:32:09,557 - INFO - 
=== Epoch 11 Summary ===
2025-04-15 07:32:09,557 - INFO -   Avg total loss: 2.379590
2025-04-15 07:32:09,557 - INFO -   Avg diffusion loss: 1.718134
2025-04-15 07:32:09,557 - INFO -   Avg grasp loss: 1.322913
2025-04-15 07:32:09,557 - INFO - 
=== EPOCH 12/20 ===
2025-04-15 07:32:09,558 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:09,560 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:09,561 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6456, 3.3801]
2025-04-15 07:32:09,561 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0743, 3.8345]
2025-04-15 07:32:09,561 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,561 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,562 - INFO -   True actions shape: tensor([-1.1655, -1.2900,  1.2126,  0.7299,  0.1547,  1.1818, -0.4237],
       device='cuda:0'), range: [-3.6456, 3.3801]
2025-04-15 07:32:09,562 - INFO -   Noise shape: tensor([-1.2260, -0.9389, -0.1462,  1.0122,  0.1707, -0.3701, -0.9504],
       device='cuda:0'), range: [-3.1242, 3.9528]
2025-04-15 07:32:09,563 - INFO -   Noisy actions shape: tensor([-1.5605, -1.5588,  1.0511,  1.0757,  0.2103,  0.9328, -0.7704],
       device='cuda:0'), range: [-3.5144, 4.6896]
2025-04-15 07:32:09,563 - INFO -   Diffusion: timestep range [169, 975], noise range [-3.1242, 3.9528]
2025-04-15 07:32:09,563 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5144, 4.6896]
2025-04-15 07:32:09,584 - INFO -   Model output shapes:
2025-04-15 07:32:09,584 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:09,584 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4346, 0.5574]
2025-04-15 07:32:09,584 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6483
2025-04-15 07:32:09,584 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1246, 0.1949]
2025-04-15 07:32:09,605 - INFO -   Loss components:
2025-04-15 07:32:09,605 - INFO -     Diffusion loss: 1.646172 (coef: 1.0)
2025-04-15 07:32:09,605 - INFO -     Grasp quality loss: 0.695423 (coef: 0.5)
2025-04-15 07:32:09,605 - INFO -     Grasp rotation loss: 0.569350 (coef: 0.5)
2025-04-15 07:32:09,605 - INFO -     Grasp width loss: 5.874886 (coef: 0.005)
2025-04-15 07:32:09,605 - INFO -     TOTAL loss: 2.307933
2025-04-15 07:32:09,613 - INFO -   Gradients: avg norm: 0.368077, max norm: 2.945329, non-zero params: 250
2025-04-15 07:32:09,613 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-15 07:32:09,613 - INFO - --- Gradient Check @ Epoch 12, Batch 0 ---
2025-04-15 07:32:09,630 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:09,630 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:09,630 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.1089e-01, MaxNorm=2.3948e+00
2025-04-15 07:32:09,630 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.3207e-02, MaxNorm=2.5855e-02
2025-04-15 07:32:09,630 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.0057e-03, MaxNorm=2.1756e-02
2025-04-15 07:32:09,630 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=5.8856e-02, MaxNorm=1.2488e-01
2025-04-15 07:32:09,630 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2574e+00, MaxNorm=2.3261e+00
2025-04-15 07:32:09,630 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.0671e+00, MaxNorm=1.9111e+00
2025-04-15 07:32:09,630 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=9.0003e-02, MaxNorm=4.1246e-01
2025-04-15 07:32:09,630 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.2769e-01, MaxNorm=3.2818e-01
2025-04-15 07:32:09,630 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.4981e-01, MaxNorm=8.7943e-01
2025-04-15 07:32:09,630 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.6214e+00, MaxNorm=2.9453e+00
2025-04-15 07:32:09,630 - INFO - --- End Gradient Check ---
2025-04-15 07:32:09,633 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:09,633 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4438, 3.7564]
2025-04-15 07:32:09,633 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6333, 3.4107]
2025-04-15 07:32:09,633 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,633 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,634 - INFO -   True actions shape: tensor([-0.4105,  0.3783, -0.3879, -0.5454, -0.9096, -1.0669,  0.7813],
       device='cuda:0'), range: [-3.4438, 3.7564]
2025-04-15 07:32:09,634 - INFO -   Noise shape: tensor([ 0.4627, -0.4692, -1.9159, -0.7401,  0.3103, -0.0883,  0.8503],
       device='cuda:0'), range: [-3.5313, 3.3956]
2025-04-15 07:32:09,635 - INFO -   Noisy actions shape: tensor([-0.2141,  0.1817, -1.0581, -0.7772, -0.7345, -1.0260,  1.0370],
       device='cuda:0'), range: [-3.2581, 3.5833]
2025-04-15 07:32:09,681 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:09,681 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7626, 3.3940]
2025-04-15 07:32:09,681 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9766, 3.2653]
2025-04-15 07:32:09,681 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,681 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,682 - INFO -   True actions shape: tensor([ 0.4618, -1.5482,  2.0570, -3.1533, -0.5127,  0.3389, -0.7403],
       device='cuda:0'), range: [-3.7626, 3.3940]
2025-04-15 07:32:09,683 - INFO -   Noise shape: tensor([-0.1442, -0.0357,  1.3143, -0.7362, -0.7715, -1.7169,  0.3575],
       device='cuda:0'), range: [-2.9819, 3.6769]
2025-04-15 07:32:09,683 - INFO -   Noisy actions shape: tensor([ 0.2179, -1.1033,  2.3754, -2.7235, -0.9108, -0.9969, -0.2586],
       device='cuda:0'), range: [-3.3064, 3.4536]
2025-04-15 07:32:09,730 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:09,730 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6602, 3.4058]
2025-04-15 07:32:09,730 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1889, 2.8261]
2025-04-15 07:32:09,731 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,731 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,731 - INFO -   True actions shape: tensor([ 0.7828,  0.2870,  0.3320, -0.1048, -0.6047,  0.0086, -0.0569],
       device='cuda:0'), range: [-3.6602, 3.4058]
2025-04-15 07:32:09,732 - INFO -   Noise shape: tensor([-1.1885, -0.3567,  0.6545, -1.4830,  1.2291,  0.7528, -0.5386],
       device='cuda:0'), range: [-3.5910, 3.0459]
2025-04-15 07:32:09,732 - INFO -   Noisy actions shape: tensor([-1.0300, -0.2999,  0.7032, -1.4779,  1.1016,  0.7422, -0.5401],
       device='cuda:0'), range: [-3.2928, 3.1974]
2025-04-15 07:32:09,777 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:09,777 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1632, 3.5085]
2025-04-15 07:32:09,777 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6698, 2.6516]
2025-04-15 07:32:09,777 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,777 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,778 - INFO -   True actions shape: tensor([ 0.4621, -0.5989,  0.1974, -0.4990, -1.0143,  0.1077, -0.8377],
       device='cuda:0'), range: [-3.1632, 3.5085]
2025-04-15 07:32:09,779 - INFO -   Noise shape: tensor([ 1.3539, -1.4472,  0.0131,  0.3694, -0.5102, -0.4128,  1.9047],
       device='cuda:0'), range: [-3.4221, 3.2391]
2025-04-15 07:32:09,779 - INFO -   Noisy actions shape: tensor([ 1.4233, -1.5450,  0.0573,  0.2473, -0.7258, -0.3779,  1.6666],
       device='cuda:0'), range: [-3.1729, 3.3757]
2025-04-15 07:32:09,824 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:09,824 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6426, 3.2969]
2025-04-15 07:32:09,824 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0462, 3.6248]
2025-04-15 07:32:09,824 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,824 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,825 - INFO -   True actions shape: tensor([ 1.4912, -0.2068, -1.0352, -1.2872, -0.8772,  1.2670,  0.2768],
       device='cuda:0'), range: [-3.6426, 3.2969]
2025-04-15 07:32:09,825 - INFO -   Noise shape: tensor([-1.1737, -0.5589,  0.2230,  0.4269, -1.0925,  0.3860,  0.4473],
       device='cuda:0'), range: [-3.1105, 3.7394]
2025-04-15 07:32:09,826 - INFO -   Noisy actions shape: tensor([-0.1119, -0.5769, -0.4081, -0.3846, -1.3978,  1.0404,  0.5253],
       device='cuda:0'), range: [-3.0992, 3.3867]
2025-04-15 07:32:09,871 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:09,871 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2672, 3.1258]
2025-04-15 07:32:09,871 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0947, 3.3570]
2025-04-15 07:32:09,871 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,871 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,872 - INFO -   True actions shape: tensor([ 1.7039, -0.7442, -0.1110, -0.4691, -1.7414,  0.4435, -0.7606],
       device='cuda:0'), range: [-3.2672, 3.1258]
2025-04-15 07:32:09,873 - INFO -   Noise shape: tensor([ 1.0762,  0.1980, -0.2849, -0.5754, -0.2752,  0.9651,  1.0906],
       device='cuda:0'), range: [-3.5427, 3.4559]
2025-04-15 07:32:09,873 - INFO -   Noisy actions shape: tensor([ 2.0075, -0.5712, -0.2291, -0.6804, -1.6744,  0.8359, -0.1775],
       device='cuda:0'), range: [-3.3478, 3.2243]
2025-04-15 07:32:09,918 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:09,918 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1846, 3.4585]
2025-04-15 07:32:09,918 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5145, 3.3420]
2025-04-15 07:32:09,918 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,918 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,919 - INFO -   True actions shape: tensor([-0.1758, -1.3612, -0.0175,  0.3533,  0.4826, -0.4772,  0.4914],
       device='cuda:0'), range: [-4.1846, 3.4585]
2025-04-15 07:32:09,919 - INFO -   Noise shape: tensor([-1.5672, -0.0400,  2.5146,  0.2119, -0.4373,  0.9232,  0.2900],
       device='cuda:0'), range: [-3.3798, 3.5850]
2025-04-15 07:32:09,920 - INFO -   Noisy actions shape: tensor([-0.8109, -1.2548,  1.0286,  0.4094,  0.2574, -0.0506,  0.5674],
       device='cuda:0'), range: [-4.1006, 3.7597]
2025-04-15 07:32:09,964 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:09,965 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0176, 3.1864]
2025-04-15 07:32:09,965 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5976, 2.8367]
2025-04-15 07:32:09,965 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:09,965 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:09,965 - INFO -   True actions shape: tensor([-0.4152,  1.7852, -0.3973,  0.2639, -0.6423, -0.3069, -0.1516],
       device='cuda:0'), range: [-4.0176, 3.1864]
2025-04-15 07:32:09,966 - INFO -   Noise shape: tensor([ 1.7240,  2.4928, -0.9701, -1.7175,  0.4121,  0.6210, -0.0075],
       device='cuda:0'), range: [-3.3706, 3.5687]
2025-04-15 07:32:09,967 - INFO -   Noisy actions shape: tensor([ 0.0335,  2.3568, -0.6294, -0.1784, -0.5174, -0.1401, -0.1486],
       device='cuda:0'), range: [-3.5452, 3.5329]
2025-04-15 07:32:10,011 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:10,011 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7658, 3.3346]
2025-04-15 07:32:10,011 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1804, 3.0041]
2025-04-15 07:32:10,011 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,011 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,012 - INFO -   True actions shape: tensor([ 0.2771,  0.0789, -1.1716, -0.8548, -0.7972, -1.8077, -2.2874],
       device='cuda:0'), range: [-3.7658, 3.3346]
2025-04-15 07:32:10,012 - INFO -   Noise shape: tensor([-0.6520,  1.7223,  0.2874, -0.6658, -0.7295,  0.3510,  0.1007],
       device='cuda:0'), range: [-3.2313, 3.8152]
2025-04-15 07:32:10,013 - INFO -   Noisy actions shape: tensor([-0.6417,  1.7240,  0.2453, -0.6960, -0.7576,  0.2860,  0.0187],
       device='cuda:0'), range: [-3.3149, 3.6678]
2025-04-15 07:32:10,058 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:10,058 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6192, 3.5702]
2025-04-15 07:32:10,058 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8836, 3.3122]
2025-04-15 07:32:10,058 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,058 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,059 - INFO -   True actions shape: tensor([ 1.9194,  0.4333,  0.6611,  1.6242, -0.6187,  0.2497,  1.3991],
       device='cuda:0'), range: [-3.6192, 3.5702]
2025-04-15 07:32:10,059 - INFO -   Noise shape: tensor([ 2.2209, -0.1754, -1.0469,  0.7592, -1.0200, -1.2601,  0.8942],
       device='cuda:0'), range: [-3.1240, 3.5612]
2025-04-15 07:32:10,060 - INFO -   Noisy actions shape: tensor([ 2.9101,  0.0914, -0.5119,  1.5264, -1.1922, -0.9160,  1.5156],
       device='cuda:0'), range: [-3.5320, 3.3545]
2025-04-15 07:32:10,102 - INFO -   Loss components:
2025-04-15 07:32:10,102 - INFO -     Diffusion loss: 1.563577 (coef: 1.0)
2025-04-15 07:32:10,102 - INFO -     Grasp quality loss: 0.693740 (coef: 0.5)
2025-04-15 07:32:10,102 - INFO -     Grasp rotation loss: 0.571102 (coef: 0.5)
2025-04-15 07:32:10,102 - INFO -     Grasp width loss: 5.980400 (coef: 0.005)
2025-04-15 07:32:10,102 - INFO -     TOTAL loss: 2.225900
2025-04-15 07:32:10,109 - INFO -   Gradients: avg norm: 0.380476, max norm: 2.906604, non-zero params: 250
2025-04-15 07:32:10,109 - INFO -   Optimizer step complete, current LR: 5.868241e-05
2025-04-15 07:32:10,112 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:10,112 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4826, 3.6365]
2025-04-15 07:32:10,112 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2604, 3.0559]
2025-04-15 07:32:10,112 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,112 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,113 - INFO -   True actions shape: tensor([ 1.0391, -2.1164, -1.8570, -1.7621, -0.0206, -0.3911, -1.6309],
       device='cuda:0'), range: [-3.4826, 3.6365]
2025-04-15 07:32:10,114 - INFO -   Noise shape: tensor([-0.0884,  0.2400,  0.0501,  1.6230,  0.0067, -0.8613, -1.8224],
       device='cuda:0'), range: [-3.0911, 3.4230]
2025-04-15 07:32:10,114 - INFO -   Noisy actions shape: tensor([-0.0137,  0.0878, -0.0831,  1.4926,  0.0052, -0.8871, -1.9345],
       device='cuda:0'), range: [-3.7886, 2.9377]
2025-04-15 07:32:10,159 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:10,159 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5493, 3.5826]
2025-04-15 07:32:10,159 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7889, 2.5984]
2025-04-15 07:32:10,159 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,159 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,160 - INFO -   True actions shape: tensor([ 1.5641, -0.9699,  0.2854, -1.3171,  0.7335,  0.8764, -0.0730],
       device='cuda:0'), range: [-3.5493, 3.5826]
2025-04-15 07:32:10,160 - INFO -   Noise shape: tensor([ 0.2866, -0.2376, -0.2889, -1.0621, -1.0089, -0.3295,  0.2457],
       device='cuda:0'), range: [-3.8868, 3.5768]
2025-04-15 07:32:10,161 - INFO -   Noisy actions shape: tensor([ 1.5700, -0.9748,  0.2791, -1.3397,  0.7115,  0.8691, -0.0677],
       device='cuda:0'), range: [-3.8228, 3.1099]
2025-04-15 07:32:10,203 - INFO - 
=== Epoch 12 Summary ===
2025-04-15 07:32:10,203 - INFO -   Avg total loss: 2.318260
2025-04-15 07:32:10,203 - INFO -   Avg diffusion loss: 1.653474
2025-04-15 07:32:10,203 - INFO -   Avg grasp loss: 1.329572
2025-04-15 07:32:10,203 - INFO - 
=== EPOCH 13/20 ===
2025-04-15 07:32:10,204 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:10,207 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:10,207 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3474, 3.3972]
2025-04-15 07:32:10,207 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0091, 3.6942]
2025-04-15 07:32:10,207 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,207 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,208 - INFO -   True actions shape: tensor([-0.7445,  1.3070, -1.1607,  0.2416, -1.9922, -0.7039, -1.9757],
       device='cuda:0'), range: [-3.3474, 3.3972]
2025-04-15 07:32:10,208 - INFO -   Noise shape: tensor([-0.4092, -1.4062, -1.4498, -1.5682, -1.5693,  0.8817,  0.4879],
       device='cuda:0'), range: [-4.2176, 3.3106]
2025-04-15 07:32:10,209 - INFO -   Noisy actions shape: tensor([-0.8221, -0.0162, -1.8394, -0.9017, -2.5258,  0.0941, -1.1006],
       device='cuda:0'), range: [-3.1592, 3.2639]
2025-04-15 07:32:10,209 - INFO -   Diffusion: timestep range [70, 811], noise range [-4.2176, 3.3106]
2025-04-15 07:32:10,209 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.1592, 3.2639]
2025-04-15 07:32:10,230 - INFO -   Model output shapes:
2025-04-15 07:32:10,230 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:10,230 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4347, 0.5726]
2025-04-15 07:32:10,230 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6408
2025-04-15 07:32:10,231 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1065, 0.3023]
2025-04-15 07:32:10,252 - INFO -   Loss components:
2025-04-15 07:32:10,252 - INFO -     Diffusion loss: 1.735750 (coef: 1.0)
2025-04-15 07:32:10,252 - INFO -     Grasp quality loss: 0.694541 (coef: 0.5)
2025-04-15 07:32:10,252 - INFO -     Grasp rotation loss: 0.555480 (coef: 0.5)
2025-04-15 07:32:10,252 - INFO -     Grasp width loss: 5.527124 (coef: 0.005)
2025-04-15 07:32:10,252 - INFO -     TOTAL loss: 2.388397
2025-04-15 07:32:10,259 - INFO -   Gradients: avg norm: 0.367178, max norm: 3.152463, non-zero params: 250
2025-04-15 07:32:10,259 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-15 07:32:10,259 - INFO - --- Gradient Check @ Epoch 13, Batch 0 ---
2025-04-15 07:32:10,276 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:10,276 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:10,276 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=6.0946e-01, MaxNorm=2.5370e+00
2025-04-15 07:32:10,276 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=5.6595e-03, MaxNorm=1.0395e-02
2025-04-15 07:32:10,276 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.9401e-03, MaxNorm=2.5527e-02
2025-04-15 07:32:10,276 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.8408e-02, MaxNorm=9.7144e-02
2025-04-15 07:32:10,276 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2246e+00, MaxNorm=2.3223e+00
2025-04-15 07:32:10,276 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.1997e+00, MaxNorm=2.2144e+00
2025-04-15 07:32:10,276 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=8.6650e-02, MaxNorm=3.8861e-01
2025-04-15 07:32:10,276 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.2664e-01, MaxNorm=2.9784e-01
2025-04-15 07:32:10,276 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=8.4808e-01, MaxNorm=8.7706e-01
2025-04-15 07:32:10,276 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.7285e+00, MaxNorm=3.1525e+00
2025-04-15 07:32:10,276 - INFO - --- End Gradient Check ---
2025-04-15 07:32:10,279 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:10,279 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1614, 3.3401]
2025-04-15 07:32:10,279 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6155, 3.3125]
2025-04-15 07:32:10,279 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,279 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,280 - INFO -   True actions shape: tensor([-1.3162, -0.0446, -1.2154, -0.0925, -1.3282, -0.4418,  0.4319],
       device='cuda:0'), range: [-4.1614, 3.3401]
2025-04-15 07:32:10,281 - INFO -   Noise shape: tensor([ 1.2702, -1.1462,  0.4838, -0.6224,  1.0702,  0.2012,  1.1763],
       device='cuda:0'), range: [-3.5325, 3.0796]
2025-04-15 07:32:10,281 - INFO -   Noisy actions shape: tensor([-0.2373, -0.7495, -0.6487, -0.4604, -0.3714, -0.2200,  1.0710],
       device='cuda:0'), range: [-3.3383, 3.7772]
2025-04-15 07:32:10,326 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:10,326 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7365, 4.5490]
2025-04-15 07:32:10,326 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6558, 3.4498]
2025-04-15 07:32:10,326 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,326 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,327 - INFO -   True actions shape: tensor([ 0.1976,  0.3140,  0.2757, -0.8771,  0.0402, -0.3660,  0.0653],
       device='cuda:0'), range: [-3.7365, 4.5490]
2025-04-15 07:32:10,328 - INFO -   Noise shape: tensor([-0.2695,  0.5488, -1.1966, -0.9704,  0.3162, -0.2391, -0.7417],
       device='cuda:0'), range: [-3.1292, 3.2099]
2025-04-15 07:32:10,329 - INFO -   Noisy actions shape: tensor([-0.2285,  0.5973, -1.1253, -1.1155,  0.3182, -0.3025, -0.7170],
       device='cuda:0'), range: [-3.4495, 4.4519]
2025-04-15 07:32:10,374 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:10,374 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6420, 3.4619]
2025-04-15 07:32:10,374 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4582, 3.0971]
2025-04-15 07:32:10,374 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,374 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,375 - INFO -   True actions shape: tensor([-0.2343,  0.2014, -0.6635,  0.6526,  1.9532,  0.9503,  0.9278],
       device='cuda:0'), range: [-3.6420, 3.4619]
2025-04-15 07:32:10,375 - INFO -   Noise shape: tensor([-2.0637, -0.2679, -1.4780, -1.8965,  0.7994,  0.5292,  0.7784],
       device='cuda:0'), range: [-3.2234, 3.5274]
2025-04-15 07:32:10,376 - INFO -   Noisy actions shape: tensor([-0.7750,  0.1228, -1.0329,  0.1245,  2.0954,  1.0568,  1.1015],
       device='cuda:0'), range: [-3.7250, 3.7501]
2025-04-15 07:32:10,421 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:10,421 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1614, 3.3096]
2025-04-15 07:32:10,421 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2586, 2.5851]
2025-04-15 07:32:10,421 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,421 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,422 - INFO -   True actions shape: tensor([0.8771, 0.3442, 0.5172, 0.1337, 0.2552, 0.2442, 0.1603],
       device='cuda:0'), range: [-3.1614, 3.3096]
2025-04-15 07:32:10,423 - INFO -   Noise shape: tensor([-0.5741, -0.3018, -0.0993,  0.0204,  1.1619,  0.2793, -0.6346],
       device='cuda:0'), range: [-3.5717, 4.1497]
2025-04-15 07:32:10,423 - INFO -   Noisy actions shape: tensor([-0.4444, -0.2501, -0.0252,  0.0390,  1.1863,  0.3110, -0.6055],
       device='cuda:0'), range: [-3.6783, 4.0906]
2025-04-15 07:32:10,469 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:10,469 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9363, 3.6165]
2025-04-15 07:32:10,469 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2026, 3.1472]
2025-04-15 07:32:10,469 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,469 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,470 - INFO -   True actions shape: tensor([ 2.6182,  1.2301,  1.2147,  0.6143,  0.8146, -0.1618, -0.5142],
       device='cuda:0'), range: [-3.9363, 3.6165]
2025-04-15 07:32:10,470 - INFO -   Noise shape: tensor([-0.1014,  0.0463, -0.5324, -0.0821,  0.8612,  1.5424,  1.6003],
       device='cuda:0'), range: [-3.8577, 3.3317]
2025-04-15 07:32:10,471 - INFO -   Noisy actions shape: tensor([ 0.5238,  0.3373, -0.2284,  0.0662,  1.0302,  1.4597,  1.4322],
       device='cuda:0'), range: [-3.8223, 3.1688]
2025-04-15 07:32:10,516 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:10,516 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4362, 3.5942]
2025-04-15 07:32:10,516 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1864, 2.9754]
2025-04-15 07:32:10,516 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,516 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,517 - INFO -   True actions shape: tensor([-0.5049,  0.3122,  1.7514, -0.8962,  0.5866, -1.9968,  1.5821],
       device='cuda:0'), range: [-3.4362, 3.5942]
2025-04-15 07:32:10,517 - INFO -   Noise shape: tensor([-0.9642, -0.7474, -0.5954, -0.8495, -0.6000,  0.0055,  0.6383],
       device='cuda:0'), range: [-3.5541, 3.5810]
2025-04-15 07:32:10,518 - INFO -   Noisy actions shape: tensor([-1.0524, -0.6592, -0.1907, -1.0277, -0.4545, -0.4390,  0.9743],
       device='cuda:0'), range: [-3.3153, 3.4812]
2025-04-15 07:32:10,563 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:10,563 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5914, 3.3665]
2025-04-15 07:32:10,563 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9826, 3.0557]
2025-04-15 07:32:10,563 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,563 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,564 - INFO -   True actions shape: tensor([-0.6895, -0.5990, -0.3969,  0.9945,  1.1131, -1.0964, -0.2910],
       device='cuda:0'), range: [-3.5914, 3.3665]
2025-04-15 07:32:10,564 - INFO -   Noise shape: tensor([-0.0949, -2.1775, -1.0796, -0.0255, -0.8191,  1.0600,  1.4270],
       device='cuda:0'), range: [-3.8010, 3.3656]
2025-04-15 07:32:10,565 - INFO -   Noisy actions shape: tensor([-0.4522, -2.1562, -1.1230,  0.5156, -0.0883,  0.3002,  1.0439],
       device='cuda:0'), range: [-3.7619, 3.4254]
2025-04-15 07:32:10,609 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:10,610 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1624, 3.5419]
2025-04-15 07:32:10,610 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6369, 2.6993]
2025-04-15 07:32:10,610 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,610 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,611 - INFO -   True actions shape: tensor([ 1.2417, -1.1000, -0.2895, -1.5777,  0.6888,  0.7517, -0.7710],
       device='cuda:0'), range: [-4.1624, 3.5419]
2025-04-15 07:32:10,611 - INFO -   Noise shape: tensor([ 0.3488, -0.8567, -1.5923, -0.4504,  0.7643, -1.5443, -0.4257],
       device='cuda:0'), range: [-3.2030, 3.4652]
2025-04-15 07:32:10,612 - INFO -   Noisy actions shape: tensor([ 1.2532, -1.3787, -1.0331, -1.5959,  0.9751, -0.1023, -0.8807],
       device='cuda:0'), range: [-3.7608, 3.2897]
2025-04-15 07:32:10,657 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:10,657 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1434, 3.6896]
2025-04-15 07:32:10,657 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9695, 3.9636]
2025-04-15 07:32:10,657 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,657 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,658 - INFO -   True actions shape: tensor([ 0.5556, -0.3288, -0.8215, -0.2998,  1.0751,  0.4380,  0.5781],
       device='cuda:0'), range: [-3.1434, 3.6896]
2025-04-15 07:32:10,658 - INFO -   Noise shape: tensor([-0.8435, -1.2317,  0.1888, -1.7617,  0.0431, -1.5804,  1.0141],
       device='cuda:0'), range: [-3.3312, 3.2094]
2025-04-15 07:32:10,659 - INFO -   Noisy actions shape: tensor([-0.8231, -1.2427,  0.1593, -1.7713,  0.0816, -1.5637,  1.0342],
       device='cuda:0'), range: [-3.2547, 3.8207]
2025-04-15 07:32:10,704 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:10,704 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3750, 3.5733]
2025-04-15 07:32:10,704 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5334, 3.6964]
2025-04-15 07:32:10,704 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,704 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,705 - INFO -   True actions shape: tensor([-0.3268, -0.6441,  2.6025,  1.0722, -0.2973,  0.0334,  0.0331],
       device='cuda:0'), range: [-3.3750, 3.5733]
2025-04-15 07:32:10,705 - INFO -   Noise shape: tensor([-1.8166,  0.1473, -0.2000, -0.8891,  0.0612, -0.5083,  0.0492],
       device='cuda:0'), range: [-3.6767, 3.7189]
2025-04-15 07:32:10,706 - INFO -   Noisy actions shape: tensor([-1.0963, -0.5126,  2.2459,  0.5686, -0.2396, -0.1948,  0.0515],
       device='cuda:0'), range: [-3.5728, 3.4240]
2025-04-15 07:32:10,748 - INFO -   Loss components:
2025-04-15 07:32:10,748 - INFO -     Diffusion loss: 1.493653 (coef: 1.0)
2025-04-15 07:32:10,748 - INFO -     Grasp quality loss: 0.694526 (coef: 0.5)
2025-04-15 07:32:10,748 - INFO -     Grasp rotation loss: 0.579297 (coef: 0.5)
2025-04-15 07:32:10,748 - INFO -     Grasp width loss: 5.366386 (coef: 0.005)
2025-04-15 07:32:10,748 - INFO -     TOTAL loss: 2.157397
2025-04-15 07:32:10,756 - INFO -   Gradients: avg norm: 0.346572, max norm: 2.629808, non-zero params: 250
2025-04-15 07:32:10,756 - INFO -   Optimizer step complete, current LR: 6.698730e-06
2025-04-15 07:32:10,759 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:10,759 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-2.9647, 3.5752]
2025-04-15 07:32:10,759 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4588, 3.3445]
2025-04-15 07:32:10,759 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,759 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,760 - INFO -   True actions shape: tensor([-0.9083, -0.8500,  2.3183,  1.3533,  0.1187, -0.9942,  0.6501],
       device='cuda:0'), range: [-2.9647, 3.5752]
2025-04-15 07:32:10,760 - INFO -   Noise shape: tensor([ 0.0169, -0.6592, -0.7356, -0.4824,  0.4432, -0.3207, -1.1589],
       device='cuda:0'), range: [-3.3037, 3.4767]
2025-04-15 07:32:10,761 - INFO -   Noisy actions shape: tensor([-0.1718, -0.8211, -0.2390, -0.1914,  0.4582, -0.5199, -0.9989],
       device='cuda:0'), range: [-3.4904, 3.5540]
2025-04-15 07:32:10,805 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:10,805 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0670, 3.2341]
2025-04-15 07:32:10,806 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1650, 2.8661]
2025-04-15 07:32:10,806 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,806 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,806 - INFO -   True actions shape: tensor([-0.3132,  1.9702, -2.2447, -1.2250, -1.7427, -0.2514,  0.1480],
       device='cuda:0'), range: [-3.0670, 3.2341]
2025-04-15 07:32:10,807 - INFO -   Noise shape: tensor([-0.2917, -0.2334,  0.9424, -1.4424, -0.3077,  0.1011,  1.0564],
       device='cuda:0'), range: [-3.5035, 3.5715]
2025-04-15 07:32:10,808 - INFO -   Noisy actions shape: tensor([-0.3582,  0.2447,  0.3781, -1.6936, -0.7156,  0.0380,  1.0611],
       device='cuda:0'), range: [-3.4788, 3.3729]
2025-04-15 07:32:10,850 - INFO - 
=== Epoch 13 Summary ===
2025-04-15 07:32:10,850 - INFO -   Avg total loss: 2.097220
2025-04-15 07:32:10,850 - INFO -   Avg diffusion loss: 1.433705
2025-04-15 07:32:10,850 - INFO -   Avg grasp loss: 1.327030
2025-04-15 07:32:10,850 - INFO - 
=== EPOCH 14/20 ===
2025-04-15 07:32:10,851 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:10,854 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:10,854 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5871, 3.7722]
2025-04-15 07:32:10,854 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0143, 3.5577]
2025-04-15 07:32:10,854 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,854 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,855 - INFO -   True actions shape: tensor([ 2.8560, -0.7241,  1.3348,  0.1154, -0.1936, -0.9260, -0.2295],
       device='cuda:0'), range: [-3.5871, 3.7722]
2025-04-15 07:32:10,855 - INFO -   Noise shape: tensor([ 0.0422,  2.6327, -1.6493,  1.5015, -0.0303, -1.1116,  0.7873],
       device='cuda:0'), range: [-3.6945, 4.0941]
2025-04-15 07:32:10,856 - INFO -   Noisy actions shape: tensor([ 2.8250, -0.2869,  1.0492,  0.3578, -0.1959, -1.0943, -0.0986],
       device='cuda:0'), range: [-3.7320, 3.1949]
2025-04-15 07:32:10,856 - INFO -   Diffusion: timestep range [36, 975], noise range [-3.6945, 4.0941]
2025-04-15 07:32:10,856 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.7320, 3.1949]
2025-04-15 07:32:10,877 - INFO -   Model output shapes:
2025-04-15 07:32:10,877 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:10,877 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4401, 0.5529]
2025-04-15 07:32:10,877 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.6160
2025-04-15 07:32:10,877 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1080, 0.2039]
2025-04-15 07:32:10,898 - INFO -   Loss components:
2025-04-15 07:32:10,898 - INFO -     Diffusion loss: 1.870814 (coef: 1.0)
2025-04-15 07:32:10,899 - INFO -     Grasp quality loss: 0.691152 (coef: 0.5)
2025-04-15 07:32:10,899 - INFO -     Grasp rotation loss: 0.575713 (coef: 0.5)
2025-04-15 07:32:10,899 - INFO -     Grasp width loss: 5.081532 (coef: 0.005)
2025-04-15 07:32:10,899 - INFO -     TOTAL loss: 2.529654
2025-04-15 07:32:10,906 - INFO -   Gradients: avg norm: 0.445824, max norm: 3.573298, non-zero params: 250
2025-04-15 07:32:10,906 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-15 07:32:10,906 - INFO - --- Gradient Check @ Epoch 14, Batch 0 ---
2025-04-15 07:32:10,923 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:10,923 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:10,923 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=7.1866e-01, MaxNorm=2.9956e+00
2025-04-15 07:32:10,923 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=2.4957e-02, MaxNorm=6.7499e-02
2025-04-15 07:32:10,923 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=8.4303e-03, MaxNorm=2.5171e-02
2025-04-15 07:32:10,923 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.2425e-01, MaxNorm=2.3146e-01
2025-04-15 07:32:10,923 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.6206e+00, MaxNorm=2.9231e+00
2025-04-15 07:32:10,923 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=1.2998e+00, MaxNorm=2.3346e+00
2025-04-15 07:32:10,923 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=1.1133e-01, MaxNorm=4.9686e-01
2025-04-15 07:32:10,923 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=3.6666e-01, MaxNorm=4.1653e-01
2025-04-15 07:32:10,923 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=9.7151e-01, MaxNorm=9.7862e-01
2025-04-15 07:32:10,923 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.9705e+00, MaxNorm=3.5733e+00
2025-04-15 07:32:10,923 - INFO - --- End Gradient Check ---
2025-04-15 07:32:10,926 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:10,926 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0633, 3.5096]
2025-04-15 07:32:10,926 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3393, 3.5920]
2025-04-15 07:32:10,926 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,926 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,927 - INFO -   True actions shape: tensor([ 0.4425, -1.9471,  1.3110, -1.0953,  0.1799, -0.7473, -2.0797],
       device='cuda:0'), range: [-3.0633, 3.5096]
2025-04-15 07:32:10,927 - INFO -   Noise shape: tensor([-1.1269,  1.4161,  0.1773, -0.6690, -0.2742, -1.5671,  0.7520],
       device='cuda:0'), range: [-3.4096, 4.1603]
2025-04-15 07:32:10,928 - INFO -   Noisy actions shape: tensor([-0.7111,  0.1443,  0.8556, -1.1537, -0.1341, -1.7229, -0.4866],
       device='cuda:0'), range: [-3.8574, 3.5441]
2025-04-15 07:32:10,973 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:10,973 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5964, 3.0958]
2025-04-15 07:32:10,973 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.7902, 3.2308]
2025-04-15 07:32:10,973 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:10,973 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:10,974 - INFO -   True actions shape: tensor([ 1.2385,  0.5543, -0.2005,  1.0845, -0.6941, -0.6732,  1.1515],
       device='cuda:0'), range: [-3.5964, 3.0958]
2025-04-15 07:32:10,974 - INFO -   Noise shape: tensor([-0.1567, -0.4503,  1.5794, -0.8025,  0.8552,  0.0663, -2.3446],
       device='cuda:0'), range: [-3.8700, 3.1470]
2025-04-15 07:32:10,975 - INFO -   Noisy actions shape: tensor([ 0.2840, -0.2294,  1.4110, -0.3750,  0.5603, -0.1720, -1.7975],
       device='cuda:0'), range: [-3.1149, 3.2472]
2025-04-15 07:32:11,025 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:11,026 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2183, 3.4276]
2025-04-15 07:32:11,026 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.4878, 3.7262]
2025-04-15 07:32:11,026 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,026 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,027 - INFO -   True actions shape: tensor([ 0.2148,  1.0808,  1.0488, -0.6423, -0.0677, -0.2354, -2.0824],
       device='cuda:0'), range: [-3.2183, 3.4276]
2025-04-15 07:32:11,027 - INFO -   Noise shape: tensor([-0.0929,  1.5177,  1.1184, -0.2165, -0.2494,  0.6390, -1.1322],
       device='cuda:0'), range: [-3.4016, 3.3512]
2025-04-15 07:32:11,028 - INFO -   Noisy actions shape: tensor([-0.0916,  1.5244,  1.1250, -0.2205, -0.2498,  0.6376, -1.1452],
       device='cuda:0'), range: [-3.3747, 3.1338]
2025-04-15 07:32:11,072 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:11,073 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7082, 3.5688]
2025-04-15 07:32:11,073 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2910, 3.2352]
2025-04-15 07:32:11,073 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,073 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,074 - INFO -   True actions shape: tensor([-0.8972, -1.7803, -2.0145, -0.6116, -0.7085,  1.3615,  0.1738],
       device='cuda:0'), range: [-3.7082, 3.5688]
2025-04-15 07:32:11,074 - INFO -   Noise shape: tensor([-0.5642,  0.2170,  1.1501, -0.3949,  0.4543, -0.7344, -0.7029],
       device='cuda:0'), range: [-3.3380, 3.5905]
2025-04-15 07:32:11,075 - INFO -   Noisy actions shape: tensor([-1.0390, -1.5873, -1.4751, -0.7119, -0.5011,  1.0122, -0.0870],
       device='cuda:0'), range: [-4.0109, 3.3481]
2025-04-15 07:32:11,119 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:11,119 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0232, 3.7191]
2025-04-15 07:32:11,120 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1633, 2.8683]
2025-04-15 07:32:11,120 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,120 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,120 - INFO -   True actions shape: tensor([ 1.3760,  0.5429, -1.7856,  2.0214,  2.3855,  0.2399, -1.0088],
       device='cuda:0'), range: [-4.0232, 3.7191]
2025-04-15 07:32:11,121 - INFO -   Noise shape: tensor([ 0.3592, -0.1621,  0.8803, -0.9985, -1.1576, -0.6089,  0.6716],
       device='cuda:0'), range: [-2.9878, 3.7551]
2025-04-15 07:32:11,122 - INFO -   Noisy actions shape: tensor([ 0.7031, -0.0160,  0.3881, -0.4413, -0.5007, -0.5261,  0.3876],
       device='cuda:0'), range: [-3.1155, 3.6938]
2025-04-15 07:32:11,166 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:11,166 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9659, 3.2815]
2025-04-15 07:32:11,166 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1768, 3.5678]
2025-04-15 07:32:11,166 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,167 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,167 - INFO -   True actions shape: tensor([ 0.9217, -1.5991,  0.8320,  0.7389,  0.2566,  0.1010,  0.5129],
       device='cuda:0'), range: [-3.9659, 3.2815]
2025-04-15 07:32:11,168 - INFO -   Noise shape: tensor([-0.5214, -0.1799,  1.9798,  1.6936, -1.5513,  0.4159,  0.3157],
       device='cuda:0'), range: [-3.4202, 3.2446]
2025-04-15 07:32:11,168 - INFO -   Noisy actions shape: tensor([ 0.3227, -1.2962,  1.9550,  1.6923, -0.8649,  0.3566,  0.5909],
       device='cuda:0'), range: [-4.6013, 3.4339]
2025-04-15 07:32:11,213 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:11,213 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1220, 3.3753]
2025-04-15 07:32:11,213 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6699, 3.1290]
2025-04-15 07:32:11,213 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,213 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,214 - INFO -   True actions shape: tensor([-0.0175,  0.3047,  1.2452,  1.5738, -1.8230, -1.1612, -0.3242],
       device='cuda:0'), range: [-3.1220, 3.3753]
2025-04-15 07:32:11,214 - INFO -   Noise shape: tensor([ 1.3270, -0.5903,  0.6929,  0.7478, -0.6212, -0.4190,  0.5042],
       device='cuda:0'), range: [-3.8701, 3.7078]
2025-04-15 07:32:11,215 - INFO -   Noisy actions shape: tensor([ 0.3821,  0.1132,  1.3959,  1.7258, -1.9254, -1.2334, -0.1578],
       device='cuda:0'), range: [-3.7349, 3.2597]
2025-04-15 07:32:11,260 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:11,260 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6245, 3.4505]
2025-04-15 07:32:11,260 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7798, 3.3314]
2025-04-15 07:32:11,260 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,260 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,261 - INFO -   True actions shape: tensor([-1.5095,  2.3058,  1.1898,  0.7088,  0.6948, -0.8041, -1.1570],
       device='cuda:0'), range: [-3.6245, 3.4505]
2025-04-15 07:32:11,261 - INFO -   Noise shape: tensor([ 0.7537,  1.4440, -0.6587, -0.9538, -0.8434,  1.9730,  0.0932],
       device='cuda:0'), range: [-3.8268, 3.8766]
2025-04-15 07:32:11,262 - INFO -   Noisy actions shape: tensor([-1.3624,  2.5146,  1.0630,  0.5395,  0.5441, -0.4632, -1.1252],
       device='cuda:0'), range: [-3.8343, 3.8787]
2025-04-15 07:32:11,306 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:11,306 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0122, 3.5673]
2025-04-15 07:32:11,306 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2027, 3.1496]
2025-04-15 07:32:11,307 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,307 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,307 - INFO -   True actions shape: tensor([ 0.6038,  0.7257,  2.2763,  0.3620, -0.0263,  0.4277, -0.8782],
       device='cuda:0'), range: [-4.0122, 3.5673]
2025-04-15 07:32:11,308 - INFO -   Noise shape: tensor([ 0.1610,  2.4788,  0.6292,  0.2527, -1.5284,  1.0899, -3.2438],
       device='cuda:0'), range: [-3.2438, 3.5482]
2025-04-15 07:32:11,308 - INFO -   Noisy actions shape: tensor([ 0.2528,  2.5614,  0.9748,  0.3058, -1.5140,  1.1431, -3.3408],
       device='cuda:0'), range: [-4.2513, 3.4816]
2025-04-15 07:32:11,353 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:11,353 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7027, 4.4044]
2025-04-15 07:32:11,353 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2476, 2.9461]
2025-04-15 07:32:11,353 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,353 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,354 - INFO -   True actions shape: tensor([ 0.3551, -0.2896, -1.0286,  0.0212, -0.5739,  0.0942, -1.6674],
       device='cuda:0'), range: [-3.7027, 4.4044]
2025-04-15 07:32:11,355 - INFO -   Noise shape: tensor([ 0.8587,  1.2194, -0.6657, -0.1780,  2.1629,  0.4458, -0.2826],
       device='cuda:0'), range: [-3.3016, 3.5124]
2025-04-15 07:32:11,355 - INFO -   Noisy actions shape: tensor([ 0.9292,  1.0168, -1.0076, -0.1565,  1.7808,  0.4481, -0.8970],
       device='cuda:0'), range: [-3.3174, 4.0900]
2025-04-15 07:32:11,397 - INFO -   Loss components:
2025-04-15 07:32:11,397 - INFO -     Diffusion loss: 1.288464 (coef: 1.0)
2025-04-15 07:32:11,397 - INFO -     Grasp quality loss: 0.695527 (coef: 0.5)
2025-04-15 07:32:11,398 - INFO -     Grasp rotation loss: 0.564379 (coef: 0.5)
2025-04-15 07:32:11,398 - INFO -     Grasp width loss: 5.595174 (coef: 0.005)
2025-04-15 07:32:11,398 - INFO -     TOTAL loss: 1.946393
2025-04-15 07:32:11,405 - INFO -   Gradients: avg norm: 0.299562, max norm: 2.442718, non-zero params: 250
2025-04-15 07:32:11,405 - INFO -   Optimizer step complete, current LR: 9.698463e-05
2025-04-15 07:32:11,408 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:11,408 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7096, 3.6157]
2025-04-15 07:32:11,408 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.6134, 3.3499]
2025-04-15 07:32:11,408 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,408 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,409 - INFO -   True actions shape: tensor([-0.0958, -0.6788, -0.2664, -0.2344,  0.1796, -0.3153, -0.2875],
       device='cuda:0'), range: [-3.7096, 3.6157]
2025-04-15 07:32:11,410 - INFO -   Noise shape: tensor([-0.1711,  0.0691,  0.7131, -1.4445,  0.6083, -2.4343, -0.1151],
       device='cuda:0'), range: [-3.3115, 3.5716]
2025-04-15 07:32:11,410 - INFO -   Noisy actions shape: tensor([-0.1877, -0.0774,  0.6398, -1.4613,  0.6326, -2.4455, -0.1738],
       device='cuda:0'), range: [-3.1345, 3.4776]
2025-04-15 07:32:11,455 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:11,455 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8038, 3.7516]
2025-04-15 07:32:11,455 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4981, 3.5300]
2025-04-15 07:32:11,455 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,455 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,456 - INFO -   True actions shape: tensor([-0.2748,  1.1012,  0.5151,  0.0441,  2.2042, -0.5002, -0.1680],
       device='cuda:0'), range: [-3.8038, 3.7516]
2025-04-15 07:32:11,456 - INFO -   Noise shape: tensor([ 0.1661, -1.7957, -0.0182,  0.2885, -1.2650, -1.3892, -0.8855],
       device='cuda:0'), range: [-3.7640, 3.4066]
2025-04-15 07:32:11,457 - INFO -   Noisy actions shape: tensor([-0.0045, -0.9403,  0.2573,  0.2681,  0.0938, -1.4434, -0.8402],
       device='cuda:0'), range: [-4.0060, 3.5532]
2025-04-15 07:32:11,500 - INFO - 
=== Epoch 14 Summary ===
2025-04-15 07:32:11,500 - INFO -   Avg total loss: 2.118339
2025-04-15 07:32:11,500 - INFO -   Avg diffusion loss: 1.457924
2025-04-15 07:32:11,500 - INFO -   Avg grasp loss: 1.320830
2025-04-15 07:32:11,500 - INFO - 
=== EPOCH 15/20 ===
2025-04-15 07:32:11,501 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:11,504 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:11,504 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5342, 3.4127]
2025-04-15 07:32:11,504 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7614, 3.1039]
2025-04-15 07:32:11,504 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,504 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,505 - INFO -   True actions shape: tensor([ 0.8301, -0.7454, -0.1142,  0.1585,  0.3294, -0.1302, -0.0926],
       device='cuda:0'), range: [-3.5342, 3.4127]
2025-04-15 07:32:11,505 - INFO -   Noise shape: tensor([-0.1440,  0.2497, -1.2835, -0.3062, -0.5516,  0.5818, -1.1946],
       device='cuda:0'), range: [-3.0389, 4.1250]
2025-04-15 07:32:11,506 - INFO -   Noisy actions shape: tensor([ 0.8019, -0.7033, -0.2918,  0.1143,  0.2493, -0.0480, -0.2580],
       device='cuda:0'), range: [-3.1353, 3.5054]
2025-04-15 07:32:11,506 - INFO -   Diffusion: timestep range [81, 894], noise range [-3.0389, 4.1250]
2025-04-15 07:32:11,506 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.1353, 3.5054]
2025-04-15 07:32:11,527 - INFO -   Model output shapes:
2025-04-15 07:32:11,527 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:11,527 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4455, 0.5721]
2025-04-15 07:32:11,527 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.5391
2025-04-15 07:32:11,528 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1511, 0.2228]
2025-04-15 07:32:11,549 - INFO -   Loss components:
2025-04-15 07:32:11,549 - INFO -     Diffusion loss: 1.355289 (coef: 1.0)
2025-04-15 07:32:11,549 - INFO -     Grasp quality loss: 0.693701 (coef: 0.5)
2025-04-15 07:32:11,549 - INFO -     Grasp rotation loss: 0.609142 (coef: 0.5)
2025-04-15 07:32:11,549 - INFO -     Grasp width loss: 4.840148 (coef: 0.005)
2025-04-15 07:32:11,549 - INFO -     TOTAL loss: 2.030911
2025-04-15 07:32:11,557 - INFO -   Gradients: avg norm: 0.291548, max norm: 2.184045, non-zero params: 250
2025-04-15 07:32:11,557 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-15 07:32:11,557 - INFO - --- Gradient Check @ Epoch 15, Batch 0 ---
2025-04-15 07:32:11,573 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:11,573 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:11,573 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.5583e-01, MaxNorm=1.7830e+00
2025-04-15 07:32:11,573 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=6.3759e-03, MaxNorm=1.3836e-02
2025-04-15 07:32:11,573 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.9830e-02, MaxNorm=4.8409e-02
2025-04-15 07:32:11,573 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=1.2244e-01, MaxNorm=2.5912e-01
2025-04-15 07:32:11,573 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.1429e+00, MaxNorm=2.0931e+00
2025-04-15 07:32:11,573 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.8902e-01, MaxNorm=1.6076e+00
2025-04-15 07:32:11,573 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.9755e-02, MaxNorm=2.6668e-01
2025-04-15 07:32:11,573 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.8457e-01, MaxNorm=3.0081e-01
2025-04-15 07:32:11,573 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.9038e-01, MaxNorm=6.1631e-01
2025-04-15 07:32:11,573 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2095e+00, MaxNorm=2.1840e+00
2025-04-15 07:32:11,573 - INFO - --- End Gradient Check ---
2025-04-15 07:32:11,576 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:11,576 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4351, 3.1878]
2025-04-15 07:32:11,576 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8496, 3.3945]
2025-04-15 07:32:11,576 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,576 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,577 - INFO -   True actions shape: tensor([ 0.6426,  0.9138, -0.5255, -2.0292,  0.5604, -0.8372, -1.0406],
       device='cuda:0'), range: [-3.4351, 3.1878]
2025-04-15 07:32:11,578 - INFO -   Noise shape: tensor([-0.8004,  0.9937,  1.9920,  1.7974, -0.7323,  1.4538, -0.7381],
       device='cuda:0'), range: [-3.4307, 3.3265]
2025-04-15 07:32:11,578 - INFO -   Noisy actions shape: tensor([-0.1560,  1.3499,  1.1135, -0.0459, -0.1612,  0.5062, -1.2473],
       device='cuda:0'), range: [-3.5665, 3.3203]
2025-04-15 07:32:11,623 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:11,623 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5140, 3.2838]
2025-04-15 07:32:11,623 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6022, 2.7979]
2025-04-15 07:32:11,623 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,623 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,624 - INFO -   True actions shape: tensor([ 1.7836, -1.2062,  0.2616, -0.6480,  0.8422,  0.4576,  0.7094],
       device='cuda:0'), range: [-3.5140, 3.2838]
2025-04-15 07:32:11,625 - INFO -   Noise shape: tensor([ 0.5394, -0.2758,  2.0595,  0.4243, -0.1027, -1.3269,  0.7527],
       device='cuda:0'), range: [-3.1469, 3.3667]
2025-04-15 07:32:11,625 - INFO -   Noisy actions shape: tensor([ 1.1921, -0.7243,  1.9985,  0.1380,  0.2338, -1.0435,  0.9697],
       device='cuda:0'), range: [-3.7140, 3.3802]
2025-04-15 07:32:11,670 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:11,670 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8791, 3.8434]
2025-04-15 07:32:11,670 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7324, 3.2520]
2025-04-15 07:32:11,670 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,670 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,671 - INFO -   True actions shape: tensor([ 1.3954, -0.0397, -0.3151, -0.6452,  1.2684,  0.2259,  0.8843],
       device='cuda:0'), range: [-3.8791, 3.8434]
2025-04-15 07:32:11,672 - INFO -   Noise shape: tensor([-0.2232,  1.7061,  0.2733,  2.3176,  0.4243,  1.5639, -1.6479],
       device='cuda:0'), range: [-3.6887, 3.6976]
2025-04-15 07:32:11,672 - INFO -   Noisy actions shape: tensor([-0.1073,  1.6970,  0.2464,  2.2565,  0.5275,  1.5772, -1.5693],
       device='cuda:0'), range: [-3.8146, 3.8710]
2025-04-15 07:32:11,717 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:11,717 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.3758, 3.5516]
2025-04-15 07:32:11,717 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1922, 3.1524]
2025-04-15 07:32:11,717 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,717 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,718 - INFO -   True actions shape: tensor([ 0.6619, -1.2170, -0.3713, -0.0235, -1.1670,  0.5804, -0.0829],
       device='cuda:0'), range: [-4.3758, 3.5516]
2025-04-15 07:32:11,719 - INFO -   Noise shape: tensor([ 0.1653, -1.9890, -0.4826, -0.2879, -1.3979,  0.5312,  0.9414],
       device='cuda:0'), range: [-3.3029, 3.4368]
2025-04-15 07:32:11,719 - INFO -   Noisy actions shape: tensor([ 0.1807, -2.0169, -0.4912, -0.2883, -1.4248,  0.5446,  0.9392],
       device='cuda:0'), range: [-4.3788, 3.4318]
2025-04-15 07:32:11,764 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:11,764 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5102, 3.6714]
2025-04-15 07:32:11,764 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8902, 3.0911]
2025-04-15 07:32:11,764 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,764 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,765 - INFO -   True actions shape: tensor([ 0.1130, -0.0824,  1.2913,  0.3994, -1.3018,  1.5056,  0.8012],
       device='cuda:0'), range: [-3.5102, 3.6714]
2025-04-15 07:32:11,766 - INFO -   Noise shape: tensor([ 0.4581,  0.3792, -0.1207,  0.5243,  0.0929, -0.5187, -1.0862],
       device='cuda:0'), range: [-4.1013, 3.3868]
2025-04-15 07:32:11,766 - INFO -   Noisy actions shape: tensor([ 0.2172,  0.0088,  1.2270,  0.5111, -1.2438,  1.3421,  0.5243],
       device='cuda:0'), range: [-3.4643, 3.3428]
2025-04-15 07:32:11,811 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:11,811 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3118, 3.3455]
2025-04-15 07:32:11,811 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9720, 2.9714]
2025-04-15 07:32:11,811 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,811 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,812 - INFO -   True actions shape: tensor([-0.5523, -0.4157, -0.1987,  0.0342, -1.2231, -0.1546, -0.7134],
       device='cuda:0'), range: [-3.3118, 3.3455]
2025-04-15 07:32:11,812 - INFO -   Noise shape: tensor([ 1.7861, -0.8413, -1.4318,  1.8349, -0.3496, -0.4518, -0.7460],
       device='cuda:0'), range: [-3.9086, 3.1758]
2025-04-15 07:32:11,813 - INFO -   Noisy actions shape: tensor([ 1.7502, -0.8644, -1.4411,  1.8337, -0.4214, -0.4602, -0.7869],
       device='cuda:0'), range: [-3.2445, 3.1600]
2025-04-15 07:32:11,858 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:11,858 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6108, 3.5013]
2025-04-15 07:32:11,858 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9986, 3.1347]
2025-04-15 07:32:11,858 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,858 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,859 - INFO -   True actions shape: tensor([ 1.0089,  1.7644, -0.0259,  0.2624, -0.3387, -1.0928,  0.2103],
       device='cuda:0'), range: [-3.6108, 3.5013]
2025-04-15 07:32:11,860 - INFO -   Noise shape: tensor([-0.9593, -0.5888, -0.5483,  0.4647, -0.0719,  0.2491, -1.1360],
       device='cuda:0'), range: [-3.7218, 4.0889]
2025-04-15 07:32:11,860 - INFO -   Noisy actions shape: tensor([-0.1035,  0.6615, -0.4408,  0.5258, -0.2702, -0.4992, -0.7460],
       device='cuda:0'), range: [-3.8562, 3.3523]
2025-04-15 07:32:11,905 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:11,905 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3038, 3.9890]
2025-04-15 07:32:11,905 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0070, 3.0435]
2025-04-15 07:32:11,905 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,905 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,906 - INFO -   True actions shape: tensor([ 0.9265,  1.5004, -0.1016, -1.6097, -1.2387,  0.6931,  1.2639],
       device='cuda:0'), range: [-3.3038, 3.9890]
2025-04-15 07:32:11,907 - INFO -   Noise shape: tensor([-0.5359,  0.6465,  1.5915,  0.8131,  0.8118,  0.8191,  1.0321],
       device='cuda:0'), range: [-3.6815, 3.7833]
2025-04-15 07:32:11,907 - INFO -   Noisy actions shape: tensor([ 0.2875,  1.5246,  1.0403, -0.5821, -0.3178,  1.0683,  1.6252],
       device='cuda:0'), range: [-3.3543, 3.0593]
2025-04-15 07:32:11,953 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:11,953 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1540, 3.2423]
2025-04-15 07:32:11,953 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2677, 2.9831]
2025-04-15 07:32:11,953 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:11,953 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:11,954 - INFO -   True actions shape: tensor([-0.6871,  0.0878, -0.2668, -0.5965, -0.8124,  0.3321, -0.5502],
       device='cuda:0'), range: [-3.1540, 3.2423]
2025-04-15 07:32:11,954 - INFO -   Noise shape: tensor([-0.8208, -0.0817, -0.9149,  0.2601,  1.3464, -0.9459, -1.3271],
       device='cuda:0'), range: [-3.5137, 3.8767]
2025-04-15 07:32:11,955 - INFO -   Noisy actions shape: tensor([-0.9500, -0.0607, -0.9509,  0.1248,  1.1386, -0.8516, -1.4147],
       device='cuda:0'), range: [-3.3609, 3.4740]
2025-04-15 07:32:11,999 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:11,999 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3182, 3.6581]
2025-04-15 07:32:12,000 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1424, 3.7793]
2025-04-15 07:32:12,000 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,000 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,000 - INFO -   True actions shape: tensor([-0.2068, -1.8251,  1.0429, -1.2222, -0.2775, -0.2662,  1.4929],
       device='cuda:0'), range: [-3.3182, 3.6581]
2025-04-15 07:32:12,001 - INFO -   Noise shape: tensor([-0.3384, -1.7195, -1.1642,  0.3012,  0.6977, -0.0772,  0.3133],
       device='cuda:0'), range: [-3.6927, 2.9345]
2025-04-15 07:32:12,001 - INFO -   Noisy actions shape: tensor([-0.3567, -2.4645,  0.2495, -0.8662,  0.1431, -0.2658,  1.4259],
       device='cuda:0'), range: [-3.4427, 3.0717]
2025-04-15 07:32:12,043 - INFO -   Loss components:
2025-04-15 07:32:12,043 - INFO -     Diffusion loss: 1.565192 (coef: 1.0)
2025-04-15 07:32:12,044 - INFO -     Grasp quality loss: 0.692748 (coef: 0.5)
2025-04-15 07:32:12,044 - INFO -     Grasp rotation loss: 0.580320 (coef: 0.5)
2025-04-15 07:32:12,044 - INFO -     Grasp width loss: 4.554418 (coef: 0.005)
2025-04-15 07:32:12,044 - INFO -     TOTAL loss: 2.224499
2025-04-15 07:32:12,051 - INFO -   Gradients: avg norm: 0.356544, max norm: 3.016966, non-zero params: 250
2025-04-15 07:32:12,051 - INFO -   Optimizer step complete, current LR: 3.289899e-05
2025-04-15 07:32:12,054 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:12,054 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1302, 3.8779]
2025-04-15 07:32:12,054 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9102, 2.6019]
2025-04-15 07:32:12,054 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,054 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,055 - INFO -   True actions shape: tensor([-0.0403, -0.8551,  1.6289,  0.0437, -1.0080, -2.4255, -0.0808],
       device='cuda:0'), range: [-3.1302, 3.8779]
2025-04-15 07:32:12,056 - INFO -   Noise shape: tensor([-1.1089, -0.0952, -1.0314, -0.8885, -0.4023,  0.3138, -1.8626],
       device='cuda:0'), range: [-4.0379, 3.4252]
2025-04-15 07:32:12,056 - INFO -   Noisy actions shape: tensor([-0.7499, -0.7125,  0.5707, -0.5431, -1.0281, -1.6424, -1.2697],
       device='cuda:0'), range: [-3.2112, 3.5126]
2025-04-15 07:32:12,101 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:12,101 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4353, 3.6611]
2025-04-15 07:32:12,101 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2279, 3.6566]
2025-04-15 07:32:12,101 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,101 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,102 - INFO -   True actions shape: tensor([ 0.9615,  0.6538, -1.3652, -0.1520,  0.5145,  0.9139,  2.1252],
       device='cuda:0'), range: [-3.4353, 3.6611]
2025-04-15 07:32:12,102 - INFO -   Noise shape: tensor([ 0.4626, -0.2532, -1.4090, -0.6030,  0.3245,  0.4625,  0.1668],
       device='cuda:0'), range: [-3.9710, 3.4298]
2025-04-15 07:32:12,103 - INFO -   Noisy actions shape: tensor([ 1.0505,  0.5615, -1.6940, -0.3087,  0.5829,  1.0046,  2.0916],
       device='cuda:0'), range: [-3.3208, 3.5904]
2025-04-15 07:32:12,145 - INFO - 
=== Epoch 15 Summary ===
2025-04-15 07:32:12,145 - INFO -   Avg total loss: 2.021313
2025-04-15 07:32:12,145 - INFO -   Avg diffusion loss: 1.359805
2025-04-15 07:32:12,145 - INFO -   Avg grasp loss: 1.323016
2025-04-15 07:32:12,315 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250415_073200/ckpt_epoch_15.pth
2025-04-15 07:32:12,316 - INFO - Saved model state with 16022452 parameters
2025-04-15 07:32:12,316 - INFO - 
=== EPOCH 16/20 ===
2025-04-15 07:32:12,317 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:12,320 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:12,320 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1691, 2.9728]
2025-04-15 07:32:12,320 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8845, 2.9620]
2025-04-15 07:32:12,320 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,320 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,321 - INFO -   True actions shape: tensor([-0.7230, -0.5020,  1.5521,  1.1495, -0.8854, -0.2465, -0.4991],
       device='cuda:0'), range: [-3.1691, 2.9728]
2025-04-15 07:32:12,321 - INFO -   Noise shape: tensor([-1.1982,  0.8896,  0.8376,  1.3952, -0.2830, -0.6092, -0.6467],
       device='cuda:0'), range: [-3.7391, 3.9778]
2025-04-15 07:32:12,322 - INFO -   Noisy actions shape: tensor([-1.3936,  0.4190,  1.5944,  1.8051, -0.7527, -0.6368, -0.8167],
       device='cuda:0'), range: [-3.4256, 3.8318]
2025-04-15 07:32:12,322 - INFO -   Diffusion: timestep range [215, 775], noise range [-3.7391, 3.9778]
2025-04-15 07:32:12,322 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4256, 3.8318]
2025-04-15 07:32:12,343 - INFO -   Model output shapes:
2025-04-15 07:32:12,343 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:12,344 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4496, 0.5738]
2025-04-15 07:32:12,344 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.4779
2025-04-15 07:32:12,344 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.1026, 0.2166]
2025-04-15 07:32:12,365 - INFO -   Loss components:
2025-04-15 07:32:12,365 - INFO -     Diffusion loss: 1.344146 (coef: 1.0)
2025-04-15 07:32:12,365 - INFO -     Grasp quality loss: 0.693936 (coef: 0.5)
2025-04-15 07:32:12,365 - INFO -     Grasp rotation loss: 0.576963 (coef: 0.5)
2025-04-15 07:32:12,365 - INFO -     Grasp width loss: 4.928552 (coef: 0.005)
2025-04-15 07:32:12,365 - INFO -     TOTAL loss: 2.004238
2025-04-15 07:32:12,373 - INFO -   Gradients: avg norm: 0.293110, max norm: 2.629105, non-zero params: 250
2025-04-15 07:32:12,373 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-15 07:32:12,373 - INFO - --- Gradient Check @ Epoch 16, Batch 0 ---
2025-04-15 07:32:12,390 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:12,390 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:12,390 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.7530e-01, MaxNorm=1.7979e+00
2025-04-15 07:32:12,390 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=8.6367e-03, MaxNorm=2.0596e-02
2025-04-15 07:32:12,390 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=2.0900e-02, MaxNorm=5.5144e-02
2025-04-15 07:32:12,390 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=3.2885e-02, MaxNorm=6.2865e-02
2025-04-15 07:32:12,390 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.3625e+00, MaxNorm=2.6291e+00
2025-04-15 07:32:12,390 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.1081e-01, MaxNorm=1.6854e+00
2025-04-15 07:32:12,390 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.9162e-02, MaxNorm=2.6490e-01
2025-04-15 07:32:12,390 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.7443e-01, MaxNorm=2.3917e-01
2025-04-15 07:32:12,390 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.1711e-01, MaxNorm=5.5474e-01
2025-04-15 07:32:12,390 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.4074e+00, MaxNorm=2.5782e+00
2025-04-15 07:32:12,390 - INFO - --- End Gradient Check ---
2025-04-15 07:32:12,392 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:12,393 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3249, 3.4660]
2025-04-15 07:32:12,393 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0190, 3.0164]
2025-04-15 07:32:12,393 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,393 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,394 - INFO -   True actions shape: tensor([ 0.4107,  0.8391, -1.2109,  0.0773, -0.8615, -2.4857, -0.5557],
       device='cuda:0'), range: [-3.3249, 3.4660]
2025-04-15 07:32:12,394 - INFO -   Noise shape: tensor([-0.2135, -0.4092, -1.4543, -0.1558,  2.2156, -0.9301,  1.0055],
       device='cuda:0'), range: [-3.1084, 3.4377]
2025-04-15 07:32:12,395 - INFO -   Noisy actions shape: tensor([ 0.1215,  0.2681, -1.8900, -0.0621,  1.0447, -2.3689,  0.3625],
       device='cuda:0'), range: [-3.4855, 3.7832]
2025-04-15 07:32:12,440 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:12,440 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6582, 3.3535]
2025-04-15 07:32:12,441 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0015, 3.1291]
2025-04-15 07:32:12,441 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,441 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,441 - INFO -   True actions shape: tensor([ 2.1263, -0.4174,  0.5056, -0.1057,  0.7546, -1.3483, -0.4003],
       device='cuda:0'), range: [-3.6582, 3.3535]
2025-04-15 07:32:12,442 - INFO -   Noise shape: tensor([ 1.0787, -0.4411,  0.3568,  1.4423, -1.3289, -0.5295, -0.8835],
       device='cuda:0'), range: [-3.5223, 3.3147]
2025-04-15 07:32:12,443 - INFO -   Noisy actions shape: tensor([ 2.1563, -0.4299,  0.5156, -0.0644,  0.7163, -1.3629, -0.4254],
       device='cuda:0'), range: [-3.1742, 3.3606]
2025-04-15 07:32:12,488 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:12,488 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8449, 3.2302]
2025-04-15 07:32:12,488 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6489, 3.1159]
2025-04-15 07:32:12,488 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,488 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,489 - INFO -   True actions shape: tensor([-1.2615,  0.7427,  0.0778, -0.0504, -0.2547,  0.4677, -0.9947],
       device='cuda:0'), range: [-3.8449, 3.2302]
2025-04-15 07:32:12,489 - INFO -   Noise shape: tensor([-0.6201, -0.0294,  0.1963, -0.0593,  0.7256, -0.8098, -1.7893],
       device='cuda:0'), range: [-3.0380, 3.2440]
2025-04-15 07:32:12,490 - INFO -   Noisy actions shape: tensor([-1.3892,  0.7000,  0.1329, -0.0658, -0.0262,  0.2042, -1.4841],
       device='cuda:0'), range: [-3.6316, 3.3835]
2025-04-15 07:32:12,535 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:12,535 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.9493, 3.5597]
2025-04-15 07:32:12,535 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0657, 3.2551]
2025-04-15 07:32:12,535 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,535 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,536 - INFO -   True actions shape: tensor([ 0.9977,  0.6203,  0.3650, -1.3376,  0.5252,  1.1527, -0.4946],
       device='cuda:0'), range: [-3.9493, 3.5597]
2025-04-15 07:32:12,536 - INFO -   Noise shape: tensor([ 0.8591,  0.4766,  2.7540, -0.9733, -1.9329, -0.4186, -0.0089],
       device='cuda:0'), range: [-3.2960, 3.8112]
2025-04-15 07:32:12,537 - INFO -   Noisy actions shape: tensor([ 0.9682,  0.5448,  2.7777, -1.1207, -1.8596, -0.2832, -0.0658],
       device='cuda:0'), range: [-3.4721, 3.7544]
2025-04-15 07:32:12,581 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:12,582 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.0270, 3.3270]
2025-04-15 07:32:12,582 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8174, 3.1527]
2025-04-15 07:32:12,582 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,582 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,583 - INFO -   True actions shape: tensor([ 0.1917, -0.1091,  1.4102,  1.8469,  1.5512, -2.5573, -0.2895],
       device='cuda:0'), range: [-4.0270, 3.3270]
2025-04-15 07:32:12,583 - INFO -   Noise shape: tensor([ 1.5095,  0.3848,  0.5818, -1.9953,  0.5178, -0.0492, -1.3897],
       device='cuda:0'), range: [-3.4244, 3.4046]
2025-04-15 07:32:12,584 - INFO -   Noisy actions shape: tensor([ 0.8649,  0.0803,  1.5197,  0.7214,  1.6154, -2.2930, -0.8966],
       device='cuda:0'), range: [-4.9332, 3.8609]
2025-04-15 07:32:12,628 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:12,628 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4184, 3.2571]
2025-04-15 07:32:12,629 - INFO -   Condition shape: torch.Size([8, 104]), range: [-4.0034, 3.2016]
2025-04-15 07:32:12,629 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,629 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,630 - INFO -   True actions shape: tensor([-0.9893,  0.8061,  0.5339,  1.2559, -1.0025,  0.7819, -0.2822],
       device='cuda:0'), range: [-3.4184, 3.2571]
2025-04-15 07:32:12,630 - INFO -   Noise shape: tensor([-0.2300,  0.1290,  1.9904,  0.1167, -0.9663,  0.8538,  2.1189],
       device='cuda:0'), range: [-3.0249, 3.7997]
2025-04-15 07:32:12,631 - INFO -   Noisy actions shape: tensor([-1.0058,  0.7986,  1.2135,  1.2139, -1.2828,  1.0365,  0.4981],
       device='cuda:0'), range: [-3.4216, 3.5618]
2025-04-15 07:32:12,676 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:12,676 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7985, 3.7056]
2025-04-15 07:32:12,676 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0857, 2.5159]
2025-04-15 07:32:12,676 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,676 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,677 - INFO -   True actions shape: tensor([-1.2740,  0.7231, -1.1043,  1.5594, -0.1507, -0.8535, -0.4382],
       device='cuda:0'), range: [-3.7985, 3.7056]
2025-04-15 07:32:12,677 - INFO -   Noise shape: tensor([-0.7298, -0.0159,  0.2172, -0.7025, -1.7858,  0.0103, -1.1905],
       device='cuda:0'), range: [-2.9518, 3.0511]
2025-04-15 07:32:12,678 - INFO -   Noisy actions shape: tensor([-1.2904,  0.3665, -0.3955,  0.2217, -1.5986, -0.4397, -1.2432],
       device='cuda:0'), range: [-3.2043, 3.3980]
2025-04-15 07:32:12,723 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:12,723 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5519, 3.8749]
2025-04-15 07:32:12,723 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7441, 3.7607]
2025-04-15 07:32:12,723 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,723 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,724 - INFO -   True actions shape: tensor([-0.4437, -1.0000, -1.4460,  0.2306,  0.6795, -0.1790, -0.4158],
       device='cuda:0'), range: [-3.5519, 3.8749]
2025-04-15 07:32:12,724 - INFO -   Noise shape: tensor([-1.6666,  0.1958,  1.4935,  0.1616, -0.0062,  0.5192,  0.3927],
       device='cuda:0'), range: [-4.2697, 3.4322]
2025-04-15 07:32:12,725 - INFO -   Noisy actions shape: tensor([-0.5935, -0.9780, -1.3042,  0.2443,  0.6762, -0.1311, -0.3784],
       device='cuda:0'), range: [-3.4348, 3.5336]
2025-04-15 07:32:12,769 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:12,769 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3151, 3.5890]
2025-04-15 07:32:12,769 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8648, 3.3438]
2025-04-15 07:32:12,770 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,770 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,770 - INFO -   True actions shape: tensor([-0.1363, -0.2562, -1.2022,  1.8213,  1.1254,  1.1883, -0.5884],
       device='cuda:0'), range: [-3.3151, 3.5890]
2025-04-15 07:32:12,771 - INFO -   Noise shape: tensor([-0.5675,  0.9309,  0.7620,  1.8226,  0.7458, -1.1877, -0.5970],
       device='cuda:0'), range: [-3.7473, 3.0281]
2025-04-15 07:32:12,771 - INFO -   Noisy actions shape: tensor([-0.4729,  0.4116, -0.4164,  2.5690,  1.3398,  0.1287, -0.8353],
       device='cuda:0'), range: [-3.7220, 3.3292]
2025-04-15 07:32:12,816 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:12,816 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5106, 3.5239]
2025-04-15 07:32:12,816 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2049, 3.9770]
2025-04-15 07:32:12,816 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,816 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,817 - INFO -   True actions shape: tensor([ 0.8634, -1.1306, -0.4210, -0.2834, -0.8638, -0.3059,  2.1610],
       device='cuda:0'), range: [-3.5106, 3.5239]
2025-04-15 07:32:12,817 - INFO -   Noise shape: tensor([-0.5837, -1.8282, -0.3534,  0.0923, -0.0648, -1.1242,  0.4331],
       device='cuda:0'), range: [-3.2566, 3.4373]
2025-04-15 07:32:12,818 - INFO -   Noisy actions shape: tensor([-0.1400, -2.1400, -0.5035, -0.0431, -0.4414, -1.1432,  1.3470],
       device='cuda:0'), range: [-3.7675, 3.2799]
2025-04-15 07:32:12,860 - INFO -   Loss components:
2025-04-15 07:32:12,860 - INFO -     Diffusion loss: 1.226047 (coef: 1.0)
2025-04-15 07:32:12,860 - INFO -     Grasp quality loss: 0.691642 (coef: 0.5)
2025-04-15 07:32:12,860 - INFO -     Grasp rotation loss: 0.574706 (coef: 0.5)
2025-04-15 07:32:12,860 - INFO -     Grasp width loss: 4.480412 (coef: 0.005)
2025-04-15 07:32:12,860 - INFO -     TOTAL loss: 1.881623
2025-04-15 07:32:12,868 - INFO -   Gradients: avg norm: 0.250621, max norm: 2.119869, non-zero params: 250
2025-04-15 07:32:12,868 - INFO -   Optimizer step complete, current LR: 2.500000e-05
2025-04-15 07:32:12,870 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:12,870 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1098, 3.3707]
2025-04-15 07:32:12,871 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3622, 3.5043]
2025-04-15 07:32:12,871 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,871 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,871 - INFO -   True actions shape: tensor([-0.3188,  0.1064,  0.8044,  1.0870, -1.2460,  0.9982,  1.2006],
       device='cuda:0'), range: [-3.1098, 3.3707]
2025-04-15 07:32:12,872 - INFO -   Noise shape: tensor([ 0.7806,  0.3115, -0.4133, -0.9125,  2.9841, -0.5217, -1.1232],
       device='cuda:0'), range: [-3.1781, 4.1279]
2025-04-15 07:32:12,872 - INFO -   Noisy actions shape: tensor([ 0.5823,  0.3278, -0.0486, -0.3889,  2.2148, -0.0685, -0.5348],
       device='cuda:0'), range: [-3.1186, 3.9408]
2025-04-15 07:32:12,917 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:12,917 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6763, 3.3797]
2025-04-15 07:32:12,917 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8982, 3.7305]
2025-04-15 07:32:12,917 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,917 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,918 - INFO -   True actions shape: tensor([-9.4200e-04, -3.5737e-01, -1.8866e-02, -2.1410e+00, -2.1307e-01,
         8.8881e-01,  6.8401e-01], device='cuda:0'), range: [-3.6763, 3.3797]
2025-04-15 07:32:12,919 - INFO -   Noise shape: tensor([ 0.5374,  0.4855, -0.7465,  1.4968, -1.3845, -0.6924, -0.9253],
       device='cuda:0'), range: [-3.8152, 2.8854]
2025-04-15 07:32:12,919 - INFO -   Noisy actions shape: tensor([ 0.4372,  0.1882, -0.6191, -0.0224, -1.2514, -0.0485, -0.3571],
       device='cuda:0'), range: [-3.7137, 3.3362]
2025-04-15 07:32:12,962 - INFO - 
=== Epoch 16 Summary ===
2025-04-15 07:32:12,962 - INFO -   Avg total loss: 2.006916
2025-04-15 07:32:12,962 - INFO -   Avg diffusion loss: 1.348747
2025-04-15 07:32:12,962 - INFO -   Avg grasp loss: 1.316338
2025-04-15 07:32:12,962 - INFO - 
=== EPOCH 17/20 ===
2025-04-15 07:32:12,963 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:12,966 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:12,966 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3939, 3.5039]
2025-04-15 07:32:12,966 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2571, 3.6283]
2025-04-15 07:32:12,966 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:12,966 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:12,967 - INFO -   True actions shape: tensor([ 0.3126,  0.1712,  1.6981,  1.6981, -1.9593,  0.7236, -1.8424],
       device='cuda:0'), range: [-3.3939, 3.5039]
2025-04-15 07:32:12,967 - INFO -   Noise shape: tensor([ 0.1711,  0.0709, -0.6389,  0.8214, -0.0912, -1.7014, -0.9045],
       device='cuda:0'), range: [-3.2491, 3.2666]
2025-04-15 07:32:12,968 - INFO -   Noisy actions shape: tensor([ 0.2109,  0.0929, -0.4091,  1.0385, -0.3492, -1.5909, -1.1399],
       device='cuda:0'), range: [-3.5577, 3.4871]
2025-04-15 07:32:12,968 - INFO -   Diffusion: timestep range [106, 914], noise range [-3.2491, 3.2666]
2025-04-15 07:32:12,968 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.5577, 3.4871]
2025-04-15 07:32:12,990 - INFO -   Model output shapes:
2025-04-15 07:32:12,990 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:12,990 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4244, 0.5683]
2025-04-15 07:32:12,990 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.4866
2025-04-15 07:32:12,990 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0911, 0.1921]
2025-04-15 07:32:13,011 - INFO -   Loss components:
2025-04-15 07:32:13,011 - INFO -     Diffusion loss: 1.214850 (coef: 1.0)
2025-04-15 07:32:13,011 - INFO -     Grasp quality loss: 0.696020 (coef: 0.5)
2025-04-15 07:32:13,011 - INFO -     Grasp rotation loss: 0.585182 (coef: 0.5)
2025-04-15 07:32:13,011 - INFO -     Grasp width loss: 4.843148 (coef: 0.005)
2025-04-15 07:32:13,011 - INFO -     TOTAL loss: 1.879667
2025-04-15 07:32:13,019 - INFO -   Gradients: avg norm: 0.270225, max norm: 2.275472, non-zero params: 250
2025-04-15 07:32:13,019 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-15 07:32:13,019 - INFO - --- Gradient Check @ Epoch 17, Batch 0 ---
2025-04-15 07:32:13,035 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:13,035 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:13,035 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.3629e-01, MaxNorm=1.6890e+00
2025-04-15 07:32:13,035 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.8350e-02, MaxNorm=4.7109e-02
2025-04-15 07:32:13,036 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.2262e-02, MaxNorm=2.3856e-02
2025-04-15 07:32:13,036 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=3.7335e-02, MaxNorm=7.7401e-02
2025-04-15 07:32:13,036 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.1410e+00, MaxNorm=2.2324e+00
2025-04-15 07:32:13,036 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=9.0301e-01, MaxNorm=1.6841e+00
2025-04-15 07:32:13,036 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=5.5470e-02, MaxNorm=2.5025e-01
2025-04-15 07:32:13,036 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.6201e-01, MaxNorm=2.0770e-01
2025-04-15 07:32:13,036 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=5.4598e-01, MaxNorm=5.7550e-01
2025-04-15 07:32:13,036 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.2615e+00, MaxNorm=2.2755e+00
2025-04-15 07:32:13,036 - INFO - --- End Gradient Check ---
2025-04-15 07:32:13,038 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:13,038 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7893, 3.5686]
2025-04-15 07:32:13,038 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8499, 3.7595]
2025-04-15 07:32:13,039 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,039 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,039 - INFO -   True actions shape: tensor([-0.0371,  0.1527, -0.8346,  0.7135,  0.3837,  0.2329,  1.2841],
       device='cuda:0'), range: [-3.7893, 3.5686]
2025-04-15 07:32:13,040 - INFO -   Noise shape: tensor([-0.6541,  0.5777,  0.8473,  1.0337, -1.0248,  0.1322,  0.8240],
       device='cuda:0'), range: [-3.6637, 3.1891]
2025-04-15 07:32:13,040 - INFO -   Noisy actions shape: tensor([-0.3752,  0.4334, -0.2650,  1.1502, -0.2118,  0.2676,  1.5255],
       device='cuda:0'), range: [-3.6846, 3.2009]
2025-04-15 07:32:13,085 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:13,085 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1049, 3.5143]
2025-04-15 07:32:13,085 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7247, 3.3548]
2025-04-15 07:32:13,085 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,085 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,086 - INFO -   True actions shape: tensor([ 0.9136, -1.6792,  0.1075, -1.7891,  0.2710, -0.4513,  0.2685],
       device='cuda:0'), range: [-3.1049, 3.5143]
2025-04-15 07:32:13,087 - INFO -   Noise shape: tensor([ 0.3113,  0.5582,  1.0726,  0.3947,  0.5185, -0.1644, -0.1638],
       device='cuda:0'), range: [-3.8792, 3.4874]
2025-04-15 07:32:13,087 - INFO -   Noisy actions shape: tensor([ 0.6074, -0.0553,  1.0439, -0.2467,  0.5802, -0.3100, -0.0612],
       device='cuda:0'), range: [-3.9045, 3.4668]
2025-04-15 07:32:13,132 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:13,132 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1903, 3.3939]
2025-04-15 07:32:13,132 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9314, 3.6610]
2025-04-15 07:32:13,132 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,132 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,133 - INFO -   True actions shape: tensor([ 0.9976, -1.6392,  0.3967, -0.5828, -0.6040, -0.5509,  0.0953],
       device='cuda:0'), range: [-3.1903, 3.3939]
2025-04-15 07:32:13,133 - INFO -   Noise shape: tensor([ 1.6576, -0.0277,  0.4064, -2.0799,  0.4474, -0.9818,  0.4798],
       device='cuda:0'), range: [-3.3518, 3.8557]
2025-04-15 07:32:13,134 - INFO -   Noisy actions shape: tensor([ 1.5210, -1.5423,  0.5151, -1.2831, -0.4059, -0.8635,  0.2594],
       device='cuda:0'), range: [-3.3512, 3.9750]
2025-04-15 07:32:13,179 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:13,179 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4128, 3.7280]
2025-04-15 07:32:13,179 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3376, 3.3119]
2025-04-15 07:32:13,179 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,179 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,180 - INFO -   True actions shape: tensor([-0.4283, -1.2380, -0.8699, -0.4539, -1.3030, -0.8014,  1.2672],
       device='cuda:0'), range: [-3.4128, 3.7280]
2025-04-15 07:32:13,180 - INFO -   Noise shape: tensor([-2.1116,  1.4863, -0.5463,  0.3420, -0.7380,  1.0148,  1.5681],
       device='cuda:0'), range: [-3.0783, 3.3402]
2025-04-15 07:32:13,181 - INFO -   Noisy actions shape: tensor([-0.7054, -1.0292, -0.9348, -0.4043, -1.3896, -0.6593,  1.4645],
       device='cuda:0'), range: [-3.3219, 4.2200]
2025-04-15 07:32:13,225 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:13,226 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2377, 3.4411]
2025-04-15 07:32:13,226 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4540, 3.2582]
2025-04-15 07:32:13,226 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,226 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,227 - INFO -   True actions shape: tensor([ 1.3800, -1.5760,  1.8066, -0.8273,  1.4668,  0.5747,  0.5892],
       device='cuda:0'), range: [-3.2377, 3.4411]
2025-04-15 07:32:13,227 - INFO -   Noise shape: tensor([-0.3485, -0.6267, -1.5145, -1.2518,  0.5249, -0.9841,  0.9583],
       device='cuda:0'), range: [-3.9925, 3.0708]
2025-04-15 07:32:13,228 - INFO -   Noisy actions shape: tensor([ 1.2298, -1.6879,  1.3173, -1.1412,  1.5548,  0.2801,  0.8313],
       device='cuda:0'), range: [-3.5395, 3.3170]
2025-04-15 07:32:13,272 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:13,273 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7003, 3.4318]
2025-04-15 07:32:13,273 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5919, 3.5327]
2025-04-15 07:32:13,273 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,273 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,274 - INFO -   True actions shape: tensor([-1.0438,  0.9682,  0.0699,  1.3611,  0.0662,  1.5857, -1.6651],
       device='cuda:0'), range: [-3.7003, 3.4318]
2025-04-15 07:32:13,274 - INFO -   Noise shape: tensor([ 0.1638, -1.0331, -1.1174,  0.6487,  1.1647, -0.0097,  0.5445],
       device='cuda:0'), range: [-3.8655, 4.0293]
2025-04-15 07:32:13,275 - INFO -   Noisy actions shape: tensor([-0.8159,  0.3093, -0.5074,  1.5020,  0.6486,  1.3610, -1.1577],
       device='cuda:0'), range: [-3.6442, 3.2584]
2025-04-15 07:32:13,319 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:13,319 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5209, 3.7733]
2025-04-15 07:32:13,319 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1389, 3.3687]
2025-04-15 07:32:13,319 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,319 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,320 - INFO -   True actions shape: tensor([-0.0639, -0.8235, -0.0043, -0.4875,  1.0387, -1.2582,  1.7006],
       device='cuda:0'), range: [-3.5209, 3.7733]
2025-04-15 07:32:13,321 - INFO -   Noise shape: tensor([ 1.9047,  0.2434, -0.1108, -0.5297, -0.1118, -1.8998, -0.5213],
       device='cuda:0'), range: [-3.8693, 3.2897]
2025-04-15 07:32:13,321 - INFO -   Noisy actions shape: tensor([ 0.7139, -0.6541, -0.0488, -0.6604,  0.9042, -1.9204,  1.3432],
       device='cuda:0'), range: [-3.6321, 3.4155]
2025-04-15 07:32:13,366 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:13,366 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2175, 3.1134]
2025-04-15 07:32:13,366 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0516, 3.4609]
2025-04-15 07:32:13,366 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,366 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,367 - INFO -   True actions shape: tensor([-0.6687, -1.4109, -0.0469,  0.8129,  0.3311, -0.5628,  0.1492],
       device='cuda:0'), range: [-3.2175, 3.1134]
2025-04-15 07:32:13,368 - INFO -   Noise shape: tensor([ 0.6230,  1.4694,  0.7779,  1.2655, -1.4390, -0.1884, -0.0896],
       device='cuda:0'), range: [-3.2408, 3.1898]
2025-04-15 07:32:13,368 - INFO -   Noisy actions shape: tensor([ 0.6125,  1.4472,  0.7771,  1.2780, -1.4337, -0.1972, -0.0872],
       device='cuda:0'), range: [-3.5111, 3.3235]
2025-04-15 07:32:13,413 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:13,413 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7543, 3.1992]
2025-04-15 07:32:13,413 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7387, 2.5571]
2025-04-15 07:32:13,413 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,413 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,414 - INFO -   True actions shape: tensor([ 0.0384, -0.5762,  1.4127, -0.5745, -0.7161, -0.0097, -1.0488],
       device='cuda:0'), range: [-3.7543, 3.1992]
2025-04-15 07:32:13,414 - INFO -   Noise shape: tensor([-0.9626, -1.4811,  0.5227, -0.3356, -1.6181,  1.2458,  0.0783],
       device='cuda:0'), range: [-3.4592, 3.2111]
2025-04-15 07:32:13,415 - INFO -   Noisy actions shape: tensor([-0.0629, -0.7286,  1.4598, -0.6066, -0.8822,  0.1212, -1.0348],
       device='cuda:0'), range: [-3.3700, 3.1245]
2025-04-15 07:32:13,460 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:13,460 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4904, 3.7645]
2025-04-15 07:32:13,460 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0246, 3.8556]
2025-04-15 07:32:13,460 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,460 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,461 - INFO -   True actions shape: tensor([-0.2766, -1.3192,  0.5576, -0.8483, -0.8807,  0.2380, -1.0458],
       device='cuda:0'), range: [-3.4904, 3.7645]
2025-04-15 07:32:13,462 - INFO -   Noise shape: tensor([-0.7041, -0.3163, -1.4293,  0.1194,  0.0507, -1.4855, -1.2071],
       device='cuda:0'), range: [-3.7192, 4.1360]
2025-04-15 07:32:13,462 - INFO -   Noisy actions shape: tensor([-0.7122, -1.1065, -0.7090, -0.4684, -0.5415, -0.9616, -1.5972],
       device='cuda:0'), range: [-3.7572, 3.1825]
2025-04-15 07:32:13,505 - INFO -   Loss components:
2025-04-15 07:32:13,505 - INFO -     Diffusion loss: 1.363141 (coef: 1.0)
2025-04-15 07:32:13,505 - INFO -     Grasp quality loss: 0.693143 (coef: 0.5)
2025-04-15 07:32:13,505 - INFO -     Grasp rotation loss: 0.585395 (coef: 0.5)
2025-04-15 07:32:13,505 - INFO -     Grasp width loss: 4.685644 (coef: 0.005)
2025-04-15 07:32:13,505 - INFO -     TOTAL loss: 2.025838
2025-04-15 07:32:13,513 - INFO -   Gradients: avg norm: 0.331713, max norm: 2.498127, non-zero params: 250
2025-04-15 07:32:13,513 - INFO -   Optimizer step complete, current LR: 9.924039e-05
2025-04-15 07:32:13,516 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:13,516 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6330, 3.4658]
2025-04-15 07:32:13,516 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.5362, 3.2783]
2025-04-15 07:32:13,516 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,516 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,517 - INFO -   True actions shape: tensor([-0.3787,  0.9500,  1.1090,  0.0175, -0.4382,  1.1839,  0.4921],
       device='cuda:0'), range: [-3.6330, 3.4658]
2025-04-15 07:32:13,517 - INFO -   Noise shape: tensor([ 0.1039, -0.1633, -0.5155,  0.0313, -1.0585, -0.5900, -0.6299],
       device='cuda:0'), range: [-3.7908, 4.1310]
2025-04-15 07:32:13,518 - INFO -   Noisy actions shape: tensor([-0.3408,  0.8792,  0.9454,  0.0248, -0.6884,  0.9993,  0.3194],
       device='cuda:0'), range: [-3.7933, 3.3976]
2025-04-15 07:32:13,563 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:13,563 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4522, 3.1678]
2025-04-15 07:32:13,563 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1897, 2.8285]
2025-04-15 07:32:13,563 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,563 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,564 - INFO -   True actions shape: tensor([ 0.0330,  1.2780,  0.5072, -1.9469,  1.0468,  0.7372, -0.0405],
       device='cuda:0'), range: [-3.4522, 3.1678]
2025-04-15 07:32:13,564 - INFO -   Noise shape: tensor([-0.1202,  1.0107, -0.1600,  1.1492,  1.2562,  0.3239,  0.4899],
       device='cuda:0'), range: [-4.1079, 3.2875]
2025-04-15 07:32:13,565 - INFO -   Noisy actions shape: tensor([-0.1073,  1.3116, -0.0207,  0.5959,  1.4875,  0.5066,  0.4619],
       device='cuda:0'), range: [-3.7307, 3.1488]
2025-04-15 07:32:13,607 - INFO - 
=== Epoch 17 Summary ===
2025-04-15 07:32:13,607 - INFO -   Avg total loss: 1.954227
2025-04-15 07:32:13,607 - INFO -   Avg diffusion loss: 1.294571
2025-04-15 07:32:13,607 - INFO -   Avg grasp loss: 1.319312
2025-04-15 07:32:13,607 - INFO - 
=== EPOCH 18/20 ===
2025-04-15 07:32:13,608 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:13,611 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:13,611 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8522, 3.6832]
2025-04-15 07:32:13,611 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0345, 2.8560]
2025-04-15 07:32:13,611 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,612 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,612 - INFO -   True actions shape: tensor([0.1555, 0.8034, 2.2205, 2.2143, 1.6518, 0.7499, 1.3387],
       device='cuda:0'), range: [-3.8522, 3.6832]
2025-04-15 07:32:13,613 - INFO -   Noise shape: tensor([ 1.1786, -1.4615, -0.3053, -0.4076,  0.2441,  2.6734, -1.0168],
       device='cuda:0'), range: [-3.4838, 3.2983]
2025-04-15 07:32:13,613 - INFO -   Noisy actions shape: tensor([ 0.9845, -0.5593,  1.2463,  1.1657,  1.2794,  2.4968,  0.1288],
       device='cuda:0'), range: [-3.6371, 3.6550]
2025-04-15 07:32:13,613 - INFO -   Diffusion: timestep range [18, 965], noise range [-3.4838, 3.2983]
2025-04-15 07:32:13,614 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.6371, 3.6550]
2025-04-15 07:32:13,635 - INFO -   Model output shapes:
2025-04-15 07:32:13,635 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:13,635 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4357, 0.5555]
2025-04-15 07:32:13,635 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.4055
2025-04-15 07:32:13,635 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0797, 0.2370]
2025-04-15 07:32:13,656 - INFO -   Loss components:
2025-04-15 07:32:13,656 - INFO -     Diffusion loss: 1.257301 (coef: 1.0)
2025-04-15 07:32:13,656 - INFO -     Grasp quality loss: 0.695614 (coef: 0.5)
2025-04-15 07:32:13,656 - INFO -     Grasp rotation loss: 0.565974 (coef: 0.5)
2025-04-15 07:32:13,656 - INFO -     Grasp width loss: 4.428803 (coef: 0.005)
2025-04-15 07:32:13,656 - INFO -     TOTAL loss: 1.910240
2025-04-15 07:32:13,664 - INFO -   Gradients: avg norm: 0.302794, max norm: 2.537547, non-zero params: 250
2025-04-15 07:32:13,664 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-15 07:32:13,664 - INFO - --- Gradient Check @ Epoch 18, Batch 0 ---
2025-04-15 07:32:13,680 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:13,680 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:13,680 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=4.9318e-01, MaxNorm=1.8104e+00
2025-04-15 07:32:13,680 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.0284e-02, MaxNorm=1.9981e-02
2025-04-15 07:32:13,680 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=1.2774e-02, MaxNorm=3.7922e-02
2025-04-15 07:32:13,681 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=4.3084e-02, MaxNorm=1.0527e-01
2025-04-15 07:32:13,681 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.4024e+00, MaxNorm=2.5375e+00
2025-04-15 07:32:13,681 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=8.8994e-01, MaxNorm=1.6185e+00
2025-04-15 07:32:13,681 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=6.4320e-02, MaxNorm=2.9086e-01
2025-04-15 07:32:13,681 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=1.6599e-01, MaxNorm=2.2373e-01
2025-04-15 07:32:13,681 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=6.0666e-01, MaxNorm=6.2910e-01
2025-04-15 07:32:13,681 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.3263e+00, MaxNorm=2.4187e+00
2025-04-15 07:32:13,681 - INFO - --- End Gradient Check ---
2025-04-15 07:32:13,683 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:13,683 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3763, 3.4186]
2025-04-15 07:32:13,683 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0434, 3.2528]
2025-04-15 07:32:13,684 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,684 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,684 - INFO -   True actions shape: tensor([ 0.9932, -1.2127,  0.7944,  0.5126,  2.3066, -1.3005,  0.6488],
       device='cuda:0'), range: [-3.3763, 3.4186]
2025-04-15 07:32:13,685 - INFO -   Noise shape: tensor([ 1.0326,  0.1664,  0.5712,  1.2580, -1.0563,  0.8758,  0.8145],
       device='cuda:0'), range: [-3.3614, 3.6259]
2025-04-15 07:32:13,685 - INFO -   Noisy actions shape: tensor([ 1.3995, -0.4921,  0.9022,  1.3404,  0.3055,  0.0667,  1.0335],
       device='cuda:0'), range: [-3.5659, 3.2625]
2025-04-15 07:32:13,730 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:13,730 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5377, 3.9230]
2025-04-15 07:32:13,730 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8885, 2.6881]
2025-04-15 07:32:13,731 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,731 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,731 - INFO -   True actions shape: tensor([ 0.5248, -1.6355, -0.6587,  0.1780,  1.1017, -1.3373,  0.5807],
       device='cuda:0'), range: [-3.5377, 3.9230]
2025-04-15 07:32:13,732 - INFO -   Noise shape: tensor([ 1.2675,  0.1556, -1.0126,  0.7407,  1.3384, -1.1348, -0.3941],
       device='cuda:0'), range: [-3.2277, 3.4637]
2025-04-15 07:32:13,732 - INFO -   Noisy actions shape: tensor([ 1.3229, -0.0490, -1.0866,  0.7571,  1.4651, -1.2923, -0.3188],
       device='cuda:0'), range: [-3.5239, 3.3955]
2025-04-15 07:32:13,777 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:13,777 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0595, 3.5869]
2025-04-15 07:32:13,778 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9433, 3.5124]
2025-04-15 07:32:13,778 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,778 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,778 - INFO -   True actions shape: tensor([-0.9477,  0.7233,  0.1302,  0.4400, -0.1640, -0.3825, -0.9775],
       device='cuda:0'), range: [-3.0595, 3.5869]
2025-04-15 07:32:13,779 - INFO -   Noise shape: tensor([-1.3025,  0.6797, -0.1224, -0.9803,  1.1949,  1.2853,  1.2406],
       device='cuda:0'), range: [-2.8748, 3.3138]
2025-04-15 07:32:13,779 - INFO -   Noisy actions shape: tensor([-1.3645,  0.9244,  0.0753,  0.0433,  0.2928,  0.1236, -0.4452],
       device='cuda:0'), range: [-3.5402, 2.8905]
2025-04-15 07:32:13,824 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:13,824 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8696, 3.8343]
2025-04-15 07:32:13,824 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0973, 3.6413]
2025-04-15 07:32:13,824 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,824 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,825 - INFO -   True actions shape: tensor([ 0.0237, -0.0946, -0.5935,  0.2745, -1.6310,  0.8033, -1.6537],
       device='cuda:0'), range: [-3.8696, 3.8343]
2025-04-15 07:32:13,826 - INFO -   Noise shape: tensor([-1.3796,  1.5097,  0.1666, -0.7348, -2.2152, -0.2559,  0.5182],
       device='cuda:0'), range: [-3.2388, 3.2250]
2025-04-15 07:32:13,826 - INFO -   Noisy actions shape: tensor([-0.7877,  0.8063, -0.3839, -0.2072, -2.6186,  0.5019, -1.0382],
       device='cuda:0'), range: [-3.6198, 3.1354]
2025-04-15 07:32:13,871 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:13,871 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0695, 3.6405]
2025-04-15 07:32:13,871 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2361, 2.8470]
2025-04-15 07:32:13,871 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,871 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,872 - INFO -   True actions shape: tensor([ 0.3334, -0.8144,  0.5107, -1.4527, -1.3957, -0.8868, -1.2684],
       device='cuda:0'), range: [-3.0695, 3.6405]
2025-04-15 07:32:13,872 - INFO -   Noise shape: tensor([-1.3928, -0.0062,  0.0404, -1.1080,  0.1539, -0.7450, -0.8179],
       device='cuda:0'), range: [-3.2668, 3.1189]
2025-04-15 07:32:13,873 - INFO -   Noisy actions shape: tensor([-0.1339, -0.7728,  0.4964, -1.7325, -1.2713, -1.0797, -1.4645],
       device='cuda:0'), range: [-3.2743, 3.1007]
2025-04-15 07:32:13,918 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:13,918 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6159, 3.1492]
2025-04-15 07:32:13,918 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.4282, 3.1621]
2025-04-15 07:32:13,918 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,918 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,919 - INFO -   True actions shape: tensor([ 0.7716, -1.7421, -1.1063,  1.1480,  0.2580,  0.1716, -0.4063],
       device='cuda:0'), range: [-3.6159, 3.1492]
2025-04-15 07:32:13,919 - INFO -   Noise shape: tensor([-1.3250,  0.4677,  1.0440, -1.0576,  0.6332,  0.4083,  1.1794],
       device='cuda:0'), range: [-3.3412, 3.8406]
2025-04-15 07:32:13,920 - INFO -   Noisy actions shape: tensor([-1.1553,  0.1300,  0.8161, -0.8216,  0.6706,  0.4334,  1.0814],
       device='cuda:0'), range: [-3.3510, 3.4126]
2025-04-15 07:32:13,965 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:13,965 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5589, 3.3031]
2025-04-15 07:32:13,965 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.9340, 2.9459]
2025-04-15 07:32:13,965 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:13,965 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:13,966 - INFO -   True actions shape: tensor([-0.4341,  1.0549, -1.2771,  0.5415,  1.4282, -1.1306,  0.9917],
       device='cuda:0'), range: [-3.5589, 3.3031]
2025-04-15 07:32:13,966 - INFO -   Noise shape: tensor([-0.3993, -1.4399, -1.7634,  2.1449, -1.5131, -0.1709,  0.5214],
       device='cuda:0'), range: [-3.5468, 4.6855]
2025-04-15 07:32:13,967 - INFO -   Noisy actions shape: tensor([-0.4424, -1.3221, -1.8869,  2.1896, -1.3560, -0.2879,  0.6220],
       device='cuda:0'), range: [-3.2292, 4.7530]
2025-04-15 07:32:14,011 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:14,011 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.7274, 3.5168]
2025-04-15 07:32:14,011 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7260, 3.1799]
2025-04-15 07:32:14,012 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,012 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,012 - INFO -   True actions shape: tensor([-1.4226, -0.9336,  0.5269, -0.1594, -0.7311,  0.6859,  1.1121],
       device='cuda:0'), range: [-3.7274, 3.5168]
2025-04-15 07:32:14,013 - INFO -   Noise shape: tensor([ 0.3264,  1.1034, -0.7214,  2.3214,  1.0073, -0.9888,  0.0316],
       device='cuda:0'), range: [-3.5307, 4.2080]
2025-04-15 07:32:14,013 - INFO -   Noisy actions shape: tensor([-0.7733,  0.1222, -0.1388,  1.5314,  0.1972, -0.2160,  0.8076],
       device='cuda:0'), range: [-3.2514, 4.1821]
2025-04-15 07:32:14,058 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:14,058 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5423, 3.0926]
2025-04-15 07:32:14,058 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9447, 2.7415]
2025-04-15 07:32:14,058 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,058 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,059 - INFO -   True actions shape: tensor([ 1.2858, -0.1158, -0.7986, -1.8874,  1.5332,  0.8134, -0.3536],
       device='cuda:0'), range: [-3.5423, 3.0926]
2025-04-15 07:32:14,060 - INFO -   Noise shape: tensor([-1.0947, -1.4649, -0.5311,  1.2755,  1.2875, -0.1793, -0.5579],
       device='cuda:0'), range: [-3.2075, 3.2001]
2025-04-15 07:32:14,060 - INFO -   Noisy actions shape: tensor([ 0.8295, -0.6138, -0.9327, -1.3320,  1.8831,  0.7018, -0.5243],
       device='cuda:0'), range: [-3.7785, 2.8442]
2025-04-15 07:32:14,105 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:14,105 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.0016, 3.5445]
2025-04-15 07:32:14,105 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5048, 3.2837]
2025-04-15 07:32:14,105 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,105 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,106 - INFO -   True actions shape: tensor([ 0.3724,  2.0892, -1.6305, -0.1796,  0.2405, -0.2909,  0.1569],
       device='cuda:0'), range: [-3.0016, 3.5445]
2025-04-15 07:32:14,107 - INFO -   Noise shape: tensor([ 0.6878,  0.2826, -0.5879,  1.2979, -1.0224,  2.3124,  1.0713],
       device='cuda:0'), range: [-3.3540, 3.2678]
2025-04-15 07:32:14,107 - INFO -   Noisy actions shape: tensor([ 0.5489,  2.0854, -1.7297,  0.1884, -0.0533,  0.3636,  0.4486],
       device='cuda:0'), range: [-3.3575, 3.4399]
2025-04-15 07:32:14,150 - INFO -   Loss components:
2025-04-15 07:32:14,150 - INFO -     Diffusion loss: 1.095438 (coef: 1.0)
2025-04-15 07:32:14,150 - INFO -     Grasp quality loss: 0.695074 (coef: 0.5)
2025-04-15 07:32:14,150 - INFO -     Grasp rotation loss: 0.552730 (coef: 0.5)
2025-04-15 07:32:14,150 - INFO -     Grasp width loss: 4.530294 (coef: 0.005)
2025-04-15 07:32:14,150 - INFO -     TOTAL loss: 1.741992
2025-04-15 07:32:14,158 - INFO -   Gradients: avg norm: 0.225928, max norm: 2.182395, non-zero params: 250
2025-04-15 07:32:14,158 - INFO -   Optimizer step complete, current LR: 1.169778e-05
2025-04-15 07:32:14,160 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:14,160 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5502, 3.6343]
2025-04-15 07:32:14,160 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7887, 3.2736]
2025-04-15 07:32:14,161 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,161 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,161 - INFO -   True actions shape: tensor([-0.4538, -0.4001,  1.4293, -0.2687, -1.3424, -1.1829,  0.6995],
       device='cuda:0'), range: [-3.5502, 3.6343]
2025-04-15 07:32:14,162 - INFO -   Noise shape: tensor([ 1.4252,  0.2172, -1.0929,  0.5908,  0.4193,  0.6618, -0.5769],
       device='cuda:0'), range: [-3.4579, 3.6876]
2025-04-15 07:32:14,162 - INFO -   Noisy actions shape: tensor([ 1.1826,  0.0666, -0.5354,  0.4626, -0.0673,  0.2152, -0.3015],
       device='cuda:0'), range: [-3.4911, 3.4260]
2025-04-15 07:32:14,207 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:14,207 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.2011, 2.9231]
2025-04-15 07:32:14,207 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3540, 2.9889]
2025-04-15 07:32:14,207 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,208 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,208 - INFO -   True actions shape: tensor([ 1.0095, -0.7167, -0.3470, -0.7783,  0.5224, -0.8716, -0.5199],
       device='cuda:0'), range: [-4.2011, 2.9231]
2025-04-15 07:32:14,209 - INFO -   Noise shape: tensor([-0.4717, -0.9148, -0.3039, -0.6149,  0.6666, -1.6762, -0.8007],
       device='cuda:0'), range: [-4.0235, 3.9239]
2025-04-15 07:32:14,209 - INFO -   Noisy actions shape: tensor([ 0.1119, -1.1528, -0.4388, -0.9268,  0.8401, -1.8861, -0.9540],
       device='cuda:0'), range: [-4.2001, 3.0754]
2025-04-15 07:32:14,252 - INFO - 
=== Epoch 18 Summary ===
2025-04-15 07:32:14,252 - INFO -   Avg total loss: 1.792032
2025-04-15 07:32:14,252 - INFO -   Avg diffusion loss: 1.134294
2025-04-15 07:32:14,252 - INFO -   Avg grasp loss: 1.315477
2025-04-15 07:32:14,252 - INFO - 
=== EPOCH 19/20 ===
2025-04-15 07:32:14,253 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:14,256 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:14,256 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1401, 3.1831]
2025-04-15 07:32:14,256 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7014, 3.2320]
2025-04-15 07:32:14,256 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,256 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,257 - INFO -   True actions shape: tensor([-1.4640, -1.2691,  0.3242, -0.3352,  0.6752, -1.1261, -1.6352],
       device='cuda:0'), range: [-3.1401, 3.1831]
2025-04-15 07:32:14,257 - INFO -   Noise shape: tensor([ 0.5685,  1.4429, -1.5752,  0.9436, -0.7044,  1.7464,  0.9854],
       device='cuda:0'), range: [-3.7856, 3.3479]
2025-04-15 07:32:14,258 - INFO -   Noisy actions shape: tensor([-1.1284, -0.6093, -0.3128,  0.0575,  0.3488, -0.3597, -1.1243],
       device='cuda:0'), range: [-4.2633, 3.5069]
2025-04-15 07:32:14,258 - INFO -   Diffusion: timestep range [40, 716], noise range [-3.7856, 3.3479]
2025-04-15 07:32:14,258 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-4.2633, 3.5069]
2025-04-15 07:32:14,279 - INFO -   Model output shapes:
2025-04-15 07:32:14,279 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:14,279 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4428, 0.5561]
2025-04-15 07:32:14,279 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3943
2025-04-15 07:32:14,280 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0782, 0.1736]
2025-04-15 07:32:14,301 - INFO -   Loss components:
2025-04-15 07:32:14,301 - INFO -     Diffusion loss: 1.318165 (coef: 1.0)
2025-04-15 07:32:14,301 - INFO -     Grasp quality loss: 0.695579 (coef: 0.5)
2025-04-15 07:32:14,301 - INFO -     Grasp rotation loss: 0.571271 (coef: 0.5)
2025-04-15 07:32:14,301 - INFO -     Grasp width loss: 4.073389 (coef: 0.005)
2025-04-15 07:32:14,301 - INFO -     TOTAL loss: 1.971957
2025-04-15 07:32:14,308 - INFO -   Gradients: avg norm: 0.251136, max norm: 2.327605, non-zero params: 250
2025-04-15 07:32:14,308 - INFO -   Optimizer step complete, current LR: 7.596123e-07
2025-04-15 07:32:14,308 - INFO - --- Gradient Check @ Epoch 19, Batch 0 ---
2025-04-15 07:32:14,325 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:14,325 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:14,325 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=3.9237e-01, MaxNorm=1.4952e+00
2025-04-15 07:32:14,325 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=1.1731e-02, MaxNorm=2.6993e-02
2025-04-15 07:32:14,325 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.7986e-03, MaxNorm=2.0354e-02
2025-04-15 07:32:14,325 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=9.7678e-02, MaxNorm=1.8848e-01
2025-04-15 07:32:14,325 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=1.2154e+00, MaxNorm=2.3276e+00
2025-04-15 07:32:14,325 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=6.9408e-01, MaxNorm=1.2468e+00
2025-04-15 07:32:14,325 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=4.6789e-02, MaxNorm=2.1460e-01
2025-04-15 07:32:14,325 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=2.2971e-01, MaxNorm=2.4401e-01
2025-04-15 07:32:14,325 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=3.9357e-01, MaxNorm=4.1196e-01
2025-04-15 07:32:14,325 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=1.0536e+00, MaxNorm=1.9324e+00
2025-04-15 07:32:14,325 - INFO - --- End Gradient Check ---
2025-04-15 07:32:14,328 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:14,328 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-4.1537, 3.7304]
2025-04-15 07:32:14,328 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8406, 3.0017]
2025-04-15 07:32:14,328 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,328 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,329 - INFO -   True actions shape: tensor([ 1.1352,  1.1908,  0.9408, -0.0938,  0.9057,  2.2839, -0.8518],
       device='cuda:0'), range: [-4.1537, 3.7304]
2025-04-15 07:32:14,329 - INFO -   Noise shape: tensor([ 0.0614, -0.5930, -1.6328,  0.1924,  2.7724, -1.5225, -0.7285],
       device='cuda:0'), range: [-3.0975, 3.1866]
2025-04-15 07:32:14,330 - INFO -   Noisy actions shape: tensor([ 0.5135, -0.0631, -1.1156,  0.1383,  2.9024, -0.4736, -1.0099],
       device='cuda:0'), range: [-3.1905, 3.0521]
2025-04-15 07:32:14,375 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:14,375 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3368, 3.3065]
2025-04-15 07:32:14,375 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.0008, 3.1012]
2025-04-15 07:32:14,375 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,375 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,376 - INFO -   True actions shape: tensor([-0.2244, -0.1590, -1.6040,  0.1263, -1.0498,  0.0504,  0.6740],
       device='cuda:0'), range: [-3.3368, 3.3065]
2025-04-15 07:32:14,376 - INFO -   Noise shape: tensor([-1.8102, -0.0172,  0.2542, -0.4250, -0.5390,  0.5498, -1.6057],
       device='cuda:0'), range: [-3.6362, 3.5150]
2025-04-15 07:32:14,377 - INFO -   Noisy actions shape: tensor([-1.3296, -0.1333, -1.0712, -0.1745, -1.1519,  0.3902, -0.5079],
       device='cuda:0'), range: [-3.8105, 2.8731]
2025-04-15 07:32:14,422 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:14,422 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4382, 3.6615]
2025-04-15 07:32:14,422 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9879, 2.7822]
2025-04-15 07:32:14,422 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,422 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,423 - INFO -   True actions shape: tensor([-1.1010, -0.4707,  3.6615, -1.0122, -0.8161, -0.3341, -1.1731],
       device='cuda:0'), range: [-3.4382, 3.6615]
2025-04-15 07:32:14,423 - INFO -   Noise shape: tensor([ 0.9394, -0.6941,  2.1648,  0.4128, -1.1953, -0.0838,  0.4834],
       device='cuda:0'), range: [-3.0610, 3.3618]
2025-04-15 07:32:14,424 - INFO -   Noisy actions shape: tensor([ 0.0321, -0.8354,  3.9918, -0.3198, -1.4421, -0.2762, -0.3669],
       device='cuda:0'), range: [-3.7522, 3.9918]
2025-04-15 07:32:14,469 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:14,469 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2149, 3.3357]
2025-04-15 07:32:14,469 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1258, 3.3093]
2025-04-15 07:32:14,469 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,469 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,470 - INFO -   True actions shape: tensor([ 0.5173, -1.0153, -0.9184, -0.2345, -0.2889,  0.3467, -0.4817],
       device='cuda:0'), range: [-3.2149, 3.3357]
2025-04-15 07:32:14,471 - INFO -   Noise shape: tensor([-0.0920,  1.5430, -1.0745,  0.8441,  0.0701,  0.7843, -0.0482],
       device='cuda:0'), range: [-3.1689, 3.3574]
2025-04-15 07:32:14,471 - INFO -   Noisy actions shape: tensor([ 0.5053, -0.8528, -1.0231, -0.1472, -0.2803,  0.4249, -0.4841],
       device='cuda:0'), range: [-3.2885, 3.5732]
2025-04-15 07:32:14,516 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:14,516 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5735, 3.5430]
2025-04-15 07:32:14,517 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1526, 3.2598]
2025-04-15 07:32:14,517 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,517 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,517 - INFO -   True actions shape: tensor([ 0.9451, -1.2075, -0.7113, -1.3267,  1.2910,  0.4102,  2.1470],
       device='cuda:0'), range: [-3.5735, 3.5430]
2025-04-15 07:32:14,518 - INFO -   Noise shape: tensor([-1.9796, -1.0945,  0.0947, -1.1886,  0.9620, -0.2262, -0.1159],
       device='cuda:0'), range: [-3.4094, 3.3502]
2025-04-15 07:32:14,519 - INFO -   Noisy actions shape: tensor([-1.8966, -1.1887,  0.0368, -1.2921,  1.0633, -0.1923,  0.0583],
       device='cuda:0'), range: [-3.8086, 3.3128]
2025-04-15 07:32:14,563 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:14,564 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8213, 3.3855]
2025-04-15 07:32:14,564 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.8316, 2.9482]
2025-04-15 07:32:14,564 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,564 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,565 - INFO -   True actions shape: tensor([ 0.7372,  1.4684, -0.3204, -0.2616, -1.0159, -0.1115,  0.0344],
       device='cuda:0'), range: [-3.8213, 3.3855]
2025-04-15 07:32:14,565 - INFO -   Noise shape: tensor([-0.3950,  0.1627, -0.0098,  0.6016, -0.4399,  0.6034, -0.9927],
       device='cuda:0'), range: [-3.4002, 3.5121]
2025-04-15 07:32:14,566 - INFO -   Noisy actions shape: tensor([ 0.7068,  1.4763, -0.3203, -0.2175, -1.0450, -0.0677, -0.0373],
       device='cuda:0'), range: [-3.6396, 3.5554]
2025-04-15 07:32:14,610 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:14,610 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2854, 3.5189]
2025-04-15 07:32:14,610 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9102, 3.7169]
2025-04-15 07:32:14,610 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,611 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,611 - INFO -   True actions shape: tensor([-1.5225,  0.8493, -0.3506, -0.5813,  1.4571, -1.2936, -0.1326],
       device='cuda:0'), range: [-3.2854, 3.5189]
2025-04-15 07:32:14,612 - INFO -   Noise shape: tensor([ 1.6252,  2.0283,  0.3780, -0.8525,  1.7182, -0.2823,  0.3319],
       device='cuda:0'), range: [-3.3828, 3.2111]
2025-04-15 07:32:14,612 - INFO -   Noisy actions shape: tensor([-0.7590,  1.5798, -0.1733, -0.8702,  2.0162, -1.3002,  0.0089],
       device='cuda:0'), range: [-3.7296, 3.6142]
2025-04-15 07:32:14,657 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:14,657 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2973, 3.2276]
2025-04-15 07:32:14,657 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.7942, 2.9210]
2025-04-15 07:32:14,657 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,657 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,658 - INFO -   True actions shape: tensor([-0.4607, -0.2882, -0.0423,  1.7031,  1.5823,  0.0469, -1.3073],
       device='cuda:0'), range: [-3.2973, 3.2276]
2025-04-15 07:32:14,659 - INFO -   Noise shape: tensor([ 0.4815,  0.9585, -0.1597, -1.6488,  1.0419, -0.3705, -0.1332],
       device='cuda:0'), range: [-3.4682, 3.5124]
2025-04-15 07:32:14,659 - INFO -   Noisy actions shape: tensor([ 0.2222,  0.7257, -0.1616, -0.7043,  1.6432, -0.3096, -0.7081],
       device='cuda:0'), range: [-3.7482, 3.7952]
2025-04-15 07:32:14,704 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:14,704 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6825, 3.7385]
2025-04-15 07:32:14,704 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5449, 3.9309]
2025-04-15 07:32:14,704 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,704 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,705 - INFO -   True actions shape: tensor([ 0.1707,  0.1927,  0.4426,  0.0737, -1.1759,  0.8264,  0.9030],
       device='cuda:0'), range: [-3.6825, 3.7385]
2025-04-15 07:32:14,705 - INFO -   Noise shape: tensor([ 0.5959,  0.8519,  1.1611, -0.3598, -0.1641,  1.9890,  0.0374],
       device='cuda:0'), range: [-3.5019, 3.8252]
2025-04-15 07:32:14,706 - INFO -   Noisy actions shape: tensor([ 0.5696,  0.7820,  1.1795, -0.2323, -0.8704,  2.0637,  0.5997],
       device='cuda:0'), range: [-3.7397, 3.2403]
2025-04-15 07:32:14,750 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:14,750 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8271, 3.4924]
2025-04-15 07:32:14,751 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.5474, 3.2274]
2025-04-15 07:32:14,751 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,751 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,751 - INFO -   True actions shape: tensor([ 0.1142, -1.7084, -1.6769, -0.1901, -2.4416,  1.1244, -0.9162],
       device='cuda:0'), range: [-3.8271, 3.4924]
2025-04-15 07:32:14,752 - INFO -   Noise shape: tensor([-0.9068, -0.0299, -0.6954, -0.6742,  0.3051,  1.1393,  0.5181],
       device='cuda:0'), range: [-3.6027, 4.1738]
2025-04-15 07:32:14,753 - INFO -   Noisy actions shape: tensor([-0.9030, -0.0805, -0.7448, -0.6795,  0.2327,  1.1721,  0.4908],
       device='cuda:0'), range: [-3.2492, 3.1086]
2025-04-15 07:32:14,794 - INFO -   Loss components:
2025-04-15 07:32:14,795 - INFO -     Diffusion loss: 1.154909 (coef: 1.0)
2025-04-15 07:32:14,795 - INFO -     Grasp quality loss: 0.693177 (coef: 0.5)
2025-04-15 07:32:14,795 - INFO -     Grasp rotation loss: 0.586765 (coef: 0.5)
2025-04-15 07:32:14,795 - INFO -     Grasp width loss: 4.841228 (coef: 0.005)
2025-04-15 07:32:14,795 - INFO -     TOTAL loss: 1.819086
2025-04-15 07:32:14,802 - INFO -   Gradients: avg norm: 0.208649, max norm: 1.925195, non-zero params: 250
2025-04-15 07:32:14,802 - INFO -   Optimizer step complete, current LR: 5.000000e-05
2025-04-15 07:32:14,805 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:14,805 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1751, 3.4903]
2025-04-15 07:32:14,805 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1472, 3.5228]
2025-04-15 07:32:14,805 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,805 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,806 - INFO -   True actions shape: tensor([-0.9692,  1.7389, -1.4795, -0.8249,  0.6206, -0.5908,  1.4762],
       device='cuda:0'), range: [-3.1751, 3.4903]
2025-04-15 07:32:14,807 - INFO -   Noise shape: tensor([ 1.7157, -0.6914,  1.7595,  0.3837,  0.4949,  0.4527,  0.9396],
       device='cuda:0'), range: [-4.4516, 3.0897]
2025-04-15 07:32:14,807 - INFO -   Noisy actions shape: tensor([ 0.9044,  0.3742,  0.6615, -0.1309,  0.7540,  0.0551,  1.5947],
       device='cuda:0'), range: [-4.1718, 3.3970]
2025-04-15 07:32:14,853 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:14,853 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3474, 3.5464]
2025-04-15 07:32:14,853 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6242, 3.7847]
2025-04-15 07:32:14,853 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,853 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,854 - INFO -   True actions shape: tensor([ 0.2357, -2.5237, -0.5049,  0.8770,  0.0301,  0.2025, -0.8216],
       device='cuda:0'), range: [-3.3474, 3.5464]
2025-04-15 07:32:14,855 - INFO -   Noise shape: tensor([-0.1630,  2.1914, -0.5309,  1.2416,  0.0699,  2.5486, -0.0638],
       device='cuda:0'), range: [-3.4148, 3.5463]
2025-04-15 07:32:14,855 - INFO -   Noisy actions shape: tensor([ 0.1591, -1.5399, -0.6649,  1.2724,  0.0537,  1.1263, -0.7874],
       device='cuda:0'), range: [-3.5907, 3.8247]
2025-04-15 07:32:14,898 - INFO - 
=== Epoch 19 Summary ===
2025-04-15 07:32:14,898 - INFO -   Avg total loss: 1.802896
2025-04-15 07:32:14,898 - INFO -   Avg diffusion loss: 1.144072
2025-04-15 07:32:14,898 - INFO -   Avg grasp loss: 1.317648
2025-04-15 07:32:14,898 - INFO - 
=== EPOCH 20/20 ===
2025-04-15 07:32:14,899 - INFO - GPU Memory: 0.26GB allocated, 0.49GB reserved
2025-04-15 07:32:14,902 - INFO - Batch 1/13: Generated dummy data
2025-04-15 07:32:14,902 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6305, 3.8345]
2025-04-15 07:32:14,902 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.7427, 3.5305]
2025-04-15 07:32:14,902 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,902 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,903 - INFO -   True actions shape: tensor([-0.9575, -0.1796, -0.7630,  0.1923,  1.5717, -0.8792,  0.1883],
       device='cuda:0'), range: [-3.6305, 3.8345]
2025-04-15 07:32:14,904 - INFO -   Noise shape: tensor([-0.6490, -0.0306, -1.2112,  0.4492, -0.5889, -0.4875, -0.9450],
       device='cuda:0'), range: [-3.3926, 3.9560]
2025-04-15 07:32:14,904 - INFO -   Noisy actions shape: tensor([-0.9806, -0.1006, -1.4163,  0.4886,  0.0966, -0.8013, -0.7883],
       device='cuda:0'), range: [-3.4183, 3.5389]
2025-04-15 07:32:14,904 - INFO -   Diffusion: timestep range [98, 785], noise range [-3.3926, 3.9560]
2025-04-15 07:32:14,904 - INFO -   Noisy actions shape: torch.Size([8, 50, 7]), range: [-3.4183, 3.5389]
2025-04-15 07:32:14,925 - INFO -   Model output shapes:
2025-04-15 07:32:14,925 - INFO -     Diffusion pred: torch.Size([8, 50, 7])
2025-04-15 07:32:14,926 - INFO -     Grasp quality: torch.Size([8, 64]), range: [0.4461, 0.5593]
2025-04-15 07:32:14,926 - INFO -     Grasp rotation: torch.Size([8, 64, 4]), norm: 2.3876
2025-04-15 07:32:14,926 - INFO -     Grasp width: torch.Size([8, 64]), range: [-0.0628, 0.1975]
2025-04-15 07:32:14,948 - INFO -   Loss components:
2025-04-15 07:32:14,948 - INFO -     Diffusion loss: 0.990515 (coef: 1.0)
2025-04-15 07:32:14,948 - INFO -     Grasp quality loss: 0.692088 (coef: 0.5)
2025-04-15 07:32:14,948 - INFO -     Grasp rotation loss: 0.584156 (coef: 0.5)
2025-04-15 07:32:14,948 - INFO -     Grasp width loss: 4.868881 (coef: 0.005)
2025-04-15 07:32:14,948 - INFO -     TOTAL loss: 1.652981
2025-04-15 07:32:14,955 - INFO -   Gradients: avg norm: 0.203713, max norm: 1.734877, non-zero params: 250
2025-04-15 07:32:14,956 - INFO -   Optimizer step complete, current LR: 7.500000e-05
2025-04-15 07:32:14,956 - INFO - --- Gradient Check @ Epoch 20, Batch 0 ---
2025-04-15 07:32:14,972 - INFO -   Total Trainable Params: 250, Params with Gradients: 250
2025-04-15 07:32:14,972 - INFO -   --- Gradient Stats by Component ---
2025-04-15 07:32:14,972 - INFO -     blocks: Found=120, Zero=0, None=0, AvgNorm=2.8244e-01, MaxNorm=9.7626e-01
2025-04-15 07:32:14,972 - INFO -     decoder_qual: Found=34, Zero=0, None=0, AvgNorm=8.8965e-03, MaxNorm=1.6342e-02
2025-04-15 07:32:14,972 - INFO -     decoder_rot: Found=34, Zero=0, None=0, AvgNorm=9.0965e-03, MaxNorm=2.1401e-02
2025-04-15 07:32:14,972 - INFO -     decoder_width: Found=34, Zero=0, None=0, AvgNorm=2.0428e-01, MaxNorm=4.6213e-01
2025-04-15 07:32:14,972 - INFO -     final_layer: Found=4, Zero=0, None=0, AvgNorm=9.3007e-01, MaxNorm=1.7349e+00
2025-04-15 07:32:14,972 - INFO -     t_embedder: Found=4, Zero=0, None=0, AvgNorm=5.5765e-01, MaxNorm=1.0382e+00
2025-04-15 07:32:14,972 - INFO -     tsdf_embedder: Found=14, Zero=0, None=0, AvgNorm=3.4955e-02, MaxNorm=1.5989e-01
2025-04-15 07:32:14,972 - INFO -     tsdf_encoder: Found=2, Zero=0, None=0, AvgNorm=4.3226e-01, MaxNorm=4.6517e-01
2025-04-15 07:32:14,972 - INFO -     x_embedder: Found=2, Zero=0, None=0, AvgNorm=3.1604e-01, MaxNorm=3.4888e-01
2025-04-15 07:32:14,972 - INFO -     y_embedder: Found=2, Zero=0, None=0, AvgNorm=7.7063e-01, MaxNorm=1.4051e+00
2025-04-15 07:32:14,972 - INFO - --- End Gradient Check ---
2025-04-15 07:32:14,975 - INFO - Batch 2/13: Generated dummy data
2025-04-15 07:32:14,975 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.6792, 3.5920]
2025-04-15 07:32:14,975 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6458, 3.0561]
2025-04-15 07:32:14,975 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:14,975 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:14,976 - INFO -   True actions shape: tensor([ 0.1930,  0.5639,  0.8529, -3.6792,  0.5468, -1.5467,  1.3106],
       device='cuda:0'), range: [-3.6792, 3.5920]
2025-04-15 07:32:14,976 - INFO -   Noise shape: tensor([-1.5491,  1.3658,  1.4721, -0.7912, -0.0394, -2.1894, -0.5519],
       device='cuda:0'), range: [-3.6419, 3.2186]
2025-04-15 07:32:14,977 - INFO -   Noisy actions shape: tensor([-0.5914,  1.1612,  1.4653, -3.5945,  0.4572, -2.4216,  0.8715],
       device='cuda:0'), range: [-3.5945, 3.2829]
2025-04-15 07:32:15,023 - INFO - Batch 3/13: Generated dummy data
2025-04-15 07:32:15,023 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3626, 3.8045]
2025-04-15 07:32:15,023 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2882, 2.8246]
2025-04-15 07:32:15,023 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,023 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,024 - INFO -   True actions shape: tensor([-0.5442,  0.0262, -2.1785, -0.2858,  2.3084, -0.3317,  0.9125],
       device='cuda:0'), range: [-3.3626, 3.8045]
2025-04-15 07:32:15,024 - INFO -   Noise shape: tensor([-0.4724, -2.2146,  0.5854, -0.8194, -0.8619,  1.4893,  0.6071],
       device='cuda:0'), range: [-3.4464, 3.3557]
2025-04-15 07:32:15,025 - INFO -   Noisy actions shape: tensor([-0.6820, -0.8100, -1.7974, -0.5735,  1.8136,  0.2538,  1.0740],
       device='cuda:0'), range: [-3.2225, 3.0002]
2025-04-15 07:32:15,070 - INFO - Batch 4/13: Generated dummy data
2025-04-15 07:32:15,070 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.2336, 3.3480]
2025-04-15 07:32:15,070 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9440, 3.2905]
2025-04-15 07:32:15,070 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,071 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,071 - INFO -   True actions shape: tensor([-0.9717, -1.1105, -0.2708, -0.9632,  0.1112,  1.5583, -0.2727],
       device='cuda:0'), range: [-3.2336, 3.3480]
2025-04-15 07:32:15,072 - INFO -   Noise shape: tensor([-0.0264,  0.2732,  0.4276, -0.8933,  1.3822, -1.9327, -0.1620],
       device='cuda:0'), range: [-3.4786, 3.4022]
2025-04-15 07:32:15,072 - INFO -   Noisy actions shape: tensor([-0.8876, -0.8832, -0.0593, -1.2547,  0.6979,  0.5696, -0.3159],
       device='cuda:0'), range: [-3.5100, 3.4046]
2025-04-15 07:32:15,118 - INFO - Batch 5/13: Generated dummy data
2025-04-15 07:32:15,118 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5733, 3.4426]
2025-04-15 07:32:15,119 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6320, 3.3496]
2025-04-15 07:32:15,119 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,119 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,120 - INFO -   True actions shape: tensor([-0.5160,  0.2003, -0.9696,  0.5016,  0.9624, -0.4655,  1.2259],
       device='cuda:0'), range: [-3.5733, 3.4426]
2025-04-15 07:32:15,120 - INFO -   Noise shape: tensor([-0.0353, -0.2832, -1.3095,  0.3595,  0.5861, -1.4555, -0.4330],
       device='cuda:0'), range: [-3.6547, 3.2266]
2025-04-15 07:32:15,121 - INFO -   Noisy actions shape: tensor([-0.4815,  0.0598, -1.4369,  0.6073,  1.1207, -1.0438,  0.9225],
       device='cuda:0'), range: [-3.5513, 3.4724]
2025-04-15 07:32:15,167 - INFO - Batch 6/13: Generated dummy data
2025-04-15 07:32:15,167 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.8088, 4.1657]
2025-04-15 07:32:15,167 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.6200, 3.1780]
2025-04-15 07:32:15,167 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,167 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,168 - INFO -   True actions shape: tensor([ 0.0199, -0.7528,  0.7358,  0.6367, -0.3671,  0.3945,  1.0726],
       device='cuda:0'), range: [-3.8088, 4.1657]
2025-04-15 07:32:15,168 - INFO -   Noise shape: tensor([ 0.3860,  0.9372,  0.1558, -1.0304,  0.8446,  0.5667, -0.6712],
       device='cuda:0'), range: [-3.5486, 3.3266]
2025-04-15 07:32:15,169 - INFO -   Noisy actions shape: tensor([ 0.3721,  0.6470,  0.3831, -0.7725,  0.6827,  0.6632, -0.2927],
       device='cuda:0'), range: [-3.1202, 3.4210]
2025-04-15 07:32:15,214 - INFO - Batch 7/13: Generated dummy data
2025-04-15 07:32:15,214 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.1582, 4.0602]
2025-04-15 07:32:15,214 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.1362, 2.9130]
2025-04-15 07:32:15,214 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,214 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,215 - INFO -   True actions shape: tensor([ 1.3264,  1.8816,  0.6848,  1.6666,  1.8480,  0.8859, -0.7095],
       device='cuda:0'), range: [-3.1582, 4.0602]
2025-04-15 07:32:15,216 - INFO -   Noise shape: tensor([ 0.0637, -0.9028, -0.3194,  1.6788,  0.2770, -1.1825,  0.1802],
       device='cuda:0'), range: [-3.0936, 4.0611]
2025-04-15 07:32:15,216 - INFO -   Noisy actions shape: tensor([ 0.5814, -0.0880, -0.0236,  2.1999,  0.9831, -0.7376, -0.1141],
       device='cuda:0'), range: [-3.5939, 3.6750]
2025-04-15 07:32:15,262 - INFO - Batch 8/13: Generated dummy data
2025-04-15 07:32:15,262 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4455, 3.2273]
2025-04-15 07:32:15,262 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.9935, 3.8385]
2025-04-15 07:32:15,262 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,262 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,263 - INFO -   True actions shape: tensor([ 0.2019, -0.0767, -1.1635,  0.5488,  0.2811,  1.7870, -2.0213],
       device='cuda:0'), range: [-3.4455, 3.2273]
2025-04-15 07:32:15,263 - INFO -   Noise shape: tensor([-0.6558,  0.5207, -0.6812, -0.4950, -0.8639,  0.5145, -0.5382],
       device='cuda:0'), range: [-3.6201, 3.1755]
2025-04-15 07:32:15,264 - INFO -   Noisy actions shape: tensor([-0.5636,  0.4728, -1.0024, -0.3050, -0.7378,  1.0330, -1.1267],
       device='cuda:0'), range: [-3.2736, 3.7919]
2025-04-15 07:32:15,309 - INFO - Batch 9/13: Generated dummy data
2025-04-15 07:32:15,309 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.4414, 3.0959]
2025-04-15 07:32:15,309 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.3684, 3.2127]
2025-04-15 07:32:15,310 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,310 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,310 - INFO -   True actions shape: tensor([-0.1756,  1.9477,  0.2831,  0.3896, -0.3827,  0.8501,  0.5485],
       device='cuda:0'), range: [-3.4414, 3.0959]
2025-04-15 07:32:15,311 - INFO -   Noise shape: tensor([ 1.4694,  0.4808, -0.2803, -1.1259,  1.2010, -1.6273,  0.4441],
       device='cuda:0'), range: [-3.2994, 3.8457]
2025-04-15 07:32:15,311 - INFO -   Noisy actions shape: tensor([ 1.4084,  0.8459, -0.2207, -1.0301,  1.1052, -1.4337,  0.5412],
       device='cuda:0'), range: [-3.5525, 3.6932]
2025-04-15 07:32:15,357 - INFO - Batch 10/13: Generated dummy data
2025-04-15 07:32:15,357 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.5798, 3.6638]
2025-04-15 07:32:15,357 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2009, 3.6766]
2025-04-15 07:32:15,357 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,357 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,358 - INFO -   True actions shape: tensor([-1.4419,  0.1562, -1.4365, -0.2353, -0.3466,  3.1770,  1.1831],
       device='cuda:0'), range: [-3.5798, 3.6638]
2025-04-15 07:32:15,358 - INFO -   Noise shape: tensor([-0.8559,  0.6490, -0.1248, -1.5214,  0.0388,  0.7449,  1.3151],
       device='cuda:0'), range: [-4.1777, 3.2253]
2025-04-15 07:32:15,359 - INFO -   Noisy actions shape: tensor([-0.9004,  0.6536, -0.1695, -1.5280,  0.0280,  0.8435,  1.3513],
       device='cuda:0'), range: [-3.4317, 3.2946]
2025-04-15 07:32:15,404 - INFO - Batch 11/13: Generated dummy data
2025-04-15 07:32:15,404 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3700, 3.4621]
2025-04-15 07:32:15,404 - INFO -   Condition shape: torch.Size([8, 104]), range: [-2.6490, 3.4745]
2025-04-15 07:32:15,404 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,404 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,405 - INFO -   True actions shape: tensor([ 1.5722,  0.6484,  1.2293, -0.2404,  0.9287,  0.5775, -1.9191],
       device='cuda:0'), range: [-3.3700, 3.4621]
2025-04-15 07:32:15,406 - INFO -   Noise shape: tensor([ 0.3132, -0.3535,  0.3109,  0.6166, -1.0784,  0.4697, -0.2734],
       device='cuda:0'), range: [-3.3771, 3.4339]
2025-04-15 07:32:15,406 - INFO -   Noisy actions shape: tensor([ 0.5884, -0.2322,  0.5251,  0.5639, -0.8956,  0.5652, -0.6111],
       device='cuda:0'), range: [-3.1411, 3.3757]
2025-04-15 07:32:15,449 - INFO -   Loss components:
2025-04-15 07:32:15,449 - INFO -     Diffusion loss: 1.244400 (coef: 1.0)
2025-04-15 07:32:15,449 - INFO -     Grasp quality loss: 0.693586 (coef: 0.5)
2025-04-15 07:32:15,449 - INFO -     Grasp rotation loss: 0.570225 (coef: 0.5)
2025-04-15 07:32:15,449 - INFO -     Grasp width loss: 4.314013 (coef: 0.005)
2025-04-15 07:32:15,449 - INFO -     TOTAL loss: 1.897875
2025-04-15 07:32:15,457 - INFO -   Gradients: avg norm: 0.205827, max norm: 1.889644, non-zero params: 250
2025-04-15 07:32:15,457 - INFO -   Optimizer step complete, current LR: 8.830222e-05
2025-04-15 07:32:15,460 - INFO - Batch 12/13: Generated dummy data
2025-04-15 07:32:15,460 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3768, 3.3270]
2025-04-15 07:32:15,460 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2982, 3.5843]
2025-04-15 07:32:15,460 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,460 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,461 - INFO -   True actions shape: tensor([-1.3376,  1.2323, -0.9400, -0.3675,  0.1983, -1.7497,  0.3063],
       device='cuda:0'), range: [-3.3768, 3.3270]
2025-04-15 07:32:15,461 - INFO -   Noise shape: tensor([-0.6592, -0.2981,  0.8255, -1.1390, -0.6732,  1.3160, -0.0504],
       device='cuda:0'), range: [-3.3635, 3.6500]
2025-04-15 07:32:15,462 - INFO -   Noisy actions shape: tensor([-1.1814,  0.2758,  0.3265, -1.1843, -0.5168,  0.4097,  0.0898],
       device='cuda:0'), range: [-3.7017, 3.5399]
2025-04-15 07:32:15,508 - INFO - Batch 13/13: Generated dummy data
2025-04-15 07:32:15,508 - INFO -   Trajectory shape: torch.Size([8, 50, 7]), range: [-3.3843, 3.4278]
2025-04-15 07:32:15,508 - INFO -   Condition shape: torch.Size([8, 104]), range: [-3.2916, 3.1912]
2025-04-15 07:32:15,508 - INFO -   TSDF grid shape: torch.Size([8, 1, 32, 32, 32]), sparsity: 0.00
2025-04-15 07:32:15,508 - INFO -   Grasp query points: torch.Size([8, 64, 3]), TSDF query points: torch.Size([8, 32, 3])
2025-04-15 07:32:15,509 - INFO -   True actions shape: tensor([ 0.8739,  0.5312, -0.6799, -0.4830, -1.9370, -0.5496,  2.2586],
       device='cuda:0'), range: [-3.3843, 3.4278]
2025-04-15 07:32:15,510 - INFO -   Noise shape: tensor([ 0.3204,  0.1344,  0.4832, -0.3186, -0.8485, -0.0725,  2.1080],
       device='cuda:0'), range: [-3.9848, 3.2482]
2025-04-15 07:32:15,510 - INFO -   Noisy actions shape: tensor([ 0.7537,  0.4080,  0.0213, -0.5340, -1.7852, -0.3670,  3.0098],
       device='cuda:0'), range: [-3.7363, 3.2206]
2025-04-15 07:32:15,554 - INFO - 
=== Epoch 20 Summary ===
2025-04-15 07:32:15,554 - INFO -   Avg total loss: 1.734884
2025-04-15 07:32:15,554 - INFO -   Avg diffusion loss: 1.079096
2025-04-15 07:32:15,554 - INFO -   Avg grasp loss: 1.311576
2025-04-15 07:32:15,722 - INFO - Checkpoint saved: runs/combined_train_standalone_test/20250415_073200/ckpt_epoch_20.pth
2025-04-15 07:32:15,723 - INFO - Saved model state with 16022452 parameters
2025-04-15 07:32:15,751 - INFO - 
=== Training Complete ===
2025-04-15 07:32:15,751 - INFO - Total training time: 0.24 minutes
2025-04-15 07:32:15,751 - INFO - Final global step: 260
2025-04-15 07:32:15,751 - INFO - ----------------------

2025-04-15 07:32:15,752 - INFO - 
=== Model Configuration ===
2025-04-15 07:32:15,752 - INFO - Model: PrestoGIGA with depth=12, heads=4, hidden=256
2025-04-15 07:32:15,752 - INFO - Sequence length: 50, patch size: 1
2025-04-15 07:32:15,752 - INFO - GIGA encoder: voxel_simple_local, decoder: simple_local, c_dim: 32
2025-04-15 07:32:15,752 - INFO - Diffusion: beta_schedule=squaredcos_cap_v2, steps=1000, type=epsilon
2025-04-15 07:32:15,752 - INFO - x0_type: step, x0_iter: 1
2025-04-15 07:32:15,752 - INFO - Optimizer: AdamW with lr=0.0001, weight_decay=0.01
