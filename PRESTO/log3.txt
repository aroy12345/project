2025-04-23 22:56:44,643 - INFO - --- Logging Initialized ---

2025-04-23 22:56:44,643 - INFO - Starting training with config: Config(meta=MetaConfig(project='trajopt-distance', task='test', group='ddim-shelf-kcfg-rename', run_id=None, resume=False), path=RunPath.Config(key_format='run-{:03d}', root='save/trajopt_distance', key=None), train=TrainConfig(learning_rate=0.0003, weight_decay=0.0, lr_warmup_steps=2000, lr_schedule='cos', num_epochs=512, batch_size=128, num_configs=1000, save_epoch=64, use_amp=False, collision_coef=0.05, distance_coef=0.005, diffusion_coef=1.0, euclidean_coef=0.1, mp_cost_type='ddpm', cost=CuroboCost.Config(margin=0.01, robot_file='franka.yml', sweep=False, export_world=None, force_reset=False, relabel=False, esdf=False, classify=False, sum_dist=True), cached_cost=CachedCuroboCost.Config(margin=0.01, robot_file='franka.yml', base_cfg_file='base_cfg.yml', gradient_file='gradient_trajopt.yml', sweep=False, sum_dist=True, export_world=None, force_reset=False, relabel=False, pad=True, esdf=False, classify=False), use_cached=True, use_ng=False, log_by='epoch', step_max=None, check_cost=False, weighting_scheme='logit_normal', logit_mean=0.0, logit_std=1.0, mode_scale=1.29), diffusion=DiffusionConfig(num_train_diffusion_iter=1024, pred_type='v_prediction', sched_type='ddim', rescale_betas_zero_snr=True, timestep_spacing='trailing', beta_start=0.0001, beta_end=0.02, beta_schedule='sqrt_cos', clip_sample=True, shift=3.0), model=ModelConfig(model_type='dit', seq_len=256, obs_dim=7, cond_dim=1024, embed_dim=512, dit=DiT.Config(input_size=256, patch_size=8, in_channels=7, hidden_size=512, num_layer=6, num_heads=16, mlp_ratio=4.0, class_dropout_prob=0.0, cond_dim=1024, learn_sigma=False, use_cond=True, use_pos_emb=False, dim_pos_emb=192, use_amp=None, sin_emb_x=0, cat_emb_x=False, use_cond_token=True, use_cloud=False), dit_cloud=DiTCloud.Config(input_size=256, patch_size=20, in_channels=7, hidden_size=512, num_layer=4, num_heads=16, mlp_ratio=4.0, class_dropout_prob=0.0, cond_dim=1024, learn_sigma=True, use_cond=True, use_pos_emb=False, dim_pos_emb=192, use_amp=None, sin_emb_x=0, cat_emb_x=False, use_cond_token=False, use_cloud=False, cloud_size=1024, num_cloud_token=8, num_cloud_layer=4, norm_cloud_token=False, cloud_block2=False, cond_type='mean', split_c=False), subnet_type='dit'), data=DataConfig(dataset_type='shelf', dataset_dir='/input/presto-simple', relative=False, start_zero=True, normalize=True, add_task_cond=True, load_cloud=False, shelf=PrestoDatasetShelf.Config(dataset_dir='data/presto_cabinet_train/merge-v3', dataset_type='pkl', pattern='*.pkl', normalize=True, device='cuda', load_count=None, use_kcfg=True, add_task_cond=True, binarize=True, one_hot=False, stride=3, embed_init_goal=128, retime=True, prim=True, index=None, prim_label=False, use_v2=True, add_cloud=False), embed_init_goal=128), device='cuda', cfg_file=None, x0_type='step', x0_iter=4, load_ckpt=None, reweight_loss_by_coll=False, use_wandb=True)
2025-04-23 22:57:01,764 - INFO - key=run-013
2025-04-23 22:57:01,764 - INFO - self.dir=save/trajopt_distance/run-013
